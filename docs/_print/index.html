<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.99.0"><link rel=canonical type=text/html href=https://www.eucastack.io/docs/><link rel=alternate type=application/rss+xml href=https://www.eucastack.io/docs/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Documentation | EucaStack</title><meta name=description content="Overview
Documentation for Eucalyptus Cloud, the open source software for building AWS-compatible private and hybrid clouds.
Guides
This documentation …"><meta property="og:title" content="Documentation"><meta property="og:description" content="A Docsy example site"><meta property="og:type" content="website"><meta property="og:url" content="https://www.eucastack.io/docs/"><meta property="og:site_name" content="EucaStack"><meta itemprop=name content="Documentation"><meta itemprop=description content="A Docsy example site"><meta name=twitter:card content="summary"><meta name=twitter:title content="Documentation"><meta name=twitter:description content="A Docsy example site"><link rel=preload href=/scss/main.min.dbc832a6b41f9cb352db274e4a5e4f9087c9f9f914bcd919a25e9dad92d530f3.css as=style><link href=/scss/main.min.dbc832a6b41f9cb352db274e4a5e4f9087c9f9f914bcd919a25e9dad92d530f3.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-00000000-0","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><svg viewBox="0 0 1388.9 333.38" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g transform="translate(-136.21 41.582)"><path transform="matrix(.26458 0 0 .26458 136.21 -41.582)" d="m1616.4 487.23c-38.46.0-73.324 9.8216-104.59 29.467s-55.615 47.177-73.047 82.594c-17.155 35.14-25.732 75.123-25.732 119.95v12.451c0 66.96 19.782 120.64 59.35 161.04 39.844 40.12 91.725 60.18 155.64 60.18 37.354.0 70.971-7.3314 100.85-21.996 30.16-14.941 54.232-35.833 72.217-62.672l-54.369-51.879c-29.053 37.354-66.683 56.029-112.89 56.029-32.926.0-60.319-10.791-82.178-32.373-21.582-21.582-33.896-50.911-36.939-87.988h293.43v-40.674c0-71.387-16.741-126.59-50.221-165.6-33.203-39.014-80.378-58.52-141.53-58.52zm927.61.0c-63.086.0-112.89 20.613-149.41 61.84-36.523 40.951-54.785 95.598-54.785 163.94v10.377c0 71.663 18.399 127.83 55.199 168.51 36.8 40.674 86.605 61.01 149.41 61.01 32.373.0 62.532-7.0547 90.478-21.166 27.946-14.111 50.081-33.203 66.406-57.275 16.325-24.349 25.042-50.497 26.148-78.443h-95.045c-1.1067 21.582-9.9609 39.706-26.562 54.371-16.602 14.665-37.491 21.996-62.67 21.996-33.203.0-58.659-11.898-76.367-35.693-17.432-24.072-26.148-60.456-26.148-109.15v-16.188c.2767-48.145 9.2702-83.975 26.978-107.49 17.708-23.796 42.887-35.695 75.537-35.695 25.456.0 46.345 8.3008 62.67 24.902 16.602 16.602 25.456 37.77 26.562 63.502h95.045c-1.6602-50.635-19.368-91.448-53.125-122.44-33.48-31.266-76.921-46.898-130.32-46.898zm439.94.0c-34.587.0-65.992 6.0872-94.215 18.262-27.946 12.174-50.081 29.053-66.406 50.635-16.325 21.305-24.486 44.271-24.486 68.896h100.85c0-17.708 7.3333-32.236 21.998-43.58 14.665-11.621 33.48-17.432 56.445-17.432 26.562.0 46.345 7.0566 59.35 21.168 13.004 13.835 19.508 32.373 19.508 55.615v29.469h-61.842c-66.13.0-117.04 12.865-152.73 38.598-35.417 25.456-53.125 62.118-53.125 109.99.0 37.907 14.251 69.727 42.75 95.459s65.299 38.598 110.4 38.598c46.484.0 85.775-16.739 117.87-50.219 3.3203 19.369 7.194 33.34 11.621 41.918h102.93v-7.0547c-11.344-24.072-17.018-56.308-17.018-96.705v-202.54c-.8301-47.868-16.878-84.945-48.144-111.23-31.266-26.563-73.184-39.844-125.76-39.844zm-1099.9 8.3008v290.94c0 53.955 12.451 95.182 37.354 123.68 25.179 28.499 62.118 42.748 110.82 42.748 54.508.0 96.566-17.432 126.17-52.295l2.4903 43.994h95.045v-449.07h-100.86v322.49c-17.155 35.14-50.221 52.709-99.195 52.709-47.314.0-70.971-28.499-70.971-85.498v-289.7h-100.86zm-268.12 72.631c27.946.0 49.805 8.7168 65.576 26.148 15.772 17.155 24.765 42.611 26.978 76.367v7.4707h-192.16c4.7038-34.587 15.495-61.563 32.373-80.932 17.155-19.369 39.567-29.055 67.236-29.055zm1386.6 165.6h54.371v84.668c-8.8542 16.325-22.135 29.329-39.844 39.014-17.432 9.6842-36.109 14.527-56.031 14.527-21.582.0-38.874-5.6732-51.879-17.018-12.728-11.621-19.092-27.116-19.092-46.484.0-23.796 9.4075-42.195 28.223-55.199 18.815-13.005 46.898-19.508 84.252-19.508z" fill="#fff"/><path transform="matrix(.26458 0 0 .26458 136.21 -41.582)" d="m4889.8 307.1v637.5h100.85V798.09l44.824-46.07 133.23 192.58h116.62l-184.69-261.89 166.85-187.18h-121.19l-124.1 139.87-31.543 39.43V307.11h-100.85zm-1162.1 79.271v109.16h-73.877v74.707h73.877v254.42c0 85.498 38.737 128.25 116.21 128.25 21.305.0 43.441-3.181 66.406-9.5449v-78.027c-11.898 2.7669-23.656 4.1504-35.277 4.1504-17.432.0-29.606-3.7364-36.523-11.207-6.6406-7.7474-9.9609-20.199-9.9609-37.354v-250.68h79.272v-74.707h-79.272v-109.16h-100.86zm-296.34 100.86c-50.358.0-91.862 13.005-124.51 39.014-32.65 26.009-48.975 58.382-48.975 97.119.0 46.208 25.179 81.487 75.537 105.84 22.965 11.068 51.602 20.199 85.912 27.393 34.31 7.194 58.798 15.495 73.463 24.902 14.942 9.4076 22.412 23.103 22.412 41.088.0 16.325-6.9174 29.606-20.752 39.844-13.835 9.9609-34.033 14.941-60.596 14.941-27.392.0-49.39-6.3639-65.992-19.092-16.602-13.005-25.593-31.404-26.977-55.199h-97.949c0 26.839 8.0241 51.879 24.072 75.121 16.048 23.242 38.46 41.504 67.236 54.785s61.563 19.922 98.363 19.922c54.232.0 98.088-12.451 131.57-37.354 33.48-25.179 50.221-57.966 50.221-98.363.0-24.072-5.5338-44.548-16.602-61.426-10.791-16.878-27.532-31.266-50.221-43.164-22.412-12.174-53.402-22.551-92.969-31.129-39.567-8.8542-65.853-17.569-78.857-26.146-13.005-8.5775-19.508-20.615-19.508-36.109.0-17.155 6.9173-30.852 20.752-41.09 14.112-10.238 32.236-15.355 54.371-15.355 23.795.0 42.887 6.5013 57.275 19.506 14.388 12.728 21.582 28.776 21.582 48.145h100.86c0-42.334-16.602-76.781-49.805-103.34-32.926-26.563-76.23-39.844-129.91-39.844zm733.79.0c-34.587.0-65.99 6.0872-94.213 18.262-27.946 12.174-50.081 29.053-66.406 50.635-16.325 21.305-24.488 44.271-24.488 68.896h100.86c0-17.708 7.3313-32.236 21.996-43.58 14.665-11.621 33.48-17.432 56.445-17.432 26.562.0 46.347 7.0566 59.352 21.168 13.005 13.835 19.506 32.373 19.506 55.615v29.469h-61.84c-66.13.0-117.04 12.865-152.73 38.598-35.417 25.456-53.125 62.118-53.125 109.99.0 37.907 14.249 69.727 42.748 95.459 28.499 25.732 65.3 38.598 110.4 38.598 46.484.0 85.775-16.739 117.87-50.219 3.3202 19.369 7.194 33.34 11.621 41.918h102.93v-7.0547c-11.344-24.072-17.016-56.308-17.016-96.705v-202.54c-.83-47.868-16.878-84.945-48.144-111.23-31.266-26.563-73.186-39.844-125.76-39.844zm464.84.0c-63.086.0-112.89 20.613-149.41 61.84-36.524 40.951-54.785 95.598-54.785 163.94v10.377c0 71.663 18.401 127.83 55.201 168.51 36.8 40.674 86.605 61.01 149.41 61.01 32.373.0 62.532-7.0547 90.479-21.166 27.946-14.111 50.081-33.203 66.406-57.275 16.325-24.349 25.042-50.497 26.148-78.443h-95.045c-1.1066 21.582-9.9608 39.706-26.562 54.371-16.601 14.665-37.493 21.996-62.672 21.996-33.203.0-58.659-11.898-76.367-35.693-17.432-24.072-26.146-60.456-26.146-109.15V711.36c.2769-48.145 9.2682-83.975 26.976-107.49 17.708-23.796 42.888-35.695 75.537-35.695 25.456.0 46.347 8.3008 62.672 24.902 16.602 16.602 25.456 37.77 26.562 63.502h95.045c-1.6602-50.635-19.37-91.448-53.127-122.44-33.48-31.266-76.921-46.898-130.32-46.898zm-446.17 246.53h54.369v84.668c-8.8541 16.325-22.135 29.329-39.844 39.014-17.432 9.6842-36.107 14.527-56.029 14.527-21.582.0-38.876-5.6732-51.881-17.018-12.728-11.621-19.092-27.116-19.092-46.484.0-23.796 9.4075-42.195 28.223-55.199 18.815-13.005 46.9-19.508 84.254-19.508z" fill="#8bc13a"/></g><g transform="translate(9.5814 7.9375)"><path transform="scale(.26458)" d="m560.34-22.102-558.42 231.31c-21.06 8.7235-38.133 34.275-38.133 57.07v688.09c0 11.398 8.5364 24.173 19.067 28.535l577.49 239.2c10.53 4.3617 27.603 4.3617 38.133.0l558.42-231.31c21.06-8.7235 38.133-34.275 38.133-57.07v-688.09c0-11.398-8.5364-24.173-19.067-28.535l-577.49-239.2c-10.53-4.3617-27.603-4.3617-38.133.0z" fill="#fff"/></g><g transform="translate(-1331.7 150.96)"><g transform="translate(-.13227 -.14313)"><path transform="scale(.26458)" d="m5651.4-517.82c-4.3107-.18795-9.0505.68347-14.025 2.7441l-507.35 210.15c-19.9 8.2427-36.031 32.385-36.031 53.924v642c0 11.537 4.7163 19.84 12.072 23.934v.06641l1.0156.41992c1.147.55934 2.2859 1.1151 3.5469 1.4688l116.15 48.111v-90l410.6-170.08c19.9-8.2427 36.031-32.385 36.031-53.924v-581l108.64 45v-80l-120.26-49.812c-3.0346-1.7765-6.523-2.8394-10.385-3.0078z" fill="#8bc13a"/><path d="m1379.7 116.68V-53.18c0-5.6989 4.2682-12.087 9.5333-14.268l134.24-55.602c5.2651-2.1809 9.5333.67105 9.5333 6.3699v169.86c0 5.6989-4.2682 12.087-9.5333 14.268l-134.24 55.602c-5.2651 2.1809-9.5333-.67105-9.5333-6.3699z" fill="#003556"/><path transform="scale(.26458)" d="m5856.6-432.82c-4.3107-.18795-9.0505.68347-14.025 2.7441l-507.35 210.15c-19.9 8.2427-36.031 32.385-36.031 53.924v642c0 11.536 4.7155 19.84 12.07 23.934v.06641l1.0352.42969c1.1397.55448 2.2713 1.1073 3.5234 1.459l116.15 48.111v-90l410.6-170.08c19.9-8.2427 36.031-32.385 36.031-53.924v-561l108.64 45v-1e2l-120.26-49.812c-3.0347-1.7765-6.525-2.8394-10.387-3.0078z" fill="#8bc13a"/><path d="m1434 139.17V-30.69c0-5.6989 4.2682-12.087 9.5333-14.268l134.24-55.602c5.2651-2.1809 9.5333.67105 9.5333 6.3699v169.86c0 5.6989-4.2682 12.087-9.5333 14.268l-134.24 55.602c-5.2651 2.1809-9.5333-.67105-9.5333-6.3699z" fill="#003556"/><path transform="scale(.26458)" d="m6061.8-347.82c-4.3107-.18795-9.0505.68347-14.025 2.7441l-507.35 210.15c-19.9 8.2427-36.031 32.385-36.031 53.924v642c1e-4 11.537 4.7163 19.84 12.072 23.934v.06641l1.0156.41992c1.147.55934 2.2859 1.1151 3.5469 1.4688l116.15 48.111v-90l410.6-170.08c19.9-8.2427 36.031-32.385 36.031-53.924v-561l108.64 45v-1e2l-120.25-49.811c-3.036-1.7784-6.5287-2.8413-10.393-3.0098z" fill="#8bc13a"/><path d="m1488.3 161.66v-169.86c0-5.6989 4.2682-12.087 9.5333-14.268l134.24-55.602c5.2651-2.1809 9.5333.67105 9.5333 6.3699v169.86c0 5.6989-4.2682 12.087-9.5333 14.268l-134.24 55.602c-5.2651 2.1809-9.5333-.67105-9.5333-6.3699z" fill="#003556"/><path d="m1520.2-14.532 89.523-37.082c5.2651-2.1809 9.5333.67105 9.5333 6.3699v135.47c0 5.6989-4.2682 12.087-9.5333 14.268l-89.523 37.082c-5.2651 2.1809-9.5333-.67104-9.5333-6.3699v-135.47c0-5.6989 4.2682-12.087 9.5333-14.268z" fill="#fff"/><path d="m1596.9 85.99-63.876 26.458-1e-4-46.302 49.504-20.505V29.766l-49.504 20.505 1e-4-46.302 63.876-26.458z" fill="#8bc13a"/></g></g></svg></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/docs/><i class="fas fa-book"></i><span class=active>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/blog/><i class="fas fa-rss"></i><span>Blog</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community/><i class="fas fa-users"></i><span>Community</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/docs/>Return to the regular view of this page</a>.</p></div><h1 class=title>Documentation</h1><ul><li>1: <a href=#pg-fbefc613e3033c21ad569e127331156e>Installation Guide</a></li><ul><li>1.1: <a href=#pg-1982a068fa7e47f88783f4d54cb5d003>Installation Overview</a></li><ul></ul><li>1.2: <a href=#pg-6d78406d918bd7894025c1743b526546>Introduction to Eucalyptus</a></li><ul><li>1.2.1: <a href=#pg-de069bf8912ac64065ebcab85c7461f3>Eucalyptus Overview</a></li><ul></ul><li>1.2.2: <a href=#pg-23a4f3e33ed01dedee5d6356fc8830b7>Eucalyptus Components</a></li><ul></ul><li>1.2.3: <a href=#pg-57cacd852b34aa702681badd617fa5c5>System Requirements</a></li><ul></ul></ul><li>1.3: <a href=#pg-e01281a8db4910fb78f0d12ffd65afe0>Automated Eucalyptus Installation</a></li><ul></ul><li>1.4: <a href=#pg-12bc0a87fc6f085bd8de2b8681be810a>Manual Eucalyptus Installation</a></li><ul><li>1.4.1: <a href=#pg-b7604a899f9379e2a4ad64b89548b5a3>Plan Your Installation</a></li><ul><li>1.4.1.1: <a href=#pg-0462e0983621e9e80df8057a5f87089e>Eucalyptus Architecture Overview</a></li><ul></ul><li>1.4.1.2: <a href=#pg-c57095c343881511c6992288161bb07d>Plan Your Hardware</a></li><ul></ul><li>1.4.1.3: <a href=#pg-e6dc0ef0fcec95ccdc99df75bd2c99f8>Plan Services Placement</a></li><ul></ul><li>1.4.1.4: <a href=#pg-447c3fba4a65cbe021e473fffd22ce9d>Plan Disk Space</a></li><ul></ul><li>1.4.1.5: <a href=#pg-3a0799333f9d078659c0417ef1a1bc02>Plan Eucalyptus Features</a></li><ul><li>1.4.1.5.1: <a href=#pg-1abf120cbe2ad01da294a3af9af82b16>Availability Zone Support</a></li><ul></ul><li>1.4.1.5.2: <a href=#pg-c67311d13adefe1c703c24414718c35f>Object Storage</a></li><ul></ul></ul><li>1.4.1.6: <a href=#pg-d4b6f38707425e1c71a4e9bf6b20026f>Plan Networking Modes</a></li><ul><li>1.4.1.6.1: <a href=#pg-9e803e1e2ff2aef49d537ffcdab263e0>About Eucanetd</a></li><ul></ul><li>1.4.1.6.2: <a href=#pg-4a09021661db136481b10bdbcfcadf33>Understanding Eucalyptus EDGE Mode</a></li><ul></ul><li>1.4.1.6.3: <a href=#pg-89eeb5c8d44418651392426591292fef>Understanding VPCMIDO and MidoNet</a></li><ul></ul></ul><li>1.4.1.7: <a href=#pg-a2181acdf80f6af185740ebc8fad10a0>Prepare the Network</a></li><ul><li>1.4.1.7.1: <a href=#pg-09ac412868e7569242d53b81dd90e21f>Reserve Ports</a></li><ul></ul><li>1.4.1.7.2: <a href=#pg-f79af8966d6daed045469c4cbf231034>Verify Connectivity</a></li><ul></ul></ul></ul><li>1.4.2: <a href=#pg-7445d721146b3bd901e55ec91ae81aa4>Configure Dependencies</a></li><ul><li>1.4.2.1: <a href=#pg-6cefa559970e018b0616595a7b88f9d3>Configure Bridges</a></li><ul></ul><li>1.4.2.2: <a href=#pg-df5626afcae9a08fe87ee2b7a8bdf8ce>Disable FirewallD on RHEL 7</a></li><ul></ul><li>1.4.2.3: <a href=#pg-1cd6ada50e0e7b78b2d90f4603c34345>Configure NTP</a></li><ul></ul><li>1.4.2.4: <a href=#pg-b492735f6bd0619b5a487201a17fedcc>Configure Java</a></li><ul></ul><li>1.4.2.5: <a href=#pg-eca124ba6897a9d471807816d50dc50d>Configure an MTA</a></li><ul></ul><li>1.4.2.6: <a href=#pg-d116f8746c016eeb95e02cf25d69dc9b>Install MidoNet</a></li><ul><li>1.4.2.6.1: <a href=#pg-5bb925d2c296c64558ffa27487ecb1a6>Prerequisites</a></li><ul></ul><li>1.4.2.6.2: <a href=#pg-5002f76f28ab24c82d06601830a8d53a>MidoNet Component Topology</a></li><ul></ul><li>1.4.2.6.3: <a href=#pg-b670fbdd76e9d8c060bb6a50218a5226>Install MidoNet for Eucalyptus</a></li><ul></ul></ul></ul><li>1.4.3: <a href=#pg-671d5e1abc09d2e7bfe7ddbd6dde02d9>Install Repositories</a></li><ul><li>1.4.3.1: <a href=#pg-0b4fcc2c7d167b279883e39950e226b6>Software Signing</a></li><ul></ul><li>1.4.3.2: <a href=#pg-90008be4c92c3bb568e4cc25e4c50356>Install Eucalyptus Release Packages</a></li><ul></ul></ul><li>1.4.4: <a href=#pg-44973e6bf96612bed4bcbdfbd9a7fd95>Configure Eucalyptus</a></li><ul><li>1.4.4.1: <a href=#pg-14155a79410525e50ff553116b98f68e>Configure SELinux</a></li><ul></ul><li>1.4.4.2: <a href=#pg-b207cc52541e5c29799b86402eba76bf>Configure Network Modes</a></li><ul><li>1.4.4.2.1: <a href=#pg-a2a9c18fa398c16422822d97110e4c38>Configure EDGE Network Mode</a></li><ul></ul><li>1.4.4.2.2: <a href=#pg-8a92c056ba1bcd9ef177398b6531e644>Configure VPCMIDO Network Mode</a></li><ul><li>1.4.4.2.2.1: <a href=#pg-f8ba73af96d5cbb99b41ddffed1ee80e>VPCMIDO Gateway Configuration Parameters</a></li><ul></ul></ul></ul><li>1.4.4.3: <a href=#pg-4a69989b840665db85b061db956b4cb4>Create Scheduling Policy</a></li><ul></ul></ul><li>1.4.5: <a href=#pg-5ae0c9c8d53a01fedd24bb294ad33591>Start Eucalyptus</a></li><ul><li>1.4.5.1: <a href=#pg-e5e8324b00fdfa50dcd59ddbf6f60ddb>Start the CLC</a></li><ul></ul><li>1.4.5.2: <a href=#pg-e52984760577000fde6160fd154cc81e>Start the UFS</a></li><ul></ul><li>1.4.5.3: <a href=#pg-914aa1501b6ef1bcbb0e19230cf43590>Start Walrus</a></li><ul></ul><li>1.4.5.4: <a href=#pg-fba34cb1eb8eead504cd60172f4a0f09>Start the CC</a></li><ul></ul><li>1.4.5.5: <a href=#pg-f56ccb1e4b8ad50651edc72cca7ba09d>Start the SC</a></li><ul></ul><li>1.4.5.6: <a href=#pg-a2992fd0511e4cd5b3e30621ca66c715>Start the NC</a></li><ul></ul><li>1.4.5.7: <a href=#pg-42ad0538f40eb9fe89a3ea0967ab4d80>Start the Management Console</a></li><ul></ul><li>1.4.5.8: <a href=#pg-e7dfbf0222ff21863a7a57492266c6d4>Verify the Startup</a></li><ul></ul></ul><li>1.4.6: <a href=#pg-108e0ca8c7851c5668e3b09f56eae60e>Register Eucalyptus Services</a></li><ul><li>1.4.6.1: <a href=#pg-6c3b799939e318d49db2499a7bd58541>Register User-Facing Services</a></li><ul></ul><li>1.4.6.2: <a href=#pg-0333fa64f2ebc68bd3e0ed029d46c621>Register the Walrus Backend</a></li><ul></ul><li>1.4.6.3: <a href=#pg-04341adcb357c8048563067bfaf9e9fd>Register the Cluster Controller</a></li><ul></ul><li>1.4.6.4: <a href=#pg-a4d7a5b8052a5795166ed717511322d1>Register the Storage Controller</a></li><ul></ul><li>1.4.6.5: <a href=#pg-df7fcaa99d87b06e61625e4a49b721de>Register the Node Controllers</a></li><ul></ul></ul><li>1.4.7: <a href=#pg-9f6ef2abc861228ad98d0746a52e3bbf>Configure the Runtime Environment</a></li><ul><li>1.4.7.1: <a href=#pg-a0ef37a70072d465efc415fbe578fa67>Configure Eucalyptus DNS</a></li><ul></ul><li>1.4.7.2: <a href=#pg-09d0cc0a79d201e09f5c9804c4c61cd3>Create the Eucalyptus Cloud Administrator User</a></li><ul></ul><li>1.4.7.3: <a href=#pg-dc4447570e8060e614e4b8d90b23a14c>Upload the Network Configuration</a></li><ul></ul><li>1.4.7.4: <a href=#pg-fd3ae2688dc91115bc710364761b2ce5>Configure Eucalyptus Storage</a></li><ul><li>1.4.7.4.1: <a href=#pg-a6a6c7da8c6d5461dad3100d9ba3e31c>Configure Block Storage</a></li><ul><li>1.4.7.4.1.1: <a href=#pg-aa18b8d819fd6a67cb70f4fa0d18328b>Use Ceph-RBD</a></li><ul><li>1.4.7.4.1.1.1: <a href=#pg-30efcc5250832311a0363dcab5fce14e>Configure Hypervisor Support for Ceph-RBD</a></li><ul></ul></ul><li>1.4.7.4.1.2: <a href=#pg-3545c566a3fc5b961cdc7b265f1876ce>About the BROKEN State</a></li><ul></ul><li>1.4.7.4.1.3: <a href=#pg-07723a85c687e2a440a2f0f6cefdfba9>Use Direct Attached Storage (JBOD)</a></li><ul></ul><li>1.4.7.4.1.4: <a href=#pg-8aef961027c14d30b9d6272cd4fd35d4>Use the Overlay Local Filesystem</a></li><ul></ul></ul><li>1.4.7.4.2: <a href=#pg-25aafdcb9e624a1e783a00453ac2ce31>Configure Object Storage</a></li><ul><li>1.4.7.4.2.1: <a href=#pg-06a4664ccf8870894a6bb96a526ff06f>Use Ceph-RGW</a></li><ul></ul><li>1.4.7.4.2.2: <a href=#pg-84f727ca46a827f083dac6dafc1dba25>Use MinIO Backend</a></li><ul></ul><li>1.4.7.4.2.3: <a href=#pg-bfe6a73803221ee955acb39011736fbe>Use Walrus Backend</a></li><ul></ul></ul></ul><li>1.4.7.5: <a href=#pg-88c36c1a825c683df6b9c36b64b2ad63>Install and Configure the Imaging Service</a></li><ul></ul><li>1.4.7.6: <a href=#pg-ebb91e7b9d56062f2a00522894fe0965>Configure the Load Balancer</a></li><ul></ul><li>1.4.7.7: <a href=#pg-d2c8e2a6f2f469cba2014a65b5ab8768>Configure Node Controller</a></li><ul></ul></ul></ul><li>1.5: <a href=#pg-18cc942116b7be0a5dd971348caeb9f8>Client Installation</a></li><ul><li>1.5.1: <a href=#pg-8cea5def468485a152ffc86adafe42ca>AWS CLI Installation</a></li><ul></ul><li>1.5.2: <a href=#pg-a6359d685c4cda87190983e9d9228cb1>Euca2ools Standalone Installation</a></li><ul></ul></ul><li>1.6: <a href=#pg-8515c0c3c3e0fe7882713abf9dd756c5>Find More Information</a></li><ul></ul></ul><li>2: <a href=#pg-19f5e2511913cedf804f463954f59f69>Administration Guide</a></li><ul><li>2.1: <a href=#pg-074ed240259ce2673819b6d36b698b33>Management Overview</a></li><ul><li>2.1.1: <a href=#pg-08cc7e8e4f67103184d84c0c0eae071f>Overview of Eucalyptus</a></li><ul></ul><li>2.1.2: <a href=#pg-27f8046ed1bbae7b0d4a03fc2af70fcd>Command Line Interface</a></li><ul></ul></ul><li>2.2: <a href=#pg-7c57425594226a312363f5d8cfd308cc>Manage Your Cloud</a></li><ul><li>2.2.1: <a href=#pg-b3a46ec9125656b706d97df986bc7a8e>Cloud Overview</a></li><ul></ul><li>2.2.2: <a href=#pg-d73ed3e9be6276adf1279150e887ad16>Cloud Best Practices</a></li><ul><li>2.2.2.1: <a href=#pg-0c436b3bf6b70c20c0ce3404204c17f4>Synchronize Clocks</a></li><ul></ul><li>2.2.2.2: <a href=#pg-cc2d80c5dff82bc6fab5e1644ee01aca>Configure SSL</a></li><ul></ul><li>2.2.2.3: <a href=#pg-f68cd1ff367b861eaae9def533f65647>Storage Volumes</a></li><ul></ul></ul><li>2.2.3: <a href=#pg-6099fc0dd7ed56fbedde6ac653013f29>Cloud Tasks</a></li><ul><li>2.2.3.1: <a href=#pg-25c5c10adb123e14983d2795cb6da1e4>Inspect System Health</a></li><ul></ul><li>2.2.3.2: <a href=#pg-767e10bba226dfa998d960b8f8db15a1>View User Resources</a></li><ul></ul><li>2.2.3.3: <a href=#pg-40eae85392833eb096392d5106a8dc59>Change Network Configuration</a></li><ul><li>2.2.3.3.1: <a href=#pg-b9e646cefa91214c3c1dd7fd1d68523f>Networking Configuration Options</a></li><ul></ul></ul><li>2.2.3.4: <a href=#pg-b9307d8c7842213d531a1887a7cff498>Add a Node Controller</a></li><ul></ul><li>2.2.3.5: <a href=#pg-b94a8f5398dab9391684bbba3babbcc9>Migrate Instances Between Node Controllers</a></li><ul></ul><li>2.2.3.6: <a href=#pg-305df335c1e1184ccbecdecf3dbaed8c>Remove a Node Controller</a></li><ul></ul><li>2.2.3.7: <a href=#pg-cec332a68c9602c3dd63331552c1a240>Restart Eucalyptus</a></li><ul><li>2.2.3.7.1: <a href=#pg-e02fe48225ce8b52cecd81c56c1b7c75>Shut Down All Instances</a></li><ul></ul><li>2.2.3.7.2: <a href=#pg-ed8972bfa7c21e81d9c319bd1b821695>Restart the CLC</a></li><ul></ul><li>2.2.3.7.3: <a href=#pg-3bde7106c2cd8834340b697a46b497af>Restart Walrus</a></li><ul></ul><li>2.2.3.7.4: <a href=#pg-1e4cb3fd184cc4c16f0c3297b02062dc>Restart the CC</a></li><ul></ul><li>2.2.3.7.5: <a href=#pg-845252ede8416a07631956756ce7ee36>Restart the SC</a></li><ul></ul><li>2.2.3.7.6: <a href=#pg-4bc52c55980cc5901a1c043b23a6bce8>Restart an NC</a></li><ul></ul></ul><li>2.2.3.8: <a href=#pg-69c1fe179039b186dcb51d9c2c1fd5af>Shut Down Eucalyptus</a></li><ul><li>2.2.3.8.1: <a href=#pg-fdf4afeb6709fa4aa52a8adc853fd267>Shut Down All Instances</a></li><ul></ul><li>2.2.3.8.2: <a href=#pg-2baf2c0364f55c61223c36f37adb156b>Shut Down the NCs</a></li><ul></ul><li>2.2.3.8.3: <a href=#pg-d7a70b66de8a1142c36f1af178ee2f2e>Shut Down the CCs</a></li><ul></ul><li>2.2.3.8.4: <a href=#pg-514810555162e04167ff04de95c11329>Shut Down the SCs</a></li><ul></ul><li>2.2.3.8.5: <a href=#pg-4eeca744ed3e81940980ca7850c932ed>Shut Down Walrus</a></li><ul></ul><li>2.2.3.8.6: <a href=#pg-f6f892cd051d9b9c7572679c49841736>Shut Down the CLC</a></li><ul></ul></ul><li>2.2.3.9: <a href=#pg-bd7d4a47a2762fa1f7267d2aec9dbbae>Disable CloudWatch</a></li><ul></ul></ul></ul><li>2.3: <a href=#pg-409e6261b06210f064883bd322fd80a0>Operations</a></li><ul><li>2.3.1: <a href=#pg-ebfd7f8f734a435867e539f62e247e35>Operations Overview</a></li><ul></ul><li>2.3.2: <a href=#pg-ba269b0051a8d0bf24b4c651de0407ba>Planning Your Deployment</a></li><ul></ul><li>2.3.3: <a href=#pg-513c1f5ea9e48bc66b63d63705bd6285>Testing Your Deployment</a></li><ul></ul><li>2.3.4: <a href=#pg-b4fc1a7b029c7f366c80a05a9415a4e2>Customizing Your Deployment</a></li><ul></ul><li>2.3.5: <a href=#pg-d3dc2274c8d9ba899d5b287b9e7fecd7>Managing Policies</a></li><ul></ul><li>2.3.6: <a href=#pg-c402cfde98e55529aa6c3fe474f0e1cf>Networking</a></li><ul></ul><li>2.3.7: <a href=#pg-94d6b71bfdb57b839443a8eb5fe41b4d>Monitoring</a></li><ul></ul><li>2.3.8: <a href=#pg-5ba778536cf329f3f22230937a68bfd5>Backup and Recovery</a></li><ul><li>2.3.8.1: <a href=#pg-52db2925512295cf7d8cba9b1ce0b676>Back Up Eucalyptus Cloud Data</a></li><ul><li>2.3.8.1.1: <a href=#pg-e5a12f89eb93ddf43353e2b70c052f99>Back Up the Database</a></li><ul></ul></ul><li>2.3.8.2: <a href=#pg-5cf42cac5b615d53b45cc5386be85dd9>Recover Eucalyptus Cloud Data</a></li><ul><li>2.3.8.2.1: <a href=#pg-4f71551333a6fc86a65369a23bf0eecc>Restore the Database</a></li><ul></ul></ul></ul><li>2.3.9: <a href=#pg-773e3fce9d093e7f7f47622dd59594b2>Troubleshooting</a></li><ul><li>2.3.9.1: <a href=#pg-449c7065f0f6ff554817ce04a8b4f4fc>Eucalyptus Log Files</a></li><ul></ul><li>2.3.9.2: <a href=#pg-186617b25ccba629a34b947a31509cf8>Network Information</a></li><ul></ul><li>2.3.9.3: <a href=#pg-6ff55e132456066cd91070cc57fe4e20>Common Problems</a></li><ul><li>2.3.9.3.1: <a href=#pg-db12c95988678b82de1626a327e04931>Problem: can't communicate with instance</a></li><ul></ul><li>2.3.9.3.2: <a href=#pg-e45f12c11a3ecedb728511fcf82a4bcc>Problem: install-time checks</a></li><ul></ul><li>2.3.9.3.3: <a href=#pg-8d009201f7ce8c96ae19456ce0b09336>Problem: instance runs but fails</a></li><ul></ul><li>2.3.9.3.4: <a href=#pg-c8e2c9f569c1bb7a549a1dffc10c38cf>Problem: snapshot creation failed</a></li><ul></ul><li>2.3.9.3.5: <a href=#pg-eb35ffdc7c3611be1e9b4bbfc74c51e9>Problem: volume creation failed</a></li><ul></ul></ul><li>2.3.9.4: <a href=#pg-4e75713b798e9f1356b1c9622e50f794>Component Workarounds</a></li><ul><li>2.3.9.4.1: <a href=#pg-6c93c08954ec6e4ca0b7c95fb598f8a4>Access and Identities</a></li><ul></ul><li>2.3.9.4.2: <a href=#pg-dfdf1ab52db293741aa0539b53c504a7>Elastic Load Balancing</a></li><ul></ul><li>2.3.9.4.3: <a href=#pg-f1e33740e1d4467eebdfe02297aef981>Imaging Worker</a></li><ul></ul><li>2.3.9.4.4: <a href=#pg-58919d9aac2f9e11e6ba972627dd4bbd>Instances</a></li><ul></ul><li>2.3.9.4.5: <a href=#pg-d6cbcd9901b5e3c3cb26119429a1da9a>Walrus and Storage</a></li><ul></ul></ul></ul></ul><li>2.4: <a href=#pg-c2b7309755f32db77e33eb61e57d3ece>Manage Resources</a></li><ul><li>2.4.1: <a href=#pg-edf86d14926ae3a2bbefffedef75cbeb>Manage Auto Scaling Resources</a></li><ul></ul><li>2.4.2: <a href=#pg-f4988213f26f030d1e85ce5aeddaabce>Manage CloudWatch Resources</a></li><ul></ul><li>2.4.3: <a href=#pg-2ce7519662bd80408299a03a60cb02c5>Manage Compute Resources</a></li><ul></ul><li>2.4.4: <a href=#pg-064b0a1d8dd0ee794906de718d301ad2>Manage ELB Resources</a></li><ul></ul><li>2.4.5: <a href=#pg-942fda2d9d757d8ea3d1be5c0b1d3f7d>Manage IAM Resources</a></li><ul></ul><li>2.4.6: <a href=#pg-6f77576acb8c9ef68ed227f6a296c19a>Manage Walrus Resources</a></li><ul></ul></ul><li>2.5: <a href=#pg-320258f138ecdf359054b41c11eb2d1f>Manage Regions</a></li><ul><li>2.5.1: <a href=#pg-db615c32de89d91a77013d625ff2e499>Regions Overview</a></li><ul></ul><li>2.5.2: <a href=#pg-fedae7a6c85d933e61e99e237cd57022>Region Configuration File Format</a></li><ul></ul><li>2.5.3: <a href=#pg-a462f267acaac5c4b8976eeaae34fe55>Examples</a></li><ul></ul><li>2.5.4: <a href=#pg-740779bdf59dfee316438e0ca35651ca>Federation Differences Between AWS and Eucalyptus</a></li><ul></ul><li>2.5.5: <a href=#pg-8e39bf241d6fac54907f76a6c54f4c6a>Troubleshooting</a></li><ul></ul></ul><li>2.6: <a href=#pg-278f037a8bd490532a48f4f1a61bd8e5>Manage Security</a></li><ul><li>2.6.1: <a href=#pg-5b7d7dee815ee6bcca58655f04835d1c>Security Overview</a></li><ul></ul><li>2.6.2: <a href=#pg-697bda1d9d1dd21fb81f0e1acb65c52d>Best Practices</a></li><ul><li>2.6.2.1: <a href=#pg-83e928201de7403ef1103d92ab7fea90>Authentication and Access Control Best Practices</a></li><ul></ul><li>2.6.2.2: <a href=#pg-ba213df0e04164ac639d1838a5962490>Hosts</a></li><ul></ul><li>2.6.2.3: <a href=#pg-5676afb7c0aa1c817051295ff82d245b>Images and Instances</a></li><ul></ul><li>2.6.2.4: <a href=#pg-116e73440d426e3c5ea9bef31359e1b5>Management Console</a></li><ul></ul><li>2.6.2.5: <a href=#pg-8bf0377070c3313dea6e1ff81ee341ef>Message Security</a></li><ul></ul><li>2.6.2.6: <a href=#pg-c47d035995b8048e6a740e8c3ee23f23>Networking Modes</a></li><ul></ul></ul><li>2.6.3: <a href=#pg-13246c7b0d9bef36481bdf14a4cd5846>Security Tasks</a></li><ul><li>2.6.3.1: <a href=#pg-226e0bfa8b3c0ed408ce08527d014c08>Configure SSL</a></li><ul><li>2.6.3.1.1: <a href=#pg-dddbacba6d71acd887c93037013a80f0>Configure and Enable SSL for the Management Console</a></li><ul></ul><li>2.6.3.1.2: <a href=#pg-57fbe3724e7cedcae9c871e49b0c4ad9>Configure and Enable SSL for the UFS</a></li><ul></ul></ul><li>2.6.3.2: <a href=#pg-f830b9392693b0e025f4e6bd3504f145>Change Multicast Address</a></li><ul></ul><li>2.6.3.3: <a href=#pg-28a7fb3671e5a330f487e45ac93c2298>Configure Replay Protection</a></li><ul></ul><li>2.6.3.4: <a href=#pg-5e82611da967775627cb729da5a91d5f>Configure Session Timeouts</a></li><ul></ul><li>2.6.3.5: <a href=#pg-1ba059d499956d167936d9424839cde6>Configure STS Actions</a></li><ul></ul><li>2.6.3.6: <a href=#pg-6341f918a06a1cdf6c45dcb3a1658ec6>Configure the Firewall</a></li><ul></ul><li>2.6.3.7: <a href=#pg-1f9a21e581772e0f82f0ef2c19c6a415>Reserve Ports</a></li><ul></ul><li>2.6.3.8: <a href=#pg-5eed8aeffe499879dcbee977c2a48e2b>Synchronize Components</a></li><ul></ul></ul></ul><li>2.7: <a href=#pg-25d5c1581cfff916bab451388a3fd597>Eucalyptus Commands</a></li><ul><li>2.7.1: <a href=#pg-6969b7b3f9e92cd651d22c179842083b>Eucalyptus Administration Commands</a></li><ul><li>2.7.1.1: <a href=#pg-a2d37d4166ce932546080639f12d8306>euctl</a></li><ul></ul><li>2.7.1.2: <a href=#pg-8cf7f7238ebe61a58f5ac8ed855fb652>euserv-deregister-service</a></li><ul></ul><li>2.7.1.3: <a href=#pg-a5bfbddcc33a3bc8eaefea7da24ef443>euserv-describe-events</a></li><ul></ul><li>2.7.1.4: <a href=#pg-c70f153ba84a6618f2f703140174aadd>euserv-describe-node-controllers</a></li><ul></ul><li>2.7.1.5: <a href=#pg-e9a48048918ffaf831fb098b1d60207c>euserv-describe-service-types</a></li><ul></ul><li>2.7.1.6: <a href=#pg-d778cb3b0aaf9315d3e4d21e5a17faf5>euserv-describe-services</a></li><ul></ul><li>2.7.1.7: <a href=#pg-f36f17e872bf9ed38edd86c023d9cbe8>euserv-migrate-instances</a></li><ul></ul><li>2.7.1.8: <a href=#pg-5337787a5abaab70a9ea99454b1aa3eb>euserv-modify-service</a></li><ul></ul><li>2.7.1.9: <a href=#pg-c5b48c310af33cd72b92785cce136c58>euserv-register-service</a></li><ul></ul></ul><li>2.7.2: <a href=#pg-5c036c1422f881139c085dfb36899de3>Eucalyptus Configuration Variables</a></li><ul></ul></ul><li>2.8: <a href=#pg-477d92ba2e18c93ed66a01a0a25b975d>Advanced Storage Configuration</a></li><ul><li>2.8.1: <a href=#pg-295d8e8f523b64cb65b220c89c352b76>OSG Advanced Configuration</a></li><ul></ul></ul></ul><li>3: <a href=#pg-13493f4b6354d2403513e9c3ca6c28cd>User Guide</a></li><ul><li>3.1: <a href=#pg-85f55646064f1dec46959e9c3daa72ab>Eucalyptus Overview</a></li><ul></ul><li>3.2: <a href=#pg-7ccd036145111c0b3368cd5072ab982d>Getting Started</a></li><ul><li>3.2.1: <a href=#pg-e0617e76c8036d82da2243711cac82df>Getting Started with the Eucalyptus Management Console</a></li><ul><li>3.2.1.1: <a href=#pg-2f7b6c129c029052d00bc07f9cd62d79>Console Login</a></li><ul></ul><li>3.2.1.2: <a href=#pg-a8a8d8e2f6913a7a6ecefa02cbdb34dc>Launch and Connect to an Instance with the Management Console</a></li><ul></ul><li>3.2.1.3: <a href=#pg-2240f361898c60bd0a70d9cd2335bffe>Set Up A Web Server on an Instance</a></li><ul></ul><li>3.2.1.4: <a href=#pg-a3bcdbed84d0b1cd6dfdded6507eafb3>Reboot an Instance with the Management Console</a></li><ul></ul><li>3.2.1.5: <a href=#pg-aec23dc55cbb9df683302eeffee5924c>Terminate an Instance with the Management Console</a></li><ul></ul></ul><li>3.2.2: <a href=#pg-fa37186bd5f27c35edba56002937484b>Getting Started with the AWS CLI</a></li><ul></ul><li>3.2.3: <a href=#pg-d7a6d5f63064093cc68394c2fd2504bc>Getting Started with Euca2ools</a></li><ul></ul></ul><li>3.3: <a href=#pg-8cef1bc119dfdc0a049083c756c1e3b0>Using Instances</a></li><ul><li>3.3.1: <a href=#pg-c8c8904933395220f6e6f02f9f38f8ab>Instance Overview</a></li><ul><li>3.3.1.1: <a href=#pg-707e8d9b576f5953437508761993f01c>Instance Concepts</a></li><ul></ul><li>3.3.1.2: <a href=#pg-c63429542400b7a279b8b1078a07fb43>Instance Basics</a></li><ul><li>3.3.1.2.1: <a href=#pg-b57674acf9fe6ea2a2a8008cfdff8ca2>Virtual Machine Types</a></li><ul></ul><li>3.3.1.2.2: <a href=#pg-4e63c349678457b1b72c9935c40ac634>Ephemeral Linux Instances</a></li><ul></ul><li>3.3.1.2.3: <a href=#pg-d62df5951494ee46a1ad7a21c0b7416d>EBS-Backed Instances</a></li><ul><li>3.3.1.2.3.1: <a href=#pg-502b551b05ef67f98038caf6f8a4eb57>Comparing Instance Types</a></li><ul></ul><li>3.3.1.2.3.2: <a href=#pg-c7b3795a5460a910fe5dac797f20ad4e>Using EBS-Backed Instances</a></li><ul></ul><li>3.3.1.2.3.3: <a href=#pg-c2fe73bb7c748d43cef3c10c00583725>Suspending and Resuming EBS-Backed Instances</a></li><ul></ul><li>3.3.1.2.3.4: <a href=#pg-41690748817a78956fae5de69ab20ec6>EBS EMI Creation Overview</a></li><ul><li>3.3.1.2.3.4.1: <a href=#pg-4c08ac2498e9684f659efd667898b1fc>Create an EBS EMI</a></li><ul></ul></ul></ul></ul></ul><li>3.3.2: <a href=#pg-83652bc4be9268467c42ab3484f0e40a>Instance Tasks</a></li><ul><li>3.3.2.1: <a href=#pg-4431c3c3b61c62f799aec4295b107972>Authorize Security Groups</a></li><ul></ul><li>3.3.2.2: <a href=#pg-546931904329351c201dba64cb89bb39>Create Key Pairs</a></li><ul></ul><li>3.3.2.3: <a href=#pg-905ee14893a84b2745ff29c0ef61b535>Find an Image</a></li><ul></ul><li>3.3.2.4: <a href=#pg-525f763e09b9be41d25f1be85b460a5b>Launch an Instance</a></li><ul></ul><li>3.3.2.5: <a href=#pg-e176b4c3908ff2cbf5db5f64c1ebee7e>Log in to an Instance</a></li><ul></ul><li>3.3.2.6: <a href=#pg-2f379d6e014e7c1d96aff4819e677b7c>Reboot an Instance</a></li><ul></ul><li>3.3.2.7: <a href=#pg-469bfcc1237864a18c2680a9642d16ba>Terminate an Instance</a></li><ul></ul></ul></ul><li>3.4: <a href=#pg-0be18b368f65d8d2c92834ec5538e410>Using EBS</a></li><ul><li>3.4.1: <a href=#pg-31c75827e10c1e182a3219af935fc5ec>EBS Overview</a></li><ul></ul><li>3.4.2: <a href=#pg-b7ccf5028c0d51a8483e0e9dbab864c4>EBS Tasks</a></li><ul><li>3.4.2.1: <a href=#pg-b35aea79c89f1e994e72383068d64b2f>Create and Attach an EBS Volume</a></li><ul></ul><li>3.4.2.2: <a href=#pg-4d27f361294d4088d42f0e2f28e4fc06>List Available EBS Volumes</a></li><ul></ul><li>3.4.2.3: <a href=#pg-342628b6c418ae44913f5db90085207b>Detach an EBS Volume</a></li><ul></ul><li>3.4.2.4: <a href=#pg-5a971a6386dcddcbeafeaec0a93954d1>Create a Snapshot</a></li><ul></ul><li>3.4.2.5: <a href=#pg-71839a6768e53254fa7a77f3762aa369>List Available Snapshots</a></li><ul></ul><li>3.4.2.6: <a href=#pg-67417bb3e6e5b99bc61bd05c2c357333>Delete a Snapshot</a></li><ul></ul></ul></ul><li>3.5: <a href=#pg-bc2ec5acd11c798f24b0d13d9b265b43>Using Tags and Filters</a></li><ul><li>3.5.1: <a href=#pg-6336ee0d735b8b532ea96ff02720c720>Tagging and Filtering Overview</a></li><ul><li>3.5.1.1: <a href=#pg-60a80d0c9ddbf683a4e4190e48ed483e>Tagging Resources</a></li><ul></ul><li>3.5.1.2: <a href=#pg-aa8f5aec560ade894a46a3970dfbf14e>Filtering Resources</a></li><ul></ul></ul><li>3.5.2: <a href=#pg-6bd1385dba448291dd98302145461127>Tagging and Filtering Tasks</a></li><ul><li>3.5.2.1: <a href=#pg-dd571d37f5c80cdcde9d3a6732730c01>Add a Tag</a></li><ul></ul><li>3.5.2.2: <a href=#pg-042b4d977236060f7f46fbed197c0590>List Tags</a></li><ul></ul><li>3.5.2.3: <a href=#pg-1855209f1ecefb64ccd88f7af8b7c8b8>Change a Tag's Value</a></li><ul></ul><li>3.5.2.4: <a href=#pg-9b1a43ba2107a4f7eafe77b5ee38d4ec>Delete a Tag</a></li><ul></ul><li>3.5.2.5: <a href=#pg-1270c26578adb8e744d48ed49e2f1e74>Filter by Tag</a></li><ul></ul></ul></ul><li>3.6: <a href=#pg-ab7c354e5ad78e7429a5dc9aa9029889>Managing Access</a></li><ul><li>3.6.1: <a href=#pg-3d2989c89b0e9dd4fb0ef6ef92ac4a1c>Groups</a></li><ul><li>3.6.1.1: <a href=#pg-6f28ff1ca761e9e3262daf843ecc60eb>Create a Group</a></li><ul></ul><li>3.6.1.2: <a href=#pg-efab8a77484ceb68ddfd46bb2d03f60d>Add a Group Policy</a></li><ul></ul><li>3.6.1.3: <a href=#pg-c9e870f9faf2341d92203254dc47199e>Modify a Group</a></li><ul></ul><li>3.6.1.4: <a href=#pg-22f88efb8f7b4230c617ce233958b08e>Add a User to a Group</a></li><ul></ul><li>3.6.1.5: <a href=#pg-e86d20ce4bd225b0dc141c155d554ca3>Remove a User from a Group</a></li><ul></ul><li>3.6.1.6: <a href=#pg-0ffc021482c3305f0a60954b22bcd807>List Groups</a></li><ul></ul><li>3.6.1.7: <a href=#pg-24fe2284a9b4c5dac4de4e3b984907ea>Delete a Group</a></li><ul></ul></ul><li>3.6.2: <a href=#pg-6820a056ed00ccc938ab0e1d5bc2fbbc>Users</a></li><ul><li>3.6.2.1: <a href=#pg-342fe017ac5a34ef1d0f3e3591560d1b>Add a User</a></li><ul></ul><li>3.6.2.2: <a href=#pg-752c1c6d43c0a1ec40de40e16ac7757b>Create a Login Profile</a></li><ul></ul><li>3.6.2.3: <a href=#pg-52fdb183c537a61661d91b13998619b4>Modify a User</a></li><ul></ul><li>3.6.2.4: <a href=#pg-26affa6e4f189906a2479f938e44bf6e>Change User Path</a></li><ul></ul><li>3.6.2.5: <a href=#pg-732f9e3d6d25d353e49876081277ff93>Change User Password</a></li><ul></ul><li>3.6.2.6: <a href=#pg-7b318b328661bcfbe169389beddb17a1>List Users</a></li><ul></ul><li>3.6.2.7: <a href=#pg-0a09544f1e4b3297bc5e07fddde2cc06>Delete a User</a></li><ul></ul></ul><li>3.6.3: <a href=#pg-407c51194c7080ffe59d541454978bdc>Credentials</a></li><ul><li>3.6.3.1: <a href=#pg-2fa37849f9c1f6c20198b2ea31557ca7>Create Credentials</a></li><ul></ul><li>3.6.3.2: <a href=#pg-ef53b52e534f0ea94eba216f4cbef56f>Upload a Certificate</a></li><ul></ul></ul></ul><li>3.7: <a href=#pg-771685f3698cbf9f2500bba7717c4bf1>Using VM Networking and Security</a></li><ul><li>3.7.1: <a href=#pg-8e5e2d308d2a6de61e0cdec278497495>Associate an IP Address with an Instance</a></li><ul></ul><li>3.7.2: <a href=#pg-eba6d058af5f53c724aac0b09f2ead69>Release an IP Address</a></li><ul></ul><li>3.7.3: <a href=#pg-a708dbaf6ae500e2811936c10cba1ada>Create a Security Group</a></li><ul></ul><li>3.7.4: <a href=#pg-ca7e9523da8da1f44b9a178664b281e5>Delete a Security Group</a></li><ul></ul><li>3.7.5: <a href=#pg-fcb1a70c1a948cba1ca649d72cbb7c99>Authorize Security Group Rules</a></li><ul></ul><li>3.7.6: <a href=#pg-c85449799b2f17c043704492a4a20e32>Revoke Security Group Rules</a></li><ul></ul></ul><li>3.8: <a href=#pg-9b7bdc22a4ccce9fcccfa599c27cb642>Using Auto Scaling</a></li><ul><li>3.8.1: <a href=#pg-eca302cc14efa49f00bba5ea410e31e7>How Auto Scaling Works</a></li><ul></ul><li>3.8.2: <a href=#pg-18877d04bc0954a2d14b9a825becf87e>Auto Scaling Concepts</a></li><ul><li>3.8.2.1: <a href=#pg-ec71d585508ba55ce2779a64496f9175>Understanding Launch Configurations</a></li><ul></ul><li>3.8.2.2: <a href=#pg-3f7496825c64b070eef53cc4acc6b30d>Understanding Auto Scaling Groups</a></li><ul></ul><li>3.8.2.3: <a href=#pg-21224594ae25d8659105c5691ab05af7>Understanding Auto Scaling Policies</a></li><ul></ul><li>3.8.2.4: <a href=#pg-1039aae90fb93b25460c6a3f9b056d4c>Understanding Health Checks</a></li><ul></ul><li>3.8.2.5: <a href=#pg-8566326bbd9883d42b15b0bac8e468f1>Understanding Instance Termination Policies</a></li><ul></ul></ul><li>3.8.3: <a href=#pg-d921ce29126b5c99559b331c22229ef0>Auto Scaling Usage Examples</a></li><ul><li>3.8.3.1: <a href=#pg-c036ed77e65d33988a1baddd590db82e>Creating a Basic Auto Scaling Configuration</a></li><ul></ul><li>3.8.3.2: <a href=#pg-cdb324072ca0c83712273c2e73d1192a>Configuring a Demand-Based Scaling Policy</a></li><ul></ul><li>3.8.3.3: <a href=#pg-b0cf01cf054f73b508f76b8e16b3106d>Configuring Health Checks</a></li><ul></ul><li>3.8.3.4: <a href=#pg-c0a0eccf064a86028174691a2cc3ab0f>Configuring an Instance Termination Policy</a></li><ul></ul><li>3.8.3.5: <a href=#pg-85971fafb1ec1756b89b860719894dc1>Configuring Auto Scaling with Elastic Load Balancing</a></li><ul></ul></ul></ul><li>3.9: <a href=#pg-fa9c57ce9cf0f118403555c12854216f>Using Elastic Load Balancing</a></li><ul><li>3.9.1: <a href=#pg-3efded6de8291ff4c6b94c2482944aa9>Elastic Load Balancing Overview</a></li><ul><li>3.9.1.1: <a href=#pg-52af6b78792afd89a364bc84e5671daa>Elastic Load Balancing Concepts</a></li><ul></ul></ul><li>3.9.2: <a href=#pg-0ef117021b7f2e69b6b89b62164a657f>Eucalyptus Load Balancing Usage Examples</a></li><ul><li>3.9.2.1: <a href=#pg-d435e90ef9d0abe8cf8635997f7c2916>Eucalyptus ELB Listener Configurations</a></li><ul></ul><li>3.9.2.2: <a href=#pg-441800215b6afae35e19bd054f75affd>Creating a Basic Elastic Load Balancing Configuration</a></li><ul></ul><li>3.9.2.3: <a href=#pg-9b07046d5cfd7a621ae1abebbaa563bb>Configuring the Health Check</a></li><ul></ul><li>3.9.2.4: <a href=#pg-174d97ee16b0c7ca97b9cd8e0d1c14d1>Modifying an Elastic Load Balancing Configuration</a></li><ul></ul><li>3.9.2.5: <a href=#pg-5d3d174a5842b1b8c026080102c901df>Creating Elastic Load Balancing Sticky Sessions</a></li><ul></ul><li>3.9.2.6: <a href=#pg-f1ad054efec9e95d751013d7b0f2103c>Uploading SSL Certificates for Elastic Load Balancing</a></li><ul></ul><li>3.9.2.7: <a href=#pg-84660b0f56fa561f8e7dd7fd39147d84>Adding SSL Support</a></li><ul></ul><li>3.9.2.8: <a href=#pg-6daed41591ecf089789af6ae6c4f4c9c>Updating the SSL Negotiation Configuration</a></li><ul></ul><li>3.9.2.9: <a href=#pg-ad3df4530193d2f58cafb2565733cba6>Adding and Editing Predefined Security Policies</a></li><ul></ul><li>3.9.2.10: <a href=#pg-9eafb00077fc3a1a35dfa444899e3962>Configuring Back-end Server Authentication</a></li><ul></ul><li>3.9.2.11: <a href=#pg-43db79d13bfc91251cd4fc4343275495>Enabling Cross-Zone Load Balancing</a></li><ul></ul><li>3.9.2.12: <a href=#pg-65ae084284fdc29b9fc2bf4bf58cabf6>Accessing Load Balancer Logs</a></li><ul></ul></ul></ul><li>3.10: <a href=#pg-e2537d6cae270c2662113e6704686e49>Using CloudWatch</a></li><ul><li>3.10.1: <a href=#pg-ba38e0f8d65765ef9bcbb48ac325b0fd>CloudWatch Overview</a></li><ul><li>3.10.1.1: <a href=#pg-de26569f213c700b3e57db3b7012fd27>CloudWatch Concepts</a></li><ul></ul><li>3.10.1.2: <a href=#pg-3b5b122efee1ace175c6ccba6745c721>Namespaces, Metrics, and Dimensions</a></li><ul><li>3.10.1.2.1: <a href=#pg-88efa26658a001d560fce3ae313b2d65>Namespaces</a></li><ul></ul><li>3.10.1.2.2: <a href=#pg-47515a2b2793917872c10fdb522c10da>Instance Metrics and Dimensions</a></li><ul></ul><li>3.10.1.2.3: <a href=#pg-efeec537c451e9e7ddb811e740c25c4b>EBS Metrics and Dimensions</a></li><ul></ul><li>3.10.1.2.4: <a href=#pg-6310ab278a92a17016f53fc8d51fd556>Auto Scaling Metrics and Dimensions</a></li><ul></ul><li>3.10.1.2.5: <a href=#pg-fcd023d86753d7a388178c89e8d61668>ELB Metrics and Dimensions</a></li><ul></ul></ul></ul><li>3.10.2: <a href=#pg-8335412c70063736f4ead3d2c0b2a905>CloudWatch Tasks</a></li><ul><li>3.10.2.1: <a href=#pg-510e16c7fba8408b8a3310fa823896df>Configuring Monitoring</a></li><ul><li>3.10.2.1.1: <a href=#pg-09a589afd5cc8a4a8d929168058bb87f>Enable Monitoring</a></li><ul></ul><li>3.10.2.1.2: <a href=#pg-507278909208e5e78085e4cb24776f25>Disable Monitoring</a></li><ul></ul></ul><li>3.10.2.2: <a href=#pg-0d91fb6ab60e290d5d3123d4919a2041>Viewing and Publishing Metrics</a></li><ul><li>3.10.2.2.1: <a href=#pg-31655e3bc3911b43dbbd5461613ac43d>List Available Metrics</a></li><ul></ul><li>3.10.2.2.2: <a href=#pg-4a58c6e031aaa184531b2d009b2ee36a>Get Statistics for a Metric</a></li><ul></ul><li>3.10.2.2.3: <a href=#pg-c0f64dfbb19c23bdb97ba7dd7a1ec5dc>Publish Custom Metrics</a></li><ul></ul><li>3.10.2.2.4: <a href=#pg-a6b482304590bdee0ed027c6050cf792>Modify Metric Polling Timing</a></li><ul></ul></ul><li>3.10.2.3: <a href=#pg-4ffb6602b363163032c20bc9576ac0ca>Configuring Alarms</a></li><ul><li>3.10.2.3.1: <a href=#pg-b324598b5d78202fe7038ed12b933f84>Create an Alarm</a></li><ul></ul><li>3.10.2.3.2: <a href=#pg-4505c07adc12e8c41df5e2928668541d>Test an Alarm</a></li><ul></ul><li>3.10.2.3.3: <a href=#pg-5953f3e5b73a1493608731018d21703d>Delete an Alarm</a></li><ul></ul></ul></ul></ul><li>3.11: <a href=#pg-88e53ce2fba838d96249ddad99d4cbf9>Using Object Storage</a></li><ul><li>3.11.1: <a href=#pg-28970e2b1f6059613beb141748479142>Access Object Storage</a></li><ul></ul></ul><li>3.12: <a href=#pg-02cba64fa23838de5af5870774334303>Using Route53</a></li><ul><li>3.12.1: <a href=#pg-99545870fdb7b8ece45ca25e77436db3>Route53 Concepts</a></li><ul></ul><li>3.12.2: <a href=#pg-f146d3642318659063bc98995e4793ad>Route53 Usage</a></li><ul></ul><li>3.12.3: <a href=#pg-1b5e6b30624788fc3ce78b0d4f182d8c>Route53 Delegated Subdomain</a></li><ul></ul></ul><li>3.13: <a href=#pg-f6982d0753d21dc2259ad3af26fbdd7f>Using Simple Queue Service</a></li><ul><li>3.13.1: <a href=#pg-a945a3681424452a865a77f09ee6c361>Simple Queue Service Concepts</a></li><ul></ul><li>3.13.2: <a href=#pg-4695109097ddeeb95b11f0f914f20676>Simple Queue Service Overview</a></li><ul></ul></ul><li>3.14: <a href=#pg-c590edd3b622a7fa8a549679149755fd>Using CloudFormation</a></li><ul><li>3.14.1: <a href=#pg-16f6676bbc04702c9aa113b96e8208bb>CloudFormation Use Case</a></li><ul></ul><li>3.14.2: <a href=#pg-70fe51a9080ba0a3a8dd4d5b64a0c516>CloudFormation Templates</a></li><ul></ul><li>3.14.3: <a href=#pg-21e29648ce96484797f4155e4f10cac0>Troubleshooting CloudFormation</a></li><ul></ul></ul><li>3.15: <a href=#pg-54de08f31ea3a000e9d4c449e213742a>Using Virtual Private Cloud</a></li><ul><li>3.15.1: <a href=#pg-98a4c8eabd3123e6c2febb3fc85d9a08>How VPC Works</a></li><ul><li>3.15.1.1: <a href=#pg-1476e25db6444279c953d0bf4910fee1>Default VPCs</a></li><ul></ul><li>3.15.1.2: <a href=#pg-90f3cb02a25b58e0f1210668106b6e0b>Subnets and IP Addressing</a></li><ul></ul></ul><li>3.15.2: <a href=#pg-9696b58e42c55b3f2386909aefa32a8d>Understanding VPC Networking Concepts</a></li><ul><li>3.15.2.1: <a href=#pg-a2fc9c3cb43048d3dba6174f4d88338c>Domain Name System (DNS)</a></li><ul></ul><li>3.15.2.2: <a href=#pg-c0b77bfe05ecbbbc8b0c5c63a84365ae>Elastic Network Interfaces (ENIs)</a></li><ul></ul><li>3.15.2.3: <a href=#pg-17b230366694602b68dca7534531c6b5>Route Tables</a></li><ul></ul><li>3.15.2.4: <a href=#pg-813b39755fd2696456e6c9e942b46520>Internet Gateways</a></li><ul></ul><li>3.15.2.5: <a href=#pg-16a25a9a6d471ed2564d98fdb25c53e7>Network Address Translation (NAT) Gateways</a></li><ul></ul></ul><li>3.15.3: <a href=#pg-364ac051523babdcea4194ceefceb519>VPC Security Concepts</a></li><ul><li>3.15.3.1: <a href=#pg-e051c24ce8cd658239c4695c54061aff>Security Groups</a></li><ul></ul></ul></ul></ul><li>4: <a href=#pg-48f04918ab7d0b3b8f48499011af68a2>Identity and Access Management (IAM) Guide</a></li><ul><li>4.1: <a href=#pg-f6da8fc8ef0827125e645306bec13ada>IAM Overview</a></li><ul></ul><li>4.2: <a href=#pg-69ad99986647a1ebf7fd6be4ffbfa240>Work with IAM</a></li><ul></ul><li>4.3: <a href=#pg-90c01c24a1427f3b5047b1d987236d28>Manage Identities Overview</a></li><ul></ul><li>4.4: <a href=#pg-96fced99c900b9e11c51c5f599ea87fa>Authentication and Access Control Best Practices</a></li><ul></ul><li>4.5: <a href=#pg-5085d7067a5b593ef29e26bb3ecd627d>Manage Users and Groups</a></li><ul><li>4.5.1: <a href=#pg-5fca87e4a6c9e3079871a4b36ee5dedb>Access Overview</a></li><ul><li>4.5.1.1: <a href=#pg-b42155c89673875a0b80cbb32539bc6e>Access Concepts</a></li><ul><li>4.5.1.1.1: <a href=#pg-3a29bfab6ef24865dd5d8def713c0463>User Identities</a></li><ul></ul><li>4.5.1.1.2: <a href=#pg-41f08888d693ab8ca7df8e8896ef2b2c>Special Identities</a></li><ul></ul><li>4.5.1.1.3: <a href=#pg-5f719c74a4c9fdeafacfb5d3a81eed5b>Credentials</a></li><ul></ul><li>4.5.1.1.4: <a href=#pg-2b47b57b4394be60269a788523a4d435>Account Creation</a></li><ul></ul><li>4.5.1.1.5: <a href=#pg-ef6bd0d48c0481e73fc7d1380b447e84>Special User Attributes</a></li><ul></ul><li>4.5.1.1.6: <a href=#pg-4c249034d75e75bbe34ed2b982efd5ef>Roles</a></li><ul></ul></ul><li>4.5.1.2: <a href=#pg-10ac73830e44db67e0bd489683d323c9>Policy Overview</a></li><ul><li>4.5.1.2.1: <a href=#pg-5b6c57aa0721763e54d72328818b1489>Default Permissions</a></li><ul></ul><li>4.5.1.2.2: <a href=#pg-1df740d0f1d9b6aee225cc02210fdb78>Quotas</a></li><ul></ul><li>4.5.1.2.3: <a href=#pg-2fd1500750414686247b9a98920b6a79>Algorithms</a></li><ul></ul><li>4.5.1.2.4: <a href=#pg-a50cea07654bcd0b3fba9751d30080ef>Sample Policies</a></li><ul></ul></ul></ul><li>4.5.2: <a href=#pg-211e97ce1f13ff3dbf0a61508e74de7c>Access Tasks</a></li><ul><li>4.5.2.1: <a href=#pg-66b688f91bd75e9ff79293a8cecea97a>Use Case: Create an Administrator</a></li><ul></ul><li>4.5.2.2: <a href=#pg-b3ab8773164c8b2c00d5acec7fb01370>Use Case: Create a User</a></li><ul></ul><li>4.5.2.3: <a href=#pg-1f570e81f370916ad106fc0a2c96693c>Accounts</a></li><ul><li>4.5.2.3.1: <a href=#pg-ee5db335419f0605c0ef830d9d1b33bd>Add an Account</a></li><ul></ul><li>4.5.2.3.2: <a href=#pg-d69f4dd3c4ac7c6cbf91511a959f1bd2>Rename an Account</a></li><ul></ul><li>4.5.2.3.3: <a href=#pg-6cd17355e2e96493bb90897e4a2f8c33>List Accounts</a></li><ul></ul><li>4.5.2.3.4: <a href=#pg-582e00b20c363033f7b83ba92bd0b838>Delete an Account</a></li><ul></ul></ul><li>4.5.2.4: <a href=#pg-33ce4312fe81b2a6519096dfdbaa2d35>Groups</a></li><ul><li>4.5.2.4.1: <a href=#pg-e923951fba34c12b5e794474eebc511b>Create a Group</a></li><ul></ul><li>4.5.2.4.2: <a href=#pg-668ca8d059318ac7c2e987847a894801>Add a Group Policy</a></li><ul></ul><li>4.5.2.4.3: <a href=#pg-5fc1960c90e1ce37dea91ee71ce340e2>Modify a Group</a></li><ul></ul><li>4.5.2.4.4: <a href=#pg-272a727e7141c758cd69d2a1a6390811>Remove a User from a Group</a></li><ul></ul><li>4.5.2.4.5: <a href=#pg-4bf78627ecd1a139de1c5a212ac996a7>List Groups</a></li><ul></ul><li>4.5.2.4.6: <a href=#pg-aa0e7d2e3857a776753212c9ed8715c3>List Policies for a Group</a></li><ul></ul><li>4.5.2.4.7: <a href=#pg-f2ce03eabebf66486b27234034aea9e9>Delete a Group</a></li><ul></ul></ul><li>4.5.2.5: <a href=#pg-4afff178247fe629dd1d5d9acb2be979>Users</a></li><ul><li>4.5.2.5.1: <a href=#pg-dd72d1e88ac0a1d16ad0b337152e146a>Add a User</a></li><ul></ul><li>4.5.2.5.2: <a href=#pg-749b80672158f431a1d7d9bb97c1a249>Add a User to a Group</a></li><ul></ul><li>4.5.2.5.3: <a href=#pg-5d0f0396bee32b62b263b2b8339ced18>Create a Login Profile</a></li><ul></ul><li>4.5.2.5.4: <a href=#pg-0aca94e11d4a95cff001c7f0329bfc49>Generating User Credentials</a></li><ul></ul><li>4.5.2.5.5: <a href=#pg-cfa9d31d4cd20d9e7b9fe0b970545a1c>Uploading a Certificate</a></li><ul></ul><li>4.5.2.5.6: <a href=#pg-389f024ceefc48314659d7755e6a3c9b>Modify a User</a></li><ul></ul><li>4.5.2.5.7: <a href=#pg-0542bfe18474766936611fdf92b19945>List Users</a></li><ul></ul><li>4.5.2.5.8: <a href=#pg-28d56f710b14e8cec57a979316b116d2>Delete a User</a></li><ul></ul></ul><li>4.5.2.6: <a href=#pg-b1b0637f24aff2f57dd658f327d66299>Roles</a></li><ul><li>4.5.2.6.1: <a href=#pg-2f6d69b689bb4ca2ac8340b80c6b0b8e>Launch an Instance with a Role</a></li><ul></ul><li>4.5.2.6.2: <a href=#pg-5560a10e0d26af09b396e8fac12da746>Use a Role with an Instance Application</a></li><ul></ul><li>4.5.2.6.3: <a href=#pg-28ddd1def442ce481c7968ae53b8633c>Assume a Role</a></li><ul></ul><li>4.5.2.6.4: <a href=#pg-67ba8f7be3147b2c7fbd12e16b4e0725>Delegate Access Across Your Accounts Using Roles</a></li><ul></ul></ul></ul></ul></ul><li>5: <a href=#pg-18a34a33922bf60fbc3affdcbf7663e6>Image Management Guide</a></li><ul><li>5.1: <a href=#pg-95baf3f86c33cef7adb3b53047a62983>Image Management Overview</a></li><ul></ul><li>5.2: <a href=#pg-43adcca7528e430b8c80d48e6d9c7635>Image Overview</a></li><ul></ul><li>5.3: <a href=#pg-bbce802474b3563a37c590a7850aa76c>Image Tasks</a></li><ul><li>5.3.1: <a href=#pg-a083b7deb3e20a834645aa2bd24d9925>Browse and Download from Eucalyptus</a></li><ul></ul><li>5.3.2: <a href=#pg-5acab9f9462dcc08070fbaebe7007f83>Install an HVM Image</a></li><ul></ul><li>5.3.3: <a href=#pg-c907c3df7ce28d2ca48fad707ab84eb1>Create an HVM Image</a></li><ul><li>5.3.3.1: <a href=#pg-45164578f8923bf27cb79d783bb5ddb9>Create an HVM Image from a Linux Distribution ISO (KVM)</a></li><ul></ul></ul><li>5.3.4: <a href=#pg-2f36b1734e7c4ede8a5fa61fa256d3eb>Migrate an Image</a></li><ul><li>5.3.4.1: <a href=#pg-c4467c3959f12bd32dd51b6e0a608dc9>Create an Image from an Existing EBS-Backed Instance</a></li><ul></ul><li>5.3.4.2: <a href=#pg-7ae829a308446b76f985667650c1a46a>Create an Image from an Existing Instance-Store Instance</a></li><ul></ul><li>5.3.4.3: <a href=#pg-a6c7933f04213a52b2578c77b81cbc98>Prepare a Linux System for Eucalyptus</a></li><ul></ul><li>5.3.4.4: <a href=#pg-83a5584fa76ae7d7f1cd6f56000c1f48>Migrate a Linux Image from AWS to Eucalyptus</a></li><ul></ul><li>5.3.4.5: <a href=#pg-d754d743eb9edad186e0971725e7173b>Migrate a Linux Image from Eucalyptus to AWS</a></li><ul></ul></ul><li>5.3.5: <a href=#pg-f0a7abff6f890e9d6a76f4948f030b61>Install a paravirtual image</a></li><ul><li>5.3.5.1: <a href=#pg-124214d3be37c49eb70ea51c9e3be93a>Add a Kernel</a></li><ul></ul><li>5.3.5.2: <a href=#pg-a58ff9b57c5502b55b633d737a109153>Add a Ramdisk</a></li><ul></ul><li>5.3.5.3: <a href=#pg-5b52a2311765cea7d4c67e50b33cee77>Add a Root Filesystem</a></li><ul></ul></ul><li>5.3.6: <a href=#pg-dd61de6258e3b46d3f1d9e7ca4b14e4f>Remove an Image</a></li><ul></ul></ul></ul></ul><div class=content><h2 id=overview>Overview</h2><p>Documentation for Eucalyptus Cloud, the open source software for building AWS-compatible private and hybrid clouds.</p><h2 id=guides>Guides</h2><p>This documentation consists of the following guides:</p><h2 id=resources>Resources</h2><p>Documentation for earlier releases can be found here:</p><ul><li><a href=https://docs.eucalyptus.cloud/eucalyptus/4.4.6/>Documentation</a></li></ul><p>Related guides:</p><ul><li><a href=https://docs.eucalyptus.cloud/eucalyptus/4.4.6/index.html#shared/console_section.html>Console Guide</a></li><li><a href=https://docs.eucalyptus.cloud/eucalyptus/4.4.6/index.html#shared/euca2ools_section.html>Euca2ools Guide</a></li></ul><hr><p>Copyright for portions of this documentation are held by Ent. Services Development Corporation LP, 2017. All other copyright for this documentation is held by AppScale Systems, Inc 2020</p></div></div><div class=td-content style=page-break-before:always><h1 id=pg-fbefc613e3033c21ad569e127331156e>1 - Installation Guide</h1><h1 id=installation-guide>Installation Guide</h1><p>This section describes concepts and tasks you need to successfully install Eucalyptus.</p></div><div class=td-content><h1 id=pg-1982a068fa7e47f88783f4d54cb5d003>1.1 - Installation Overview</h1><p>This topic helps you understand, plan for, and install Eucalyptus. If you follow the recommendations and instructions in this guide, you will have a working version of Eucalyptus customized for your specific needs and requirements. This guide walks you through installations for a few different use cases.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Upgrading to Eucalyptus version 5 from earlier versions is not currently supported.</div><p>You can choose from one of the installation types listed in the following table.</p><table><thead><tr><th style=text-align:left>What Do You Want to Do?</th><th style=text-align:left>Installation Type</th></tr></thead><tbody><tr><td style=text-align:left>Quickly deploy on one machine</td><td style=text-align:left>If you have a CentOS 7.9 minimal install and a few IP addresses to spare, try the FastStart script. Run the following command as root: bash &lt;(curl -Ls <a href=https://get.eucalyptus.cloud>https://get.eucalyptus.cloud</a>)</td></tr><tr><td style=text-align:left>Create a development or production environment</td><td style=text-align:left>See the <a href=/docs/install_guide/automated_install/>Automated Eucalyptus Installation</a> section for installation using Ansible</td></tr><tr><td style=text-align:left>Manually create a development or production environment</td><td style=text-align:left>See the <a href=/docs/install_guide/eucalyptus/>Manual Eucalyptus Installation</a> section for manual deployment steps</td></tr></tbody></table><p>We recommend that you read the section you choose in the order presented. To customize your installation, you have to understand what Eucalyptus is, what the installation requirements are, what your network configuration and restrictions are, and what Eucalyptus components and features are available based on your needs and requirements.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-6d78406d918bd7894025c1743b526546>1.2 - Introduction to Eucalyptus</h1><h1 id=introduction-to-eucalyptus>Introduction to Eucalyptus</h1><p>Eucalyptus is open source software for building AWS-compatible private and hybrid clouds.</p><p>As an Infrastructure as a Service (IaaS) product, Eucalyptus allows your users to provision your compute and storage resources on-demand.</p><p>You can install Eucalyptus on the following Linux distributions:</p><ul><li>CentOS 7.9</li><li>Red Hat Enterprise Linux (RHEL) 7.9</li></ul><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>References to RHEL in this guide apply equally to CentOS unless otherwise specified.</div></div><div class=td-content style=page-break-before:always><h1 id=pg-de069bf8912ac64065ebcab85c7461f3>1.2.1 - Eucalyptus Overview</h1><p>Eucalyptus was designed to be easy to install and as non-intrusive as possible. The software framework is modular, with industry-standard, language-agnostic communication.</p><p>Eucalyptus provides a virtual network overlay that both isolates network traffic of different users and allows two or more clusters to appear to belong to the same Local Area Network (LAN). Also, Eucalyptus offers API compatibility with Amazon’s EC2, S3, IAM, ELB, Auto Scaling, CloudFormation, and CloudWatch services. This offers you the capability of a hybrid cloud.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-23a4f3e33ed01dedee5d6356fc8830b7>1.2.2 - Eucalyptus Components</h1><p>This topic describes the various components that comprise a Eucalyptus cloud.The following image shows a high-level architecture of Eucalyptus with its main components.</p><p><img src=https://www.eucastack.io/images/euca_cloud_arch_basics.png alt=image>
A detailed description of each Eucalyptus component follows.</p><h2 id=cloud-controller>Cloud Controller</h2><p>In many deployments, the Cloud Controller (CLC) service and the User-Facing Services (UFS) are on the same host machine. This server is the entry-point into the cloud for administrators, developers, project managers, and end-users. The CLC handles persistence and is the backend for the UFS. A Eucalyptus cloud must have exactly one CLC.</p><h2 id=user-facing-services>User-Facing Services</h2><p>The User-Facing Services (UFS) serve as endpoints for the AWS-compatible services offered by Eucalyptus : EC2 (compute), AS (AutoScaling), CW (CloudWatch), ELB (LoadBalancing), IAM (Euare), and STS (tokens). A Eucalyptus cloud can have several UFS host machines.</p><h2 id=object-storage-gateway>Object Storage Gateway</h2><p>The Object Storage Gateway (OSG) is part of the UFS. The OSG passes requests to object storage providers and talks to the persistence layer (DB) to authenticate requests. You can use Walrus, Riak CS, or Ceph-RGW as the object storage provider.</p><h2 id=object-storage-provider>Object Storage Provider</h2><p>The Object Storage Provider (OSP) can be either the Eucalyptus Walrus backend, Riak CS, or Ceph-RGW. Walrus is intended for light S3 usage and is a single service. <a href=https://github.com/basho/riak>Riak</a> is an open source scalable general purpose data platform; it is intended for deployments with heavy S3 usage. Ceph-RGW is an object storage interface built on top of Librados.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4></div><h2 id=management-console>Management Console</h2><p>The Eucalyptus Management Console is an easy-to-use web-based interface that allows you to manage your Eucalyptus cloud. The Management Console is often deployed on the same host machine as the UFS. A Eucalyptus cloud can have multiple Management Console host machines.</p><h2 id=cluster-controller>Cluster Controller</h2><p>The Cluster Controller (CC) service must run on a host machine that has network connectivity to the host machines running the Node Controllers (NCs) and to the host machine for the CLC. CCs gather information about a set of NCs and schedules virtual machine (VM) execution on specific NCs. All NCs associated with a single CC must be in the same subnet.</p><h2 id=storage-controller>Storage Controller</h2><p>The Storage Controller (SC) service provides functionality similar to Amazon Elastic Block Store (Amazon EBS). The SC can interface with various storage systems. Elastic block storage exports storage volumes that can be attached by a VM and mounted or accessed as a raw block device. EBS volumes can persist past VM termination and are commonly used to store persistent data. An EBS volume cannot be shared between multiple VMs at once and can be accessed only within the same availability zone in which the VM is running. Users can create snapshots from EBS volumes. Snapshots are stored by the OSG and made available across availability zones.</p><h2 id=node-controller>Node Controller</h2><p>The Node Controller (NC) service runs on any machine that hosts VM instances. The NC controls VM activities, including the execution, inspection, and termination of VM instances. It also fetches and maintains a local cache of instance images, and it queries and controls the system software (host OS and the hypervisor) in response to queries and control requests from the CC.</p><h2 id=eucanetd>Eucanetd</h2><p>The eucanetd service implements artifacts to manage and define Eucalyptus cloud networking. Eucanetd runs alongside the CLC or NC services, depending on the configured networking mode.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-57cacd852b34aa702681badd617fa5c5>1.2.3 - System Requirements</h1><p>To install Eucalyptus, your system must meet the baseline requirements described in this topic.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>The specific requirements of your deployment, including the number of physical machines, structure of the physical network, storage requirements, and access to software are ultimately determined by the features you choose for your cloud and the availability of infrastructure required to support those features.</div><h2 id=compute-requirements>Compute Requirements</h2><ul><li>Physical Machines: All services must be installed on physical servers, not virtual machines.</li><li>Central Processing Units (CPUs): We recommend that each host machine in your cloud contain either an Intel or AMD processor with a minimum of 4 2GHz cores.</li><li>Operating Systems: supports the following Linux distributions: CentOS 7.9 and RHEL 7.9. supports only 64-bit architecture.</li><li>Machine Clocks: Each host machine and any client machine clocks must be synchronized (for example, using NTP). These clocks must be synchronized all the time, not only during the installation process.</li></ul><h2 id=storage-and-memory-requirements>Storage and Memory Requirements</h2><ul><li>Each machine needs a minimum of 100GB of storage.</li><li>We recommend at least 500GB for Walrus and SC hosts.</li><li>We recommend 200GB per NC host running Linux VMs. Note that larger available disk space enables a greater number of VMs.</li><li>Each machine needs a minimum of 16GB RAM. However, we recommend more RAM for improved caching and on NCs to support more instances.</li></ul><h2 id=network-requirements>Network Requirements</h2><ul><li>For VPCMIDO, Eucalyptus needs MidoNet to be installed.</li><li>The network connecting machines that host components (except the CC and NC) must support UDP multicast for IP address 239.193.7.3. Note that UDP multicast is not used over the network that connects the CC to the NCs.</li></ul><p>Once you are satisfied that your systems requirements are met, you are ready to plan your Eucalyptus installation.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-e01281a8db4910fb78f0d12ffd65afe0>1.3 - Automated Eucalyptus Installation</h1><p>Automated Eucalytpus installation uses an <a href=https://www.ansible.com/overview/how-ansible-works>Ansible</a> playbook.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Before starting the automated installation CentOS 7.9 should be installed on all hosts. RHEL is not currently supported for automated installs.</div><p>To install Eucalyptus you will need to have Ansible and the Eucalyptus playbooks available and to create an <em>inventory</em> file that describes your deployment.</p><h2 id=install-packages>Install Packages</h2><p>The host performing the installation must have the EPEL YUM repository available (for Ansible):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>yum install epel-release
</span></span></code></pre></div><p>and a Eucalyptus YUM repository, either the release repository:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>yum install https://downloads.eucalyptus.cloud/software/eucalyptus/5/rhel/7/x86_64/eucalyptus-release-5-1.11.as.el7.noarch.rpm
</span></span></code></pre></div><p>or the master repository for the latest nightly build:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>yum install https://downloads.eucalyptus.cloud/software/eucalyptus/master/rhel/7/x86_64/eucalyptus-release-5-1.15.as.el7.noarch.rpm
</span></span></code></pre></div><h2 id=create-inventory>Create Inventory</h2><p>The Ansible inventory file describes both the hosts that will run your Eucalyptus cloud and the options for your installation.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#000>---</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>all</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>cloud.example.com</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>node[01:10].example.com</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>vars</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>vpcmido_public_ip_range</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;1.X.Y.128-1.X.Y.254&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>vpcmido_public_ip_cidr</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;1.X.Y.128/25&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>children</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>cloud</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>cloud.example.com</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>zone</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>cloud.example.com</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>node</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>node[01:10].example.com</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>There are three main sections to an inventory file:</p><ol><li><em>hosts</em> : the hosts to deploy</li><li><em>vars</em> : variables providing options for the deployment</li><li><em>children</em> : host groupings that describe where to install Eucalyptus components</li></ol><h3 id=minimal-install>Minimal Install</h3><p>The minimum inventory for a deployment must specify one host and have a <em>children</em>/<em>cloud</em> section that includes that host.</p><p>For <code>VPCMIDO</code> the <em>vars</em> for <em>vpcmido_public_ip_range</em> and <em>vpcmido_public_ip_cidr</em> must also be provided.</p><p>When the <em>zone</em> and <em>node</em> children are not specified they are assumed to be the same host as the <em>cloud</em>.</p><h3 id=customization>Customization</h3><p>Settings that are often used in an inventory are described in this section.</p><p>The DNS domain to be used should be set in the <em>vars</em> section:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>cloud_system_dns_dnsdomain</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;mycloud.example.com&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The NTP server to use with services in your deployment can also be specifed:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>cloud_properties</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>services.imaging.worker.ntp_server</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;time.cloudflare.com&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>services.loadbalancing.worker.ntp_server</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;time.cloudflare.com&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>The <em>cloud_properties</em> section allows you configure any settings that you would later set using <em>euctl</em></div><p>To specify region and zone names for your deployment add the <em>vars</em>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>cloud_region_name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;us-euca-1&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>cloud_zone_1_name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;us-euca-1a&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>cloud_zone_2_name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;us-euca-1b&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>cloud_zone_3_name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;us-euca-1c&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>You can follow AWS naming conventions or can use your own naming scheme. To specify which hosts belong to which zone update the <code>hosts</code> section:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>node01.example.com</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>host_cluster_ipv4</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;10.111.10.101&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>host_public_ipv4</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;1.X.Y.101&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>host_zone_key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The <em>host_zone_key</em> value of <code>1</code> specifes that <code>node01</code> would be part of the <code>us-euca-1a</code> zone. This example also shows how to configure the public and cluster IP addresses for a host.</p><p>To specify the port for web sevices use:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>cloud_public_port</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>443</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>If using port <code>443</code> for web services, the management console should be deployed as a service to avoid a port conflict.</p><p>To enable a firewall on the public/cluster interfaces use:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>cloud_firewalld_configure</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>yes</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>cloud_firewalld_cluster_cidr</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;10.111.0.0/16&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>cloud_firewalld_cluster_interface</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;en2&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>cloud_firewalld_public_interface</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;en1&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Interfaces must be named consistently on all hosts.</p><p>The default install uses <em>overlay</em> for block storage, to use <em>das</em> you must have an LVM volume group available on all storage (<em>zone</em>) hosts and set:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>cloud_storage_dasdevice</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;storage_vg&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>To deploy the management console as service running on an instance in your Eucalyptus cloud:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>eucalyptus_console_cloud_deploy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>yes</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>cloud_service_image_rpm</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>no</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>This will also create a DNS entry for the console such as <code>console.mycloud.example.com</code>. When deploying the console on an instance it is recommended to also set <em>cloud_service_image_rpm</em> to <code>no</code> so that the service image for loadbalancing and imaging is installed using the same approach rather than from the rpm.</p><h3 id=midonet-nsdb>MidoNet NSDB</h3><p>For <code>VPCMIDO</code> deployments the MidoNet NSDB (Network State Database) should be deployed on multiple hosts:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>midonet-nsdb</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>midonet-nsdb[01:03].example.com</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>These could be distinct hosts, or could be hosts running cloud and zone components (for example)</p><h3 id=using-ceph>Using Ceph</h3><p>To use Ceph for block and object storage configure the settings:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>ceph_release</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;nautilus&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>ceph_osd_data_path</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;storage_vg/storage_lv&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>ceph_public_network</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;10.111.0.0/16&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>the <em>ceph_osd_data_path</em> should reference either an existing LVM volume available on all hosts or a device.</p><p>The hosts for ceph must be in the <em>ceph</em> group under <em>children</em>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>ceph</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>hosts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>ceph[01:03].example.com</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>There must be three or more hosts to have redundancy.</p><h3 id=using-minio>Using MinIO</h3><p>To deploy MinIO as the objectstorage provider you specify <em>minio</em> under <em>children</em>:</p><pre tabindex=0><code>    minio:
      hosts:
        minio.example.com:
</code></pre><p>This will deploy MinIO on those hosts and also configure MinIO as the objectstorage provider when Ceph is not being deployed. There must be three or more hosts to have redundancy.</p><h3 id=enabling-certbot-integration>Enabling Certbot Integration</h3><p>To enable <a href=https://letsencrypt.org>Let&rsquo;s Encrypt</a> for HTTPS via certbot set the following <em>vars</em>:</p><pre tabindex=0><code>    eucaconsole_certbot_configure: yes
    eucalyptus_console_certbot_enable: yes
    eucalyptus_services_certbot_enable: yes
</code></pre><p>To use this functionality the cloud must be public so that it can be reached for DNS (services) or HTTP (console) challenges. See the Let&rsquo;s Encrypt <a href=https://letsencrypt.org/docs/challenge-types/>Challenge Types</a> for details.</p><p>The <em>eucaconsole_certbot_configure</em> setting should be used when deploying the console on a physical host. The <em>eucalyptus_console_certbot_enable</em> setting applies when deploying the console on the cloud (i.e. when you specifed <em>eucalyptus_console_cloud_deploy</em>)</p><h2 id=test-connectivity>Test Connectivity</h2><p>Before starting a deployment, test that the installation host can access all hosts in the inventory by running:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ansible --inventory inventory.yml -m ping all
</span></span></code></pre></div><p>If this fails, ensure that you have configured SSH access to all inventory hosts (e.g. configure passwordless SSH access) before proceeding to the installation.</p><h2 id=perform-installation>Perform Installation</h2><p>To start a <code>VPCMIDO</code> installation:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ansible-playbook --inventory inventory.yml /usr/share/eucalyptus-ansible/playbook_vpcmido.yml
</span></span></code></pre></div><p>To start an <code>EDGE</code> installation:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ansible-playbook --inventory inventory.yml /usr/share/eucalyptus-ansible/playbook_edge.yml
</span></span></code></pre></div><p>See the <a href=https://www.eucastack.io/docs/install_guide/what_next/>Find More Information</a> page for next steps.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-12bc0a87fc6f085bd8de2b8681be810a>1.4 - Manual Eucalyptus Installation</h1><h1 id=manual-eucalyptus-installation>Manual Eucalyptus Installation</h1><p>This section details steps to install Eucalyptus manually. To install Eucalyptus, perform the following tasks in the order presented.</p><div class="alert alert-warning" role=alert><h4 class=alert-heading>Warning</h4>The recommended way to install Eucalyptus 5 is to follow the <a href=https://www.eucastack.io/docs/install_guide/automated_install/>Automated Eucalyptus Installation</a> section.</div></div><div class=td-content><h1 id=pg-b7604a899f9379e2a4ad64b89548b5a3>1.4.1 - Plan Your Installation</h1><h1 id=plan-your-installation>Plan Your Installation</h1><p>Before you install Eucalyptus components on your machines, we recommend that you take the time to plan how you want to install it.</p><p>To successfully plan for your Eucalyptus installation, you must determine two things:</p><ul><li>Think about the application workload performance and resource utilization tuning. Think about how many machines you want on your system.</li><li>Use your existing architecture and policies to determine the networking features you want to enable: EC2 Classic Networking or EC2 VPC Networking.</li></ul><p>This section describes how to evaluate each tradeoff to determine the best choice to make, and how to verify that the resource environment can support the features that are enabled as a consequence of making a choice.</p><p>By the end of this section, you should be able to specify how you will deploy Eucalyptus in your environment, any tradeoffs between feature set and flexibility, and where your deployment will integrate with existing infrastructure systems.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-0462e0983621e9e80df8057a5f87089e>1.4.1.1 - Eucalyptus Architecture Overview</h1><p>This topics describes the relationship of the components in a Eucalyptus installation.
<img src=https://www.eucastack.io/images/euca_arch_separate_hosts.png alt=image>
The cloud components: Cloud Controller (CLC) and Walrus, as well as user components: User-Facing Services (UFS) and the Management Console, communicate with cluster components: the Cluster Controllers (CCs) and Storage Controllers (SCs). The CCs and SCs, in turn, communicate with the Node Controllers (NCs). The networks between machines hosting these components must be able to allow TCP connections between them.</p><p>Ceph provides an alternative to Walrus as an object storage provider, and can also be used as a block storage provider (EBS).</p></div><div class=td-content style=page-break-before:always><h1 id=pg-c57095c343881511c6992288161bb07d>1.4.1.2 - Plan Your Hardware</h1><p>This topic describes ways you can install Eucalyptus services on your physical servers.You can run Eucalyptus services in any combination on the various physical servers in a data center. For example, you can install the Cloud Controller (CLC), Walrus, CC, and SC on one host machine, and NCs on one or more host machines. Or you can install each service on an independent physical server. This gives each service its own local resources to work with.</p><p>Often in installation decisions, you must trade deployment simplicity for performance. For example, if you place all cloud (CLC) and zone (CC) services on a single machine, it makes for simple administration. This is because there is only one machine to monitor and control for the Eucalyptus control services. But, each service acts as an independent web service; so if they share a single machine, the reduced physical resources available to each service might become a performance bottleneck.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-e6dc0ef0fcec95ccdc99df75bd2c99f8>1.4.1.3 - Plan Services Placement</h1><p><img src=https://www.eucastack.io/images/euca_deploy_examples_training_source.png alt=image></p><h2 id=cloud-services>Cloud Services</h2><p>The main decision for cloud services is whether to install the Cloud Controller (CLC) and Walrus on the same server. If they are on the same server, they operate as separate web services within a single Java environment, and they use a fast path for inter-service communication. If they are not on the same server, they use SOAP and REST to work together.</p><p>Sometimes the key factor for cloud services is not performance, but server cost and data center configuration. If you only have one server available for the cloud, then you have to install the services on the same server.</p><p>All services should be in the same data center. They use aggressive time-outs to maintain system responsiveness so separating them over a long-latency, lossy network link will not work.</p><h2 id=user-services>User Services</h2><p>The User Facing Services (UFS) handle all of the AWS APIs and provide an entry point for clients and users interacting with the Eucalyptus cloud. The UFS and the Management Console are often hosted on the same machine since both must be accessible from the public, client-facing network.</p><p>You may optionally choose to have redundant UFS and Management Console host machines behind a load balancer.</p><h2 id=zone-services>Zone Services</h2><p>The Eucalyptus services deployed in the zone level of a Eucalyptus deployment are the Cluster Controller (CC) and Storage Controller (SC).</p><p>You can install all zone services on a single server, or you can distribute them on different servers. The choice of one or multiple servers is dictated by the demands of user workload in terms of number of instances (CC) and EBS volume access (SC).</p><p>Things to consider for CC placement:</p><ul><li><p>Place the CC on a server that has TCP/IP connectivity to the front-end servers and the NC servers in its zone.</p></li><li><p>Each CC can manage a maximum of 4000 instances.
Things to consider for SC placement:</p></li><li><p>The SC host machine must always have TCP/IP connectivity to the CLC and be able use multicast to the CLC.</p></li><li><p>The SC must have TCP/IP connectivity to the UFS/OSG hosts for uploading snapshots into the object store. (The SC does not require connectivity directly to users, it is an internal component and does not serve user EBS API requests; that job is done by the UFS.)</p></li><li><p>The SC must be reachable via TCP/IP from all NCs in the zone within which the SC is registered. The SC and NC exchange tokens to authorize volume attachment, so they must be able to directly communicate. The SC provides the NCs with network access to the dynamic block volumes on the SC&rsquo;s storage (if the SC is configured for overlay local filesystem or DAS-JBOD).</p></li><li><p>IF using Ceph the SC must also have TCP/IP connectivity to the Ceph cluster.</p></li><li><p>If you are going to use overlay local filesystem or DAS-JBOD configurations to export local SC storage for EBS, then SC storage should consist of a fast, reliable disk pool (either local file-system or block-attached storage) so that the SC can create and maintain volumes for the NCs. The capacity of the disk pool should be sufficient to provide the NCs with enough space to accommodate all dynamic block volumes requests from end users.</p></li></ul><h2 id=node-services>Node Services</h2><p>The Node Controllers are the services that comprise the Eucalyptus backend. All NCs must have network connectivity to whatever machine(s) host their EBS volumes. Hosts are either a Ceph deployment or the SC.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-447c3fba4a65cbe021e473fffd22ce9d>1.4.1.4 - Plan Disk Space</h1><p>We recommend that you choose a disk for the Walrus that is large enough to hold all objects and buckets you ever expect to have, including all images that will ever be registered to your system, plus any Amazon S3 application data. For heavy S3 usage, Riak CS is a better choice for object storage.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>We recommend that you use LVM (Logical Volume Manager). If you run out of disk space, LVM allows you to add disks and migrate the data.</div><table><thead><tr><th style=text-align:left>Service</th><th style=text-align:left>Directory</th><th style=text-align:left>Minimum Size</th></tr></thead><tbody><tr><td style=text-align:left>Cloud Controller (CLC)CLC logging</td><td style=text-align:left>/var/lib/eucalyptus/db/var/log/eucalyptus</td><td style=text-align:left>20GB2GB</td></tr><tr><td style=text-align:left>WalrusWalrus logging</td><td style=text-align:left>/var/lib/eucalyptus/bukkits/var/log/eucalyptus</td><td style=text-align:left>250GB2GB</td></tr><tr><td style=text-align:left>Storage Controller (SC) (EBS storage) This disk space on the SC is only required if you are not using Ceph. For DAS the space must not be used by an existing filesystem.</td><td style=text-align:left>/var/lib/eucalyptus/volumes/var/log/eucalyptus</td><td style=text-align:left>250GB</td></tr><tr><td style=text-align:left>User-Facing Services (UFS)UFS logging</td><td style=text-align:left>/var/lib/eucalyptus/var/log/eucalyptus</td><td style=text-align:left>5GB 2GB</td></tr><tr><td style=text-align:left>Management ConsoleConsole logging</td><td style=text-align:left>/var/log/eucalyptus-console</td><td style=text-align:left>5GB 2GB</td></tr><tr><td style=text-align:left>Cluster Controller (CC)CC logging</td><td style=text-align:left>/var/lib/eucalyptus/CC/var/log/eucalyptus</td><td style=text-align:left>5GB2GB</td></tr><tr><td style=text-align:left>Node Controller (NC)NC logging</td><td style=text-align:left>/var/lib/eucalyptus/instances/var/log/eucalyptus</td><td style=text-align:left>250GB2GB</td></tr></tbody></table><p>If necessary, create symbolic links or mount points to larger filesystems from the above locations. Make sure that the &rsquo;eucalyptus&rsquo; user owns the directories.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-3a0799333f9d078659c0417ef1a1bc02>1.4.1.5 - Plan Eucalyptus Features</h1><h1 id=plan-features>Plan Features</h1><p>Before you install Eucalyptus , we recommend that you think about the features you plan to implement with Eucalyptus. These features are detailed in the following sections.</p></div><div class=td-content><h1 id=pg-1abf120cbe2ad01da294a3af9af82b16>1.4.1.5.1 - Availability Zone Support</h1><p>Eucalyptus offers the ability to create multiple local availability zones.An availability zone for AWS denotes a large subset of their cloud environment. Eucalyptus refines this definition to denote a subset of the cloud that shares a local area network. Each Eucalyptus zone has its own Cluster Controller and Storage Controller.</p><p><img src=https://www.eucastack.io/images/euca-arch-basic-two-clusters.png alt=image></p></div><div class=td-content style=page-break-before:always><h1 id=pg-c67311d13adefe1c703c24414718c35f>1.4.1.5.2 - Object Storage</h1><p>Eucalyptus supports Walrus and Riak CS as its object storage backend. There is no extra planning if you use Walrus. If you use Riak CS, you can use a single Riak CS cluster for several Eucalyptus clouds. Basho (the vendor of RiakCS) recommends five nodes for each Riak CS cluster. This also means that you have to set up and configure a load balancer between the Riak CS nodes and the object storage gateway (OSG).</p></div><div class=td-content style=page-break-before:always><h1 id=pg-d4b6f38707425e1c71a4e9bf6b20026f>1.4.1.6 - Plan Networking Modes</h1><h1 id=plan-networking-modes>Plan Networking Modes</h1><p>These networking modes are designed to allow you to choose an appropriate level of security and flexibility for your cloud. The purpose is to direct Eucalyptus to use different network features to manage the virtual networks that connect VMs to each other and to clients external to Eucalyptus .</p><p>Eucalyptus networking modes are generally modeled after AWS networking capabilities. In legacy AWS accounts, you have the ability to choose EC2 Classic network mode or VPC network mode. New AWS accounts do not have this flexibility and are forced into using VPC. Eucalyptus VPCMIDO mode is similar to AWS VPC in that it allows users to fully manage their cloud network, including the definition of a Classless Inter-Domain Routing (CIDR) block, subnets, and security groups with rules for additional protocols beyond the default three (UDP, TCP, and ICMP) available in EC2 Classic networking.</p><p>Your choice of networking mode depends on the following considerations:</p><ul><li>Does your cloud need to mimic behavior in your AWS account? If you need EC2-Classic behavior, select EDGE mode. If you need EC2-VPC behavior, select VPCMIDO mode.</li><li>Do you need to create security group rules with additional protocols (e.g., all protocols, RDP, XTP, etc.)? If so, choose VPCMIDO mode.</li><li>If there is no specific requirement for either mode, then VPCMIDO mode is recommended given its flexibility and networking features.</li></ul><p>Each networking mode is described in the following sections.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-9e803e1e2ff2aef49d537ffcdab263e0>1.4.1.6.1 - About Eucanetd</h1><p>The eucanetd service implements artifacts to manage and define Eucalyptus cloud networking. Eucanetd runs alongside the CLC or NC services, depending on the configured networking mode. Eucanetd manages network functionality. For example:</p><ul><li>Installs network artifacts (iptables, ipsets, ebtables, dhcpd)</li><li>Performs state management for the installed network artifacts</li><li>Updates network artifact configuration as needed</li><li>In VPCMIDO mode:<ul><li>Interacts with MidoNet via the MidoNet API</li><li>Defines network artifacts in MidoNet</li></ul></li></ul><h2 id=where-to-deploy-eucanetd>Where to deploy eucanetd</h2><p>Deploy <em>eucanetd</em> depending on the selected network mode:</p><table><thead><tr><th style=text-align:left>Host Machine</th><th style=text-align:left>EDGE mode</th><th style=text-align:left>VPCMIDO mode</th></tr></thead><tbody><tr><td style=text-align:left>CLC</td><td style=text-align:left>No</td><td style=text-align:left>Yes</td></tr><tr><td style=text-align:left>NC</td><td style=text-align:left>Yes</td><td style=text-align:left>No</td></tr></tbody></table><p>When required for a mode <em>eucanetd</em> should be deployed on all hosts for that service.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-4a09021661db136481b10bdbcfcadf33>1.4.1.6.2 - Understanding Eucalyptus EDGE Mode</h1><p>In EDGE networking mode, the components responsible for implementing Eucalyptus VM networking artifacts are running at the edge of a Eucalyptus deployment: the Linux host machines acting as Node Controllers (NCs). On each NC host machine, a Eucalyptus stand-alone service, eucanetd, runs side-by-side with the NC service. The eucanetd service receives dynamically changing Eucalyptus networking views and is responsible for configuring the Linux networking subsystem to reflect the latest view.</p><p>EDGE networking mode integrates with your existing network infrastructure, allowing you to inform Eucalyptus , through configuration parameters for EDGE mode, about the existing network, which Eucalyptus then will consume when implementing the networking view.</p><p>EDGE networking mode integrates with two basic types of pre-existing network setups:</p><ul><li>One flat IP network used to service component systems, VM public IPs (elastic IPs), and VM private IPs.</li><li>Two networks, one for components and VM public IPs, and the other for VM private IPs.</li></ul><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>EDGE networking mode integrates with networks that already exist. If the network, netmask, and router don&rsquo;t already exist, you must create them outside before configuring EDGE mode.</div><h2 id=edge-mode-requirements>EDGE Mode Requirements</h2><ul><li>Each NC host machine must have an interface configured with an IP on a VM public and a VM private network (which can be the same network).</li><li>There must be IP connectivity from each NC host machine (where eucanetd runs) and the CLC host machine, so that network path from instances to the metadata server (running on the CLC host machine) can be established.</li><li>There must be a functioning router in place for the private network. This router will be the default gateway for VM instances.</li><li>The private and public networks can be the same network, but they can also be separate networks.</li><li>The NC host machines need a bridge configured on the private network, with the bridge interface itself having been assigned an IP from the network.</li><li>If you&rsquo;re using a public network, the NC host machines need an interface on the public network as well (if the public and private networks are the same network, then the bridge needs an IP assigned on the network).</li><li>If you run multiple zones, each zone can use the same network as its private network, or they can use separate networks as private networks. If you use separate networks, you need to have a router in place that is configured to route traffic between the networks.</li><li>If you use private addressing only, the CLC host machine must have a route back to the VM private network.</li></ul><h2 id=edge-mode-limitations>EDGE Mode Limitations</h2><ul><li>Global network updates (such as security group rule updates, security group VM membership updates, and elastic IP updates) are applied through an &ldquo;eventually consistent&rdquo; mechanism, as opposed to an &ldquo;atomic&rdquo; mechanism. That is, there may be a brief period of time where one NC has the new state implemented but another NC has the previous state implemented.</li><li>Mappings between VM MAC addresses and private IPs are strictly enforced. This means that instances cannot communicate using addresses the cloud has not assigned to them.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-89eeb5c8d44418651392426591292fef>1.4.1.6.3 - Understanding VPCMIDO and MidoNet</h1><p>This topic describes MidoNet components and their Eucalyptus deployment options, which provide support for VPC on Eucalyptus. Eucalyptus VPCMIDO mode resembles the Amazon Virtual Private Cloud (VPC) product wherein the network is fully configurable by users. In Eucalyptus, it is implemented with a Software-Defined Networking (SDN) technology called MidoNet. MidoNet is a network virtualization platform for Infrastructure-as-a-Service (IaaS) clouds that implements and exposes virtual network components as software abstractions, enabling programmatic provisioning of virtual networks.</p><p>This network mode requires configuration of MidoNet in order to make cloud networking functional. It offers the most advanced networking capabilities and therefore it is recommended to be used on all new Eucalyptus installations.</p><h2 id=midonet-components>MidoNet Components</h2><p>A MidoNet deployment consists of four types of nodes (according to their logical functions or services offered), connected via four IP networks as depicted in Figure 1. MidoNet does not require any specific hardware, and can be deployed in commodity x86_64 servers. Interactions with MidoNet are accomplished through Application Programming Interface (API) calls, which are translated into (virtual) network topology changes. Network state information is stored in a logically centralized data store, called the Network State Database (NSDB), which is implemented on top of two open-source distributed coordination and data store technologies: ZooKeeper and Cassandra. Implementation of (virtual) network topology is realized via cooperation and coordination among MidoNet agents, which are deployed in nodes that participate in MidoNet.</p><p><img src=https://www.eucastack.io/images/euca_mido_1v2.png alt=image>
<em>Figure 1: Logical view of a MidoNet deployment. Four components are connected via four networks.</em></p><p>Node types:</p><ul><li>MidoNet Network State Database (NSDB): consists of a cluster of ZooKeeper and Cassandra. All MidoNet nodes must have IP connectivity with NSDB.</li><li>MidoNet API: consists of MidoNet web app. Exposes MidoNet REST APIs.</li><li>Hypervisor: MidoNet agent (Midolman) are required in all Hypervisors to enable VMs to be connected via MidoNet overlay networks/SDN.</li><li>Gateway: Gateway nodes are connected to the public network, and enable the network flow from MidoNet overlays to the public network.</li></ul><p>Physical Networks:</p><ul><li>NSDB: IP network that connects all nodes that participate in MidoNet. While NSDB and Tunnel Zone networks can be the same, it is recommended to have an isolated (physical or VLAN) segment.</li><li>API: in deployments only eucanetd/CLC needs access to the API network. Only &ldquo;special hosts/processes&rdquo; should have access to this network. The use of &ldquo;localhost&rdquo; network on the node running CLC/eucanetd is sufficient and recommended in deployments.</li><li>Tunnel Zone: IP network that transports the MidoNet overlay traffic ( VM traffic), which is not &ldquo;visible&rdquo; on the physical network.</li><li>Public network: network with access to the Internet (or corporate/enterprise) network.</li></ul><h2 id=midonet-deployment-scale>MidoNet Deployment Scale</h2><p>Three reference architectures are presented in this document, ordered by complexity and size:</p><ul><li>Proof-of-Concept (PoC)</li><li>Production: Small</li><li>Production: Large</li></ul><p>Production: Large reference architecture represents the most complete and recommended deployment model of MidoNet for Eucalyptus. Whenever possible (such as when resources are available), deployments should closely match with the Production: Large reference architecture (even on small scale clouds).</p><p>All MidoNet components are designed and implemented to horizontally scale. Therefore, it is possible to start small and add resources as they become available.</p><h2 id=eucalyptus-with-midonet>Eucalyptus with MidoNet</h2><p>A Eucalyptus with MidoNet deployment consists of the following components:</p><p><img src=https://www.eucastack.io/images/euca_mido_2.png alt=image>
<em>Figure 2: Logical view of a Eucalyptus with MidoNet deployment. VM private network is created/virtualized by MidoNet, and &lsquo;software-defined&rsquo; by eucanetd. Ideally, each component and network should have its own set of independent resources. In practice, components are grouped and consolidated into a set of servers, as detailed in different reference architectures.</em></p><p>MidoNet components, Eucalyptus components, and three extra networks are present.</p><h2 id=proof-of-concept-poc>Proof of Concept (PoC)</h2><p>The PoC reference architecture is designed for very small and transient workloads, typical in development and testing environments. Quick deployment with minimal external network requirements are the key points of PoC reference architecture.</p><p><strong>Requirements</strong></p><p>Servers:</p><ul><li>Four (4) or more modern Intel cores or AMD modules - exclude logical cores that share CPU resources from the count (Hyperthreads and AMD cores within a module)</li><li>2GB of RAM reserved for MidoNet Agent (when applicable)</li><li>4GB of RAM reserved for MidoNet NSDB (when applicable)</li><li>4GB of RAM reserved for MidoNet API (when applicable)</li><li>30GB of free disk space for NSDB (when applicable)</li></ul><p>Physical Network:</p><ul><li>One (1) 1Gbps IP Network</li><li>A range or list of public IP addresses (Euca_public_IPs)</li><li>Internet Gateway</li></ul><p>Limits:</p><ul><li>Ten (10) MidoNet agents (i.e., 1 Gateway node, 1 CLC, and 8 NCs)</li><li>One (1) MidoNet Gateway</li><li>No fail over, fault tolerance, and/or network load balancing/sharing</li></ul><p><strong>Deployment Topology</strong></p><ul><li>Single server with all MidoNet components (NSDB, API, and Midolman), and with CLC/eucanetd</li><li>A server acting as MidoNet Gateway - when BGP terminated links are used, this node must not be co-located with CLC/eucanetd (in a proxy_arp setup described below, it is possible to consolidate CLC/eucanetd with MidoNet Gateway). This is due to incompatibilities in CentOS/RHEL7 netns (used by eucanetd), and bgpd (started by Midolman when BGP links are configured).</li><li>Hypervisors with Midolman</li><li>One IP network handling NSDB, Tunnel Zone, and Public Network traffic</li><li>API communication via loopback/localhost network</li></ul><p><img src=https://www.eucastack.io/images/euca_mido_3v2.png alt=image>
<em>Figure 3: PoC deployment topology. A single IP network carries NSDB, Tunnel Zone, and Public Network traffic. A single server handles MidoNet NSDB, API (and possibly Gateway) functionality.</em></p><p><strong>MidoNet Gateway Bindings</strong></p><p>Three ways to realize MidoNet Gateway bindings are discussed below, starting with the most recommended setup.</p><p>Public CIDR block(s) allocated for Eucalyptus (Euca_Public_IPs) needs to be routed to MidoNet Gateway by the customer network - this is an environment requirement, outside of control of both MidoNet and Eucalyptus systems. One way to accomplish this is to have a BGP terminated link available. MidoNet Gateway will establish a BGP session with the customer router to: (1) advertise Euca_Public_IPs to the customer router; and (2) get the default route from the customer router.</p><p>If a BGP terminated link is not available, but the routing of Euca_Public_IPs is delegated to MidoNet Gateway (configuration of customer routing infrastructure), similar setup can be used. In such scenario, static routes are configured on the customer router (to route Euca_Public_IPs to MidoNet Gateway), and on MidoNet (to use the customer router as the default route).</p><p><img src=https://www.eucastack.io/images/euca_mido_4.png alt=image>
<em>Figure 4: How servers are bound to MidoNet in a PoC deployment with BGP. A BGP terminated link is required: the gateway node eth device is bound to MidoNet virtual router (when BGP is involved, the MidoNet Gateway and Eucalyptus CLC cannot be co-located). Virtual machine tap devices are bound to MidoNet virtual bridges.</em></p><p>If routed Euca_Public_IPs are not available, static routes on all involved nodes (L2 connectivity is required among nodes) can be used as illustrated below.</p><p><img src=https://www.eucastack.io/images/euca_mido_5.png alt=image>
<em>Figure 5: How servers are bound to MidoNet in a PoC deployment without routed Euca_Public_IPs. Clients that need communication with Euca_Public_IPs configure static routes using MidoNet Gateway as the router. MidoNet Gateway configures a static default route to customer router.</em></p><p>In the case nodes outside the public network broadcast domain (L2) needs to access Euca_Public_IPs, a setup using proxy_arp, as illustrated below, can be used.</p><p><img src=https://www.eucastack.io/images/euca_mido_6.png alt=image>
<em>Figure 6: How servers are bound to MidoNet in a PoC deployment with proxy_arp. When routed Euca_Public_IPs are not available, the gateway node should proxy arp for public IP addresses allocated for Eucalyptus , and forward to a veth device that is bound to a MidoNet virtual router. Virtual machine tap devices are bound to MidoNet virtual bridges.</em></p><h2 id=production-small>Production: Small</h2><p>The Production: Small reference architecture is designed for small scale production quality deployments. It supports MidoNet NSDB fault tolerance (partial failures), and limited MidoNet Gateway failover and load balancing/sharing.</p><p>Border Gateway Protocol (BGP) terminated uplinks are recommended for production quality deployments.</p><p><strong>Requirements</strong></p><p>Servers:</p><ul><li>Four (4) or more modern Intel cores or AMD modules - exclude logical cores that share CPU resources from the count (Hyperthreads and AMD cores within a module) - for gateway nodes, 4 or more cores should be dedicated to MidoNet agent (Midolman)</li><li>4GB of RAM reserved for MidoNet Agent (when applicable), 8GB for Gateway nodes</li><li>4GB of free RAM reserved for MidoNet NSDB (when applicable)</li><li>4GB of free RAM reserved for MidoNet API (when applicable)</li><li>30GB of free disk space for NSDB (when applicable)</li><li>Two (2) 10Gbps NICs per server</li><li>Three (3) servers dedicated to MidoNet NSDB</li><li>Two (2) servers as MidoNet Gateways</li></ul><p>Physical Network:</p><ul><li>One (1) 10Gbps IP Network for public network (if upstream links are 1Gbps, this could be 1Gbps)</li><li>One (1) 10Gbps IP Network for Tunnel Zone and NSDB</li><li>Public Classless Inter-Domain Routing (CIDR) block (Euca_public_IPs)</li><li>Two (2) BGP terminated uplinks</li></ul><p>Limits:</p><ul><li>Thirty two (32) MidoNet agents (i.e., 2 Gateway nodes and 30 Hypervisors)</li><li>Two (2) MidoNet Gateways</li><li>Tolerate 1 NSDB server failure</li><li>Tolerate 1 MidoNet Gateway/uplink failure</li><li>Limited uplinks load sharing/balancing</li></ul><p><strong>Deployment Topology</strong></p><ul><li>A 3-node cluster for NSDB (co-located ZooKeeper and Cassandra)</li><li>eucanetd co-located with MidoNet API Server</li><li>Two (2) MidoNet Gateway Nodes</li><li>Hypervisors with Midolman</li><li>One 10Gbps IP network handling NSDB and Tunnel Zone traffic</li><li>One 10Gbps IP Network handling Public Network traffic</li><li>API communication via loopback/localhost network</li></ul><p><img src=https://www.eucastack.io/images/euca_mido_7v2.png alt=image>
<em>Figure 7: Production:Small deployment topology. A 10Gbps IP network carries NSDB and Tunnel Zone traffic. Another 10Gbps IP network carries Public Network traffic. A 3-node cluster for NSDB tolerates 1 server failure, and 2 gateways enable network failover and limited load balancing/sharing.</em></p><p><img src=https://www.eucastack.io/images/euca_mido_8.png alt=image>
<em>Figure 8: How servers are bound to MidoNet in a Production:Small deployment. Gateway Nodes have physical devices bound to a MidoNet virtual router. These devices should have L2 and L3 connectivity to the Customer&rsquo;s Router, and with BGP terminated links. Virtual machine tap devices are bound to MidoNet virtual bridges.</em></p><p><strong>NSDB Data Replication</strong></p><ul><li>NSDB is deployed in a cluster of 3 nodes</li><li>ZooKeeper and Cassandra both have built-in data replication</li><li>One server failure is tolerated</li></ul><p><strong>MidoNet Gateway Failover</strong></p><ul><li>Two paths are available to and from MidoNet, and failover is handled by BGP</li></ul><p><strong>MidoNet Gateway Load Balancing and Sharing</strong></p><ul><li>Load Balancing from MidoNet is implemented by MidoNet agents (Midolman): ports in a stateful port group with default routes out are used in a round-robin fashion.</li><li>Partial load sharing from the Customer&rsquo;s router to MidoNet can be accomplished by:</li></ul><h2 id=production-large>Production: Large</h2><p>The Production:Large reference architecture is designed for large scale (500 to 600 MidoNet agents) production quality deployments. It supports MidoNet NSDB fault tolerance (partial failures), and MidoNet Gateway failover and load balancing/sharing.</p><p>Border Gateway Protocol (BGP) terminated uplinks are required. Each uplink should come from an independent router.</p><p><strong>Requirements:</strong></p><ul><li>Eight (8) or more modern Intel cores or AMD modules - exclude logical cores that share CPU resources from the count (Hyperthreads and AMD cores within a module) - for gateway nodes, 8 or more cores should be dedicated to MidoNet agent (Midolman)</li><li>4GB of RAM reserved for MidoNet Agent (when applicable), 16GB for Gateway nodes</li><li>4GB of free RAM reserved for MidoNet NSDB (when applicable)</li><li>4GB of free RAM reserved for MidoNet API (when applicable)</li><li>30GB of free disk space for NSDB (when applicable)</li><li>One 1Gbps and 2 10Gbps NICs per server</li><li>Five (5) servers dedicated to MidoNet NSDB</li><li>Three (3) servers as MidoNet Gateways</li></ul><p>Physical Network:</p><ul><li>One 1Gbps IP Network for NSDB</li><li>One 10Gbps IP Network for public network (if upstream links are 1Gbps, this could be 1Gbps)</li><li>One 10Gbps IP Network for Tunnel Zone</li><li>Public Classless Inter-Domain Routing (CIDR) block (Euca_public_IPs)</li><li>Three (3) BGP terminated uplinks, each of which coming from an independent router</li><li>ZooKeeper performance recommendations:</li></ul><p>Limits:</p><ul><li>500 to 600 MidoNet agents</li><li>Three (3) MidoNet Gateways</li><li>Tolerate 1 to 2 NSDB server failures</li><li>Tolerate 1 to 2 MidoNet Gateway/uplink failures</li></ul><p><strong>Deployment Topology</strong></p><ul><li>A 5-node cluster for NSDB (co-located ZooKeeper and Cassandra)</li><li>eucanetd co-located with MidoNet API Server</li><li>Three (3) MidoNet Gateway Nodes</li><li>Hypervisors with Midolman</li><li>One 1Gbps IP network handling NSDB traffic</li><li>One 10Gbps IP network handling Tunnel Zone traffic</li><li>One 10Gbps IP network handling Public Network traffic</li><li>API communication via loopback/localhost network</li></ul><p><img src=https://www.eucastack.io/images/euca_mido_9v2.png alt=image>
<em>Figure 9: Production:Large deployment topology. A 1Gbps IP network carries NSDB; a 10Gbps IP network carries Tunnel Zone traffic; and another 10Gbps IP network carries Public Network traffic. A 5-node cluster for NSDB tolerates 2 server failures, and 3 gateways enable network failover and load balancing/sharing. Servers are bound to MidoNet in a way similar to Production:Small.</em></p><p><strong>NSDB Data Replication</strong></p><ul><li>NSDB is deployed in a cluster of 5 nodes</li><li>ZooKeeper and Cassandra both have built-in data replication</li><li>Up to 2 server failures tolerated</li></ul><p><strong>MidoNet Gateway Failover</strong></p><ul><li>Three paths are available to and from MidoNet, and failover is handled by BGP</li></ul><p><strong>MidoNet Gateway Load Balancing/Sharing</strong></p><ul><li>Load Balancing from MidoNet is implemented by MidoNet agents (Midolman): ports in a stateful port group with default routes out are used in a round-robin fashion.</li><li>The customer AS should handle multi path routing in order to support load sharing/balancing to MidoNet; for example, Equal Cost Multi Path (ECMP).</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-a2181acdf80f6af185740ebc8fad10a0>1.4.1.7 - Prepare the Network</h1><h1 id=prepare-the-network>Prepare the Network</h1></div><div class=td-content><h1 id=pg-09ac412868e7569242d53b81dd90e21f>1.4.1.7.1 - Reserve Ports</h1><table><thead><tr><th style=text-align:left>Port</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left>TCP 5005</td><td style=text-align:left>DEBUG ONLY: This port is used for debugging (using the &ndash;debug flag).</td></tr><tr><td style=text-align:left>TCP 8772</td><td style=text-align:left>DEBUG ONLY: JMX port. This is disabled by default, and can be enabled with the &ndash;debug or &ndash;jmx options for CLOUD_OPTS.</td></tr><tr><td style=text-align:left>TCP 8773</td><td style=text-align:left>Web services port for the CLC, user-facing services (UFS), object storage gateway (OSG), Walrus SC; also used for external and internal communications by the CLC and Walrus. Configurable with euctl.</td></tr><tr><td style=text-align:left>TCP 8774</td><td style=text-align:left>Web services port on the CC. Configured in the eucalyptus.conf configuration file</td></tr><tr><td style=text-align:left>TCP 8775</td><td style=text-align:left>Web services port on the NC. Configured in the eucalyptus.conf configuration file.</td></tr><tr><td style=text-align:left>TCP 8777</td><td style=text-align:left>Database port on the CLC</td></tr><tr><td style=text-align:left>TCP 8779 (or next available port, up to TCP 8849)</td><td style=text-align:left>jGroups failure detection port on CLC, UFS, OSG, Walrus SC. If port 8779 is available, it will be used, otherwise, the next port in the range will be attempted until an unused port is found.</td></tr><tr><td style=text-align:left>TCP 8888</td><td style=text-align:left>The default port for the Management Console. Configured in the /etc/eucalyptus-console/console.ini file.</td></tr><tr><td style=text-align:left>TCP 16514</td><td style=text-align:left>TLS port on Node Controller, required for instance migrations</td></tr><tr><td style=text-align:left>UDP 7500</td><td style=text-align:left>Port for diagnostic probing on CLC, UFS, OSG, Walrus SC</td></tr><tr><td style=text-align:left>UDP 8773</td><td style=text-align:left>Membership port for any UFS, OSG, Walrus, and SC</td></tr><tr><td style=text-align:left>UDP 8778</td><td style=text-align:left>The bind port used to establish multicast communication</td></tr><tr><td style=text-align:left>TCP/UDP 53</td><td style=text-align:left>DNS port on UFS</td></tr><tr><td style=text-align:left>UDP 63822</td><td style=text-align:left>eucanetd binds to localhost port 63822 and uses it to detect and avoid running multiple instances (of eucanetd)</td></tr></tbody></table><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>For information about ports used by MidoNet, see the (Category OpenStack can be ignored).</div></div><div class=td-content style=page-break-before:always><h1 id=pg-f79af8966d6daed045469c4cbf231034>1.4.1.7.2 - Verify Connectivity</h1><p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Any firewall running on the CC must be compatible with the dynamic changes performed by when working with security groups. will flush the &lsquo;filter&rsquo; and &rsquo;nat&rsquo; tables upon boot.</div>Verify component connectivity by performing the following checks on the machines that will be running the listed Eucalyptus components.</p><p>Verify connection from an end-user to the CLC on TCP port 8773 Verify connection from an end-user to Walrus on TCP port 8773 Verify connection from the CLC, SC, and NC to SC on TCP port 8773 Verify connection from the CLC, SC, and NC to Walrus on TCP port 8773 Verify connection from Walrus and SC to CLC on TCP port 8777 Verify connection from CLC to CC on TCP port 8774 Verify connection from CC to NC on TCP port 8775 Verify connection from NC to Walrus on TCP port 8773. Or, you can verify the connection from the CC to Walrus on port TCP 8773, and from an NC to the CC on TCP port 8776 Verify connection from public IP addresses of Eucalyptus instances (metadata) and CC to CLC on TCP port 8773 Verify TCP connectivity between CLC, Walrus, and SC on TCP port 8779 (or the first available port in range 8779-8849)  Verify connection between CLC, Walrus, and SC on UDP port 7500 Verify multicast connectivity for IP address 239.193.7.3 between CLC and UFS, OSG, Walrus, and SC on UDP port 8773 If DNS is enabled, verify connection from an end-user and instance IPs to DNS ports If you use tgt (iSCSI open source target) for EBS in DAS or Overlay modes, verify connection from NC to SC on TCP port 3260</p></div><div class=td-content style=page-break-before:always><h1 id=pg-7445d721146b3bd901e55ec91ae81aa4>1.4.2 - Configure Dependencies</h1><h1 id=configure-dependencies>Configure Dependencies</h1><p>Before you install Eucalyptus , ensure you have the appropriate dependencies installed and configured.</p></div><div class=td-content><h1 id=pg-6cefa559970e018b0616595a7b88f9d3>1.4.2.1 - Configure Bridges</h1><p>To configure a bridge on CentOS 7 or RHEL 7, you need to create a file with bridge configuration (for example, ifcfg-brX) and modify the file for the physical interface (for example, ifcfg-ethX). The following steps describe how to set up a bridge on both CentOS 7 and RHEL 7. We show examples for configuring bridge devices that either obtain IP addresses using DHCP or statically.</p><p>Install the <code>bridge-utils</code> package.</p><pre><code>yum install bridge-utils
</code></pre><p>Go to the <em>/etc/sysconfig/network-scripts</em> directory:</p><pre><code>cd /etc/sysconfig/network-scripts
</code></pre><p>Open the network script for the device you are adding to the bridge and add your bridge device to it. The edited file should look similar to the following:</p><pre><code>DEVICE=eth0
# change the hardware address to match the hardware address your NIC uses
HWADDR=00:16:76:D6:C9:45
ONBOOT=yes
BRIDGE=br0
NM_CONTROLLED=no
</code></pre><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>The device name may vary. See the .</div><p>Create a new network script in the <em>/etc/sysconfig/network-scripts</em> directory called <em>ifcfg-br0</em> or something similar. The br0 is the name of the bridge, but this can be anything as long as the name of the file is the same as the <code>DEVICE</code> parameter, and the name is specified correctly in the previously created physical interface configuration (ifcfg-ethX).<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Choose names and use them consistently for all NCs (both the file name and the in the file).</div>If you are using DHCP, the configuration will look similar to:</p><pre><code>DEVICE=br0
TYPE=Bridge
BOOTPROTO=dhcp
ONBOOT=yes
DELAY=0
</code></pre><p>If you are using a static IP address, the configuration will look similar to:</p><pre><code>DEVICE=br0
TYPE=Bridge
BOOTPROTO=static
IPADDR=static_IP_address
NETMASK=netmask
GATEWAY=gateway
ONBOOT=yes
</code></pre><p>Enter the following command:</p><pre><code>systemctl restart network.service
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-df5626afcae9a08fe87ee2b7a8bdf8ce>1.4.2.2 - Disable FirewallD on RHEL 7</h1><p>This topic describes how to stop and disable FirewallD on RHEL 7.<strong>Prerequisites</strong></p><ul><li>You should have successfully installed RHEL 7 before this task.
If you have existing firewall rules on your host machines, you must disable the firewall in order to install Eucalyptus . You should re-enable it after installation.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>The firewall on a RHEL 7 system is enabled by default. Before you restart the CLC, you must disable the firewalld service on all host machines.</div></li></ul><p>For more information, see <a href=https://www.certdepot.net/rhel7-get-started-firewalld/>FirewallD on RHEL 7</a> or <a href=https://www.digitalocean.com/community/tutorials/how-to-set-up-a-firewall-using-firewalld-on-centos-7>FirewallD on CentOS</a> .</p><p><strong>To stop and disable FirewallD</strong> Check the status of the firewalld service:</p><pre><code>systemctl status firewalld.service
</code></pre><p>The status displays as <code>active (running)</code> or <code>inactive (dead)</code> . If the firewall is active / running, enter this command to stop it:</p><pre><code>systemctl stop firewalld.service
</code></pre><p>To completely disable the firewalld service, so it does not reload when you restart the host machine:</p><pre><code>systemctl disable firewalld.service
</code></pre><p>Verify the status of the firewalld service:</p><pre><code>systemctl status firewalld.service
</code></pre><p>The status should display as <code>disabled</code> and <code>inactive (dead)</code> .</p><pre><code>firewalld.service - firewalld - dynamic firewall daemon
  Loaded: loaded (/usr/lib/systemd/system/firewalld.service; disabled; vendor preset: enabled)
  Active: inactive (dead)
</code></pre><p>Repeat these steps for all host machines. The firewalld service is stopped and disabled. You can now start the CLC and other host machines.</p><p><strong>Postrequisites</strong></p><ul><li>You should re-enable the firewall after installation is complete.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-1cd6ada50e0e7b78b2d90f4603c34345>1.4.2.3 - Configure NTP</h1><p>To use NTP:</p><p>Install NTP on the machines that will host Eucalyptus components.</p><pre><code>yum install ntp
</code></pre><p>Open the <em>/etc/ntp.conf</em> file and add NTP servers, if necessary, as in the following example.</p><pre><code>server 0.pool.ntp.org
server 1.pool.ntp.org
server 2.pool.ntp.org
</code></pre><p>Save and close the file. Synchronize your server.</p><pre><code>ntpdate -u YOUR_NTP_SERVER
</code></pre><p>Configure NTP to run at reboot.</p><pre><code>systemctl enable ntpd.service
</code></pre><p>Start NTP.</p><pre><code>systemctl start ntpd.service
</code></pre><p>Synchronize your system clock, so that when your system is rebooted, it does not get out of sync.</p><pre><code>hwclock --systohc
</code></pre><p>Repeat on each host machine that will run a Eucalyptus service.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-b492735f6bd0619b5a487201a17fedcc>1.4.2.4 - Configure Java</h1><p>For the supported version of the Java Virtual Machine (JVM), see the Compatibility Matrix in the Release Notes .</p><p>As of Eucalyptus 4.3, JVM 8 is required. Eucalyptus RPM packages require java-1.8.0-openjdk, which will be installed automatically.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If your network mode is VPCMIDO, MidoNet will install JVM 1.7 as a dependency (it is acceptable to have both JVM 1.7 and JVM 1.8 installed).</div><p><strong>To use Java with Eucalyptus cloud:</strong></p><p>Open the <em>/etc/eucalyptus/eucalyptus.conf</em> file. Verify that the CLOUD_OPTS setting does not set &ndash;java-home , or that &ndash;java-home points to a supported JVM version.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Although it is possible to set , we do not recommend it unless there is a specific reason to do so.</div>If you are upgrading to Eucalyptus 4.3, note that Java 8 does not have permanent generation memory. Remove any JAVA_OPTS MaxPermSize settings at upgrade time. Save and close the file. Repeat on each host machine that will run a Eucalyptus service.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-eca124ba6897a9d471807816d50dc50d>1.4.2.5 - Configure an MTA</h1><p>You can use Sendmail, Exim, postfix, or something simpler. The MTA server does not have to be able to receive incoming mail.</p><p>Many Linux distributions satisfy this requirement with their default MTA. For details about configuring your MTA, go to the documentation for your specific product.</p><p>To test your mail relay for localhost, send email to yourself from the terminal using <code>mail</code> .</p></div><div class=td-content style=page-break-before:always><h1 id=pg-d116f8746c016eeb95e02cf25d69dc9b>1.4.2.6 - Install MidoNet</h1><h1 id=install-midonet>Install MidoNet</h1><p>Eucalyptus requires MidoNet for VPC functionality. This section describes how to install MidoNet for use with Eucalyptus.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If you are not using VPC with Eucalyptus, you do not need to install MidoNet. See <a href=https://www.eucastack.io/docs/install_guide/eucalyptus/configuring_euca/configure_network_modes/nw_edge/>Configure EDGE Network Mode</a>.</div><p><strong>Before you begin:</strong></p><ul><li>See the <a href=https://www.eucastack.io/docs/install_guide/eucalyptus/planning/planning_networking_modes/>Planning your Network</a> section of the guide to create a map of how MidoNet / will be deployed into your environment.</li><li>See the <a href=https://docs.midonet.org/docs/latest-en/quick-start-guide/rhel-7_newton-rdo/content/_midonet_installation.html>MidoNet Installation Guide</a> to become familiar with the general MidoNet installation procedure and concepts.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-5bb925d2c296c64558ffa27487ecb1a6>1.4.2.6.1 - Prerequisites</h1><p>This topic discusses the prerequisites for installing MidoNet 5.2.</p><p>You need to configure software repositories and install Network State Database (NSDB) services: ZooKeeper and Cassandra.</p><h2 id=repository-access>Repository Access</h2><p>In order to use MidoNet with Eucalyptus you need to configure the MidoNet repositories.</p><p>Create <code>/etc/yum.repos.d/midonet.repo</code> and <code>/etc/yum.repos.d/midonet-misc.repo</code> on all host machines that will run MidoNet components including ZooKeeper and Cassandra. For example:</p><pre><code>[midonet]
name=MidoNet
baseurl=http://builds.midonet.org/midonet-5.2/stable/el7/
enabled=1
gpgcheck=1
gpgkey=https://builds.midonet.org/midorepo.key
</code></pre><p>and:</p><pre><code>[midonet-misc]
name=MidoNet 3rd Party Tools and Libraries
baseurl=http://builds.midonet.org/misc/stable/el7/
enabled=1
gpgcheck=1
gpgkey=https://builds.midonet.org/midorepo.key
</code></pre><p>See <a href=https://docs.midonet.org/docs/latest-en/quick-start-guide/rhel-7_newton-rdo/content/_repository_configuration.html>MidoNet Repository Configuration</a>.</p><h2 id=zookeeper>ZooKeeper</h2><p>MidoNet uses Apache ZooKeeper to store critical path data about the virtual and physical network topology.</p><p>For a simple single-server installation, install ZooKeeper on any server that is IP accessible from all Midolman agents (for example: on the CLC host machine itself). You can also cluster ZooKeeper for fault tolerance. See <a href=https://docs.midonet.org/docs/latest-en/quick-start-guide/rhel-7_newton-rdo/content/_zookeeper_installation.html>MidoNet NSDB ZooKeeper Installation</a>.</p><p>Enable and start the ZooKeeper service before installing the other MidoNet services.</p><h2 id=cassandra>Cassandra</h2><p>MidoNet uses Apache Cassandra to store flow state information.</p><p>For a simple single-server installation, install Cassandra on any server that is IP accessible from all Midolman agents (for example: on the CLC host machine itself). You can also cluster Cassandra for fault tolerance. See <a href=https://docs.midonet.org/docs/latest-en/quick-start-guide/rhel-7_newton-rdo/content/_cassandra_installation.html>MidoNet NSDB Cassandra Installation</a>.</p><p>Enable and start the Cassandra service before installing the other MidoNet services.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-5002f76f28ab24c82d06601830a8d53a>1.4.2.6.2 - MidoNet Component Topology</h1><p>This topic lists topology recommendations for installing MidoNet.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>See [Understanding VPCMIDO and MidoNet]https://www.eucastack.io/docs/install_guide/eucalyptus/planning/planning_networking_modes/preparing_vpc_midonet/ for more information on MidoNet.</div><ul><li>The midonet-api must run co-located with the Cloud Controller (CLC).</li><li>Each Node Controller (NC) must run a Midolman agent.</li><li>The Cloud Controller (CLC) must run a Midolman agent.</li><li>It is recommended that your User Facing Services (UFS) host be used as the MidoNet Gateway (i.e., running a Midolman agent) when configuring .</li><li>The network interface(s) specified as * (in the configuration file) should be dedicated for /MidoNet (for configuration/operation/use).</li><li>/MidoNet expects exclusive use of the network interface specified in .</li><li>If the main network interface of a server is specified in , most likely the connectivity to that server will be lost once is deployed.</li></ul><h2 id=network-yaml-example>Network YAML Example</h2><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>The older (JSON) network configuration format is still accepted, however the YAML format is recommended.</div><p>The following Eucalyptus network YAML file shows a sample VPCMIDO mode configuration:</p><pre><code>Mode: VPCMIDO

InstanceDnsServers:
- &quot;10.10.10.1&quot;

PublicIps:
- &quot;1.A.B.1-1.A.B.255&quot;

Mido:
  Gateways:
  - ExternalCidr: &quot;172.19.0.0/30&quot;
    ExternalDevice: &quot;veth1&quot;
    ExternalIp: &quot;172.19.0.2&quot;
    ExternalRouterIp: &quot;172.19.0.1&quot;
    Ip: &quot;10.10.10.1&quot;
</code></pre><p>Where <code>1.A.B.1-1.A.B.255</code> represents the public IP address range for your cloud.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-b670fbdd76e9d8c060bb6a50218a5226>1.4.2.6.3 - Install MidoNet for Eucalyptus</h1><p>This topic shows how to install MidoNet for use in your Eucalyptus cloud.</p><h2 id=install-the-midonet-cluster-on-the-cloud-controller-clc>Install the MidoNet Cluster on the Cloud Controller (CLC)</h2><p>This topic describes how to install the MidoNet Cluster. MidoNet Cluster services provide a means to manage MidoNet functions that MidoNet agents (Midolman) are unable to perform on their own. MidoNet Cluster services include state synchronization of VxLAN gateways and the MidoNet REST API. A MidoNet v5 deployment requires at least one MidoNet cluster node, and it must be co-located on the CLC host machine in Eucalyptus deployments. For security reasons, the MidoNet REST API is accessed only on the CLC (localhost interface).</p><p><strong>To install the MidoNet Cluster on the CLC</strong></p><p>Add the MidoNet repo file as described in <a href=https://www.eucastack.io/docs/install_guide/eucalyptus/installing_dependencies/install_midonet/install_midonet_prereqs/>Prerequisites</a> . Install MidoNet Cluster packages.</p><pre><code>yum install midonet-cluster python-midonetclient
</code></pre><p>Edit the <em>/etc/midonet/midonet.conf</em> file to set the ZooKeeper host IP(s). Replace ZOOKEEPER_HOST_IP in the following example:</p><pre><code>[zookeeper]
zookeeper_hosts = ZOOKEEPER_HOST_IP:2181 
</code></pre><p>Configure cloud-wide access to the NSDB services:</p><pre><code>cat &lt;&lt; EOF | mn-conf set -t default
zookeeper {
  zookeeper_hosts = “ZOOKEEPER_HOST:2181&quot;
}

cassandra {
  servers = “CASSANDRA_HOST&quot;
}
EOF
</code></pre><p>Enable and start the MidoNet Cluster:</p><pre><code>systemctl enable midonet-cluster.service
systemctl start midonet-cluster.service
</code></pre><p>Set the midonet-api end point:</p><pre><code>mn-conf set cluster.rest_api.http_port=8080
mn-conf set cluster.rest_api.http_host=&quot;127.0.0.1&quot;
</code></pre><p>Restart the Midonet Cluster so the rest_api parameters take effect:</p><pre><code>systemctl restart midonet-cluster.service
</code></pre><h2 id=install-midolman-on-components>Install Midolman on components</h2><p>This topic describes how to install the Midolman agent. Midolman is the MidoNet Agent, which is a daemon that runs on all hosts where traffic enters and leaves MidoNet. The Midolman agent is required on the Cloud Controller (CLC), Node Controllers (NCs), and any host that is a MidoNet Gateway node (e.g., UFS).</p><p><strong>To install Midolman agent</strong></p><p>Edit the <code>/etc/midolman/midolman.conf</code> file to set the ZooKeeper host IP(s). Replace ZOOKEEPER_HOST_IP in the following example:</p><pre><code>[zookeeper]
zookeeper_hosts = ZOOKEEPER_HOST_IP:2181
</code></pre><p>Enable and start Midolman:</p><pre><code>systemctl enable midolman.service
systemctl start midolman.service
</code></pre><p>Configure a Midolman resource usage template. For large Eucalyptus clouds, use the agent-compute-large template. For standard (small or medium) Eucalyptus clouds, use the default template. For gateway nodes, use the agent-gateway templates.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>For production environments, large templates are recommended.</div><p>See the <a href=https://docs.midonet.org/docs/v5.2/en/quick-start-guide/rhel-7_mitaka-rdo/content/_midolman_installation.html>Midolman Installation documentation</a> for more information.</p><p>Choose the Midolman resource usage template name, based on the size and type of installation:</p><pre><code>agent-compute-large
agent-compute-medium
agent-gateway-large
agent-gateway-medium
default
</code></pre><p>Run this command, replacing <code>TEMPLATE_NAME</code> with your chosen template:</p><pre><code>mn-conf template-set -h local -t TEMPLATE_NAME
</code></pre><h2 id=create-a-tunnel-zone-in-midonet-and-add-hosts>Create a tunnel zone in MidoNet and add hosts</h2><p>This topic describes how to create a MidoNet tunnel zone. In MidoNet, a tunnel zone is an isolation zone for hosts. Physical hosts that are members of a given tunnel zone communicate directly with one another and establish network tunnels as needed, and on demand. These network tunnels are used to transport overlay traffic (e.g., inter-VM communication) and isolate the underlay physical network communication (i.e., inter-physical hosts communication). On a Eucalyptus deployment, one MidoNet tunnel zone is expected with the IP address on the physical network designated to carry VM traffic being used when configuring its members. Eucalyptus accepts the following tunnel zone names:</p><ul><li>eucatz</li><li>euca-tz</li><li>midotz</li><li>mido-tz</li></ul><p>For more information, see <a href=https://docs.midonet.org/docs/v5.2/en/operations-guide/content/tunnel_zones.html>What are Tunnel Zones?</a></p><p><strong>To create a tunnel zone in MidoNet</strong></p><p>Log into the MidoNet shell. For example:</p><pre><code>midonet-cli -A --midonet-url=http://127.0.0.1:8080/midonet-api
</code></pre><p>Create a GRE tunnel zone:</p><pre><code>[root@clcfrontend mido-docs]# midonet-cli -A --midonet-url=http://127.0.0.1:8080/midonet-api
midonet&gt; tunnel-zone add name eucatz type gre
midonet&gt; tunnel-zone list
tzone tzone0 name eucatz type gre
midonet&gt; host list
host host0 name node1 alive true
host host1 name clcfrontend alive true
host host2 name node2 alive true
</code></pre><p>You should see a host listed for each of your Node Controllers and for your User Facing Service host; if not, check the <code>/var/log/midolman/midolman.log</code> log file on the missing hosts to ensure there are no error messages.</p><p>After verifying all your hosts are listed, add each host to your tunnel zone as follows. Replace HOST_N_IP with the IP of your Node Controller or User Facing Service host that you used to register the component with Eucalyptus :</p><pre><code>midonet&gt; tunnel-zone tzone0 add member host host0 address HOST_0_IP
midonet&gt; tunnel-zone tzone0 add member host host1 address HOST_1_IP
midonet&gt; tunnel-zone tzone0 add member host host2 address HOST_2_IP
</code></pre><p>You are now ready to install and configure Eucalyptus to use this MidoNet installation.</p><h2 id=additional-zookeeper-configuration>Additional ZooKeeper Configuration</h2><p>Ongoing data directory cleanup is required for ZooKeeper. The following parameters should be added in <em>/etc/zookeeper/zoo.cfg</em> for automatic purging of the snapshots and corresponding transaction logs:</p><pre><code>autopurge.snapRetainCount=3  # The number of snapshots to retain in dataDir
autopurge.purgeInterval=1  # Purge task interval in hours
</code></pre><p>For more information, see <a href=http://zookeeper.apache.org/doc/r3.4.8/zookeeperAdmin.html#Ongoing+Data+Directory+Cleanup>ZooKeeper Admin Guide, Ongoing Data Directory Cleanup</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-671d5e1abc09d2e7bfe7ddbd6dde02d9>1.4.3 - Install Repositories</h1><h1 id=install-repositories>Install Repositories</h1><p>This section guides you through installing Eucalyptus from RPM package downloads.The first step to installing Eucalyptus is to download the RPM packages. When you&rsquo;re ready, continue to <a href=https://www.eucastack.io/docs/install_guide/eucalyptus/install_repos_intro/installing_euca_software_signing/>Software Signing</a> .</p><p>The following <em>terminology</em> might help you as you proceed through this section.</p><p>Eucalyptus open source software — Eucalyptus release packages and dependencies, which enable you to deploy a Eucalyptus cloud.</p><p>Euca2ools CLI — Euca2ools is the Eucalyptus command line interface for interacting with web services. It is compatible with many Amazon AWS services, so can be used with Eucalyptus as well as AWS.</p><p>RPM and YUM and software signing — Eucalyptus CentOS and RHEL download packages are in RPM (Red Hat Package Manager) format and use the YUM package management tool. We use GPG keys to sign our software packages and package repositories.</p><p>EPEL software — EPEL (Extra Packages for Enterprise Linux) are free, open source software, which is fully separated from licensed RHEL distribution. It requires its own package.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-0b4fcc2c7d167b279883e39950e226b6>1.4.3.1 - Software Signing</h1><p>This topic describes Eucalyptus software signing keys.We use a number of GPG keys to sign our software packages and package repositories. The necessary public keys are provided with the relevant products and can be used to automatically verify software updates. You can also verify the packages or package repositories manually using the keys on this page.</p><p>Use the <code>rpm --checksig</code> command on a download file to verify a RPM package for an Eucalyptus product. For example:</p><pre><code>rpm --checksig -v myfilename.rpm
</code></pre><p>Follow the procedure detailed on Debian&rsquo;s <a href=http://wiki.debian.org/SecureApt#How_to_manually_check_for_package.27s_integrity>SecureApt</a> web page to verify a deb package for an Eucalyptus product.</p><p>Please do not use package signing keys to encrypt email messages.</p><p>The following keys are used for signing Eucalyptus software:</p><h2 id=c1240596-eucalyptus-systems-inc-release-key-securityeucalyptuscom>c1240596: Eucalyptus Systems, Inc. (release key) <a href=mailto:security@eucalyptus.com>security@eucalyptus.com</a></h2><p>This key is used for signing Eucalyptus products released after July 2011 and their updates.</p><ul><li></li><li></li><li>Fingerprint:</li></ul><h2 id=0260cf4e-eucalyptus-systems-inc-pre-release-key-securityeucalyptuscom>0260cf4e: Eucalyptus Systems, Inc. (pre-release key) <a href=mailto:security@eucalyptus.com>security@eucalyptus.com</a></h2><p>This key is used for signing Eucalyptus pre-release products due for release after July 2011.</p><ul><li></li><li></li><li>Fingerprint:</li></ul><h2 id=9d7b073c-eucalyptus-systems-inc-nightly-release-key-securityeucalyptuscom>9d7b073c: Eucalyptus Systems, Inc. (nightly release key) <a href=mailto:security@eucalyptus.com>security@eucalyptus.com</a></h2><p>This key is used for signing nightly builds of Eucalyptus products published after July 2011.</p><ul><li></li><li></li><li>Fingerprint:</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-90008be4c92c3bb568e4cc25e4c50356>1.4.3.2 - Install Eucalyptus Release Packages</h1><p>To install Eucalyptus from release packages, perform the tasks listed in this topic.</p><p><strong>Prerequisites</strong></p><ul><li>The prerequisite hardware and software should be in place.</li></ul><p><strong>To install Eucalyptus from release packages</strong></p><p>Configure the Eucalyptus package repository on each host machine that will run a Eucalyptus service:</p><pre><code>yum install https://downloads.eucalyptus.cloud/software/eucalyptus/5/rhel/7/x86_64/eucalyptus-release-5-1.11.as.el7.noarch.rpm
</code></pre><p>Enter <code>y</code> when prompted to install this package.</p><p>Configure the Euca2ools package repository on each host machine that will run a Eucalyptus service or Euca2ools:</p><pre><code>yum install https://downloads.eucalyptus.cloud/software/euca2ools/3.4/rhel/7/x86_64/euca2ools-release-3.4-2.2.as.el7.noarch.rpm
</code></pre><p>Enter <code>y</code> when prompted to install this package.</p><p>Configure the EPEL package repository on each host machine that will run a Eucalyptus service or Euca2ools:</p><pre><code>yum install epel-release
</code></pre><p>Enter <code>y</code> when prompted to install this package.</p><p>If you are installing on RHEL 7, you must enable the Optional repository in Red Hat Network for each NC, as follows: Go to <a href=http://rhn.redhat.com>http://rhn.redhat.com</a> and navigate to the system that will run the NC. Click Alter Channel Subscriptions . Make sure the RHEL Server Optional check-box is selected. Click Change Subscriptions .</p><p>On CentOS enable the QEMU Enterprise Virtualization repository for each NC:</p><pre><code>yum install centos-release-qemu-ev
</code></pre><p>The following steps should be performed on each NC host machine. Install the Eucalyptus Node Controller software on each NC host:</p><pre><code>yum install eucalyptus-node
</code></pre><p>Remove the default libvirt network. This step allows the eucanetd dhcpd server to start.</p><pre><code>virsh net-destroy default
virsh net-autostart default --disable
</code></pre><p>Check that the KVM device node has proper permissions. Run the following command:</p><pre><code>ls -l /dev/kvm
</code></pre><p>Verify the output shows that the device node is owned by user root and group kvm.</p><pre><code>crw-rw-rw- 1 root kvm 10, 232 Nov 30 10:27 /dev/kvm
</code></pre><p>If your KVM device node does not have proper permissions, you need to reboot your NC host.</p><p>On each CLC host machine, install the Eucalyptus Cloud Controller software.</p><pre><code>yum install eucalyptus-cloud
</code></pre><p>Install the backend service image package on the machine hosting the CLC:</p><pre><code>yum install eucalyptus-service-image
</code></pre><p>This installs worker images for both the load balancer and imaging services. On the UFS host machine, install the Eucalyptus Cloud Controller software.</p><pre><code>yum install eucalyptus-cloud
</code></pre><p>(Optional) On the UFS host machine, also install the Management Console.</p><pre><code>yum install eucaconsole
</code></pre><p>The Management Console can run on any host machine, even one that does not have other Eucalyptus services . Install the software for the remaining Eucalyptus services. The following example shows services being installed on the same host machine.</p><pre><code>yum install eucalyptus-cluster eucalyptus-sc eucalyptus-walrus
</code></pre><p>This installs the cloud controller (CC), storage controller (SC), and Walrus Backend (Optional) services.</p><p>Your package installation is complete. You are now ready to <a href=https://www.eucastack.io/docs/install_guide/eucalyptus/configuring_euca/>Configure Eucalyptus</a> .</p></div><div class=td-content style=page-break-before:always><h1 id=pg-44973e6bf96612bed4bcbdfbd9a7fd95>1.4.4 - Configure Eucalyptus</h1><p>This section describes the parameters you need to set in order to launch Eucalyptus for the first time.</p><p>The first launch of Eucalyptus is different than a restart of a previously running Eucalyptus deployment in that it sets up the security mechanisms that will be used by the installation to ensure system integrity.</p><p>Eucalyptus configuration is stored in a text file, <em>/etc/eucalyptus/eucalyptus.conf</em>, that contains key-value pairs specifying various configuration parameters.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Perform the following tasks after you install software, but before you start the services.</div></div><div class=td-content style=page-break-before:always><h1 id=pg-14155a79410525e50ff553116b98f68e>1.4.4.1 - Configure SELinux</h1><p>We recommend enabling SELinux on host systems running Eucalyptus 4.4 services to improve their security on RHEL 7. Enabling SELinux, as described in this topic, can help contain break-ins. For more information, see <a href=https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/SELinux_Users_and_Administrators_Guide/chap-Security-Enhanced_Linux-Troubleshooting.html>RedHat SELinux</a> documentation.</p><p>You need to set boolean values on Storage Controller (SC) and Management Console host machines. If your network mode is VPCMIDO, you also set a boolean value on the Cloud Controller (CLC) host machines. <strong>To configure SELinux on Eucalyptus 4.4 :</strong></p><p>On each Storage Controller (SC) host machine, run the following command:</p><pre><code>setsebool -P eucalyptus_storage_controller 1
</code></pre><p>This allows Eucalyptus to manage EBS volumes.</p><p>On each Management Console host machine, run the following command:</p><pre><code>setsebool -P httpd_can_network_connect 1
</code></pre><p>This allows the Management Console&rsquo;s HTTP proxy to access the back end.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If you can&rsquo;t access the console after starting it, this KB article might help: .</div><p>If your cloud uses VPCMIDO networking mode, on the Cloud Controller (CLC), run the following command:</p><pre><code>setsebool -P httpd_can_network_connect 1
</code></pre><p>This allows the CLC&rsquo;s HTTP proxy to access the back end.</p><p>SELinux is now configured and ready to use with your Eucalyptus 4.4 cloud.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-b207cc52541e5c29799b86402eba76bf>1.4.4.2 - Configure Network Modes</h1><p>This section provides configuration instructions for Eucalyptus networking modes. Eucalyptus overlays a virtual network on top of your existing network. In order to do this, Eucalyptus supports these networking modes: EDGE (AWS EC2 Classic compatible) and VPCMIDO (AWS VPC compatible).</p></div><div class=td-content><h1 id=pg-a2a9c18fa398c16422822d97110e4c38>1.4.4.2.1 - Configure EDGE Network Mode</h1><p>This topic provides configuration instructions for Eucalyptus EDGE network mode. Eucalyptus requires network connectivity between its clients (end-users) and the cloud components (e.g., CC, CLC, and Walrus).</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If you are not using EDGE mode with Eucalyptus, you can skip this topic. See <a href=https://www.eucastack.io/docs/install_guide/eucalyptus/configuring_euca/configure_network_modes/nw_vpmido/>Configure VPCMIDO Network Mode</a>.</div><p>To configure Eucalyptus for EDGE mode, most networking configuration is handled through settings in a global Cloud Controller (CLC) property file.</p><p>The <em>/etc/eucalyptus/eucalyptus.conf</em> file contains some network-related options in the “Networking Configuration” section. These options use the prefix VNET_. The most commonly used VNET options are described in the following table.</p><p>The most commonly used VNET options are described in the following table.</p><table><thead><tr><th style=text-align:left>Option</th><th style=text-align:left>Description</th><th style=text-align:left>Component</th></tr></thead><tbody><tr><td style=text-align:left>VNET_BRIDGE</td><td style=text-align:left>This is the name of the bridge interface to which instances&rsquo; network interfaces should attach. A physical interface that can reach the CC must be attached to this bridge. Common setting for KVM is br0.</td><td style=text-align:left>Node Controller</td></tr><tr><td style=text-align:left>VNET_DHCPDAEMON</td><td style=text-align:left>The ISC DHCP executable to use. This is set to a distro-dependent value by packaging. The internal default is /usr/sbin/dhcpd3.</td><td style=text-align:left>Node Controller</td></tr><tr><td style=text-align:left>VNET_MODE</td><td style=text-align:left>The networking mode in which to run. The same mode must be specified on all CCs and NCs in your cloud. Valid values: EDGE</td><td style=text-align:left>All CCs and NCs</td></tr><tr><td style=text-align:left>VNET_PRIVINTERFACE</td><td style=text-align:left>The name of the network interface that is on the same network as the NCs. Default: eth0</td><td style=text-align:left>Node Controller</td></tr><tr><td style=text-align:left>VNET_PUBINTERFACE</td><td style=text-align:left>This is the name of the network interface that is connected to the same network as the CC. Depending on the hypervisor&rsquo;s configuration this may be a bridge or a physical interface that is attached to the bridge. Default: eth0</td><td style=text-align:left>Node Controller</td></tr></tbody></table><p>You must edit <em>eucalyptus.conf</em> on the Cluster Controller (CC) and Node Controller (NC) hosts. You must also create a network configuration file and upload it the Cloud Controller (CLC).</p><h2 id=cc-configuration>CC Configuration</h2><p>Log in to the CC and open the <em>/etc/eucalyptus/eucalyptus.conf</em> file. Go to the <strong>Network Configuration</strong> section, uncomment and set the following:</p><pre><code>VNET_MODE=&quot;EDGE&quot;
</code></pre><p>Save the file. Repeat on each CC in your cloud.</p><h2 id=nc-configuration>NC Configuration</h2><p>Log into an NC machine and open the <em>/etc/eucalyptus/eucalyptus.conf</em> file. Go to the <strong>Network Configuration</strong> section, uncomment and set the following parameters:</p><pre><code>VNET_MODE
VNET_PRIVINTERFACE
VNET_PUBINTERFACE
VNET_BRIDGE
VNET_DHCPDAEMON
</code></pre><p>For example:</p><pre><code>VNET_MODE=&quot;EDGE&quot;
VNET_PRIVINTERFACE=&quot;br0&quot;
VNET_PUBINTERFACE=&quot;br0&quot;
VNET_BRIDGE=&quot;br0&quot;
VNET_DHCPDAEMON=&quot;/usr/sbin/dhcpd&quot;
</code></pre><p>Save the file. Repeat on each NC.</p><h2 id=cloud-configuration>Cloud Configuration</h2><p>To configure the rest of the EDGE mode parameters, you must create a <em>network.yaml</em> configuration file. Later in the installation process you will <a href=https://www.eucastack.io/docs/install_guide/eucalyptus/configure_runtime/nw_json_upload/>Upload the Network Configuration</a> to the CLC.</p><p>Create the network configuration file. Open a text editor. Create a file similar to the following structure.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8f5902;font-style:italic># A list of servers that instances receive to resolve DNS names</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>InstanceDnsServers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>- <span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#8f5902;font-style:italic># List of public IP addresses or address ranges</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>PublicIps</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>- <span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#8f5902;font-style:italic># A list of cluster objects that define each availability zone (AZ) in your cloud</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Clusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>-<span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#8f5902;font-style:italic># Name of the cluster as it was registered</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#8f5902;font-style:italic># Subnet definition that this cluster will use for private addressing</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Subnet</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic># Arbitrary name for the subnet</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic># The subnet that will be used for private addressing</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Subnet</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic># Netmask for the subnet defined above</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Netmask</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic># Gateway that will route packets for the private subnet</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Gateway</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#8f5902;font-style:italic># List of Private IP addresses or address ranges for instances   </span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>PrivateIps</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#4e9a06>&#34;&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Save the <em>network.json</em> file. The following example is for a setup with one cluster (AZ), called PARTI00, with a flat network topology.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>InstanceDnsServers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>- <span style=color:#4e9a06>&#34;10.1.1.254&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>PublicIps</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>- <span style=color:#4e9a06>&#34;10.111.101.84&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>- <span style=color:#4e9a06>&#34;10.111.101.91-10.111.101.93&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Clusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>- <span style=color:#204a87;font-weight:700>Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PARTI00</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Subnet</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;10.111.0.0&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Subnet</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;10.111.0.0&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Netmask</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;255.255.0.0&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Gateway</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;10.111.0.1&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>PrivateIps</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#4e9a06>&#34;10.111.101.94&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#4e9a06>&#34;10.111.101.95&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>For a multi-cluster deployment, add an additional cluster to your configuration for each cluster you have. The following example has an two clusters, <strong>PARTI00</strong> and <strong>PARTI01</strong>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>InstanceDnsServers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>- <span style=color:#4e9a06>&#34;10.1.1.254&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>PublicIps</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>- <span style=color:#4e9a06>&#34;10.111.101.84&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>- <span style=color:#4e9a06>&#34;10.111.101.91-10.111.101.93&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Clusters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>- <span style=color:#204a87;font-weight:700>Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PARTI00</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Subnet</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;10.111.0.0&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Subnet</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;10.111.0.0&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Netmask</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;255.255.0.0&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Gateway</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;10.111.0.1&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>PrivateIps</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#4e9a06>&#34;10.111.101.94&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#4e9a06>&#34;10.111.101.95&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>- <span style=color:#204a87;font-weight:700>Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>PARTI01</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Subnet</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;10.111.0.0&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Subnet</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;10.111.0.0&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Netmask</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;255.255.0.0&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Gateway</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;10.111.0.1&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>PrivateIps</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#4e9a06>&#34;10.111.101.96&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#4e9a06>&#34;10.111.101.97&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-8a92c056ba1bcd9ef177398b6531e644>1.4.4.2.2 - Configure VPCMIDO Network Mode</h1><p>This topic provides configuration instructions for Eucalyptus VPCMIDO network mode. Eucalyptus requires network connectivity between its clients (end-users) and the cloud components (e.g., CC, CLC, and storage).</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If you are not using VPCMIDO mode with Eucalyptus, you can skip this topic. See <a href=https://www.eucastack.io/docs/install_guide/eucalyptus/configuring_euca/configure_network_modes/nw_edge/>Configure EDGE Network Mode</a>.</div><p>To configure VPCMIDO mode parameters, you must create a <em>network.yaml</em> configuration file. Later in the installation process you will <a href=https://www.eucastack.io/docs/install_guide/eucalyptus/configure_runtime/nw_json_upload/>Upload the Network Configuration</a> to the CLC.</p><p>Create the network configuration file. Open a text editor. Create a file similar to the following structure. This example demonstrates two gateways and two BGP peers (sections relevant to VPCMIDO are shown here).</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>Mode</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>VPCMIDO</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>PublicIps</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>- <span style=color:#4e9a06>&#34;10.116.150.10-10.116.150.254&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>- <span style=color:#4e9a06>&#34;10.117.150.10-10.117.150.254&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Mido</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>BgpAsn</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;64512&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Gateways</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>Ip</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;10.111.5.11&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>ExternalDevice</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;em1.116&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>ExternalCidr</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;10.116.128.0/17&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>ExternalIp</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;10.116.133.11&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>BgpPeerIp</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;10.116.133.173&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>BgpPeerAsn</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;65000&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>BgpAdRoutes</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#4e9a06>&#34;10.116.150.0/24&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>Ip</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;10.111.5.22&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>ExternalDevice</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;em1.117&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>ExternalCidr</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;10.117.128.0/17&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>ExternalIp</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;10.117.133.22&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>BgpPeerIp</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;10.117.133.173&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>BgpPeerAsn</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;65001&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>BgpAdRoutes</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#4e9a06>&#34;10.117.150.0/24&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Save the <em>network.yaml</em> file. The following example demonstrates a gateway with static routing configuration.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>Mode</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>VPCMIDO</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>PublicIps</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>- <span style=color:#4e9a06>&#34;10.116.150.10-10.116.150.254&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Mido</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Gateways</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>Ip</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;10.111.5.11&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>ExternalDevice</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;em1.116&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>ExternalCidr</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;10.116.128.0/17&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>ExternalIp</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;10.116.133.11&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>ExternalRouterIp</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;10.116.133.173&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-f8ba73af96d5cbb99b41ddffed1ee80e>1.4.4.2.2.1 - VPCMIDO Gateway Configuration Parameters</h1><p>This topic provides detailed configuration parameter information for Eucalyptus VPCMIDO network mode.</p><h2 id=vpcmido-gateway-configuration>VPCMIDO Gateway Configuration</h2><p>The following table provides a list of VPCMIDO parameters.</p><table><thead><tr><th style=text-align:left>Parameter</th><th style=text-align:left>Description</th><th style=text-align:left>Validation</th></tr></thead><tbody><tr><td style=text-align:left>BgpAsn</td><td style=text-align:left>(Optional) Global BGP configuration *BGP Autonomous System Number assigned (to be decided by administrator/installer) for this VPCMIDO deployment. Private ASN range should be used:16-bit: 64512 - 6553432-bit: 131072 - 4199999999 (RFC6996)</td><td style=text-align:left>Private use blocks recommended, but owners of public ASNs can use public ASNs or other blocks if they wish.Valid range is 1 - 4294967295.</td></tr><tr><td style=text-align:left>Gateways</td><td style=text-align:left>(The VPCMIDO gateway parameters are below.)</td><td style=text-align:left>Per MidoNet/BGP limitation, a maximum of 6 MidoGateways can be used.</td></tr><tr><td style=text-align:left>Ip</td><td style=text-align:left>Internal IP address of Mido Gateway (not to be confused with the IP address of the gateway interface used in external communications). Note: Replaces 4.3 GatewayHost parameter.</td><td style=text-align:left>Must be a valid IP address.Must be a live IP address configured on the machine.</td></tr><tr><td style=text-align:left>ExternalDevice</td><td style=text-align:left>Device name of Mido Gateway interface that is physically connected to the external network (i.e., has L2 connectivity to the infrastructure router or BGP peer). This interface is dedicated for MidoNet use (Mido Gateway Operating System should not have control of this device). Note: Replaces 4.3 GatewayInterface parameter.</td><td style=text-align:left>Must be a valid network interface connected to the network where L2 communication with BgpPeerIp (or ExternalRouterIp) can be established.</td></tr><tr><td style=text-align:left>ExternalCidr</td><td style=text-align:left>CIDR block used in the external routing. Note: Replaces 4.3 PublicNetworkCidr parameter.</td><td style=text-align:left>Must be a valid CIDR block.</td></tr><tr><td style=text-align:left>ExternalIp</td><td style=text-align:left>IP address to be configured on ExternalDevice by eucanetd. Its subnet is as specified in ExternalCidr (ExternalCidr must contain ExternalIp). Note: Replaces 4.3 GatewayIP parameter.</td><td style=text-align:left>Must be a valid and unused IP address.Must be within ExternalCidr.Must not be a network or broadcast address.</td></tr><tr><td style=text-align:left>ExternalRouterIp</td><td style=text-align:left>IP address of an external router (for static configuration). This is the router IP address used in default routes for traffic originating from MidoNet. Note: Partially replaces 4.3 PublicGatewayIp parameter.</td><td style=text-align:left>Must be a valid and unused IP address.Must be within ExternalCidr.Must not be a network or broadcast address.Either ExternalRouterIp or BgpPeerIp is required.</td></tr><tr><td style=text-align:left>BgpPeerIp</td><td style=text-align:left>(Optional) BGP configuration * IP address of a BGP peer. This is the IP address to where MidoNet router will attempt to establish a BGP session.Note: Partially replaces 4.3 PublicGatewayIp parameter.</td><td style=text-align:left>Must be a valid and unused IP address.Must be within ExternalCidr.Must not be a network or broadcast address.Either ExternalRouterIp or BgpPeerIp is required.</td></tr><tr><td style=text-align:left>BgpPeerAsn</td><td style=text-align:left>(Optional) BGP configuration * BGP peer ASN for this MidoGateway.</td><td style=text-align:left>Valid range is 1 - 4294967295.</td></tr><tr><td style=text-align:left>BgpAdRoutes</td><td style=text-align:left>(Optional) BGP configuration * A list of CIDR blocks delegated to this VPCMIDO deployment. VPCMIDO BGP will be configured to advertise these routes. public IPs must be within these CIDR blocks. The same list can be used for all MidoGateways. The advantage of having a separate list per MidoGateway is that it allows different MidoGateways to be responsible for different CIDR blocks. If the same list of CIDR blocks is used for all MidoGateways, MidoNet built-in load sharing/balancing mechanism is used.</td><td style=text-align:left>Each entry must be a valid CIDR block.</td></tr><tr><td style=text-align:left>PublicIps</td><td style=text-align:left>The public IP address ranges associated with VPCMIDO.</td><td style=text-align:left>With BGP: Each public IP must be within one of the CIDR blocks in the union of all BgpAdRoutes entries.Must be a valid IP address range.Must not contain network or broadcast address of the CIDR blocks in the union of all BgpAdRoutes.Without BGP: On-premise infrastructure must route all PublicIps to one of the MidoGateways.</td></tr></tbody></table><p>Gateways with BGP require <em>BgpPeerAsn</em> , <em>BgpAdRoutes</em> , and <em>BgpAsn</em> . If all gateways are static (no BGP), <em>BgpAsn</em> is optional. A gateway with BGP has <em>BgpPeerAsn</em> and <em>BgpAdRoutes</em> parameters; a static gateway does not.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-4a69989b840665db85b061db956b4cb4>1.4.4.3 - Create Scheduling Policy</h1><p>This topic describes how to set up the Cluster Controller (CC) to choose which Node Controller (NC) to run each new instance.In the CC, open the <em>/etc/eucalyptus/eucalyptus.conf</em> file. In the <code>SCHEDPOLICY=</code> parameter, set the value to one of the following: <code>GREEDY</code> When the CC receives a new instance run request, it runs the instance on the first NC in an ordered list of NCs that has capacity to run the instance. At partial capacity with some amount of churn, this policy generally results in a steady state over time where some nodes are running many instances, and some nodes are running few or no instances. <code>ROUNDROBIN</code> (Default) When the CC receives a new instance run request, it runs the instance on the next NC in an ordered list of NCs that has capacity. The next NC is determined by the last NC to have received an instance. At partial capacity with some amount of churn, this policy generally results in a steady state over time where instances are more evenly distributed across the set of NCs. Save the file.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-5ae0c9c8d53a01fedd24bb294ad33591>1.4.5 - Start Eucalyptus</h1><h1 id=start>Start</h1><p>Start the Eucalyptus services in the order presented in this section. Make sure that each host machine you installed a Eucalyptus service on resolves to an IP address. Edit the <em>/etc/hosts</em> file if necessary.</p></div><div class=td-content><h1 id=pg-e5e8324b00fdfa50dcd59ddbf6f60ddb>1.4.5.1 - Start the CLC</h1><p><strong>Prerequisites</strong> You should have installed and configured Eucalyptus before starting the CLC.</p><p><strong>To initialize and start the CLC</strong></p><p>Log in to the Cloud Controller (CLC) host machine. Enter the following command to initialize the CLC:<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If you are upgrading and you just restored your cloud data, do not initialize the CLC; skip this step.</div></p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Make sure that the process is running before executing this command.</div><pre><code>clcadmin-initialize-cloud
</code></pre><p>This command might take a minute or more to finish. If it fails, check <em>/var/log/eucalyptus/cloud-output.log</em> . If you want the CLC service to start at each boot-time, run this command:</p><pre><code>systemctl enable eucalyptus-cloud.service
</code></pre><p>Enter the following command to start the CLC:</p><pre><code>systemctl start eucalyptus-cloud.service
</code></pre><p>If you are running in VPCMIDO networking mode: If you want the eucanetd service to start at each boot-time, run this command:</p><pre><code>systemctl enable eucanetd.service
</code></pre><p>Start the eucanetd service:</p><pre><code>systemctl start eucanetd.service
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-e52984760577000fde6160fd154cc81e>1.4.5.2 - Start the UFS</h1><p><strong>Prerequisites</strong> You should have installed and configured Eucalyptus before starting the UFS.</p><p><strong>To start the UFS</strong></p><p>Log in to the User-Facing Services (UFS) host machine. If you want the UFS service to start at each boot-time, run this command:</p><pre><code>systemctl enable eucalyptus-cloud.service
</code></pre><p>Enter the following command to start the UFS:</p><pre><code>systemctl start eucalyptus-cloud.service
</code></pre><p>Repeat for each UFS host machine.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-914aa1501b6ef1bcbb0e19230cf43590>1.4.5.3 - Start Walrus</h1><p><strong>Prerequisites</strong></p><p>You should have installed and configured Eucalyptus before starting the Walrus Backend.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If you not using Walrus as your object storage backend, or if you installed Walrus on the same host as the CLC, you can skip this.</div><p><strong>To start the Walrus</strong></p><p>If you want the Walrus Backend service to start at each boot-time, run this command:</p><pre><code>systemctl enable eucalyptus-cloud.service
</code></pre><p>Log in to the Walrus Backend host machine and enter the following command:</p><pre><code>systemctl start eucalyptus-cloud.service
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-fba34cb1eb8eead504cd60172f4a0f09>1.4.5.4 - Start the CC</h1><p><strong>Prerequisites</strong></p><p>You should have installed and configured Eucalyptus before starting the CC.</p><p><strong>To start the CC</strong></p><p>Log in to the Cluster Controller (CC) host machine. If you want the CC service to start at each boot-time, run this command:</p><pre><code>systemctl enable eucalyptus-cluster.service
</code></pre><p>Enter the following command to start the CC:</p><pre><code>systemctl start eucalyptus-cluster.service
</code></pre><p>If you have a multi-zone setup, repeat this step on the CC in each zone.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-f56ccb1e4b8ad50651edc72cca7ba09d>1.4.5.5 - Start the SC</h1><p><strong>Prerequisites</strong></p><p>You should have installed and configured Eucalyptus before starting the SC.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If you are re-installing the SC, restart the tgt (iSCSI open source target) daemon.</div><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If you installed SC on the same host as the CLC, you can skip this.</div><p><strong>To start the SC</strong></p><p>Log in to the Storage Controller (SC) host machine. If you want the SC service to start at each boot-time, run this command:</p><pre><code>systemctl enable eucalyptus-cloud.service
</code></pre><p>If you want the tgtd service to start at each boot-time, run this command:</p><pre><code>systemctl enable tgtd.service
</code></pre><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>depends on tgtd to create and manage block storage volumes when the storage provider is either DAS or Overlay.</div><p>Enter the following commands to start the SC:</p><pre><code>systemctl start tgtd.service

systemctl start eucalyptus-cloud.service
</code></pre><p>If you have a multi-zone setup, repeat this step on the SC in each zone.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-a2992fd0511e4cd5b3e30621ca66c715>1.4.5.6 - Start the NC</h1><p><strong>Prerequisites</strong> You should have installed and configured Eucalyptus before starting the NC.</p><p><strong>To start the NC</strong></p><p>Log in to the Node Controller (NC) host machine. If you want the NC service to start at each boot-time, run this command:</p><pre><code>systemctl enable eucalyptus-node.service
</code></pre><p>Enter the following command to start the NC:</p><pre><code>systemctl start eucalyptus-node.service
</code></pre><p>If you are running in EDGE networking mode: If you want the eucanetd service to start at each boot-time, run this command:</p><pre><code>systemctl enable eucanetd.service
</code></pre><p>Start the eucanetd service:</p><pre><code>systemctl start eucanetd.service
</code></pre><p>Repeat for each NC host machine.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-42ad0538f40eb9fe89a3ea0967ab4d80>1.4.5.7 - Start the Management Console</h1><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If you plan on running multiple Management Console host machines, we recommend turning off the default memcached in your console.ini file.</div><p>Log in to the Management Console host machine. If you want the console service to start at each boot-time, run this command:</p><pre><code>systemctl enable eucaconsole.service
</code></pre><p>Enter the following command to start the console:</p><pre><code>systemctl start eucaconsole.service
</code></pre><p>Repeat for each Management Console host machine.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-e7dfbf0222ff21863a7a57492266c6d4>1.4.5.8 - Verify the Startup</h1><p>At this point, all Eucalyptus services are enabled and starting up. Some of these services perform intensive initialization at start-up, particularly the first time they are started. You might have to wait a few minutes until they are fully operational.</p><p>One quick way to determine if the components are running is to run netstat on the various hosts and look to see when the service ports are allocated to a process. Specifically, the CLC, Walrus, and the SC allocate ports 8773. The CC listens to port 8774, and the NC uses port 8775.</p><p>Verify that everything has started without error. Expected outcomes include:</p><ul><li>The CLC is listening on port 8773</li><li>Walrus is listening on port 8773</li><li>The SC is listening on port 8773</li><li>The CC is listening on port 8774</li><li>The NCs are listening on port 8775</li><li>Log files are being written to</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-108e0ca8c7851c5668e3b09f56eae60e>1.4.6 - Register Eucalyptus Services</h1><h1 id=register-services>Register Services</h1><p>This section describes how to register Eucalyptus services.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If you are upgrading, proceed to the section. (You don&rsquo;t need to register the rest (e.g., UFS, Walrus, etc.) during the non-NC upgrade, because those registrations are already listed in the cloud database, which you recovered before getting here.)</div><p>Eucalyptus implements a secure protocol for registering separate services so that the overall system cannot be tricked into including a service run by an unauthorized administrator or user.</p><p>You need only register services once. Most registration commands run on the CLC server.</p><p>Note that each registration command will attempt an SSH as root to the remote physical host where the registering service is assumed to be running. The registration command also contacts the service so it must be running at the time the command is issued. If a password is required to allow SSH access, the command will prompt the user for it.</p><p>Registration commands need the following information:</p><ul><li>The of service you are registering. Required. For example: .</li><li>The of the service being registered. Required. The host must be specified by IP address to function correctly.</li><li>The the service belongs to. This is roughly equivalent to the availability zone in AWS.</li><li>The you assign to each instance of a service, up to 256 characters. Required. This is the name used to identify the service in a human-friendly way. This name is also used when reporting system state changes that require administrator attention.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-6c3b799939e318d49db2499a7bd58541>1.4.6.1 - Register User-Facing Services</h1><p>This topic describes how to register the User-Facing Services (UFS) with the Cloud Controller (CLC).</p><p><strong>Prerequisites</strong></p><ul><li>The Cloud Controller must be properly installed and started.</li><li>The User-Facing Services must be properly installed and started.</li></ul><p><strong>To register the User-Facing Services with the Eucalyptus cloud</strong></p><p>On the CLC host machine, obtain your temporary access keys for the Eucalyptus set up by running the following command:</p><pre><code>eval `clcadmin-assume-system-credentials`
</code></pre><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>You will create longer-lived and fully functional access keys later.</div><p>Also on the CLC host machine, run the following command:</p><pre><code>euserv-register-service -t user-api -h IP SVCINSTANCE
</code></pre><p>where:</p><ul><li><code>SVCINSTANCE</code> is the IP address of the UFS you are registering.</li><li>must be a unique name for the User-Facing service.</li></ul><p>For example:</p><pre><code>euserv-register-service -t user-api -h 10.111.5.183 user-api-1
</code></pre><p>Repeat for each UFS host, replacing the UFS IP address and UFS name. Copy the security credentials from the CLC to each machine running User-Facing Services. Run this command on the CLC host machine:</p><pre><code>clcadmin-copy-keys HOST [HOST ...]
</code></pre><p>For example:</p><pre><code>clcadmin-copy-keys 10.111.5.183
</code></pre><p>Verify that the User-Facing service is registered with the following command for each instance of the UFS:</p><pre><code>euserv-describe-services SVCINSTANCE
</code></pre><p>The registered UFS instances are now ready for your cloud.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-0333fa64f2ebc68bd3e0ed029d46c621>1.4.6.2 - Register the Walrus Backend</h1><p>This topic describes how to register the Walrus Backend service with the Cloud Controller (CLC).</p><p><strong>Prerequisites</strong></p><ul><li>You must be using the Walrus Backend service as your object storage provider.</li><li>The Cloud Controller must be properly installed and started.</li></ul><p><strong>To register the Walrus Backend service with the Eucalyptus cloud</strong></p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>This task is not necessary if you are using Riak CS instead of Walrus.</div><p>On the CLC host machine, run the following command:</p><pre><code>euserv-register-service -t walrusbackend -h IP SVCINSTANCE
</code></pre><p>where:</p><ul><li><code>SVCINSTANCE</code> is the IP of the Walrus Backend you are registering with this CLC.</li><li>must be a unique name for the Walrus Backend service. We recommend that you use a short-hand name of the hostname or IP address of the machine.</li></ul><p>For example:</p><pre><code>euserv-register-service -t walrusbackend -h 10.111.5.182 walrus-10.111.5.182
</code></pre><p>Copy the security credentials from the CLC to each machine running a Walrus Backend service. Run this command on the CLC host machine:</p><pre><code>clcadmin-copy-keys HOST [HOST ...]
</code></pre><p>For example:</p><pre><code>clcadmin-copy-keys 10.111.5.182
</code></pre><p>Verify that the Walrus Backend service is registered with the following command:</p><pre><code>euserv-describe-services SVCINSTANCE
</code></pre><p>The registered Walrus Backend service is now ready for your cloud.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-04341adcb357c8048563067bfaf9e9fd>1.4.6.3 - Register the Cluster Controller</h1><p>This topic describes how to register a Cluster Controller (CC) with the Cloud Controller (CLC).</p><p><strong>Prerequisites</strong></p><ul><li>The Cloud Controller must be properly installed and started.</li><li>The Cluster Controller service must be properly installed and started.</li></ul><p><strong>To register the Cluster Controller service with the Eucalyptus cloud</strong></p><p>On the CLC host machine, run the following command:</p><pre><code>euserv-register-service -t cluster -h IP -z ZONE SVCINSTANCE
</code></pre><p>where:</p><ul><li><code>SVCINSTANCE</code> is the IP address of the CC you are registering with this CLC.</li><li>name should be a descriptive name for the zone controlled by the CC. For example: .</li><li>must be a unique name for the CC service. We recommend that you use the IP address of the machine</li></ul><p>For example:</p><pre><code>euserv-register-service -t cluster -h 10.111.5.182 -z zone-1 cc-10.111.5.182
</code></pre><p>Copy the security credentials from the CLC to each machine running Cluster Controller services. Run this command on the CLC host machine:</p><pre><code>clcadmin-copy-keys -z ZONE HOST
</code></pre><p>For example:</p><pre><code>clcadmin-copy-keys -z zone-1 10.111.5.182
</code></pre><p>Repeat the above steps for each Cluster Controller in each zone. Verify that the Cluster Controller service is registered with the following command:</p><pre><code>euserv-describe-services SVCINSTANCE
</code></pre><p>The registered Cluster Controller service is now ready for your cloud.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-a4d7a5b8052a5795166ed717511322d1>1.4.6.4 - Register the Storage Controller</h1><p>This topic describes how to register a Storage Controller (SC) with the Cloud Controller (CLC).</p><p><strong>Prerequisites</strong></p><ul><li>The Cloud Controller must be properly installed and started.</li><li>The Storage Controller service must be properly installed and started.</li></ul><p><strong>To register the Storage Controller service with the Eucalyptus cloud</strong></p><p>Copy the security credentials from the CLC to each machine running Storage Controller services. Run this command on the CLC host machine:</p><pre><code>clcadmin-copy-keys -z ZONE HOST
</code></pre><p>For example:</p><pre><code>clcadmin-copy-keys -z zone-1 10.111.5.182
</code></pre><p>On the CLC host machine, run the following command:</p><pre><code>euserv-register-service -t storage -h IP -z ZONE SVCINSTANCE
</code></pre><p>where:</p><ul><li><code>SVCINSTANCE</code> is the IP address of the SC you are registering with this CLC.</li><li>name should be a descriptive name for the zone controlled by the CC. For example: . An SC must have the same name as the CC in the same zone.</li><li>must be a unique name for the SC service. We recommend that you use a short-hand name of the IP address or hostname of the machine.</li></ul><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>We recommend that you use IP addresses instead of DNS names when registering services.</div><p>For example:</p><pre><code>euserv-register-service -t storage -h 10.111.5.182 -z zone-1 sc-10.111.5.182
</code></pre><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>The SC automatically goes to the state after being registered with the CLC; it will remain in that state until you explicitly configure the SC by configuring the backend storage provider (later). For more information, see .</div><p>Repeat the above steps for each Storage Controller in each zone. Verify that the Storage Controller service is registered with the following command:</p><pre><code>euserv-describe-services SVCINSTANCE
</code></pre><p>The registered Storage Controller service is now ready for your cloud.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-df7fcaa99d87b06e61625e4a49b721de>1.4.6.5 - Register the Node Controllers</h1><p>This topic describes how to register a Node Controller (NC) with a Cluster Controller (CC).</p><p><strong>Prerequisites</strong></p><ul><li>The Cluster Controller service must be properly installed and started.</li><li>The Node Controller service must be properly installed and started.</li><li>If you are upgrading, you should understand that:<ul><li>If you&rsquo;re upgrading an NC, just register that NC (on the CC that had it registered before).</li><li>If you&rsquo;re upgrading the set of non-NC host machines, register all the NCs (on each CC that had NCs registered).</li></ul></li></ul><p><strong>To register the Node Controller service with the Eucalyptus cloud</strong></p><p>SSH to the Cluster Controller in the zone. On the CC, register all NCs using the following command with the IP address of each NC host machine:</p><pre><code>clusteradmin-register-nodes node0_IP_address ... [nodeN_IP_address]
</code></pre><p>For example:</p><pre><code>clusteradmin-register-nodes 10.111.5.160 10.111.5.161 10.111.5.162
</code></pre><p>Copy the CC&rsquo;s security credentials using the following command:</p><pre><code>clusteradmin-copy-keys node0_IP_address ... [nodeN_IP_address]
</code></pre><p>For example:</p><pre><code>clusteradmin-copy-keys 10.111.5.160 10.111.5.161 10.111.5.162
</code></pre><p>Repeat the steps for each zone in your cloud. The registered Node Controller service is now ready for your cloud.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-9f6ef2abc861228ad98d0746a52e3bbf>1.4.7 - Configure the Runtime Environment</h1><h1 id=configure-the-runtime-environment>Configure the Runtime Environment</h1><p>After Eucalyptus is installed and registered, perform the tasks in this section to configure the runtime environment.Now that you have installed Eucalyptus , you&rsquo;re ready to begin configuring and using it.</p></div><div class=td-content><h1 id=pg-a0ef37a70072d465efc415fbe578fa67>1.4.7.1 - Configure Eucalyptus DNS</h1><p>Eucalyptus provides a DNS service that maps service names, bucket names, and more to IP addresses. This section details how to configure the Eucalyptus DNS service.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>administration tools are designed to work with DNS-enabled clouds, so configuring this service is highly recommended. The remainder of this guide is written with the assumption that your cloud is DNS-enabled.</div>The DNS service will automatically try to bind to port 53. If port 53 cannot be used, DNS will be disabled. Typically, other system services like dnsmasq are configured to run on port 53. To use the Eucalyptus DNS service, you must disable these services.</p><h2 id=configure-the-domain-and-subdomain>Configure the Domain and Subdomain</h2><p>Before using the DNS service, configure the DNS subdomain name that you want Eucalyptus to handle using the steps that follow.</p><p>Log in to the CLC and enter the following:</p><pre><code>euctl system.dns.dnsdomain=mycloud.example.com
</code></pre><p>You can configure the load balancer DNS subdomain. To do so, log in to the CLC and enter the following:</p><pre><code>euctl services.loadbalancing.dns_subdomain=lb
</code></pre><h2 id=turn-on-ip-mapping>Turn on IP Mapping</h2><p>To enable mapping of instance IPs to DNS host names:</p><p>Enter the following command on the CLC:</p><pre><code>euctl bootstrap.webservices.use_instance_dns=true
</code></pre><p>When this option is enabled, public and private DNS entries are created for each launched instance in Eucalyptus . This also enables virtual hosting for Walrus. Buckets created in Walrus can be accessed as hosts. For example, the bucket <code>mybucket</code> is accessible as <code>mybucket.objectstorage.mycloud.example.com</code> .</p><p>Instance IP addresses will be mapped as <code>euca-A-B-C-D.eucalyptus.mycloud.example.com</code> , where <code>A-B-C-D</code> is the IP address (or addresses) assigned to your instance.</p><p>If you want to modify the subdomain that is reported as part of the instance DNS name, enter the following command:</p><pre><code>euctl cloud.vmstate.instance_subdomain=.custom-dns-subdomain
</code></pre><p>When this value is modified, the public and private DNS names reported for each instance will contain the specified custom DNS subdomain name, instead of the default value, which is <code>eucalyptus</code> . For example, if this value is set to <code>foobar</code> , the instance DNS names will appear as <code>euca-A-B-C-D.foobar.mycloud.example.com</code> .</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>The code example above correctly begins with &ldquo;.&rdquo; before .</div><h2 id=enable-dns-delegation>Enable DNS Delegation</h2><p>DNS delegation allows you to forward DNS traffic for the Eucalyptus subdomain to the Eucalyptus CLC host. This host acts as a name server. This allows interruption-free access to Eucalyptus cloud services in the event of a failure. The CLC host is capable of mapping cloud host names to IP addresses of the CLC and UFS / OSG host machines.</p><p>For example, if the IP address of the CLC is <code>192.0.2.5</code> , and the IP address of Walrus is <code>192.0.2.6</code> , the host <code>compute.mycloud.example.com</code> resolves to <code>192.0.2.5</code> and <code>objectstorage.mycloud.example.com</code> resolves to <code>192.0.2.6</code> .</p><p>To enable DNS delegation:</p><p>Enter the following command on the CLC:</p><pre><code>euctl bootstrap.webservices.use_dns_delegation=true
</code></pre><h2 id=configure-the-master-dns-server>Configure the Master DNS Server</h2><p>Set up your master DNS server to delegate the Eucalyptus subdomain to the UFS host machines, which act as name servers.</p><p>The following example shows how the Linux name server <code>bind</code> is set up to delegate the Eucalyptus subdomain.</p><p>Open <em>/etc/named.conf</em> and set up the <code>example.com</code> zone. For example, your <em>/etc/named.conf</em> may look like the following:</p><pre><code>zone &quot;example.com&quot; IN {
	      type master;
	      file &quot;/etc/bind/db.example.com&quot;;
	      };
</code></pre><p>Create <em>/etc/bind/db.example.com</em> if it does not exist. If your master DNS is already set up for <code>example.com</code> , you will need to add a name server entry for UFS host machines. For example:</p><pre><code>$ORIGIN example.com.
$TTL 604800

@ IN    SOA ns1 admin.example.com 1 604800 86400 2419200 604800
        NS  ns1
ns1     A   MASTER.DNS.SERVER_IP
ufs1    A   UFS1_IP
mycloud NS  ufs1
</code></pre><p>After this, you will be able to resolve your instances&rsquo; public DNS names such as <code>euca-A-B-C-D.eucalyptus.mycloud.example.com</code> .</p><p>Restart the bind nameserver <code>service named restart</code> . Verify your setup by pointing <em>/etc/resolv.conf</em> on your client to your primary DNS server and attempt to resolve <code>compute.example.com</code> using ping or nslookup. It should return the IP address of a UFS host machine.</p><h2 id=advanced-dns-options>Advanced DNS Options</h2><p>Recursive lookups and split-horizon DNS are available in Eucalyptus .</p><p>To enable any of the DNS resolvers, set <code>dns.enabled</code> to <code>true</code> . To enable the recursive DNS resolver, set <code>dns.recursive.enabled</code> to <code>true</code> . To enable split-horizon DNS resolution for internal instance public DNS name queries, set <code>dns.split_horizon.enabled</code> to <code>true</code> .</p><h2 id=optional-configure-eucalyptus-dns-to-spoof-aws-endpoints>Optional: Configure Eucalyptus DNS to Spoof AWS Endpoints</h2><p>You can configure instances to use AWS region FQDNs for service endpoints by enabling DNS spoofing.</p><p>Set up a Eucalyptus cloud with Eucalyptus DNS and HTTPS endpoints. When creating CSR, make sure and add Subject Alternative Names for all the supported AWS services for the given region that’s being tested. For example:</p><pre><code>$ openssl req -in wildcard.c-06.autoqa.qa1.eucalyptus-systems.com.csr 
						-noout -text | less X509v3 Subject Alternative Name:
     DNS:ec2.us-east-1.amazonaws.com, DNS:autoscaling.us-east-1.amazonaws.com, 
     DNS:cloudformation.us-east-1.amazonaws.com, DNS:monitoring.us-east-1.amazonaws.com, 
     DNS:elasticloadbalancing.us-east-1.amazonaws.com, DNS:s3.amazonaws.com, 
     DNS:sts.us-east-1.amazonaws.com
</code></pre><p>Set DNS spoofing:</p><pre><code>[root@d-17 ~]#  euctl dns.spoof_regions --region euca-admin@future
dns.spoof_regions.enabled = true
dns.spoof_regions.region_name =
dns.spoof_regions.spoof_aws_default_regions = true
dns.spoof_regions.spoof_aws_regions = true
</code></pre><p>Launch an instance, and allow SSH access. SSH into the instance and install AWS CLI.</p><pre><code>ubuntu@euca-172-31-12-59:~$ sudo apt-get install -y python-pip
ubuntu@euca-172-31-12-59:~$ sudo -H pip install --upgrade pip
ubuntu@euca-172-31-12-59:~$ sudo -H pip install --upgrade awscli
</code></pre><p>Run <code>aws configure</code> and set access and secret key information if not using instance profile. Confirm AWS CLI works with HTTPS Eucalyptus service endpoint:</p><pre><code>ubuntu@euca-172-31-12-59:~$ aws --ca-bundle euca-ca-0.crt 
--endpoint-url https://ec2.c-06.autoqa.qa1.eucalyptus-systems.com/ ec2 describe-key-pairs
{
    &quot;KeyPairs&quot;: [
        {
            &quot;KeyName&quot;: &quot;devops-admin&quot;,
            &quot;KeyFingerprint&quot;: &quot;ee:4f:93:a8:87:8d:80:8d:2c:d6:d5:60:20:a3:2d:b2&quot;
        }
    ]
}
</code></pre><p>Test against AWS FQDN service endpoint that matches one of the SANs in the signed certificate:</p><pre><code>ubuntu@euca-172-31-12-59:~$ aws --ca-bundle euca-ca-0.crt 
--endpoint-url https://ec2.us-east-1.amazonaws.com ec2 describe-key-pairs{
    &quot;KeyPairs&quot;: [
        {
            &quot;KeyName&quot;: &quot;devops-admin&quot;,
            &quot;KeyFingerprint&quot;: &quot;ee:4f:93:a8:87:8d:80:8d:2c:d6:d5:60:20:a3:2d:b2&quot;
        }
    ]
}				
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-09d0cc0a79d201e09f5c9804c4c61cd3>1.4.7.2 - Create the Eucalyptus Cloud Administrator User</h1><p>After your cloud is running and DNS is functional, create a user and access key for day-to-day cloud administration.</p><h2 id=prerequisites>Prerequisites</h2><ul><li>cloud services must be installed and registered.</li><li>DNS must be configured.</li></ul><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>This is where you would begin using the admin role, if you want to use that feature.</div><h2 id=create-a-cloud-admin-user>Create a cloud admin user</h2><p>Eucalyptus admin tools and Euca2ools commands need configuration from <em>~/.euca</em> . If the directory does not yet exist, create it:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkdir ~/.euca
</span></span></code></pre></div><p>Choose a name for the new user and create it along with an access key:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>euare-usercreate -wld DOMAIN USER &gt;~/.euca/FILE.ini
</span></span></code></pre></div><p>where:</p><ul><li><strong>DOMAIN</strong> must match the DNS domain for the cloud.</li><li><strong>USER</strong> is the name of the new admin user.</li><li><strong>FILE</strong> can be anything; we recommend a descriptive name that includes the user&rsquo;s name.</li></ul><p>This creates a file with a region name that matches that of your cloud&rsquo;s DNS domain; you can edit the file to change the region name if needed.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>This creates an admin user in the built-in <strong>eucalyptus</strong> account. The admin user has full control of all aspects of the cloud. For additional security, you might instead want to create a new account and grant it access to a more limited administration role.</div><p>Switch to the new admin user:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># eval `clcadmin-release-credentials`</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># export AWS_DEFAULT_REGION=REGION</span>
</span></span></code></pre></div><p>where:</p><ul><li><strong>REGION</strong> must match the region name from the previous step. By default, this is the same as the cloud&rsquo;s DNS domain.</li></ul><p>As long as this file exists in <em>~/.euca</em> , you can use it by repeating the <code>export</code> command above. These <code>euca2ools.ini</code> configuration files are a flexible means of managing cloud regions and users.</p><p>Alternatively you can configure the default region in the <strong>global</strong> section of your Euca2ools configuration:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># cat ~/.euca/global.ini</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span>global<span style=color:#ce5c00;font-weight:700>]</span>
</span></span><span style=display:flex><span>default-region <span style=color:#ce5c00;font-weight:700>=</span> REGION
</span></span></code></pre></div><p>setting the <strong>REGION</strong> to the one from the earlier step means you do not have to use <em>export</em> to select the region.</p><h2 id=user-impersonation>User impersonation</h2><p>The <strong>eucalyptus</strong> account can act as other accounts for administrative purposes. To act as the <em>admin</em> user in the <em>account-1</em> account run:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># eval `clcadmin-impersonate-user -a account-1 -u admin`</span>
</span></span></code></pre></div><p>Impersonating an account allows you to view and modify resources for that account. For example, you can clean up resources in an account before deleting it.</p><p>To stop impersonating run:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>clcadmin-release-credentials
</span></span></code></pre></div><h2 id=next-steps>Next steps</h2><p>The remainder of this guide assumes you have completed the above steps.</p><p>Use these credentials after this point.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-dc4447570e8060e614e4b8d90b23a14c>1.4.7.3 - Upload the Network Configuration</h1><p>This topic describes how to upload the network configuration created earlier in the installation process. To upload your networking configuration:</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>This step can only be run after getting your credentials in <a href=https://www.eucastack.io/docs/install_guide/eucalyptus/configure_runtime/credentials_admin_create/>Create the Eucalyptus Cloud Administrator User</a>.</div><p>Run the following command to upload the configuration file to the CLC (with valid Eucalyptus admin credentials):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>euctl cloud.network.network_configuration<span style=color:#ce5c00;font-weight:700>=</span>@/path/to/your/network_config_file
</span></span></code></pre></div><p>To review the existing network configuration run:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>euctl  --dump --format<span style=color:#ce5c00;font-weight:700>=</span>raw cloud.network.network_configuration
</span></span></code></pre></div><p>When you use the Ansible playbook for deployment a network configuration file is available at <em>/etc/eucalyptus/network.yaml</em> on the CLC.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-fd3ae2688dc91115bc710364761b2ce5>1.4.7.4 - Configure Eucalyptus Storage</h1><h1 id=configure-storage>Configure Storage</h1><p>These are the types of storage available for your Eucalyptus cloud. Object storage Eucalyptus provides an AWS S3 compatible object storage service that provides users with web-based general purpose storage, designed to be scalable, reliable and inexpensive. You choose the object storage backend provider: Walrus or Ceph RGW. The Object Storage Gateway (OSG) provides access to objects via the backend provider you choose.</p><p>Block storage Eucalyptus provides an AWS EBS compatible block storage service that provides block storage for EC2 instances. Volumes can be created as needed and dynamically attached and detached to instances as required. EBS provides persistent data storage for instances: the volume, and the data on it, can exist beyond the lifetime of an instance. You choose the block storage backend provider for a deployment.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-a6a6c7da8c6d5461dad3100d9ba3e31c>1.4.7.4.1 - Configure Block Storage</h1><h1 id=configure-block-storage>Configure Block Storage</h1><p>This topic describes how to configure block storage on the Storage Controller (SC) for the backend of your choice.</p><p>The Storage Controller (SC) provides functionality similar to the Amazon Elastic Block Store (Amazon EBS). The SC can interface with various storage systems. Eucalyptus block storage (EBS) exports storage volumes that can be attached to a VM and mounted or accessed as a raw block device. EBS volumes can persist past VM termination and are commonly used to store persistent data.</p><p>Eucalyptus provides the following open source (free) backend providers for the SC:</p><ul><li>Overlay, using the local file system</li><li>DAS-JBOD (just a bunch of disks)</li><li>Ceph</li></ul><p>You must configure the SC to use one of the backend provider options.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-aa18b8d819fd6a67cb70f4fa0d18328b>1.4.7.4.1.1 - Use Ceph-RBD</h1><h1 id=use-ceph-rbd>Use Ceph-RBD</h1><p>This topic describes how to configure Ceph-RBD as the block storage backend provider for the Storage Controller (SC).<strong>Prerequisites</strong></p><ul><li><p>Successful completion of all the install sections prior to this section.</p></li><li><p>The SC must be installed, registered, and running.</p></li><li><p>You must execute the steps below as a administrator.</p></li><li><p>You must have a functioning Ceph cluster.</p></li><li><p>Ceph user credentials with the following privileges are available to SCs and NCs (different user credentials can be used for the SCs and NCs).</p></li><li><p>Hypervisor support for Ceph-RBD on NCs. Node Controllers (NCs) are designed to communicate with the Ceph cluster via libvirt. This interaction requires a hypervisor that supports Ceph-RBD. See to satisfy this prerequisite.
<strong>To configure Ceph-RBD block storage for the zone, run the following commands on the CLC</strong> Configure the SC to use Ceph-RBD for EBS.</p><p>euctl ZONE.storage.blockstoragemanager=ceph-rbd</p></li></ul><p>The output of the command should be similar to:</p><pre><code>one.storage.blockstoragemanager=ceph-rbd
</code></pre><p>Verify that the property value is now <code>ceph-rbd</code> :</p><pre><code>euctl ZONE.storage.blockstoragemanager
</code></pre><p>Check the SC to be sure that it has transitioned out of the <code>BROKEN</code> state and is in the <code>NOTREADY</code> , <code>DISABLED</code> or <code>ENABLED</code> state before configuring the rest of the properties for the SC. The ceph-rbd provider will assume defaults for the following properties for the SC:</p><pre><code>euctl ZONE.storage.ceph
 
PROPERTY        one.storage.cephconfigfile  /etc/ceph/ceph.conf
DESCRIPTION     one.storage.cephconfigfile  Absolute path to Ceph configuration (ceph.conf) file. Default value is '/etc/ceph/ceph.conf'
 
PROPERTY        one.storage.cephkeyringfile /etc/ceph/ceph.client.eucalyptus.keyring
DESCRIPTION     one.storage.cephkeyringfile Absolute path to Ceph keyring (ceph.client.eucalyptus.keyring) file. Default value is '/etc/ceph/ceph.client.eucalyptus.keyring'
 
PROPERTY        one.storage.cephsnapshotpools       rbd
DESCRIPTION     one.storage.cephsnapshotpools       Ceph storage pool(s) made available to  for EBS snapshots. Use a comma separated list for configuring multiple pools. Default value is 'rbd'
 
PROPERTY        one.storage.cephuser        eucalyptus
DESCRIPTION     one.storage.cephuser        Ceph username employed by  operations. Default value is 'eucalyptus'
 
PROPERTY        one.storage.cephvolumepools rbd
DESCRIPTION     one.storage.cephvolumepools Ceph storage pool(s) made available to  for EBS volumes. Use a comma separated list for configuring multiple pools. Default value is 'rbd'
</code></pre><p>The following steps are optional if the default values do not work for your cloud: To set the Ceph username (the default value for Eucalyptus is &rsquo;eucalyptus&rsquo;):</p><pre><code>euctl ZONE.storage.cephuser=myuser
</code></pre><p>To set the absolute path to keyring file containing the key for the &rsquo;eucalyptus&rsquo; user (the default value is &lsquo;/etc/ceph/ceph.client.eucalyptus.keyring&rsquo;):</p><pre><code>euctl ZONE.storage.cephkeyringfile='/etc/ceph/ceph.client.myuser.keyring'
</code></pre><p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If cephuser was modified, ensure that cephkeyringfile is also updated with the location to the keyring for the specific cephuser:</div>To set the absolute path to ceph.conf file (default value is &lsquo;/etc/ceph/ceph.conf&rsquo;):</p><pre><code>euctl ZONE.storage.cephconfigfile=/path/to/ceph.conf
</code></pre><p>To change the comma-delimited list of Ceph pools assigned to Eucalyptus for managing EBS volumes (default value is &lsquo;rbd&rsquo;) :</p><pre><code>euctl ZONE.storage.cephvolumepools=rbd,myvolumes
</code></pre><p>To change the comma-delimited list of Ceph pools assigned to Eucalyptus for managing EBS snapshots (default value is &lsquo;rbd&rsquo;) :</p><pre><code>euctl ZONE.storage.cephsnapshotpools=mysnapshots
</code></pre><p>If you want to enable snapshot deltas for your Ceph backend:<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Snapshot deltas are supported only on Ceph-RBD.</div></p><p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4></div>Verify that snapshots are enabled:</p><pre><code>euctl ZONE.storage.shouldtransfersnapshots=true
</code></pre><p>Set the maximum number of deltas to be created before creating a new full snapshot:</p><pre><code>euctl ZONE.storage.maxsnapshotdeltas=NON_ZERO_INTEGER
</code></pre><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>This variable applies to all Ceph volumes.</div><p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If you need to create a non-Ceph volume from a Ceph snapshot, this value would need to be set to zero (at least temporarily).</div>Every NC will assume the following defaults:</p><pre><code>CEPH_USER_NAME=&quot;eucalyptus&quot;
CEPH_KEYRING_PATH=&quot;/etc/ceph/ceph.client.eucalyptus.keyring&quot;
CEPH_CONFIG_PATH=&quot;/etc/ceph/ceph.conf&quot;
</code></pre><p>To override the above defaults, add/edit the following properties in the <code>/etc/eucalyptus/eucalyptus.conf</code> on the specific NC file:</p><pre><code>CEPH_USER_NAME=&quot;ceph-username-for-use-by-this-NC&quot;
CEPH_KEYRING_PATH=&quot;path-to-keyring-file-for-ceph-username&quot;
CEPH_CONFIG_PATH=&quot;path-to-ceph.conf-file&quot;
</code></pre><p>Repeat this step for every NC in the specific Eucalyptus zone. Your Ceph backend is now ready to use with Eucalyptus .</p></div><div class=td-content style=page-break-before:always><h1 id=pg-30efcc5250832311a0363dcab5fce14e>1.4.7.4.1.1.1 - Configure Hypervisor Support for Ceph-RBD</h1><p>This topic describes how to configure the hypervisor for Ceph-RBD support.The following instructions will walk you through steps for verifying and or installing the required hypervisor for Ceph-RBD support. <strong>Repeat this process for every NC in the Eucalyptus zone</strong></p><p>Verify if <code>qemu-kvm</code> and <code>qemu-img</code> are already installed.</p><pre><code>rpm -q qemu-kvm qemu-img
</code></pre><p>Proceed to the preparing the RHEV qemu packages step if they are not installed.</p><p>Verify qemu support for the <code>ceph-rbd</code> driver.</p><pre><code>qemu-img --help
qemu-img version 0.12.1, Copyright (c) 2004-2008 Fabrice Bellard
...
Supported formats: raw cow qcow vdi vmdk cloop dmg bochs vpc vvfat qcow2 qed vhdx parallels nbd blkdebug host_cdrom 
host_floppy host_device file gluster gluster gluster gluster rbd
</code></pre><p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If &lsquo;rbd&rsquo; is listed as one of the supported formats, no further action is required; otherwise proceed to the next step.</div>If the <code>eucalyptus-node</code> service is running, terminate/stop all instances. After all instances are terminated, stop the eucalyptus-node service.</p><pre><code>systemctl stop eucalyptus-node.service
</code></pre><p>Prepare the RHEV qemu packages:</p><ul><li><p>If this NC is a RHEL system and the RHEV subscription to qemu packages is available, consult the RHEV package procedure to install the qemu-kvm-ev and qemu-img-ev packages. Blacklist the RHEV packages in the repository to ensure that packages from the RHEV repository are installed.</p></li><li><p>If this NC is a RHEL system and RHEV subscription to qemu packages is unavailable, built and maintained qemu-rhev packages may be used. These packages are available in the same yum repository as other packages. Note that using built RHEV packages voids the original RHEL support for the qemu packages.</p></li><li><p>If this NC is a non-RHEL (CentOS) system, -built and maintained qemu-rhev packages may be used. These packages are available in the same yum repository as other packages.
If you are <em>not</em> using the RHEV package procedure to install the <code>qemu-kvm-ev</code> and <code>qemu-img-ev</code> packages, install Eucalyptus -built RHEV packages: <code>qemu-kvm-ev</code> and <code>qemu-img-ev</code> , which can be found in the same yum repository as other Eucalyptus packages.</p><p>yum install qemu-kvm-ev qemu-img-ev</p></li></ul><p>Start the <code>libvirtd</code> service.</p><pre><code>systemctl start libvirtd.service
</code></pre><p>Verify <code>qemu</code> support for the <code>ceph-rbd</code> driver.</p><pre><code>qemu-img --help
qemu-img version 0.12.1, Copyright (c) 2004-2008 Fabrice Bellard
...
Supported formats: raw cow qcow vdi vmdk cloop dmg bochs vpc vvfat qcow2 qed vhdx parallels nbd blkdebug host_cdrom 
host_floppy host_device file gluster gluster gluster gluster rbd
</code></pre><p>Make sure the eucalyptus-node service is started.</p><pre><code>systemctl start eucalyptus-node.service
</code></pre><p>Your hypervisor is ready for Eucalyptus Ceph-RBD support. You are now ready to <a href=https://www.eucastack.io/docs/install_guide/eucalyptus/configure_runtime/config_storage/config_block_storage/config_storage_ceph_rbd/>configure Ceph-RBD</a> for Eucalyptus .</p></div><div class=td-content style=page-break-before:always><h1 id=pg-3545c566a3fc5b961cdc7b265f1876ce>1.4.7.4.1.2 - About the BROKEN State</h1><p>This topic describes the initial state of the Storage Controller (SC) after you have registered it with the Cloud Controller (CLC).The SC automatically goes to the <code>broken</code> state after being registered with the CLC; it will remain in that state until you explicitly configure the SC by telling it which backend storage provider to use.</p><p>You can check the state of a storage controller by running <code>euserv-describe-services --expert</code> and note the state and status message of the SC(s). The output for an unconfigured SC looks something like this:</p><pre><code>SERVICE	storage        	ZONE1        	SC71           	BROKEN    	37  	http://192.168.51.71:8773/services/Storage	arn:euca:eucalyptus:ZONE1:storage:SC71/
SERVICEEVENT	6c1f7a0a-21c9-496c-bb79-23ddd5749222	arn:euca:eucalyptus:ZONE1:storage:SC71/
SERVICEEVENT	6c1f7a0a-21c9-496c-bb79-23ddd5749222	ERROR
SERVICEEVENT	6c1f7a0a-21c9-496c-bb79-23ddd5749222	Sun Nov 18 22:11:13 PST 2012
SERVICEEVENT	6c1f7a0a-21c9-496c-bb79-23ddd5749222	SC blockstorageamanger not configured. Found empty or unset manager(unset). Legal values are: das,overlay,ceph
</code></pre><p>Note the error above: <code>SC blockstoragemanager not configured. Found empty or unset manager(unset). Legal values are: das,overlay,ceph</code> .</p><p>This indicates that the SC is not yet configured. It can be configured by setting the <code>ZONE.storage.blockstoragemanager</code> property to &lsquo;das&rsquo;, &lsquo;overlay&rsquo;, or &lsquo;ceph&rsquo;.</p><p>You can verify that the configured SC block storage manager using:</p><pre><code>euctl ZONE.storage.blockstoragemanager
</code></pre><p>to show the current value.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-07723a85c687e2a440a2f0f6cefdfba9>1.4.7.4.1.3 - Use Direct Attached Storage (JBOD)</h1><p>This topic describes how to configure the DAS-JBOD as the block storage backend provider for the Storage Controller (SC).<strong>Prerequisites</strong></p><ul><li><p>Successful completion of all the install sections prior to this section.</p></li><li><p>The SC must be installed, registered, and running.</p></li><li><p>Direct Attached Storage requires that have enough space for locally cached snapshots.</p></li><li><p>You must execute the steps below as a administrator.
<strong>To configure DAS-JBOD block storage for the zone, run the following commands on the CLC</strong> Configure the SC to use the Direct Attached Storage for EBS.</p><p>euctl ZONE.storage.blockstoragemanager=das</p></li></ul><p>The output of the command should be similar to:</p><pre><code>one.storage.blockstoragemanager=das
</code></pre><p>Verify that the property value is now: &lsquo;das&rsquo;</p><pre><code>euctl ZONE.storage.blockstoragemanager
</code></pre><p>Set the DAS device name property. The device name can be either a raw device (/dev/sdX, for example), or the name of an existing Linux LVM volume group.</p><pre><code>euctl ZONE.storage.dasdevice=DEVICE_NAME
</code></pre><p>For example:</p><pre><code>euctl one.storage.dasdevice=/dev/sdb
</code></pre><p>Your DAS-JBOD backend is now ready to use with Eucalyptus .</p></div><div class=td-content style=page-break-before:always><h1 id=pg-8aef961027c14d30b9d6272cd4fd35d4>1.4.7.4.1.4 - Use the Overlay Local Filesystem</h1><p>This topic describes how to configure the local filesystem as the block storage backend provider for the Storage Controller (SC).<strong>Prerequisites</strong></p><ul><li>Successful completion of all the install sections prior to this section.</li><li>The SC must be installed, registered, and running.</li><li>The local filesystem must have enough space to hold volumes and snapshots created in the cloud.</li><li>You must execute the steps below as a administrator.
In this configuration the SC itself hosts the volume and snapshots for EBS and stores them as files on the local filesystem. It uses standard Linux iSCSI tools to serve the volumes to instances running on NCs.</li></ul><p><strong>To configure overlay block storage for the zone, run the following commands on the CLC</strong> Configure the SC to use the local filesystem for EBS.</p><pre><code>euctl ZONE.storage.blockstoragemanager=overlay 
</code></pre><p>The output of the command should be similar to:</p><pre><code>one.storage.blockstoragemanager=overlay
</code></pre><p>Verify that the property value is now: &lsquo;overlay&rsquo;</p><pre><code>euctl ZONE.storage.blockstoragemanager
</code></pre><p>Your local filesystem (overlay) backend is now ready to use with Eucalyptus .</p></div><div class=td-content style=page-break-before:always><h1 id=pg-25aafdcb9e624a1e783a00453ac2ce31>1.4.7.4.2 - Configure Object Storage</h1><p>This topic describes how to configure object storage on the Object Storage Gateway (OSG) for the backend of your choice. The OSG passes requests to object storage providers and talks to the persistence layer (DB) to authenticate requests. You can use Walrus, MinIO, or Ceph-RGW as the object storage provider.</p><ul><li><p><strong>Walrus</strong> - the default backend provider. It is a single-host Eucalyptus -integrated provider which provides basic object storage functionality for the small scale. Walrus is intended for light S3 usage.</p></li><li><p><strong>MinIO</strong> - a high performing scalable object storage provider. MinIO implements the S3 API which is used by the OSG, not directly by end users. Distributed MinIO provides protection against multiple node/drive failures and bit rot using erasure code.</p></li><li><p><strong>Ceph-RGW</strong> - an object storage interface built on top of Librados to provide applications with a RESTful gateway to Ceph Storage Clusters. Ceph-RGW uses the Ceph Object Gateway daemon (radosgw), which is a FastCGI module for interacting with a Ceph Storage Cluster. Since it provides interfaces compatible with OpenStack Swift and Amazon S3, the Ceph Object Gateway has its own user management. Ceph Object Gateway can store data in the same Ceph Storage Cluster used to store data from Ceph Filesystem clients or Ceph Block Device clients. The S3 and Swift APIs share a common namespace, so you may write data with one API and retrieve it with the other.</p></li></ul><p>You must configure the OSG to use one of the backend provider options.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If OSG has been registered but not yet properly configured, it will be listed in the state when listed with the euserv-describe-services command.</div><p>Example showing unconfigured <em>objectstorage</em>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># euserv-describe-services --show-headers --filter service-type=objectstorage</span>
</span></span><span style=display:flex><span>SERVICE  TYPE              	ZONE    	NAME                   	  STATE	
</span></span><span style=display:flex><span>SERVICE  objectstorage      user-api-1  user-api-1.objectstorage  broken
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-06a4664ccf8870894a6bb96a526ff06f>1.4.7.4.2.1 - Use Ceph-RGW</h1><p>This topic describes how to configure Ceph Rados Gateway (RGW) as the backend for the Object Storage Gateway (OSG).</p><h2 id=prerequisites>Prerequisites</h2><ul><li>Successful completion of all the install sections prior to this section.</li><li>The UFS must be registered and enabled.</li><li>A Ceph storage cluster is available.</li><li>The ceph-radosgw service has been installed (on the UFS or any other host) and configured to use the Ceph storage cluster. recommends using civetweb with ceph-radosgw service. is a lightweight web server and is included in the ceph-radosgw installation. It is relatively easier to install and configure than the alternative option – a combination of Apache and Fastcgi modules.</li></ul><p>For more information on Ceph-RGW, see the <a href=http://docs.ceph.com/docs/master/radosgw/>Ceph-RGW documentation</a>.</p><h2 id=configure-ceph-rgw-object-storage>Configure Ceph-RGW object storage</h2><p>You must execute the steps below as a administrator.</p><p>Configure <strong>ceph-rgw</strong> as the storage provider using the <em>euctl</em> command:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>euctl objectstorage.providerclient<span style=color:#ce5c00;font-weight:700>=</span>ceph-rgw
</span></span></code></pre></div><p>Configure <em>objectstorage.s3provider.s3endpoint</em> to the <strong>ip:port</strong> of the host running the ceph-radosgw service:</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Depending on the front end web server used by ceph-radosgw service, the default port is 80 for apache and 7480 for civetweb.</div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>euctl objectstorage.s3provider.s3endpoint<span style=color:#ce5c00;font-weight:700>=</span>&lt;radosgw-host-ip&gt;:&lt;radosgw-webserver-port&gt;
</span></span></code></pre></div><p>Configure <em>objectstorage.s3provider.s3accesskey</em> and <em>objectstorage.s3provider.s3secretkey</em> with the radosgw user credentials:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>euctl objectstorage.s3provider.s3accesskey<span style=color:#ce5c00;font-weight:700>=</span>&lt;radosgw-user-accesskey&gt;
</span></span><span style=display:flex><span>euctl objectstorage.s3provider.s3secretkey<span style=color:#ce5c00;font-weight:700>=</span>&lt;radosgw-user-secretkey&gt;
</span></span></code></pre></div><p>The Ceph-RGW backend and OSG are now ready for production.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-84f727ca46a827f083dac6dafc1dba25>1.4.7.4.2.2 - Use MinIO Backend</h1><p>This topic describes how to configure MinIO as the object storage backend provider for the Object Storage Gateway (OSG).</p><h2 id=prerequisites>Prerequisites</h2><ul><li>The UFS must be registered and enabled.</li><li>Install and start MinIO</li></ul><p>For more information on MinIO installation and configuration see the <a href=https://docs.min.io/>MinIO Server Documentation</a></p><h2 id=to-configure-minio-object-storage>To configure MinIO object storage</h2><p>You must execute the steps below as a administrator.</p><p>Configure <strong>minio</strong> as the storage provider using the <em>euctl</em> command:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>euctl objectstorage.providerclient<span style=color:#ce5c00;font-weight:700>=</span>minio
</span></span></code></pre></div><p>Configure <em>objectstorage.s3provider.s3endpoint</em> to the <strong>ip:port</strong> of a host running the minio server:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>euctl objectstorage.s3provider.s3endpoint<span style=color:#ce5c00;font-weight:700>=</span>&lt;minio-host-ip&gt;:&lt;minio-port&gt;
</span></span></code></pre></div><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>The default port for MinIO is 9000</div><p>Configure <em>objectstorage.s3provider.s3accesskey</em> and <em>objectstorage.s3provider.s3secretkey</em> with credentials for minio:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>euctl objectstorage.s3provider.s3accesskey<span style=color:#ce5c00;font-weight:700>=</span>&lt;minio-accesskey&gt;
</span></span><span style=display:flex><span>euctl objectstorage.s3provider.s3secretkey<span style=color:#ce5c00;font-weight:700>=</span>&lt;minio-secretkey&gt;
</span></span></code></pre></div><p>Configure the expected response code for minio:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>euctl objectstorage.s3provider.s3endpointheadresponse<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>400</span>
</span></span></code></pre></div><p>The MinIO backend and OSG are now ready for production.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-bfe6a73803221ee955acb39011736fbe>1.4.7.4.2.3 - Use Walrus Backend</h1><p>This topic describes how to configure Walrus as the object storage backend provider for the Object Storage Gateway (OSG).</p><h2 id=prerequisites>Prerequisites</h2><ul><li>Successful completion of all the install sections prior to this section.</li><li>The UFS must be registered and enabled.</li></ul><h2 id=to-configure-walrus-object-storage>To configure Walrus object storage</h2><p>You must execute the steps below as a administrator.</p><p>Configure <strong>walrus</strong> as the storage provider using the <em>euctl</em> command.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>euctl objectstorage.providerclient<span style=color:#ce5c00;font-weight:700>=</span>walrus
</span></span></code></pre></div><p>Check that the OSG is enabled.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>euserv-describe-services
</span></span></code></pre></div><p>If the state appears as <strong>disabled</strong> or <strong>broken</strong> , check the cloud-*.log files in the <em>/var/log/eucalyptus</em> directory. A <strong>disabled</strong> state generally indicates that there is a problem with your network or credentials. See <a href=https://www.eucastack.io/docs/admin_guide/ops_oview/ops_ts/ts_logs/>Log File Location and Content</a> for more information.</p><p>The Walrus backend and OSG are now ready for production.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-88c36c1a825c683df6b9c36b64b2ad63>1.4.7.5 - Install and Configure the Imaging Service</h1><p>The Eucalyptus Imaging Service, introduced in Eucalyptus 4.0, makes it easier to deploy EBS images in your Eucalyptus cloud and automates many of the labor-intensive processes required for uploading data into EBS images.</p><p>The Eucalyptus Imaging Service is implemented as a system-controlled &ldquo;worker&rdquo; virtual machine that is monitored and controlled via Auto Scaling. Once the Imaging Service is configured, the Imaging Service VM will be started automatically upon the first request that requires it: such as an EBS volume ingress. Specifically, in this release of Eucalyptus , these are the usage scenarios for the Eucalyptus Imaging Service:</p><ul><li><strong>Importing a raw disk image as a volume:</strong> If you have a raw disk image (containing either a data partition or a full operating system with a boot record, e.g., an HVM image), you can use the Imaging Service to import this into your cloud as a volume. This is accomplished with the <code>euca-import-volume</code> command. If the volume was populated with a bootable disk, that volume can be snapshotted and registered as an image.</li><li><strong>Importing a raw disk image as an instance:</strong> If you have a raw disk image containing a bootable operating system, you can import this disk image into as an instance: the Imaging Service automatically creates a volume, registers the image, and launches an instance from the image. This is accomplished with the <code>euca-import-instance</code> command, which has options for specifying the instance type and the SSH key for the instance to use.</li></ul><h2 id=install-and-register-the-imaging-worker-image>Install and Register the Imaging Worker Image</h2><p>Eucalyptus provides a command-line tool for installing and registering the Imaging Worker image. Once you have run the tool, the Imaging Worker will be ready to use.Run the following commands on the machine where you installed the <code>eucalyptus-service-image</code> RPM package (it will set the <code>imaging.imaging_worker_emi</code> property to the newly created EMI of the imaging worker):</p><pre><code>esi-install-image --region localhost --install-default
</code></pre><p>Consider setting the <code>imaging.imaging_worker_keyname</code> property to an SSH keyname (previously created with the <code>euca-create-keypair</code> command), so that you can perform troubleshooting inside the Imaging Worker instance, if necessary:</p><pre><code>euctl services.imaging.worker.keyname=mykey
</code></pre><h2 id=managing-the-imaging-worker-instance>Managing the Imaging Worker Instance</h2><p>Eucalyptus automatically starts Imaging Worker instances when there are tasks for workers to perform.The cloud administrator can list the running Imaging Worker instances, if any, by running the command:</p><pre><code>euca-describe-instances --filter tag-value=euca-internal-imaging-workers
</code></pre><p>To delete / stop the imaging worker:</p><pre><code>esi-manage-stack -a delete imaging
</code></pre><p>To create / start the imaging worker:</p><pre><code>esi-manage-stack -a create imaging
</code></pre><p>Consider setting the <code>imaging.imaging_worker_instance_type</code> property to an Instance Type with enough ephemeral disk to convert any of your paravirtual images. The Imaging Worker root filesystem takes up about 2GB, so the maximum paravirtual image that the Imaging Worker will be able to convert is the disk allocation of the Instance Type minus 2GBs.</p><pre><code>euctl services.imaging.worker.instance_type=m3.xlarge
</code></pre><h2 id=troubleshooting-imaging-worker>Troubleshooting Imaging Worker</h2><p>If the Imaging Worker is configured correctly, users will be able to import data into EBS volumes with <code>euca-import-*</code> commands, and paravirtual EMIs will run as instances. In some cases, though, paravirtual images may fail to convert (e.g., due to intermittent network failures or a network setup that doesn&rsquo;t allow the Imaging Worker to communicate with the CLC), leaving the images in a special state. To troubleshoot:If the Imaging Worker Instance Type does not provide sufficient disk space for converting all paravirtual images, the administrator may have to change the Instance Type used by the Imaging Worker. After changing the instance type, the Imaging Worker instance should be restarted by terminating the old Imaging Worker instance:</p><pre><code>euctl services.imaging.worker.instance_type=m2.2xlarge
euca-terminate-instances $(euca-describe-instances --filter tag-value=euca-internal-imaging-workers | grep INSTANCE | cut -f 2)
</code></pre><p>If the status of the conversion operation is &lsquo;Image conversion failed&rsquo;, but the image is marked as &lsquo;available&rsquo; (in the output of euca-describe-images), the conversion can be retried by running the EMI again:</p><pre><code>euca-run-instances ...
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-ebb91e7b9d56062f2a00522894fe0965>1.4.7.6 - Configure the Load Balancer</h1><h2 id=install-and-register-the-load-balancer-image>Install and Register the Load Balancer Image</h2><p>Eucalyptus provides a tool for installing and registering the Load Balancer image. Once you have run the tool, your Load Balancer will be ready to use.</p><p>Run the following commands on the machine where you installed the <code>eucalyptus-service-image</code> RPM package (it will set the <code>imaging.imaging_worker_emi</code> property to the newly created EMI of the imaging worker):</p><pre><code>esi-install-image --install-default
</code></pre><h2 id=verify-load-balancer-configuration>Verify Load Balancer Configuration</h2><p>If you would like to verify that Load Balancer support is enabled you can list installed Load Balancers. The currently active Load Balancer will be listed as enabled. If no Load Balancers are listed, or none are marked as enabled, then your Load Balancer support has not been configured properly.Run the following command to list installed Load Balancer images:</p><pre><code>esi-describe-images
</code></pre><p>This will produce output similar to the followin:</p><pre><code>SERVICE     VERSION  ACTIVE     IMAGE      INSTANCES
    imaging       2.2      *     emi-573925e5      0
 loadbalancing    2.2      *     emi-573925e5      0
    database      2.2      *     emi-573925e5      0
</code></pre><p>You can also check the enabled Load Balancer EMI with:</p><pre><code>euctl services.loadbalancing.worker.image
</code></pre><p>If you need to manually set the enabled Load Balancer EMI use:</p><pre><code>euctl services.loadbalancing.worker.image=emi-12345678
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-d2c8e2a6f2f469cba2014a65b5ab8768>1.4.7.7 - Configure Node Controller</h1><p>On some Linux installations, a sufficiently large amount of local disk activity can slow down process scheduling. This can cause other operations (e.g., network communication and instance provisioning) appear to stall. Examples of disk-intensive operations include preparing disk images for launch and creating ephemeral storage.</p><ol><li>Log in to an NC server and open the <em>/etc/eucalyptus/eucalyptus.conf</em> file.</li><li>Change the <code>CONCURRENT_DISK_OPS</code> parameter to the number of disk-intensive operations you want the NC to perform at once.<ol><li>Set <code>CONCURRENT_DISK_OPS</code> to 1 to serialize all disk-intensive operations. Or &mldr;</li><li>Set it to a higher number to increase the amount of disk-intensive operations the NC will perform in parallel.</li></ol></li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-18cc942116b7be0a5dd971348caeb9f8>1.5 - Client Installation</h1><p>The AWS CLI and Euca2ools are two command line interfaces that work well with Eucalyptus. See the relevant section for instructions to install each client.</p></div><div class=td-content><h1 id=pg-8cea5def468485a152ffc86adafe42ca>1.5.1 - AWS CLI Installation</h1><p>The AWS CLI is the official client for AWS. The CentOS and RHEL 7 official repositories provide a packaged AWS CLI version 1 that works well with Eucalyptus.</p><p>To allow easy use of the AWS CLI with Eucalyptus a plug-in is provided that understands how to access Eucalyptus services.</p><h2 id=install>Install</h2><p>To install the Eucalyptus plug-in a Eucalyptus YUM repository must first be enabled, either the release repository:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>yum install https://downloads.eucalyptus.cloud/software/eucalyptus/5/rhel/7/x86_64/eucalyptus-release-5-1.11.as.el7.noarch.rpm
</span></span></code></pre></div><p>or the master repository for the latest nightly build:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>yum install https://downloads.eucalyptus.cloud/software/eucalyptus/master/rhel/7/x86_64/eucalyptus-release-5-1.15.as.el7.noarch.rpm
</span></span></code></pre></div><p>Once a repository is configured, install the plugin and client:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>yum install eucalyptus-awscli-plugin
</span></span></code></pre></div><p>Which will install the plug-in and version 1 of the AWS CLI.</p><h2 id=configuration>Configuration</h2><p>AWS provides general instructions on <a href=https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.html>Configuring the AWS CLI</a> which includes configuration for credentials. This section covers Eucalyptus plugin specific configuration.</p><p>An example configuration for the AWS CLI is:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># cat .aws/config </span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span>plugins<span style=color:#ce5c00;font-weight:700>]</span>
</span></span><span style=display:flex><span><span style=color:#000>eucalyptus</span> <span style=color:#ce5c00;font-weight:700>=</span> awscli_plugin_eucalyptus
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span>default<span style=color:#ce5c00;font-weight:700>]</span>
</span></span><span style=display:flex><span><span style=color:#000>ufshost</span> <span style=color:#ce5c00;font-weight:700>=</span> mycloud.example.com
</span></span><span style=display:flex><span><span style=color:#000>ufsport</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>8773</span>
</span></span><span style=display:flex><span><span style=color:#000>verify_ssl</span> <span style=color:#ce5c00;font-weight:700>=</span> yes
</span></span><span style=display:flex><span><span style=color:#000>output</span> <span style=color:#ce5c00;font-weight:700>=</span> text
</span></span><span style=display:flex><span><span style=color:#000>region</span> <span style=color:#ce5c00;font-weight:700>=</span> eucalyptus
</span></span></code></pre></div><p>The configuration enables the plugin and sets the <em>ufshost</em> and <em>ufsport</em> to enable Eucalyptus service endpoints to be derived.</p><p>If your cloud does not have a valid HTTPS certificate then you will need to change <em>verify_ssl</em> to <code>no</code>, but note that this is less secure.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-a6359d685c4cda87190983e9d9228cb1>1.5.2 - Euca2ools Standalone Installation</h1><p>Euca2ools is the Eucalyptus command line interface for interacting with Eucalyptus. This topic discusses how to perform a standalone installation of Euca2ools. If you&rsquo;re running recent versions of Fedora, Debian, or Ubuntu, you can install Euca2ools using <em>yum</em> or <em>apt</em>.</p><p>If you&rsquo;re running RHEL/CentOS, you can use the following instructions to install Euca2ools.</p><p>To perform a standalone installation of Euca2ools on RHEL/CentOS:</p><p>Configure the EPEL package repository:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>yum install epel-release
</span></span></code></pre></div><p>Configure the Euca2ools package repository:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>yum install http://downloads.eucalyptus.cloud/software/euca2ools/3.4/rhel/7/x86_64/euca2ools-release-3.4-2.2.as.el7.noarch.rpm
</span></span></code></pre></div><p>Install Euca2ools:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>yum install euca2ools
</span></span></code></pre></div><p>You&rsquo;ve now performed a standalone installation of Euca2ools.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-8515c0c3c3e0fe7882713abf9dd756c5>1.6 - Find More Information</h1><p>This topic explains what to do once you have installed Eucalyptus, including further reading and other resources for understanding your cloud.</p><h2 id=read-more>Read More</h2><p>Eucalyptus has the following guides to help you with more information:</p><ul><li>The <a href=https://www.eucastack.io/docs/admin_guide/>Administration Guide</a> details ways to manage your Eucalyptus deployment. Refer to this guide to learn more about managing your Eucalyptus services, like the Cloud Controller; and resources, like instances and images.</li><li>The <a href=https://www.eucastack.io/docs/iam_guide/>Identity and Access Management (IAM) Guide</a> provides information to help you securely control access to services and resources for your Eucalyptus cloud users. Refer to this guide to learn more about managing identities, authentication and access control best practices, and specifically managing your users and groups.</li><li>The <a href=https://www.eucastack.io/docs/user_guide/>User Guide</a> details ways to use Eucalyptus for your computing and storage needs. Refer to this guide to learn more about getting and using euca2ools, creating images, running instances, and using dynamic block storage devices.</li><li>The <a href=https://www.eucastack.io/docs/image_guide/>Image Management Guide</a> describes how to create and manage images for your cloud.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-19f5e2511913cedf804f463954f59f69>2 - Administration Guide</h1><h1 id=administration-guide>Administration Guide</h1><p>This section contains concepts and tasks to help you manage your Eucalyptus cloud.</p></div><div class=td-content><h1 id=pg-074ed240259ce2673819b6d36b698b33>2.1 - Management Overview</h1><h1 id=management-overview>Management Overview</h1><p>The section shows you how to access Eucalyptus with a web-based console and with command line tools. This section also describes how to perform common management tasks. This document is intended to be a reference. You do not need to read it in order, unless you are following the directions for a particular task.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-08cc7e8e4f67103184d84c0c0eae071f>2.1.1 - Overview of Eucalyptus</h1><p>Eucalyptus is a Linux-based software architecture that implements scalable, efficiency-enhancing private and hybrid clouds within an enterprise’s existing IT infrastructure. Because Eucalyptus provides Infrastructure as a Service (IaaS), you can provision your own resources (hardware, storage, and network) through Eucalyptus on an as-needed basis.</p><p>A Eucalyptus cloud is deployed across your enterprise&rsquo;s on-premise data center. As a result, your organization has a full control of the cloud infrastructure. You can implement and enforce various level of security. Sensitive data managed by the cloud does not have to leave your enterprise boundaries, keeping data completely protected from external access by your enterprise firewall.</p><p>Eucalyptus was designed from the ground up to be easy to install and non-intrusive. The software framework is modular, with industry-standard, language-agnostic communication. Eucalyptus is also unique in that it provides a virtual network overlay that isolates network traffic of different users as well as allows two or more clusters to appear to belong to the same Local Area Network (LAN).</p><p>Eucalyptus also is compatible with Amazon’s EC2, S3, and IAM services. This offers you hybrid cloud capability.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-27f8046ed1bbae7b0d4a03fc2af70fcd>2.1.2 - Command Line Interface</h1><p>Eucalyptus supports two command line interfaces (CLIs): the administration CLI and the user CLI.The administration CLI is installed when you install Eucalyptus server-side components. The administration CLI is for maintaining and modifying Eucalyptus.</p><p>The other user CLI, called Euca2ools, can be downloaded and installed on clients. Euca2ools is a set of commands for end users and can be used with both Eucalyptus and Amazon Web Services (AWS).</p></div><div class=td-content style=page-break-before:always><h1 id=pg-7c57425594226a312363f5d8cfd308cc>2.2 - Manage Your Cloud</h1><h1 id=manage-your-cloud>Manage Your Cloud</h1><p>After you install and initially configure Eucalyptus, there are some common administration tasks you can perform. This section describes these tasks and associated concepts.</p></div><div class=td-content><h1 id=pg-b3a46ec9125656b706d97df986bc7a8e>2.2.1 - Cloud Overview</h1><p>This topic presents an overview of the components in Eucalyptus. Eucalyptus is comprised of several components: Cloud Controller, Walrus, Cluster Controller, Storage Controller, and Node Controller. Each component is a stand-alone web service. This architecture allows Eucalyptus both to expose each web service as a well-defined, language-agnostic API, and to support existing web service standards for secure communication between its components.</p><h2 id=cloud-controller>Cloud Controller</h2><p>The Cloud Controller (CLC) is the entry-point into the cloud for administrators, developers, project managers, and end-users. The CLC queries other components for information about resources, makes high-level scheduling decisions, and makes requests to the Cluster Controllers (CCs). As the interface to the management platform, the CLC is responsible for exposing and managing the underlying virtualized resources (servers, network, and storage). You can access the CLC through command line tools that are compatible with Amazon’s Elastic Compute Cloud (EC2).</p><h2 id=walrus>Walrus</h2><p>Walrus allows users to store persistent data, organized as buckets and objects. You can use Walrus to create, delete, and list buckets, or to put, get, and delete objects, or to set access control policies. Walrus is interface compatible with Amazon’s Simple Storage Service (S3). It provides a mechanism for storing and accessing virtual machine images and user data. Walrus can be accessed by end-users, whether the user is running a client from outside the cloud or from a virtual machine instance running inside the cloud.</p><h2 id=cluster-controller>Cluster Controller</h2><p>The Cluster Controller (CC) generally executes on a machine that has network connectivity to both the machines running the Node Controller (NC) and to the machine running the CLC. CCs gather information about a set of NCs and schedules virtual machine (VM) execution on specific NCs. The CC also manages the virtual machine networks. All NCs associated with a single CC must be in the same subnet.</p><h2 id=storage-controller>Storage Controller</h2><p>The Storage Controller (SC) provides functionality similar to the Amazon Elastic Block Store (Amazon EBS). Elastic block storage exports storage volumes that can be attached by a VM and mounted or accessed as a raw block device. EBS volumes persist past VM termination and are commonly used to store persistent data. An EBS volume cannot be shared between VMs and can only be accessed within the same availability zone in which the VM is running. Users can create snapshots from EBS volumes. Snapshots may be stored in Walrus and made available across availability zones.</p><h2 id=node-controller>Node Controller</h2><p>The Node Controller (NC) executes on any machine that hosts VM instances. The NC controls VM activities, including the execution, inspection, and termination of VM instances. It also fetches and maintains a local cache of instance images, and it queries and controls the system software (host OS and the hypervisor) in response to queries and control requests from the CC. The NC is also responsible for the management of the virtual network endpoint.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-d73ed3e9be6276adf1279150e887ad16>2.2.2 - Cloud Best Practices</h1><h1 id=cloud-best-practices>Cloud Best Practices</h1><p>This section details Eucalyptus best practices for your private cloud.</p></div><div class=td-content><h1 id=pg-0c436b3bf6b70c20c0ce3404204c17f4>2.2.2.1 - Synchronize Clocks</h1><p>Eucalyptus checks message timestamps across components in the cloud infrastructure. This assures command integrity and provides better security.Eucalyptus components receive and exchange messages using either Query or SOAP interfaces (or both). Messages received over these interfaces are required to have some form of a time stamp (as defined by AWS specification) to prevent message replay attacks. Because Eucalyptus enforces strict policies when checking timestamps in the received messages, for the correct functioning of the cloud infrastructure, it is crucial to have clocks constantly synchronized (for example, with ntpd) on all machines hosting Eucalyptus components. To prevent user command failures, it is also important to have clocks synchronized on the client machines.</p><p>Following the AWS specification, all Query interface requests containing the Timestamp element are rejected as expired after 15 minutes of the timestamp. Requests containing the Expires element expire at the time specified by the element. SOAP interface requests using WS-Security expire as specified by the WS-Security Timestamp element.</p><p>When checking the timestamps for expiration, Eucalyptus allows up to 20 seconds of clock drift between the machines. This is a default setting. You can change this value for the CLC at runtime by setting the <code>bootstrap.webservices.clock_skew_sec</code> property as follows:</p><pre><code>euctl bootstrap.webservices.clock_skew_sec=&lt;new_value_in_seconds&gt;
</code></pre><p>For additional protection from the message replay attacks, the CLC implements a replay detection algorithm and rejects messages with the same signatures received within 15 minutes. Replay detection parameters can be tuned as described in <a href=https://www.eucastack.io/docs/admin_guide/security_section/security_tasks/security_task_replays/>Configure Replay Protection</a> .</p></div><div class=td-content style=page-break-before:always><h1 id=pg-cc2d80c5dff82bc6fab5e1644ee01aca>2.2.2.2 - Configure SSL</h1><p>In order to connect to Eucalyptus using SSL/TLS, you must have a valid certificate for the Cloud Controller (CLC)</p><p>If you have more than one host (other than node controllers), note the following:</p><ul><li>The keystore must be updated on each host running the eucalyptus-cloud service</li><li>The [key_alias] must be the same on each host</li><li>Use a wildcard certificate (i.e. *.&lt;system.dns.dnsdomain>), since UFS is responsible for all service API endpoints</li></ul><h2 id=create-a-keystore>Create a keystore</h2><p>Eucalyptus uses a PKCS12-format keystore. If you are using a certificate signed by a trusted root CA, use the following command to convert your trusted certificate and key into an appropriate format:</p><pre><code>openssl pkcs12 -export -in [YOURCERT.crt] -inkey [YOURKEY.key] \
  -out tmp.p12 -name [key_alias]
</code></pre><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>The above command will request an export password, which is used in the following steps.</div><p>Save a backup of the Eucalyptus keystore, at <em>/var/lib/eucalyptus/keys/euca.p12</em> , and then import your keystore into the Eucalyptus keystore as follows:</p><pre><code>keytool -importkeystore \
  -srckeystore tmp.p12 -srcstoretype pkcs12 -srcstorepass [export_password] \
  -destkeystore /var/lib/eucalyptus/keys/euca.p12 -deststoretype pkcs12 \
  -deststorepass eucalyptus -alias [key_alias] \
  -srckeypass [export_password]
</code></pre><h2 id=enable-the-cloud-controller-to-use-this-keystore>Enable the Cloud Controller to use this keystore</h2><p>Run the following commands on the Cloud Controller (CLC):</p><pre><code>euctl bootstrap.webservices.ssl.server_alias=[key_alias]
</code></pre><h2 id=optional-redirect-requests-to-use-port-443>Optional: Redirect Requests to use Port 443</h2><p>To allow user facing services requests on port 443 instead of the default 8773, run the following commands on the CLC:</p><pre><code>euctl bootstrap.webservices.port=443
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-f68cd1ff367b861eaae9def533f65647>2.2.2.3 - Storage Volumes</h1><p>Eucalyptus manages storage volumes for your private cloud. Volume management strategies are application specific, but this topic includes some general guidelines.When setting up your Storage Controller, consider whether performance (bandwidth and latency of read/write operations) or availability is more important for your application. For example, using several smaller volumes will allow snapshots to be taken on a rolling basis, decreasing each snapshot creation time and potentially making restore operations faster if the restore can be isolated to a single volume. However, a single larger volume allows for faster read/write operations from the VM to the storage volume.</p><p>An appropriate network configuration is an important part of optimizing the performance of your storage volumes. For best performance, each Node Controller should be connected to a distinct storage network that enables the NC to communicate with the SC or Ceph, without interfering with normal NC/VM-instance network traffic.</p><p>Eucalyptus includes configurable limits on the size of a single volume, as well as the aggregate size of all volumes on an SC. The SC can push snapshots from Ceph, where the volumes reside, to object storage, where the snapshots become available across multiple clusters. Smaller volumes will be much faster to snapshot and transfer, whereas large volumes will take longer. However, if many concurrent snapshot requests are sent to the SC, operations may take longer to complete.</p><p>EBS volumes are created from snapshots on the SC or Ceph, after the snapshot has been downloaded from object storage to the device. Creating an EBS volume from a snapshot on the same cluster as the source volume of the snapshot will reduce delays caused by having to transfer snapshots from object storage.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-6099fc0dd7ed56fbedde6ac653013f29>2.2.3 - Cloud Tasks</h1><h1 id=cloud-tasks>Cloud Tasks</h1><p>This section contains a listing of your Eucalyptus cloud-related tasks.</p></div><div class=td-content><h1 id=pg-25c5c10adb123e14983d2795cb6da1e4>2.2.3.1 - Inspect System Health</h1><p>Eucalyptus provides access to the current view of service state and the ability to manipulate the state. You can inspect the service state to either ensure system health or to identify faulty services. You can modify a service state to maintain activities and apply external service placement policies.</p><h2 id=view-service-state>View Service State</h2><p>Use the <code>euserv-describe-services</code> command to view the service state. The output indicates:</p><ul><li>Component type of the service</li><li>Partition in which the service is registered</li><li>Unique name of the service</li><li>Current view of service state</li><li>Last reported epoch (this can be safely ignored)</li><li>Service URI</li><li>Fully qualified name of the service (This is needed for manipulating services that did not get unique names during registration. For example: internal services like DNS)
The default output includes the services that are registered during configuration, as well as information about the DNS service, if present. You can obtain additional service state information, such as internal services, by providing the <code>-a</code> flag.</li></ul><p>You can also make requests to retrieve service information that is filtered by either:</p><ul><li>current state (for example, )</li><li>host where service is registered</li><li>partition where service is registered</li><li>type of service (for example, CC or Walrus)
When you investigate service failures, you can specify <code>-events</code> to return a summary of the last fault. You can retrieve extended information (primarily useful for debugging) by specifying <code>-events -events-verbose</code> .</li></ul><h2 id=heartbeat-service>Heartbeat Service</h2><p><code>http://CLCIPADDRESS:8773/services/Heartbeat</code> provides a list of components and their respective statuses. This allows you to find out if a service is enabled without requiring cloud credentials.</p><h2 id=modify-service-state>Modify Service State</h2><p>To modify a service:</p><p>Enter the following command on the CLC, Walrus, or SC machines:</p><pre><code>systemctl stop eucalyptus-cloud.service
</code></pre><p>On the CC, use the following command:</p><pre><code>systemctl stop eucalyptus-cluster.service
</code></pre><p>If you want to shut down the SC for maintenance. The SC is <code>SC00</code> is <code>ENABLED</code> and needs to be <code>DISABLED</code> for maintenance.</p><p>To stop <code>SC00</code> first verify that no volumes or snapshots are being created and that no volumes are being attached or detached, and then enter the following command on SC00:</p><pre><code>systemctl stop eucalyptus-cloud.service
</code></pre><p>To check status of services, you would enter:</p><pre><code>euserv-describe-services
</code></pre><p>When maintenance is complete, you can start the eucalyptus-cloud process on <code>SC00</code> , which will enter the <code>DISABLED</code> state by default.</p><pre><code>systemctl start eucalyptus-cloud.service
</code></pre><p>Monitor the state of services using <code>euserv-describe-services</code> until <code>SC00</code> is <code>ENABLED</code> .</p></div><div class=td-content style=page-break-before:always><h1 id=pg-767e10bba226dfa998d960b8f8db15a1>2.2.3.2 - View User Resources</h1><p>To see resource use by your cloud users, Eucalyptus provides the following commands with the flag.</p><ul><li>: Returns information about security groups in your account, including output type identifier, security group ID, security group name, security group description, output type identifier, account ID of the group owner, name of group granting permission, type of rule, protocol to allow, start of port range, end of port range, source (for ingress rules) or destination (for egress rules), and any tags assigned to the security group.</li><li>: Returns information about your instances, including output type identifier, reservation ID, name of each security group the instance is in, output type identifier, instance ID for each running instance, EMI ID of the image on which the instance is based, public DNS name associated with the instance (for instances in the running state), private DNS name associated with the instance (for instances in running state), instance state, key name, launch index, instance type, launch time, availability zone, kernel ID, ramdisk ID, monitoring state, public IP address, private IP address, type of root device (ebs or instance-store), placement group the cluster instance is in, virtualization type (paravirtual or hvm), any tags assigned to the instance, hypervisor type, block device identifier for each EBS volume the instance is using, along with the device name, the volume ID, and the timestamp.</li><li>: Returns information about key pairs available to you, including keypair identifier, keypair name, and private key fingerprint.</li><li>: Returns information about EBS snapshots available to you, including snapshot identifier, ID of the snapshot, ID of the volume, snapshot state (pending, completed, error), timestamp when snapshot initiated, percentage of completion, ID of the owner, volume sized, description, and any tags assigned to the snapshot.</li><li>: Describes your EBS volumes, including volume identifier, volume ID, size of the volume in GiBs, snapshot from which the volume was created, availability zone, volume state (creating, available, in-use, deleting, deleted, error), timestamp of the volume creation, and any tags assigned to the volume.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-40eae85392833eb096392d5106a8dc59>2.2.3.3 - Change Network Configuration</h1><h1 id=change-network-configuration>Change Network Configuration</h1><p>You might want to change the original network configuration of your cloud. To change your network configuration, perform the tasks listed in this topic.Log in to the CLC and open the <em>/etc/eucalyptus/eucalyptus.conf</em> file. Navigate to the Networking Configuration section and make your edits. Save the file. Restart the Cluster Controller.</p><pre><code>systemctl restart eucalyptus-cluster.service
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-b9e646cefa91214c3c1dd7fd1d68523f>2.2.3.3.1 - Networking Configuration Options</h1><p>All network-related options specified in /etc/eucalyptus/eucalyptus.conf use the prefix VNET_. The most commonly used VNET options are described in the following table.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If you change the value of in the file, you must restart the Cluster Controller.</div><table><thead><tr><th style=text-align:left>Option</th><th style=text-align:left>Description</th><th style=text-align:left>Component</th></tr></thead><tbody><tr><td style=text-align:left>VNET_BRIDGE</td><td style=text-align:left>This is the name of the bridge interface to which instances&rsquo; network interfaces should attach. A physical interface that can reach the CC must be attached to this bridge. Common setting for KVM is br0.</td><td style=text-align:left>Node Controller</td></tr><tr><td style=text-align:left>VNET_DHCPDAEMON</td><td style=text-align:left>The ISC DHCP executable to use. This is set to a distro-dependent value by packaging. The internal default is /usr/sbin/dhcpd3.</td><td style=text-align:left>Node Controller</td></tr><tr><td style=text-align:left>VNET_MODE</td><td style=text-align:left>The networking mode in which to run. The same mode must be specified on all CCs and NCs in your cloud. Valid values: EDGE</td><td style=text-align:left>All CCs and NCs</td></tr><tr><td style=text-align:left>VNET_PRIVINTERFACE</td><td style=text-align:left>The name of the network interface that is on the same network as the NCs. Default: eth0</td><td style=text-align:left>Node Controller</td></tr><tr><td style=text-align:left>VNET_PUBINTERFACE</td><td style=text-align:left>This is the name of the network interface that is connected to the same network as the CC. Depending on the hypervisor&rsquo;s configuration this may be a bridge or a physical interface that is attached to the bridge. Default: eth0</td><td style=text-align:left>Node Controller</td></tr></tbody></table></div><div class=td-content style=page-break-before:always><h1 id=pg-b9307d8c7842213d531a1887a7cff498>2.2.3.4 - Add a Node Controller</h1><p>If you want to increase your system’s capacity, you’ll want to add more Node Controllers (NCs).To add an NC, perform the following tasks:</p><p>Log in to the CLC and enter the following command:</p><pre><code>clusteradmin-register-nodes node0_IP_address ... [nodeN_IP_address]
</code></pre><p>When prompted, enter the password to log into each node. Eucalyptus requires this password to propagate the cryptographic keys.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-b94a8f5398dab9391684bbba3babbcc9>2.2.3.5 - Migrate Instances Between Node Controllers</h1><p>In order to ensure optimal system performance, or to perform system maintenance, it is sometimes necessary to move running instances between Node Controllers (NCs). You can migrate instances individually, or migrate all instances from a given NC.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>For migrations to succeed, you must have set to the same value in the file on each NC.</div>To migrate a single instance to another NC, enter the following command:</p><pre><code>euserv-migrate-instances -i INSTANCE_ID
</code></pre><p>You can also optionally specify <code>--include-dest HOST_NC_IP</code> or <code>--exclude-dest HOST_NC_IP</code> , to ensure that the instance is migrated to one of the specified NCs, or to avoid migrating the instance to any of the specified NCs. These flags may be used more than once to specify multiple NCs.</p><p>To migrate all instances away from an NC, enter the following command:</p><pre><code>euserv-migrate-instances --source HOST_NC_IP
</code></pre><p>You can also optionally specify <code>euserv-modify-service -s stop HOST_NC_IP</code> , to stop the specified NC and ensure that no new instances are started on that NC while the migration occurs. This allows you to safely remove the NC without interrupting running instances. The NC will remain in the DISABLED state until it is explicitly enabled using <code>euserv-modify-service -s start HOST_NC_IP</code> .</p><p>In some cases, timeouts may cause a migration to initially fail. Run the command again to complete the migration.</p><p>If the migration fails, check the <em>nc.log</em> file on the source and destination NCs. If you see an error similar to:</p><pre><code>libvirt: Cannot get interface MTU on 'br0': No such device (code=38)
</code></pre><p>&mldr; then ensure the NCs have the same interface and bridge device names, as described in <a href=https://www.eucastack.io/docs/install_guide/eucalyptus/installing_dependencies/configuring_bridge/></a> .</p></div><div class=td-content style=page-break-before:always><h1 id=pg-305df335c1e1184ccbecdecf3dbaed8c>2.2.3.6 - Remove a Node Controller</h1><p>Describes how to delete NCs in your system.If you want to decrease your system’s capacity, you’ll need to decrease NC servers. To delete an NC, perform the following tasks.</p><p>Log in to the CC and enter the following command:</p><pre><code>clusteradmin-deregister-nodes node0_IP_address ... [nodeN_IP_address]
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-cec332a68c9602c3dd63331552c1a240>2.2.3.7 - Restart Eucalyptus</h1><h1 id=restart-eucalyptus>Restart Eucalyptus</h1><p>Describes the recommended processes to restart Eucalyptus, including terminating instances and restarting Eucalyptus components.You must restart Eucalyptus whenever you make a physical change (e.g., switch out routers), or edit the eucalyptus.conf file. To restart Eucalyptus, perform the following tasks in the order presented.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Before you restart Eucalyptus, we recommend that you notify all users that you are terminating all instances.</div></div><div class=td-content style=page-break-before:always><h1 id=pg-e02fe48225ce8b52cecd81c56c1b7c75>2.2.3.7.1 - Shut Down All Instances</h1><p>To terminate all instances on all NCs perform the steps listed in this topic. To terminate all instances on all NCs:</p><p>Enter the following command:</p><pre><code>euca-terminate-instances &lt;instance_id&gt;
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-ed8972bfa7c21e81d9c319bd1b821695>2.2.3.7.2 - Restart the CLC</h1><p>Log in to the CLC and enter the following command:</p><pre><code>systemctl restart eucalyptus-cloud.service
</code></pre><p>All Eucalyptus components on this server will restart.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-3bde7106c2cd8834340b697a46b497af>2.2.3.7.3 - Restart Walrus</h1><p>Log in to Walrus and enter the following command:</p><pre><code>systemctl restart eucalyptus-cloud.service
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-1e4cb3fd184cc4c16f0c3297b02062dc>2.2.3.7.4 - Restart the CC</h1><p>Log in to the CC and enter the following command:</p><pre><code>systemctl restart eucalyptus-cluster.service
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-845252ede8416a07631956756ce7ee36>2.2.3.7.5 - Restart the SC</h1><p>Log in to the SC and enter the following command:</p><pre><code>systemctl restart eucalyptus-cloud.service
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-4bc52c55980cc5901a1c043b23a6bce8>2.2.3.7.6 - Restart an NC</h1><p>To restart an NC perform the steps listed in this topic.Log in to the NC and enter the following command:</p><pre><code>systemctl restart eucalyptus-node.service
</code></pre><p>Repeat for each NC. Verify that the following is even needed. If so, replicate for other NC-tasks. You can automate the restart command for all of your NCs. Store a list of your NCs in a file called <em>nc-hosts</em> that looks like:</p><pre><code>nc-host-00
nc-host-01
...
nc-host-nn
</code></pre><p>To restart all of your NCs, run the following command:</p><pre><code>cat nc-hosts | xargs -i ssh root@{} systemctl restart eucalyptus-node.service
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-69c1fe179039b186dcb51d9c2c1fd5af>2.2.3.8 - Shut Down Eucalyptus</h1><h1 id=shut-down-eucalyptus>Shut Down Eucalyptus</h1><p>Describes the recommended processes to shut down Eucalyptus.There may be times when you need to shut down Eucalyptus. This might be because of a physical failure, topological change, backing up, or making an upgrade. We recommend that you shut down Eucalyptus components in the reverse order of how you started them. To stop the system, shut down the components in the order listed.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Before you shut Eucalyptus down, we recommend that you notify all users that you are terminating all instances.</div></div><div class=td-content style=page-break-before:always><h1 id=pg-fdf4afeb6709fa4aa52a8adc853fd267>2.2.3.8.1 - Shut Down All Instances</h1><p>To terminate all instances on all NCs perform the steps listed in this topic.To terminate all instances on all NCs:</p><p>Enter the following command:</p><pre><code>euca-terminate-instances &lt;instance_id&gt;
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-2baf2c0364f55c61223c36f37adb156b>2.2.3.8.2 - Shut Down the NCs</h1><p>To shut down the NCs perform the steps listed in this topic.To shut down the NCs:</p><p>Log in as root to a machine hosting an NC. Enter the following command:</p><pre><code>systemctl stop eucalyptus-node.service
</code></pre><p>Repeat for each machine hosting an NC.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-d7a70b66de8a1142c36f1af178ee2f2e>2.2.3.8.3 - Shut Down the CCs</h1><p>To shut down the CCs:</p><p>Log in as root to a machine hosting a CC. Enter the following command:</p><pre><code>systemctl stop eucalyptus-cluster.service
</code></pre><p>Repeat for each machine hosting a CC.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-514810555162e04167ff04de95c11329>2.2.3.8.4 - Shut Down the SCs</h1><p>To shut down the SC:</p><p>Log in as root to the physical machine that hosts the SC. Enter the following command:</p><pre><code>systemctl stop eucalyptus-cloud.service
</code></pre><p>Repeat for any other machine hosting an SC.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-4eeca744ed3e81940980ca7850c932ed>2.2.3.8.5 - Shut Down Walrus</h1><p>To shut down Walrus:</p><p>Log in as root to the physical machine that hosts Walrus. Enter the following command:</p><pre><code>systemctl stop eucalyptus-cloud.service
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-f6f892cd051d9b9c7572679c49841736>2.2.3.8.6 - Shut Down the CLC</h1><p>To shut down the CLC:</p><p>Log in as root to the physical machine that hosts the CLC. Enter the following command:</p><pre><code>systemctl stop eucalyptus-cloud.service
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-bd7d4a47a2762fa1f7267d2aec9dbbae>2.2.3.9 - Disable CloudWatch</h1><p>To disable CloudWatch, run the following command.</p><pre><code>euctl cloudwatch.enable_cloudwatch_service=true
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-409e6261b06210f064883bd322fd80a0>2.3 - Operations</h1><h1 id=operations>Operations</h1><p>This section contains concepts and tasks associated with operating your Eucalyptus cloud.</p></div><div class=td-content><h1 id=pg-ebfd7f8f734a435867e539f62e247e35>2.3.1 - Operations Overview</h1><p>This section is for architects and cloud administrators who plan to deploy Eucalyptus in a production environment. It is not intended for end users or proof-of-concept installations.To run Eucalyptus in a production environment, you must be aware of your hardware and network resources. This guide is to help you make decisions about deploying Eucalyptus. It is also meant to help you keep Eucalyptus running smoothly.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-ba269b0051a8d0bf24b4c651de0407ba>2.3.2 - Planning Your Deployment</h1><p>To decide on your deployment&rsquo;s scope, determine the use case for your cloud. For example, will this be a small dev-test environment, or a large and scalable web services environment?To help with scoping your deployment, see <a href=https://www.eucastack.io/docs/install_guide/eucalyptus/planning/>Plan Your Installation</a> in the <a href=https://www.eucastack.io/docs/install_guide/>Installation Guide</a> . There you will find solution examples and physical resource information.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-513c1f5ea9e48bc66b63d63705bd6285>2.3.3 - Testing Your Deployment</h1><p>This topic details what you should test when you want to make sure your deployment is working. The following suggested test plan contains tasks that ensure DNS, imaging, and storage are working.</p><h2 id=dns>DNS</h2><ul><li>Verify that instances can ping their:</li><li>Verify that instances are pingable on their public DNS names from:</li></ul><h2 id=imaging>Imaging</h2><ul><li>Verify that an EBS-backed image boots successfully</li><li>Verify that you can create an image from a running EBS-backed instance</li><li>Verify that you can install a new Ubuntu image</li><li>Verify that you can deregister an image</li><li>Verify that you can import an instance</li><li>Verify that you can import a volume</li></ul><h2 id=walrus>Walrus</h2><ul><li>Verify that you can make a basic s3cmd request</li><li>Verify that you can successfully perform a multi-part upload (use a 1G+ file)</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-b4fc1a7b029c7f366c80a05a9415a4e2>2.3.4 - Customizing Your Deployment</h1><p>This section describes the most commonly applied post-install customizations and the issues they pose:</p><ul><li>Over-subscription</li><li>Networking changes (EDGE mode)</li><li>CloudWatch tweaks/customizations</li><li>Capacity changes</li></ul><h2 id=over-subscription>Over-subscription</h2><p>Over-subscription refers to the practice of expanding your computer beyond its limits. Over-subscription applies only to node controllers. You may modify disks and cores to allow enough usage buffer for your instance. Navigate to <code>/etc/eucalyptus/</code> and locate the <code>eucalyptus.conf</code> file. Edit the following values to define the appropriate size buffers for your instances: <code>NC_WORK_SIZE</code> Defines the amount of disk space available for instances to be run. Defaults to 1/3 of the currently available disk space on the NC, and NC_CACHE_SIZE defaults to the other 2/3.</p><p><code>NC_CACHE_SIZE</code> Defines how much disk space is needed for images to be cached. <code>MAX_CORES</code> Defines the maximum number of cores that can be provided to VMs on each NC. If it is 0 or not present, then the only limit on the number of instances is the number of cores available on the NC. If it is present, any value greater than 256 is treated as 256. In order for these changes to take effect, you must restart the NC.</p><h2 id=networking-changes-edge-modes>Networking Changes (EDGE modes)</h2><p>You can modify the default by adding network IPs to your cloud. Adding public IPs does not require shutting down the whole system.</p><p>To add network IPs:In EDGE mode, adding or changing the IP involves creating a JSON file and uploading it the Cloud Controller (CLC). See <a href=https://www.eucastack.io/docs/install_guide/eucalyptus/configuring_euca/configure_network_modes/nw_edge/>Configure for Edge Mode</a> for more details. No restart needed, changes apply automatically.</p><h2 id=change-cloudwatch-properties>Change CloudWatch Properties</h2><p>You can change the following CloudWatch properties:</p><table><thead><tr><th style=text-align:left>Property</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left>cloud.monitor.default_poll_interval_mins</td><td style=text-align:left>This is how often the CLC sends a request to the CC for sensor data. Default value is 5 minutes. If you set it to 0 = no reporting. The more often you poll, the more hit on system performance.</td></tr><tr><td style=text-align:left>cloud.monitor.history_size</td><td style=text-align:left>This is how many data value samples are sent in each sensor data request. The default value is 5. How many samples per poll interval.</td></tr><tr><td style=text-align:left>cloudwatch.enable_cloudwatch_service</td><td style=text-align:left>Disables CloudWatch when set to false.</td></tr></tbody></table><h2 id=change-capacity>Change Capacity</h2><p>Capacity changes refer to adding another zone or more nodes. To add another zone, <a href=https://www.eucastack.io/docs/install_guide/eucalyptus/install_repos_intro/>install</a> , <a href=https://www.eucastack.io/docs/install_guide/eucalyptus/starting_euca/>start</a> , and <a href=https://www.eucastack.io/docs/install_guide/eucalyptus/register_services/registering_ccs/>register</a> . To add more nodes, see <a href=https://www.eucastack.io/docs/admin_guide/managing_system/system_tasks/add_nodes/>Add a Node Controller</a> .</p></div><div class=td-content style=page-break-before:always><h1 id=pg-d3dc2274c8d9ba899d5b287b9e7fecd7>2.3.5 - Managing Policies</h1><p>This topic details best practices for managing your cloud policies.</p><ul><li>Establish a workflow for account creation, including the initial request for a cloud account and the email containing credentials.</li><li>Limit your use of individual policies. Focus your policies on groups and add individuals to the group.</li><li>Use groups to assign permissions to individual users. Limit the use of policies for individual users.
For more information about policy best practices, see <a href=http://docs.aws.amazon.com/IAM/latest/UserGuide/IAMBestPractices.html>IAM Best Practices</a> .</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-c402cfde98e55529aa6c3fe474f0e1cf>2.3.6 - Networking</h1><p>This topic addresses networking in the Eucalyptus cloud.</p><h2 id=networking-modes>Networking Modes</h2><p>Eucalyptus offers different modes to provide you with a cloud that will fit in your current network. For information what each networking mode has to offer, see <a href=https://www.eucastack.io/docs/install_guide/eucalyptus/planning/planning_networking_modes/>Plan Networking Modes</a> .</p><h2 id=ec2-classic-networking>EC2-Classic Networking</h2><p>Eucalyptus EDGE networking mode supports EC2-Classic networking. Your instances run in a single, flat network that you share with others. For more information about EC2-Classic networking, see <a href=http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-supported-platforms.html#platform-differences>EC2 Supported Platforms</a> .</p><h2 id=ec2-vpc-networking>EC2-VPC Networking</h2><p>Eucalyptus VPCMIDO networking mode resembles the Amazon Virtual Private Cloud (VPC) product wherein the network is fully configurable by users. For more information about EC2-VPC networking, see <a href=http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-vpc.html#differences-ec2-classic-vpc>Differences Between Instances in EC2-Classic and EC2-VPC</a> .</p></div><div class=td-content style=page-break-before:always><h1 id=pg-94d6b71bfdb57b839443a8eb5fe41b4d>2.3.7 - Monitoring</h1><p>This topic includes details about which resources you should monitor.</p><table><thead><tr><th style=text-align:left>Component</th><th style=text-align:left>Running Processes</th></tr></thead><tbody><tr><td style=text-align:left>Cloud Controller (CLC)</td><td style=text-align:left>eucalyptus-cloud, postgres, eucanetd (VPCMIDO mode)</td></tr><tr><td style=text-align:left>User-facing services (UFS)</td><td style=text-align:left>eucalyptus-cloud</td></tr><tr><td style=text-align:left>Walrus</td><td style=text-align:left>eucalyptus-cloud</td></tr><tr><td style=text-align:left>Cluster Controller (CC)</td><td style=text-align:left>eucalyptus-cluster</td></tr><tr><td style=text-align:left>Storage Controller (SC)</td><td style=text-align:left>eucalyptus-sc, tgtd (for DAS and Overlay)</td></tr><tr><td style=text-align:left>Node Controller (NC)</td><td style=text-align:left>eucalyptus-node, httpd, dhcpd, eucanetd (EDGE mode), qemu-kvm / 1 per instance</td></tr><tr><td style=text-align:left>Management Console</td><td style=text-align:left>eucaconsole</td></tr></tbody></table></div><div class=td-content style=page-break-before:always><h1 id=pg-5ba778536cf329f3f22230937a68bfd5>2.3.8 - Backup and Recovery</h1><h1 id=backup-and-recovery>Backup and Recovery</h1><p>This section provides details on important files to back up and recover.</p></div><div class=td-content><h1 id=pg-52db2925512295cf7d8cba9b1ce0b676>2.3.8.1 - Back Up Eucalyptus Cloud Data</h1><h1 id=back-up-cloud-data>Back Up Cloud Data</h1><p>This section explains what you need to back up and protect your cloud data.We recommend that you back up the following data:</p><ul><li>The cloud database: see</li><li>Object storage. For objects in Walrus, the frequency depends on current load. Use your own discretion to determine the backup plan and strategy. You must have Walrus running.</li><li>EBS volumes in each cluster (DAS and Overlay)</li><li>The configuration file for the cloud is stored on the CLC: .</li><li>Any configuration file for the cloud stored on any other host (UFS, CC, etc.): .</li><li>The cloud security credentials on all hosts (you already backed up the CLC keys as part of the database backup). Use the tar command: .</li><li>The CC and NC configuration files, stored on every CC and NC: .</li><li>Any Euca2ools (.ini) configuration files, which reside on any Euca2ools host machine. Files can be found in:</li><li>Management Console config files in should be backed up. Typical files:</li><li>Ensure you have your instances&rsquo; so you can access the instances later.</li><li>and LVM snapshots
Users are responsible for volume backups using EBS snapshots on their defined schedules.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-e5a12f89eb93ddf43353e2b70c052f99>2.3.8.1.1 - Back Up the Database</h1><p>To back up the cloud database follow the steps listed in this topic.Bucket and object metadata are stored in the Eucalyptus cloud database. <strong>To back up the database</strong></p><p>Log in to the CLC. The cloud database is on the CLC. Extract the Eucalyptus PostgreSQL database cluster into a script file.</p><pre><code>pg_dumpall --oids -c -h/var/lib/eucalyptus/db/data -p8777 -U root -f/root/eucalyptus_pg_dumpall-backup.sql
</code></pre><p>Back up the cloud security credentials in the keys directory.</p><pre><code>tar -czvf ~/eucalyptus-keydir.tgz /var/lib/eucalyptus/keys
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-5cf42cac5b615d53b45cc5386be85dd9>2.3.8.2 - Recover Eucalyptus Cloud Data</h1><h1 id=recover-cloud-data>Recover Cloud Data</h1><p>This topic explains what to include when you recover your cloud.<strong>Recovering Your Cloud Data</strong></p><p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>When you recover your cloud data, you need to stop all services, recover the files, then start all services again.</div>We recommend that you recover the following data:</p><ul><li>The cloud database: see</li><li>Object storage. For objects in Walrus, the frequency depends on current load. Use your own discretion to determine the restore plan and strategy.</li><li>EBS volumes in each cluster (DAS and Overlay)</li><li>The configuration file for the cloud is stored on the CLC: .</li><li>Any configuration file for the cloud stored on any other host (UFS, CC, etc.): .</li><li>The cloud security credentials on all hosts (you already restored the CLC keys as part of the database restore). Use the tar command: .</li><li>The CC and NC configuration files, stored on every CC and NC: .</li><li>Any Euca2ools (.ini) configuration files, which reside on any Euca2ools host machine. Files in these directories:</li><li>Management Console config files you backed up from should be restored. Typical files:</li><li>Ensure you have your instances&rsquo; so you can access the instances.</li><li>and LVM snapshots
Users are responsible for volume restore using EBS snapshots.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-4f71551333a6fc86a65369a23bf0eecc>2.3.8.2.1 - Restore the Database</h1><p>To restore the cloud database follow the steps listed in this topic.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Sometimes you&rsquo;ll get this message on both startup and shutdown of the database: &mldr; where is actually your current directory, meaning if you run the command from , then the path in the output will be instead of . The message is completely benign and can be ignored.</div><strong>To restore the database</strong></p><p>Stop the CLC service.</p><pre><code>systemctl stop eucalyptus-cloud.service
</code></pre><p>Remove traces of the old database.</p><pre><code>rm -rf /var/lib/eucalyptus/db
</code></pre><p>Restore the cloud security credentials in the keys directory.</p><pre><code>tar -xvf ~/eucalyptus-keydir.tgz -C /
</code></pre><p>Re-initialize the database structure.</p><pre><code>clcadmin-initialize-cloud
</code></pre><p>Start the database manually.</p><pre><code>su eucalyptus -s /bin/bash -c &quot;/usr/bin/pg_ctl start -w \
-s -D/var/lib/eucalyptus/db/data -o '-h0.0.0.0/0 -p8777 -i'&quot;
</code></pre><p>Restore the backup.</p><pre><code>psql -U root -d postgres -p 8777 -h /var/lib/eucalyptus/db/data -f/root/eucalyptus_pg_dumpall-backup.sql
</code></pre><p>Stop the database manually.</p><pre><code>su eucalyptus -s /bin/bash -c &quot;/usr/bin/pg_ctl stop -D/var/lib/eucalyptus/db/data&quot;
</code></pre><p>Start CLC service<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If you are upgrading, skip this step (you don&rsquo;t want to start the CLC service now because you haven&rsquo;t restored the rest of the cloud data yet; starting the CLC appears in the installation steps, later).</div></p><pre><code>systemctl start eucalyptus-cloud.service
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-773e3fce9d093e7f7f47622dd59594b2>2.3.9 - Troubleshooting</h1><h1 id=troubleshooting>Troubleshooting</h1><p>This topic details how to find information you need to troubleshoot most problems in your cloud. To troubleshoot Eucalyptus, you must have the following:</p><ul><li>a knowledge about which machines each Eucalyptus component is installed on</li><li>root access to each machine hosting Eucalyptus components</li><li>an understanding of the network mode (EDGE, VPCMIDO)</li><li>an understanding of eucanetd and the configuration connecting the Eucalyptus components</li></ul><p>For most problems, the procedure for tracing problems is the same: start at the bottom to verify the bottom-most component, and then work your way up. If you do this, you can be assured that the base is solid. This applies to virtually all Eucalyptus components and also works for proactive, targeted monitoring.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-449c7065f0f6ff554817ce04a8b4f4fc>2.3.9.1 - Eucalyptus Log Files</h1><p>Usually when an issue arises in Eucalyptus, you can find information that points to the nature of the problem either in the Eucalyptus log files or in the system log files. This topic details log file message meanings, location, configuration, and fault log information.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-186617b25ccba629a34b947a31509cf8>2.3.9.2 - Network Information</h1><p>When you have to troubleshoot, it&rsquo;s important to understand the elements of the network on your system.Here are some ideas for finding out information about your network:</p><ul><li>It is also important to understand the elements of the network on your system. For example, you might want to list bridges to see which devices are enslaved by the bridge. To do this, use the command.</li><li>You might also want to list network devices and evaluate existing configurations. To do this, use these commands: , , and .</li><li>You can use to check status, or to force eucanetd to run in the foreground, sending log messages to the terminal.</li><li>You can get further information if you use the commands with the options. For example, returns all instances running by all users on the system. Other describe commands are:</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-6ff55e132456066cd91070cc57fe4e20>2.3.9.3 - Common Problems</h1><h1 id=common-problems>Common Problems</h1><p>This section describes common problems and workarounds.</p></div><div class=td-content><h1 id=pg-db12c95988678b82de1626a327e04931>2.3.9.3.1 - Problem: can't communicate with instance</h1><p>Use ping from a client (not the CLC). Can you ping it?</p><p>Yes: Check the open ports on security groups and retry connection using SSH or HTTP. Can you connect now? Yes. Okay, then. You&rsquo;re work is done. No: Try the same procedure as if you can&rsquo;t ping it up front. No: Is your cloud running in Edge networking mode?</p><ul><li><p>Yes: Run <code>euca-describe-nodes</code> . Is your instance there?</p></li><li><p>No, it is not in Edge networking mode:</p></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-e45f12c11a3ecedb728511fcf82a4bcc>2.3.9.3.2 - Problem: install-time checks</h1><p>Eucalyptus offers installation checks for any Eucalyptus component or service (CLC, Walrus, SC, NC, SC, services, and more). When Eucalyptus encounters an error, it presents the problem to the operator. These checks are used for install-time problems. They provide resolutions to some of the fault conditions.</p><p>Each problematic condition contains the following information:</p><table><thead><tr><th style=text-align:left>Heading</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left>Condition</td><td style=text-align:left>The fault found by Eucalyptus</td></tr><tr><td style=text-align:left>Cause</td><td style=text-align:left>The cause of the condition</td></tr><tr><td style=text-align:left>Initiator</td><td style=text-align:left>What is at fault</td></tr><tr><td style=text-align:left>Location</td><td style=text-align:left>Where to go to fix the fault</td></tr><tr><td style=text-align:left>Resolution</td><td style=text-align:left>The steps to take to resolve the fault</td></tr></tbody></table><p><img src=https://www.eucastack.io/images/install-check.png alt=image></p><p>For more information about all the faults we support, go to <a href=https://github.com/eucalyptus/eucalyptus/blob/master/util/README.faults>https://github.com/eucalyptus/eucalyptus/tree/master/util/faults/en_US</a> .</p></div><div class=td-content style=page-break-before:always><h1 id=pg-8d009201f7ce8c96ae19456ce0b09336>2.3.9.3.3 - Problem: instance runs but fails</h1><p>Run <code>euca-describe-nodes</code> to verify if instance is there. Is the instance there?</p><p>Yes: Go to the <a href=https://www.eucastack.io/docs/admin_guide/ops_oview/ops_ts/ts_logs/>NC log</a> for that NC and grep your instance ID. Did you find the instance?</p><ul><li>Yes: Is there an error message?</li></ul><p>No: Go to the <a href=https://www.eucastack.io/docs/admin_guide/ops_oview/ops_ts/ts_logs/>CC log</a> and grep the instance ID. Is it there error message?</p><ul><li><p>Yes: The error message should give you some helpful information.</p></li><li><p>No: grep the instance ID in <a href=https://www.eucastack.io/docs/admin_guide/ops_oview/ops_ts/ts_logs/>cloud-output.log</a> . Is there error message?</p></li></ul><p>No: Log in as admin and run <code>euca-describe-instance</code> . Is the instance there?</p><ul><li>Yes:</li><li>No: Start over and run a new instance, recreate failure, and start these steps over.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-c8e2c9f569c1bb7a549a1dffc10c38cf>2.3.9.3.4 - Problem: snapshot creation failed</h1><p>On the SC, depending on the backend used for storage:</p><ul><li>For Overlay, use the command to check the disk space in .</li><li>For DAS, use the command to check the disk space in the DAS volumes.</li><li>For any other backend, use its specific commands to check the free space for storage allocated for volumes.
Is there enough space?</li></ul><p>Yes: On the OSG host, depending on the backend used for object storage:</p><ul><li><p>For Walrus, use the command to check the disk space in .</p></li><li><p>For RiakCS or Ceph-RGW, use its specific commands to check the free space for storage allocated for buckets and objects.
Is there enough space? Yes.</p></li><li><p>Use and note the IP addresses for the OSG and SC.</p></li><li><p>SSH to SC and ping the OSG. Are there error messages?</p></li></ul><p>No: Delete volumes or add disk space. No: Delete volumes or add disk space.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-eb35ffdc7c3611be1e9b4bbfc74c51e9>2.3.9.3.5 - Problem: volume creation failed</h1><p>Symptom: Went from available to fail. This is typically caused by the CLC and the SC.On the SC, use <code>df</code> or <code>lvdisplay</code> to check the disk space. Is there enough space?</p><p>Yes: Check the <a href=https://www.eucastack.io/docs/admin_guide/ops_oview/ops_ts/ts_logs/>SC log</a> and grep the volume ID. Is there error message? Yes. This provides clues to helpful information. No: Check <a href=https://www.eucastack.io/docs/admin_guide/ops_oview/ops_ts/ts_logs/>cloud-output.log</a> for a volume ID error. No: Delete volumes or add disk space.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-4e75713b798e9f1356b1c9622e50f794>2.3.9.4 - Component Workarounds</h1><h1 id=component-workarounds>Component Workarounds</h1><p>This section contains troubleshooting information for Eucalyptus components and services.</p></div><div class=td-content><h1 id=pg-6c93c08954ec6e4ca0b7c95fb598f8a4>2.3.9.4.1 - Access and Identities</h1><p>This topic contains information about access-related problems and solutions.
Need to verify an existing LIC file.</p><ol><li>Enter the following command: The output from the example above shows the name of the LIC file and status of the synchronization (set to false).</li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-dfdf1ab52db293741aa0539b53c504a7>2.3.9.4.2 - Elastic Load Balancing</h1><p>This topic explains suggestions for problems you might have with Elastic Load Balancing (ELB).
Can&rsquo;t synchronize with time server
Eucalyptus sets up NTP automatically for any instance that has an internet connection to a public network. If an instance doesn&rsquo;t have such a connection, set the cloud property <code>loadbalancing.loadbalancer_vm_ntp_server</code> to a valid NTP server IP address. For example:</p><pre><code>euctl loadbalancing.loadbalancer_vm_ntp_server=169.254.169.254
PROPERTY	loadbalancing.loadbalancer_vm_ntp_server	169.254.169.254 was {}
</code></pre><p>Need to debug an ELB instance
To debug an ELB instance, set the <code>loadbalancing.loadbalancer_vm_keyname</code> cloud property to the keypair of the instance you want to debug. For example:</p><pre><code># euctl loadbalancing.loadbalancer_vm_keyname=sshlogin
PROPERTY	loadbalancing.loadbalancer_vm_keyname	sshlogin was {}
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-f1e33740e1d4467eebdfe02297aef981>2.3.9.4.3 - Imaging Worker</h1><p>This topic contains troubleshooting tips for the Imaging Worker.Some requests that require the Imaging Worker might remain in pending for a long time. For example: an import task or a paravirtual instance run. If request remains in pending, the Imaging Worker instance might not able to run because of a lack of resources (for example, instance slots or IP addresses).</p><p>You can check for this scenario by listing latest AutoScaling activities:</p><pre><code>euscale-describe-scaling-activities -g asg-euca-internal-imaging-worker-01
</code></pre><p>Check for failures that indicate inadequate resources such as:</p><pre><code>ACTIVITY        1950c4e5-0db9-4b80-ad3b-5c7c59d9c82e    2014-08-12T21:05:32.699Z        asg-euca-internal-imaging-worker-01    Failed   Not enough resources available: addresses; please stop or terminate unwanted instances or release unassociated elastic IPs and try again, or run with private addressing only
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-58919d9aac2f9e11e6ba972627dd4bbd>2.3.9.4.4 - Instances</h1><p>This topic contains information to help you troubleshoot your instances.
Inaccurate IP addresses display in the output of euca-describe-addresses.
This can occur if you add IPs from the wrong subnet into your public IP pool, do a restart on the CC, swap out the wrong ones for the right ones, and do another restart on the CC. To resolve this issue, run the following commands.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>A restart should only be performed when no instances are running, or when instance service interruption can be tolerated. A restart causes the CC to reset its networking configuration, regardless of whether or not it is in use.</div><pre><code>systemctl stop eucalyptus-cloud.service
systemctl stop eucalyptus-cluster.service
iptables -F
systemctl restart eucalyptus-cluster.service
systemctl start eucalyptus-cloud.service
</code></pre><p>NC does not recalculate disk size correctly
This can occur when trying to add extra disk space for instance ephemeral storage. To resolve this, you need to delete the instance cache and restart the NC.</p><p>For example:</p><pre><code>rm -rf /var/lib/eucalyptus/instances/* 
systemctl restart eucalyptus-node.service               				
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-d6cbcd9901b5e3c3cb26119429a1da9a>2.3.9.4.5 - Walrus and Storage</h1><p>This topic contains information about Walrus-related problems and solutions.
Walrus decryption failed.
On Ubuntu 10.04 LTS, kernel version 2.6.32-31 includes a bug that prevents Walrus from decrypting images. This can be determined from the following line in cloud-output.log</p><pre><code>javax.crypto.
BadPaddingException: pad block corrupted
</code></pre><p>If you are running this kernel:</p><ol><li>Update to kernel version 2.6.32-33 or higher.</li><li>De-register the failed image ( ).</li><li>Re-register the bundle that you uploaded ( ).</li></ol><p>Walrus physical disk is not large enough.</p><ol><li>Stop the CLC.</li><li>Add a disk.</li><li>Migrate your data.
Make sure you use LVM with your new disk drive(s).</li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-c2b7309755f32db77e33eb61e57d3ece>2.4 - Manage Resources</h1><h1 id=manage-resources>Manage Resources</h1><p>This section includes tasks to help you manage your users&rsquo; cloud resources.</p></div><div class=td-content><h1 id=pg-edf86d14926ae3a2bbefffedef75cbeb>2.4.1 - Manage Auto Scaling Resources</h1><p>You can list, delete, update, and suspend your Eucalyptus cloud&rsquo;s Autoscaling resources by passing the option with the keyword with the appropriate command.The followings are some examples you can use to act on your Auto Scaling resources.</p><p>To show all launch configurations in your cloud, run the following command:</p><pre><code>euscale-describe-launch-configs --show-long verbose
</code></pre><p>To show all Auto Scaling instances in your cloud, run the following command:</p><pre><code>euscale-describe-auto-scaling-groups --show-long verbose
</code></pre><p>To show all Auto Scaling instances in your cloud, run the following command:</p><pre><code>euscale-describe-auto-scaling-groups --show-long verbose
</code></pre><p>To delete an Auto Scaling resource in your cloud, first get the ARN of the resource, as in this example:</p><pre><code>$ euscale-describe-launch-configs --show-long verbose
LAUNCH-CONFIG  TestLaunchConfig  emi-06663A57  m1.medium  2013-10-30T22:52:39.392Z  true
arn:aws:autoscaling::961915002812:launchConfiguration:5ac29caf-9aad-4bdb-b228-5f
ce841dc062:launchConfigurationName/TestLaunchConfig
</code></pre><p>Then run the following command with the ARN:</p><pre><code>euscale-delete-launch-config
arn:aws:autoscaling::961915002812:launchConfiguration:5ac29caf-9aad-4bdb-b228-5f
ce841dc062:launchConfigurationName/TestLaunchConfig
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-f4988213f26f030d1e85ce5aeddaabce>2.4.2 - Manage CloudWatch Resources</h1><p>To manage CloudWatch resources on a Eucalyptus cloud, use the option in any command that lists, deletes, modifies, or sets a CloudWatch resource.The following are examples of what you can do with your CloudWatch resources.</p><p>To list all alarms for the cloud, run the following command:</p><pre><code>euwatch-describe-alarms verbose
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-2ce7519662bd80408299a03a60cb02c5>2.4.3 - Manage Compute Resources</h1><p>To manage compute resources on a Eucalyptus cloud, use the option in any command.The following are some examples you can use to view various compute resources.</p><p>To see all instances running on your cloud, enter the following command:</p><pre><code>euca-describe-instances verbose
</code></pre><p>To see all volumes in your cloud, enter the following command:</p><pre><code>euca-describe-volumes verbose
</code></pre><p>To see all keypairs in your cloud, enter the following command:</p><pre><code>euca-describe-keypairs verbose
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-064b0a1d8dd0ee794906de718d301ad2>2.4.4 - Manage ELB Resources</h1><p>To list and delete ELB resources on a Eucalyptus cloud, use the option with any command.The following are some examples.</p><p>To list all detailed configuration information for the load balancers in your cloud, run the following command:</p><pre><code>eulb-describe-lbs verbose
</code></pre><p>To list the details of policies for all load balancers in your cloud, run the following command:</p><pre><code>eulb-describe-lb-policies verbose
</code></pre><p>To list meta information for all load balancer policies in your cloud, run the following command:</p><pre><code>eulb-describe-lb-policy-types verbose
</code></pre><p>To delete any load balancer or any load balancer resource on the cloud, instead of using the ELB name, use the DNS name. For example:</p><pre><code>$ eulb-describe-lbs verbose
LOAD_BALANCER	MyLoadBalancer	MyLoadBalancer-961915002812.lb.foobar.eucalyptus-systems.com	2013-10-30T03:02:53.39Z

$ eulb-delete-lb MyLoadBalancer-961915002812.lb.foobar.eucalyptus-systems.com 
$ eulb-describe-lbs verbose 
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-942fda2d9d757d8ea3d1be5c0b1d3f7d>2.4.5 - Manage IAM Resources</h1><p>To manage Euare (IAM) resources on your Eucalyptus cloud, use the option with any command that describes, adds, deletes, or modifies resources. This option allows you to assume the role of the admin user for a given account. You can also use a policy to control and limit instances to specific availability zones. The following are some examples.</p><p>To list all groups in an account, enter the following command:</p><pre><code>euare-grouplistbypath --as-account &lt;account-name&gt;
</code></pre><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>The <em>as-account</em> option is for the Euare service only. To run commands for an account with any service use the <em>clcadmin-impersonate-user</em> command.</div><p>To list all users in an account, enter the following command:</p><pre><code>euare-userslistbypath --as-account &lt;account-name&gt;
</code></pre><p>To delete the login profile of a user in an account, enter the following command:</p><pre><code>euare-userdelloginprofile --as-account &lt;account-name&gt; -u &lt;user_name&gt;
</code></pre><p>To modify the login profile of a user in an account, enter the following command:</p><pre><code>euare-usermod --as-account &lt;account-name&gt; -u &lt;user_name&gt; -n
&lt;new_user_name&gt;
</code></pre><p>To restrict an image to a specific availability zone, edit and attach this sample policy to a user:</p><pre><code>{
    &quot;Statement&quot;:[
      {
        &quot;Effect&quot;:&quot;Allow&quot;,
        &quot;Action&quot;:&quot;ec2:*&quot;,
         &quot;Resource&quot;:&quot;*&quot;
      },
      {
        &quot;Effect&quot;: &quot;Deny&quot;,
        &quot;Action&quot;: [ &quot;ec2:*&quot; ],
        &quot;Resource&quot;: &quot;arn:aws:ec2:::availabilityzone/PARTI00&quot;,
        &quot;Condition&quot;: {
          &quot;ArnLike&quot;: {
            &quot;ec2:TargetImage&quot;: &quot;arn:aws:ec2:*:*:image/emi-239D37F2&quot;
          }
        }
      }
    ]
  }
</code></pre><p>To restrict a user to actions only within a specific availability zone, edit and attach this sample policy to a user:</p><pre><code>{
    &quot;Version&quot;: &quot;2012-10-17&quot;,
    &quot;Statement&quot;: [{
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Action&quot;: [ &quot;ec2:TerminateInstances&quot; ],
      &quot;Resource&quot;: &quot;*&quot;,
      &quot;Condition&quot;: {
        &quot;StringEquals&quot;: {
          &quot;ec2:AvailabilityZone&quot;: &quot;PARTI00&quot;
        }
      }
    }]
  }
</code></pre><p>To deny actions at the account level, edit and attach this example policy to an account:</p><pre><code>{
    &quot;Statement&quot;: [ {
      &quot;Effect&quot;: &quot;Deny&quot;,
      &quot;Action&quot;: [ &quot;ec2:RunInstances&quot; ],
      &quot;Resource&quot;: &quot;arn:aws:ec2:::availabilityzone/PARTI00&quot;,
      &quot;Condition&quot;: {
          &quot;ArnLike&quot;: {
              &quot;ec2:TargetImage&quot;: &quot;arn:aws:ec2:*:*:image/emi-239D37F2&quot;
          }
      }
    } ]
  }
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-6f77576acb8c9ef68ed227f6a296c19a>2.4.6 - Manage Walrus Resources</h1><p>This topic explains Walrus resources.</p><ul><li>Access Control Lists (ACLs) allow an account to explicitly grant access to a bucket or object to another account. ACLs only work between accounts, not IAM users. You specify accounts with the CanonicalID or the email address associated with the account (for Eucalyptus this is the email of the account admin).</li><li>These are set by the admin of an account to control the access of users within that specific account. This is how an admin controls what users in that specific account are allowed to do. Policies can specify allow/deny on specific S3 operations (e.g. s3:GetObject, or s3:PutObject). IAM policies are set by sending the policy to the IAM (Euare) endpoint, not S3 (Walrus).</li><li>These are IAM-like policies set by the bucket owner are not supported in Eucalyptus.
For more information about bucket ACLs, go to <a href=http://docs.aws.amazon.com/AmazonS3/latest/dev/ACLOverview.html>Access Control List (ACL) Overview</a> and <a href=http://docs.aws.amazon.com/AmazonS3/latest/dev/acl-using-rest-api.html>Managing ACLs Using the REST API</a> .</li></ul><p>For more information about IAM policies, go to <a href=http://docs.aws.amazon.com/AmazonS3/latest/dev/UsingIAMPolicies.html>Using IAM Policies</a> .</p></div><div class=td-content style=page-break-before:always><h1 id=pg-320258f138ecdf359054b41c11eb2d1f>2.5 - Manage Regions</h1><h1 id=manage-regions>Manage Regions</h1><p>This section provides information about regions and identity federation.</p></div><div class=td-content><h1 id=pg-db615c32de89d91a77013d625ff2e499>2.5.1 - Regions Overview</h1><p>Eucalytpus provides support for the notion of federation of identity.Federation of identity information means that a Cloud Administrator can create a federation of (otherwise independent) Eucalyptus &ldquo;clouds&rdquo; where a Cloud User, using the same credentials as always, can use any of these federated Eucalyptus cloud regions. For the parts of Identify Access Management (IAM) and Security Token Service (STS) that Eucalyptus implements, the experience exposed to the Cloud User is the same as that seen by an AWS user working across AWS regions.</p><p>A user can interact with any region using the same credentials, subjected to the same policies, and having uniformly accessible and structured principals (Accounts, Users, Groups, Roles, etc.). The globality also includes the STS service functionality, the temporary credentials produced by the STS service also work globally.</p><p>Notably, this feature is restricted to IAM/STS and does not include other services which have pseudo-global characteristics, such as global bucket name space for S3. The following are general principles associated with regions:</p><ul><li>A region needs to be Registered as a federated region</li><li>Registered regions should be discoverable via the EC2 DescribeRegions response</li><li>A cloud user&rsquo;s credentials should be accepted by any federated cloud</li><li>There is a global IAM service (identities and policies are global for all registered regions)</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-fedae7a6c85d933e61e99e237cd57022>2.5.2 - Region Configuration File Format</h1><p>This section describes the necessary configuration properties that need to be addressed.For federation to be successfully configured, each cloud (i.e. region) that will be part of the federated cloud needs to have the following properties set (at a minimum):</p><table><thead><tr><th style=text-align:left>Property Name</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left>region.region_name</td><td style=text-align:left>This cloud property identifies the local region. This is required and should be valid for use in a DNS name.</td></tr><tr><td style=text-align:left>region.region_configuration</td><td style=text-align:left>This property is a JSON document that will be the same for all federated regions.</td></tr></tbody></table></div><div class=td-content style=page-break-before:always><h1 id=pg-a462f267acaac5c4b8976eeaae34fe55>2.5.3 - Examples</h1><p>In this example, there will be two clouds used (10.111.5.32 and 10.111.1.1). Before setting up federation, the clouds must meet the following requirements:</p><ul><li>Eucalyptus installed</li><li>Eucalyptus DNS enabled</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-740779bdf59dfee316438e0ca35651ca>2.5.4 - Federation Differences Between AWS and Eucalyptus</h1><p>This section outlines the differences between AWS and Eucalyptus with respect to federation in the following platforms:</p><ul><li>Euca2ools vs. AWS EC2 API Tools</li><li>Eucalyptus OSG vs. AWS S3</li><li>Eucalyptus Resource-Level vs. AWS Resource-Level Permissions</li><li>Global Cloud Administration (Local vs. Federated)</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-8e39bf241d6fac54907f76a6c54f4c6a>2.5.5 - Troubleshooting</h1><p>This section is presented in a Q&A format to provide a quick reference to the most frequently asked questions.</p><ol><li><p>Can Cloud Administrators federate existing clouds (i.e. clouds that already have non-system Eucalyptus accounts)? <strong>A.</strong> No, this is currently not supported. If a cloud administrator wants to federate an Eucalyptus clouds, this must be done prior to any non-system Eucalyptus account/user/group creation.</p></li><li><p>Is Eucalyptus DNS required for federating Eucalyptus clouds? <strong>A.</strong> No, however its highly recommended to enable it.</p></li><li><p>Are supported for more granular IAM access policies per region? <strong>A.</strong> As of 4.2, no. IAM policies apply globally (for all regions). In order to get more granular IAM access, use availability zone restrictions under each region. For more information, see <a href=https://github.com/eucalyptus/architecture/wiki/iam-3.4-cluster-policies#Restrict_Image_to_Availability_Zone>Restrict Image to Availability Zone</a> .</p></li><li><p>What services/resources span globally? Which span regionally? <strong>A.</strong> Currently, only Eucalyptus IAM and STS are global services/resources. All other services/resources are region-based (i.e. Eucalyptus cloud-specific). The only resource that can be either global or regional are keypairs. This is because users can import the same keypair to each region, therefore, the keypair is globally accessible. For additional information, please refer to the AWS EC2 Documentation regarding <a href=http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/resources.html>Resource Locations</a> .</p></li><li><p>Are Eucalyptus system accounts global in a federated setup? <strong>A.</strong> No. Any Eucalyptus system account is limited to that region. Examples of Eucalyptus system accounts are as follows:</p></li></ol><ul><li>eucalyptus</li><li>(eucalyptus)blockstorage</li><li>(eucalyptus)aws-exec-read</li><li>(eucalyptus)cloudformation</li></ul><ol><li><p>Is and supported? <strong>A.</strong> No. There have been no improvements associated with Object Storage Gateway (OSG) regarding cross-regional behavior similar to AWS.</p></li><li><p>If a user uploads an object to an Object Storage Gateway in one region, will copies show up in other regions (similar to the behavior on AWS)? <strong>A.</strong> No, this is currently unsupported.</p></li><li><p>Do federated Eucalyptus clouds follow the same globally? <strong>A.</strong> No, Eucalyptus IAM limitations are regionally scoped.</p></li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-278f037a8bd490532a48f4f1a61bd8e5>2.6 - Manage Security</h1><h1 id=manage-security>Manage Security</h1><p>This section details concepts and tasks required to secure your cloud.</p></div><div class=td-content><h1 id=pg-5b7d7dee815ee6bcca58655f04835d1c>2.6.1 - Security Overview</h1><p>This topic is intended for people who are currently using Eucalyptus and who want to harden the cloud and underlying configuration.</p><p>This topic covers available controls and best practices for securing your Eucalyptus cloud. Cloud security depends on security across many layers of infrastructure and technology:</p><ul><li>Security of the physical infrastructure and hosts</li><li>Security of the virtual infrastructure</li><li>Security of instances</li><li>Security of storage and data</li><li>Security of users and accounts</li></ul><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>For information about securing applications in AWS cloud, we recommend the Amazon Web Services whitepaper. The practices in this in this paper also apply to your Eucalyptus cloud.</div></div><div class=td-content style=page-break-before:always><h1 id=pg-697bda1d9d1dd21fb81f0e1acb65c52d>2.6.2 - Best Practices</h1><h1 id=best-practices>Best Practices</h1><p>This topic contains recommendations for hardening your Eucalyptus cloud.</p></div><div class=td-content><h1 id=pg-83e928201de7403ef1103d92ab7fea90>2.6.2.1 - Authentication and Access Control Best Practices</h1><p>This topic describes best practices for Identity and Access Management and the account.</p><h2 id=identity-and-access-management>Identity and Access Management</h2><p>Eucalyptus manages access control through an authentication, authorization, and accounting system. This system manages user identities, enforces access controls over resources, and provides reporting on resource usage as a basis for auditing and managing cloud activities. The user identity organizational model and the scheme of authorizations used to access resources are based on and compatible with the AWS Identity and Access Management (IAM) system, with some Eucalyptus extensions provided that support ease-of-use in a private cloud environment.</p><p>For a general introduction to IAM in Eucalyptus, see <a href=https://www.eucastack.io/docs/iam_guide/managing_auth/understanding_identities/concepts_eiam/>Access Concepts</a> in the IAM Guide. For information about using IAM quotas to enforce limits on resource usage by users and accounts in Eucalyptus, see the <a href=https://www.eucastack.io/docs/iam_guide/managing_auth/understanding_identities/access_policies/access_policy_quota/>Quotas</a> section in the IAM Guide.</p><p>The <a href=http://docs.aws.amazon.com/IAM/latest/UserGuide/IAMBestPractices.html>Amazon Web Services IAM Best Practices</a> are also generally applicable to Eucalyptus.</p><h2 id=credential-management>Credential Management</h2><p>Protection and careful management of user credentials (passwords, access keys, X.509 certificates, and key pairs) is critical to cloud security. When dealing with credentials, we recommend:</p><ul><li>Limit the number of active credentials and do not create more credentials than needed.</li><li>Only create users and credentials for the interfaces that you will actually use. For example, if a user is only going to use the Management Console, do not create credentials access keys for that user.</li><li>Use and or to get a specific set of credentials if needed.</li><li>Regularly check for active credentials using commands and remove unused credentials. Ideally, only one pair of active credentials should be available at any time.</li><li>Rotate credentials regularly and delete old credentials as soon as possible. Credentials can be created and deleted using commands, such as and .</li><li>When rotating credentials, there is an option to deactivate, instead of removing, existing access/secret keys and X.509 certificates. Requests made using deactivated credentials will not be accepted, but the credentials remain in the Eucalyptus database and can be restored if needed. You can deactivate credentials using and .</li></ul><h2 id=privileged-roles>Privileged Roles</h2><p>The <code>eucalyptus</code> account is a super-privileged account in Eucalyptus. It has access to all cloud resources, cloud setup, and management. The users within this account do not obey IAM policies and compromised credentials can result in a complete cloud compromisation that is not easy to contain. We recommend limiting the use of this account and associated users&rsquo; credentials as much as possible.</p><p>For all unprivileged operations, use regular accounts. If you require super-privileged access (for example, management of resources across accounts and cloud setup administration), we recommend that you use one of the predefined privileged roles.</p><p>The Account, Infrastructure, and Resource Administrator <a href=https://www.eucastack.io/docs/iam_guide/managing_auth/understanding_identities/concepts_eiam/access_roles/>roles</a> provide a more secure way to gain super privileges in the cloud. Credentials returned by an assume-role operation are short-lived (unlike regular user credentials). Privileges available to each role are limited in scope and can be revoked easily by modifying the trust or access policy for the role.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-ba213df0e04164ac639d1838a5962490>2.6.2.2 - Hosts</h1><p>This topic describes best practices for machines that host a Eucalyptus component.Eucalyptus recommends restricting physical and network access to all hosts comprising the Eucalyptus cloud, and disabling unused applications and ports on all machines used in your cloud.</p><p>After installation, no local access to Eucalyptus component hosts is required for normal cloud operations and all normal cloud operations can be done over remote web service APIs.</p><p>The user-facing services (UFS) and object storage gateway (OSG) are the only two components that generally expect remote connections from end users. Each Eucalyptus component can be put behind a firewall following the list of open ports and connectivity requirements described in the <a href=https://www.eucastack.io/docs/admin_guide/security_section/security_tasks/configuring_iptables/>Configure the Firewall</a> section.</p><p>For more information on securing Red Hat hosts, see the <a href=https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/security_guide/index>Red Hat Enterprise Linux Security Guide</a> .</p></div><div class=td-content style=page-break-before:always><h1 id=pg-5676afb7c0aa1c817051295ff82d245b>2.6.2.3 - Images and Instances</h1><p>Because all instances are based on images, creating a secure image helps to create secure instances. This topic lists best practices that will add additional security during image creation. As a general rule, harden your images similar to how you would harden your physical servers.</p><ul><li>Turn off password-based authentication by specifying the following option in :</li><li>Encourage non-root access by providing an unprivileged user account. If necessary, use sudo to allow access to privileged commands</li><li>Always delete the shell history and any other potentially sensitive information before bundling. If you attempt more than one bundle upload in the same image, the shell history contains your secret access key.</li><li>Bundling a running instance requires your private key and X.509 certificate. Put these and other credentials in a location that is not bundled (e.g. when using , pass the folder location where the certificates are stored as part of the values for the option). AWS provides more in-depth information on .</li><li>Consider installing in the image to help control root and non-root access. If cloud-init isn&rsquo;t available, a custom script can be used.</li><li>Consider using a tool such as zerofree to zero-out any unused space on the image.</li><li>Consider editing to clear out the swap every time the instance is booted. This can be done using the following command:</li><li>Consider enabling or for your images</li><li>Disable all unused services and ports on the image.</li><li>By default, all images registered have private launch permissions. Consider using to limit the accounts that can access the image.
After locking down the image using the steps above, additional steps can be done to further secure instances started from that image. For example, restrict access to the instance by allowing only trusted hosts or networks to access ports on your instances. You can control access to instances using <code>euca-authorize</code> and <code>euca-revoke</code> .</li></ul><p>Consider creating one security group that allows external logins and keep the remainder of your instances in a group that does not allow external logins. Review the rules in your security groups regularly, and ensure that you apply the principle of least privilege: only open up permissions as they are required. Use different security groups to deal with instances that have different security requirements.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-116e73440d426e3c5ea9bef31359e1b5>2.6.2.4 - Management Console</h1><p>This topic describes things you can do to secure the Eucalyptus Management Console.</p><ul><li>Enable HTTPS for communications with the console and configure the console to use a CA-signed certificate.</li><li>We do not recommend the &ldquo;Remember my keys&rdquo; option for &ldquo;Login to AWS&rdquo; because it stores AWS credentials in your browser&rsquo;s local storage and increases the security risk of AWS credentials being compromised.</li><li>Change the default session timeouts if needed. For more information, see .</li><li>If you don&rsquo;t use the Management Console, we recommend that you disable (using ). For more information, see .</li><li>Turn off password autocomplete for the console by setting the configuration option to false in the console’s configuration file.</li><li>If memcached is configured to be used by the console, make sure it’s not exposed publicly because there is no authentication mechanism enabled out of the box. If the default Eucalyptus-provided configuration is used, it accepts connections only from localhost.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-8bf0377070c3313dea6e1ff81ee341ef>2.6.2.5 - Message Security</h1><p>This topic describes which networking mode is the most secure, and describes how to enforce message security.</p><h2 id=replay-detection>Replay Detection</h2><p>Eucalyptus components receive and exchange messages using either Query or SOAP interfaces (or both). Messages received over these interfaces are required to have a time stamp (as defined by AWS specification) to prevent message replay attacks. Because Eucalyptus enforces strict policies when checking timestamps in the received messages, for the correct functioning of the cloud infrastructure, it is crucial to have clocks constantly synchronized (for example, with ntpd) on all machines hosting Eucalyptus components. To prevent user commands failures, it is also important to have clocks synchronized on the client machines.</p><p>Following the AWS specification, all Query interface requests containing the Timestamp element are rejected as expired after 15 minutes of the timestamp. Requests containing the Expires element expire at the time specified by the element. SOAP interface requests using WS-Security expire as specified by the WS-Security Timestamp element.</p><p>Replay detection parameters can be tuned as described in <a href=https://www.eucastack.io/docs/admin_guide/security_section/security_tasks/security_task_replays/>Configure Replay Protection</a> .</p><h2 id=endpoints>Endpoints</h2><p>Eucalyptus requires that all user requests (SOAP with WS-Security and Query) are signed, and that their content is properly hashed, to ensure integrity and non-repudiation of messages. For stronger security, and to ensure message confidentiality and server authenticity, client tools and applications should always use SSL/TLS protocols with server certification verification enabled for communications with Eucalyptus components.</p><p>By default, Eucalyptus components are installed with self-signed certificates. For public Eucalyptus endpoints, certificates signed by a trusted CA provider should be installed.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-c47d035995b8048e6a740e8c3ee23f23>2.6.2.6 - Networking Modes</h1><p>This topic describes the recommendations for networking modes.A Eucalyptus deployment can be configured in EDGE (AWS EC2 Classic compatible) or VPCMIDO (AWS VPC compatible) networking modes. In both modes, by default, instances are not allowed to send traffic with spoofed IP and/or MAC addresses and receive traffic that are not destined to their own IP and/or MAC addresses. Security groups should be used to control the ingress traffic to instances (EDGE and VPCMIDO modes) and to control the egress traffic from instances (VPCMIDO mode).</p><p>VPCMIDO mode offers many security features not present in EDGE mode. Instances of different accounts are deployed in user-defined isolated networks within a Eucalyptus cloud. A combination of security features including VPC, VPC subnets, security groups, source/destination check configuration, route tables, internet gateways, and NAT gateways can be used to selectively enable and configure network access to/from instances or group of instances.</p><p>For more information about choosing a networking modes, see <a href=https://www.eucastack.io/docs/install_guide/eucalyptus/planning/planning_networking_modes/>Plan Networking Modes</a> .</p></div><div class=td-content style=page-break-before:always><h1 id=pg-13246c7b0d9bef36481bdf14a4cd5846>2.6.3 - Security Tasks</h1><h1 id=tasks>Tasks</h1><p>This section details the tasks needed to make your cloud secure.</p></div><div class=td-content><h1 id=pg-226e0bfa8b3c0ed408ce08527d014c08>2.6.3.1 - Configure SSL</h1><h1 id=configure-ssl>Configure SSL</h1><p>In order to connect to Eucalyptus using SSL, you must have a valid certificate for the User-Facing Services (UFS).</p></div><div class=td-content><h1 id=pg-dddbacba6d71acd887c93037013a80f0>2.6.3.1.1 - Configure and Enable SSL for the Management Console</h1><p>You can use secure HTTP for your console.To run your console over Secure HTTP:</p><p>Install nginx on your console server with the following command: <code>yum install nginx</code> Overwrite the default <code>nginx.conf</code> file with the template provided in <code>/usr/share/doc/eucaconsole-/nginx.conf.</code> <code>cp /usr/share/doc/eucaconsole-/nginx.conf /etc/nginx/nginx.conf</code> Uncomment the &rsquo;listen&rsquo; directive and uncomment/modify the SSL certificate paths in <code>/etc/nginx/nginx.conf</code> (search for &ldquo;SSL configuration&rdquo;). For example:</p><pre><code># SSL configuration
listen 443 ssl;
# ssl_certificate /path/to/ssl/pem_file;
# EXAMPLE:
ssl_certificate /etc/eucaconsole/console.crt;
# ssl_certificate_key /path/to/ssl/certificate_key;
# EXAMPLE: 
ssl_certificate_key /etc/eucaconsole/console.key;
# end of SSL configuration
</code></pre><p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>For more information on generating self-signed SSL certificates, go to .</div>Restart nginx using the following command: <code>systemctl restart nginx.service</code> Edit the <code>/etc/eucaconsole/console.ini</code> file, locate the <code>session.secure = false</code> parameter, change <code>false</code> to <code>true</code> , then add the <code>sslcert</code> and <code>sslkey</code> lines immediately following, per this example:</p><pre><code>session.secure = true
sslcert=/etc/eucaconsole/eucalyptus.com.chained.crt
sslkey=/etc/eucaconsole/eucalyptus.com.key
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-57fbe3724e7cedcae9c871e49b0c4ad9>2.6.3.1.2 - Configure and Enable SSL for the UFS</h1><p>This topic details tasks to configure SSL/TLS for the User-Facing Services (UFS)</p><p>If you have more than one host (other than node controllers), note the following:</p><ul><li>The keystore must be updated on each host running the eucalyptus-cloud service</li><li>The [key_alias] must be the same on each host</li><li>Use a wildcard certificate (i.e. *.&lt;system.dns.dnsdomain>), since UFS is responsible for all service API endpoints</li></ul><h2 id=create-a-keystore>Create a Keystore</h2><p>Eucalyptus uses a PKCS12-format keystore. If you are using a certificate signed by a trusted root CA, perform the following steps.</p><p>Enter the following command to convert your trusted certificate and key into an appropriate format:</p><pre><code>openssl pkcs12 -export -in [YOURCERT.crt] -inkey [YOURKEY.key] \
  -out tmp.p12 -name [key_alias]
</code></pre><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>The above command will request an export password, which is used in the following steps.</div><p>Save a backup of the Eucalyptus keystore, at <em>/var/lib/eucalyptus/keys/euca.p12</em> . Import your keystore into the Eucalyptus keystore on the UFS:</p><pre><code>keytool -importkeystore -srckeystore tmp.p12 -srcstoretype pkcs12 \
  -srcstorepass [export_password] -destkeystore /var/lib/eucalyptus/keys/euca.p12 \
  -deststoretype pkcs12 -deststorepass eucalyptus -alias [key_alias] -destkeypass eucalyptus
</code></pre><h2 id=enable-the-ufs-to-use-the-keystore>Enable the UFS to Use the Keystore</h2><p>To enable the UFS to use the keystore, perform the following steps in the CLC because the UFS gets all its configuration information from the CLC. Run the following commands on the CLC:</p><pre><code>euctl bootstrap.webservices.ssl.server_alias=[key_alias]
</code></pre><h2 id=optional-redirect-requests-to-use-port-443>Optional: Redirect Requests to use Port 443</h2><p>To allow user facing services requests on port 443 instead of the default 8773, run the following commands on the CLC:</p><pre><code>euctl bootstrap.webservices.port=443
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-f830b9392693b0e025f4e6bd3504f145>2.6.3.2 - Change Multicast Address</h1><p>This topic describes how to change your multicast address for group membership.By default, Eucalyptus uses the multicast address 239.193.7.3 for group membership. Most data centers limit multicast address communication for security measures. We recommend that you use addresses in the administratively-scoped multicast address range.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>As of Eucalyptus 4.3, the default multicast address changed from 228.7.7.3 to 239.193.7.3.</div></p><p><strong>To change the multicast address for group membership</strong> Stop all services, starting from the CC, SC, Walrus, then CLC. For example:</p><pre><code>systemctl stop eucalyptus-cluster.service
systemctl stop eucalyptus-cloud.service
</code></pre><p>Change the <em>eucalyptus.conf</em> on the CC, modifying the <code>CLOUD_OPTS</code> parameter to the new IP address:</p><pre><code>CLOUD_OPTS=&quot;--mcast-addr=228.7.7.3&quot;
</code></pre><p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>The above shows how to set the multicast address to a value compatible with releases prior to Eucalyptus 4.3.</div>Restart all services, starting from the CLC, Walrus, SC, CC. For example:</p><pre><code>systemctl start eucalyptus-cloud.service
systemctl start eucalyptus-cluster.service
</code></pre><p>Verify that the configured multicast address is being used via netstat:</p><pre><code>netstat -nulp
</code></pre><p><strong>Postrequisites</strong></p><ul><li>Check the firewall after changing the multicast address. See for more information.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-28a7fb3671e5a330f487e45ac93c2298>2.6.3.3 - Configure Replay Protection</h1><p>You can configure replay detection in Java components (which includes the CLC, UFS, OSG, Walrus, and SC) to allow replays of the same message for a set time period.</p><p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>To protect against replay attacks, the Java components cache messages only for 15 minutes. So it’s important that any client tools used to interact with the components have the Expires element set to a value less than 15 minutes from the current time. This is usually not an issue with standard tools, such as euca2ools and Amazon EC2 API Tools.</div>The Java components&rsquo; replay detection algorithm rejects messages with the same signatures received within 15 minutes. The time within which messages with the same signatures are accepted is controlled by the <code>bootstrap.webservices.replay_skew_window_sec</code> property. The default value of this property is 3 seconds. To change this value, enter the following command:</p><pre><code>euctl bootstrap.webservices.replay_skew_window_sec=[new_value_in_seconds]
</code></pre><p>If you set this property to <code>0</code> , Eucalyptus will not allow any message replays. This setting provides the best protection against message replay attacks.</p><p>If you set this property to any value greater than 15 minutes plus the values of ws.clock_skew_sec (that is, to a value >= 920 sec in the default installation), Eucalyptus disables replay detection completely.</p><p>When checking message timestamps for expiration, Eucalyptus allows up to 20 seconds of clock drift between the machines. This is a default setting. You can change this value for the Java components at runtime by setting the <code>bootstrap.webservices.clock_skew_sec</code> property as follows:</p><pre><code>euctl bootstrap.webservices.clock_skew_sec=[new_value_in_seconds]
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-5e82611da967775627cb729da5a91d5f>2.6.3.4 - Configure Session Timeouts</h1><p>To set the session timeouts in the Management Console:</p><p>Modify the <code>session.timeout</code> and <code>session.cookie_expires</code> entries in the <code>[app:main]</code> section of the configuration file. The <code>session.timeout</code> value defines the number of seconds before an idle session is timed out. The <code>session.cookie_expires</code> is the maximum length that any session can be active before being timed out. All values are in seconds:</p><pre><code>session.timeout=1800



session.cookie_expires=43200
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-1ba059d499956d167936d9424839cde6>2.6.3.5 - Configure STS Actions</h1><p>The Security Token Service (STS) allows you to enable or disable specific token actions.By default, the enabled actions list is empty. However, this means that all actions are enabled. To disable actions, list each action in the <code>disabledactions</code> property. To enable specific actions, list them in the <code>enabledactions</code> property.</p><pre><code># euctl tokens
PROPERTY	tokens.disabledactions	{}
PROPERTY	tokens.enabledactions	{}
</code></pre><p>The values for each property are case-insensitive, space or comma-separated lists of token service actions. If an action is in the disable list it will not be permitted. Eucalyptus returns an HTTP status 503 and the code <code>ServiceUnavailable</code> .</p><p>If the enable list is not empty, Eucalyptus only permits the actions specifically listed.</p><table><thead><tr><th style=text-align:left>Action</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left>AssumeRole</td><td style=text-align:left>Roles as per AWS/STS and Eucalyptus-specific personas admin functionality</td></tr><tr><td style=text-align:left>GetAccessToken</td><td style=text-align:left>Eucalyptus extension for password logins (for example, the Management Console)</td></tr><tr><td style=text-align:left>GetImpersonationToken</td><td style=text-align:left>Eucalyptus extension that allows cloud administrators to act as specific users</td></tr><tr><td style=text-align:left>GetSessionToken</td><td style=text-align:left>Session tokens in the sameas per AWS/STS</td></tr></tbody></table><p>For more information about STS, go to <a href=http://docs.aws.amazon.com/cli/latest/reference/sts/index.html>STS section of the AWS CLI Reference</a> .</p></div><div class=td-content style=page-break-before:always><h1 id=pg-6341f918a06a1cdf6c45dcb3a1658ec6>2.6.3.6 - Configure the Firewall</h1><h2 id=restricting-network-access>Restricting Network Access</h2><p>This section provides basic guidance on setting up a firewall around your Eucalyptus components. It is not intended to be exhaustive.</p><p>On the Cloud Controller (CLC), Walrus, and Storage Controller (SC), allow for the following jGroups traffic:</p><ul><li><p>TCP connections between CLC, user-facing services (UFS), object storage gateway (OSG), Walrus, and SC on port 8779 (or the first available port in range 8779-8849)</p></li><li><p>UDP connections between CLC, UFS, OSG, Walrus, and SC on port 7500</p></li><li><p>Multicast connections between CLC and UFS, OSG, Walrus, and SC to IP 239.193.7.3 on UDP port 8773
On the UFS, allow the following connections:</p></li><li><p>TCP connections from end-users and instances on ports 8773</p></li><li><p>End-user and instance connections to DNS ports
On the CLC, allow the following connections:</p></li><li><p>TCP connections from UFS, CC and Eucalyptus instances (public IPs) on port 8773 (for metadata service)</p></li><li><p>TCP connections from UFS, OSG, Walrus, and SC on port 8777
On the CC, make sure that all firewall rules are compatible with the dynamic changes performed by Eucalyptus, described in the section below. Also allow the following connections:</p></li><li><p>TCP connections from CLC on port 8774
On OSG, allow the following connections:</p></li><li><p>TCP connections from end-users and instances on port 8773</p></li><li><p>TCP connections from SC and NC on port 8773
On Walrus, allow the following connections:</p></li><li><p>TCP connections from OSG on port 8773
On the SC, allow the following connections:</p></li><li><p>TCP connections from CLC and NC on TCP port 8773</p></li><li><p>TCP connections from NC on TCP port 3260, if tgt (iSCSI open source target) is used for EBS in DAS or Overlay modes
On the NC, allow the following connections:</p></li><li><p>TCP connections from CC on port 8775</p></li><li><p>TCP connections from other NCs on port 16514</p></li><li><p>DHCP traffic forwarding to VMs</p></li><li><p>Traffic forwarding to and from instances&rsquo; private IP addresses</p></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-1f9a21e581772e0f82f0ef2c19c6a415>2.6.3.7 - Reserve Ports</h1><table><thead><tr><th style=text-align:left>Port</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left>TCP 5005</td><td style=text-align:left>DEBUG ONLY: This port is used for debugging (using the &ndash;debug flag).</td></tr><tr><td style=text-align:left>TCP 8772</td><td style=text-align:left>DEBUG ONLY: JMX port. This is disabled by default, and can be enabled with the &ndash;debug or &ndash;jmx options for CLOUD_OPTS.</td></tr><tr><td style=text-align:left>TCP 8773</td><td style=text-align:left>Web services port for the CLC, user-facing services (UFS), object storage gateway (OSG), Walrus SC; also used for external and internal communications by the CLC and Walrus. Configurable with euctl.</td></tr><tr><td style=text-align:left>TCP 8774</td><td style=text-align:left>Web services port on the CC. Configured in the eucalyptus.conf configuration file</td></tr><tr><td style=text-align:left>TCP 8775</td><td style=text-align:left>Web services port on the NC. Configured in the eucalyptus.conf configuration file.</td></tr><tr><td style=text-align:left>TCP 8777</td><td style=text-align:left>Database port on the CLC</td></tr><tr><td style=text-align:left>TCP 8779 (or next available port, up to TCP 8849)</td><td style=text-align:left>jGroups failure detection port on CLC, UFS, OSG, Walrus SC. If port 8779 is available, it will be used, otherwise, the next port in the range will be attempted until an unused port is found.</td></tr><tr><td style=text-align:left>TCP 8888</td><td style=text-align:left>The default port for the Management Console. Configured in the /etc/eucalyptus-console/console.ini file.</td></tr><tr><td style=text-align:left>TCP 16514</td><td style=text-align:left>TLS port on Node Controller, required for instance migrations</td></tr><tr><td style=text-align:left>UDP 7500</td><td style=text-align:left>Port for diagnostic probing on CLC, UFS, OSG, Walrus SC</td></tr><tr><td style=text-align:left>UDP 8773</td><td style=text-align:left>Membership port for any UFS, OSG, Walrus, and SC</td></tr><tr><td style=text-align:left>UDP 8778</td><td style=text-align:left>The bind port used to establish multicast communication</td></tr><tr><td style=text-align:left>TCP/UDP 53</td><td style=text-align:left>DNS port on UFS</td></tr><tr><td style=text-align:left>UDP 63822</td><td style=text-align:left>eucanetd binds to localhost port 63822 and uses it to detect and avoid running multiple instances (of eucanetd)</td></tr></tbody></table><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>For information about ports used by MidoNet, see the (Category OpenStack can be ignored).</div></div><div class=td-content style=page-break-before:always><h1 id=pg-5eed8aeffe499879dcbee977c2a48e2b>2.6.3.8 - Synchronize Components</h1><p>To synchronize your Eucalyptus component machines with an NTP server, perform the following tasks.</p><p>Enter the following command on a machine hosting a Eucalyptus component:</p><pre><code># ntpdate pool.ntp.org
# systemctl start ntpd.service
# systemctl enable ntpd.service
# ps ax | grep ntp
# hwclock --systohc  
</code></pre><p>Repeat for each machine hosting a Eucalyptus component.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-25d5c1581cfff916bab451388a3fd597>2.7 - Eucalyptus Commands</h1><h1 id=eucalyptus-commands>Eucalyptus Commands</h1><p>This section contains reference information for Eucalyptus administration commands.</p></div><div class=td-content><h1 id=pg-6969b7b3f9e92cd651d22c179842083b>2.7.1 - Eucalyptus Administration Commands</h1><h1 id=eucalyptus-administration-commands>Eucalyptus Administration Commands</h1><p>Eucalyptus offers commands for common administration tasks and inquiries. This section provides a reference for these commands.</p></div><div class=td-content><h1 id=pg-a2d37d4166ce932546080639f12d8306>2.7.1.1 - euctl</h1><h2 id=syntax>Syntax</h2><pre><code>euctl [-Anr] [-d | -s] NAME ...
euctl [-nq] NAME=VALUE ...
euctl [-nq] NAME=@FILE ...
euctl --dump [--format {raw,json,yaml}] NAME
euctl --edit [--format {raw,json,yaml}] NAME
</code></pre><h2 id=positional-arguments>Positional Arguments</h2><table><thead><tr><th style=text-align:left>Argument</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left>NAME</td><td style=text-align:left>Output a variable&rsquo;s value.</td></tr><tr><td style=text-align:left>NAME=VALUE</td><td style=text-align:left>Set a variable to the specified value and then output it.</td></tr><tr><td style=text-align:left>NAME=@FILE</td><td style=text-align:left>Set a variable to that of the specified file&rsquo;s contents, then output it.</td></tr></tbody></table><h2 id=options>Options</h2><table><thead><tr><th style=text-align:left>Option</th><th style=text-align:left>Description</th><th style=text-align:left>Required</th></tr></thead><tbody><tr><td style=text-align:left>-A, &ndash;all-types</td><td style=text-align:left>List all the known variable names, including structures. Those with string or integer values will be output as usual; for the structured values, the methods of retrieving them are given.</td><td style=text-align:left>No</td></tr><tr><td style=text-align:left>-d</td><td style=text-align:left>Output variables&rsquo; default values rather than their current values. Note that not all variables have default values.</td><td style=text-align:left>No</td></tr><tr><td style=text-align:left>-s</td><td style=text-align:left>Show variables&rsquo; descriptions instead of their current values.</td><td style=text-align:left>No</td></tr><tr><td style=text-align:left>-n</td><td style=text-align:left>Suppress output of the variable name. This is useful for setting shell variables.</td><td style=text-align:left>No</td></tr><tr><td style=text-align:left>-q</td><td style=text-align:left>Suppress all output when setting a variable. This option overrides the behavior of the -n parameter.</td><td style=text-align:left>No</td></tr><tr><td style=text-align:left>-r, &ndash;reset</td><td style=text-align:left>Reset the given variables to their default values.</td><td style=text-align:left>No</td></tr><tr><td style=text-align:left>&ndash;dump</td><td style=text-align:left>Output the value of a structured variable in its entirety. The value will be formatted in the manner specified by the &ndash;format option.</td><td style=text-align:left>No</td></tr><tr><td style=text-align:left>&ndash;edit</td><td style=text-align:left>Edit the value of a structure variable interactively. The value will be formatted in the manner specified by the &ndash;format option. Only one variable may be edited per invocation. When looking for an editor, the program will first try the environment variable VISUAL, then the environment variable EDITOR, and finally the default editor, vi.</td><td style=text-align:left>No</td></tr><tr><td style=text-align:left>&ndash;format {raw,json,yaml}</td><td style=text-align:left>Use the specified format when displaying a structured variable.Valid values: raw</td><td style=text-align:left>json</td></tr></tbody></table><h2 id=examples>Examples</h2><p>When retrieving a variable, a subset of the MIB name may be specified to retrieve a list of variables in that subset. For example, to list all the dns variables:</p><pre><code>euctl dns
</code></pre><p>This replaces <code>euca-describe-properties</code> .</p><p>When setting a variable, the MIB name should be followed by an equal sign and the new value:</p><pre><code>euctl dns.enabled=true
</code></pre><p>This replaces <code>euca-modify-property -p</code> .</p><p>To write variables using the contents of the files as their new values rather than typing them into the command line, follow them with <code>=@</code> and those file names:</p><pre><code>euctl cloud.network.network_configuration=@/etc/eucalyptus/network.yaml
</code></pre><p>This replaces <code>euca-modify-property -f</code> .</p><p>Specify a filename to read the values from a file:</p><pre><code>myproperty=@myvaluefile
</code></pre><p>It is possible to read or write more than one variable in a single invocation of <code>euctl</code> . Just separate them with spaces:</p><pre><code>euctl one=1 two=2 three four=@4.txt five
</code></pre><p>In all of these cases, <code>euctl</code> will generally output each variable named on its command line, along with its current (and potentially just-changed) value. For example, the output of the command above could be:</p><pre><code>one = 1 
two = 2
three = 3
four = 4
five = 5
</code></pre><p>To reset a variable to its default value, specify the -r option:</p><pre><code>euctl -r dns.enabled
</code></pre><p>The information available from euctl consists of integers, strings, and structures. The structured information can only be retrieved by specialized programs and, in some cases, this program&rsquo;s <code>--edit</code> and <code>--dump</code> options.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Refer to this command&rsquo;s manpage for a complete list of environment variables, options, and outputs.</div></div><div class=td-content style=page-break-before:always><h1 id=pg-8cf7f7238ebe61a58f5ac8ed855fb652>2.7.1.2 - euserv-deregister-service</h1><h2 id=syntax>Syntax</h2><pre><code>euserv-deregister-service [-U URL] [--region USER@REGION] [-I KEY_ID]

       [-S KEY] [--security-token TOKEN] [--debug]
              [--debugger] [--version] [-h] SVCINSTANCE
</code></pre><h2 id=positional-arguments>Positional Arguments</h2><table><thead><tr><th style=text-align:left>Argument</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left>SVCINSTANCE</td><td style=text-align:left>Name of the service instance to de-register.</td></tr></tbody></table><h2 id=output>Output</h2><p>Eucalyptus returns a message stating that service instance was successfully de-registered.</p><h2 id=example>Example</h2><p>To de-register the dns service named &ldquo;API_10.111.1.44.dns&rdquo;:</p><pre><code>euserv-deregister-service API_10.111.1.44.dns
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-a5bfbddcc33a3bc8eaefea7da24ef443>2.7.1.3 - euserv-describe-events</h1><h2 id=syntax>Syntax</h2><pre><code>euserv-describe-events [-s] [-f FORMAT]
</code></pre><h2 id=description>Description</h2><p>Events come in the form of a list, where each event contains one or more of the following tags:</p><table><thead><tr><th style=text-align:left>Tag</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left>id</td><td style=text-align:left>A unique ID for the event.</td></tr><tr><td style=text-align:left>message</td><td style=text-align:left>A free-form text description of the event.</td></tr><tr><td style=text-align:left>severity</td><td style=text-align:left>The message&rsquo;s severity (FATAL, URGENT, ERROR, WARNING, INFO, DEBUG, TRACE).</td></tr><tr><td style=text-align:left>stack-trace</td><td style=text-align:left>The stack trace, if any, corresponding to the event. The -s option is required to make this appear.</td></tr><tr><td style=text-align:left>subject-arn</td><td style=text-align:left>The Eucalyptus ARN of the service affected by the event.</td></tr><tr><td style=text-align:left>subject-name</td><td style=text-align:left>The name of the service affected by the event.</td></tr><tr><td style=text-align:left>subject-type</td><td style=text-align:left>The type of service affected by the event.</td></tr><tr><td style=text-align:left>timestamp</td><td style=text-align:left>The date and time of the event&rsquo;s creation.</td></tr></tbody></table><h2 id=environment>Environment</h2><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>The command requires access keys and knowledge of where to locate the web services it needs to contact. It can obtain these from several locations.</div><table><thead><tr><th style=text-align:left>Environment</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left>AWS_ACCESS_KEY_ID</td><td style=text-align:left>The access key ID to use when authenticating web service requests. This takes precedence over and euca2ools.ini, but not -I.</td></tr><tr><td style=text-align:left>AWS_SECRET_ACCESS_KEY</td><td style=text-align:left>The secret key to use when authenticating web service requests. This takes precedence over &ndash;region and euca2ools.ini(5), but not -S.</td></tr><tr><td style=text-align:left>EUCA_BOOTSTRAP_URL</td><td style=text-align:left>The URL of the service to contact. This takes precedence over &ndash;region and euca2ools.ini, but not -U.</td></tr></tbody></table><h2 id=options>Options</h2><table><thead><tr><th style=text-align:left>Option</th><th style=text-align:left>Description</th><th style=text-align:left>Required</th></tr></thead><tbody><tr><td style=text-align:left>-f, &ndash;format format</td><td style=text-align:left>Print events in a given format, where format can be: yaml or oneline, and format:string. See for details about each format. When omitted, the format defaults to yaml.<a href></a></td><td style=text-align:left>No</td></tr><tr><td style=text-align:left>-s, &ndash;show-stack-traces</td><td style=text-align:left>Include the stack-trace tag in events&rsquo; data. This is omitted by default due to its length.</td><td style=text-align:left>No</td></tr></tbody></table><h2 id=output>Output</h2><p>There are several built-in formats, and you can define additional formats using a format: <em>string</em> , as described below. Here are the details of the built-in formats:</p><p>yaml
This outputs block-style YAML designed to be easily readable. Tags that are empty or not defined do not appear in this output at all.</p><pre><code>events:
            - timestamp: {timestamp}
            severity: {severity}
            id: {id}
            subject-type: {subject-type}
            subject-name: {subject-name}
            subject-host: {subject-host}
            subject-arn: {subject-arn}
            message: |-
            {message}
            stack-trace: |-
            {stack-trace}
</code></pre><p>oneline
This output is designed to be as compact as possible.</p><pre><code>{timestamp} {severity} {subject-type} {subject-name} {message}
</code></pre><p>format:string
The <code>format:</code> <em>string</em> format allows you to specify which information you want to show using placeholders enclosed in curly braces to indicate where to show the tags for each event. For example:</p><pre><code>euserv-describe-events -f &quot;format:{timestamp} {subject-name} {message}&quot;
</code></pre><h2 id=example>Example</h2><p>To output a list of service-affecting events in the <code>oneline</code> format:</p><pre><code>euserv-describe-events --format oneline
2016-06-20 16:16:08 INFO node 10.111.1.15 the node is operating normally\nFound service status for 10.111.1.15: ENABLED
2016-06-27 17:37:57 ERROR node 10.111.5.50 Error occurred in transport
2016-06-28 07:00:17 ERROR node 10.111.5.50
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-c70f153ba84a6618f2f703140174aadd>2.7.1.4 - euserv-describe-node-controllers</h1><h2 id=syntax>Syntax</h2><pre><code>euserv-describe-node-controllers [--ec2-url URL] [--show-headers]

   [--show-empty-fields] [-U URL]
          [--region USER@REGION] [-I KEY_ID]  [-S  KEY]  [--security-token
          TOKEN] [--debug] [--debugger] [--version] [-h]
</code></pre><h2 id=options>Options</h2><table><thead><tr><th style=text-align:left>Option</th><th style=text-align:left>Description</th><th style=text-align:left>Required</th></tr></thead><tbody><tr><td style=text-align:left>&ndash;ec2-url url</td><td style=text-align:left>The compute service&rsquo;s endpoint URL.</td><td style=text-align:left>No</td></tr><tr><td style=text-align:left>&ndash;show-headers</td><td style=text-align:left>Show column headers.</td><td style=text-align:left>No</td></tr></tbody></table><h2 id=output>Output</h2><p>Eucalyptus returns information about the node controller and its instances, for example:</p><pre><code>NODE  one  10.111.1.53  enabled    
INSTANCE  i-162a8f09      
INSTANCE  i-2b6cdd10      
NODE  one  10.111.5.132  enabled    
INSTANCE  i-ba9307d7
</code></pre><h2 id=example>Example</h2><pre><code>euserv-describe-node-controllers --region localhost
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-e9a48048918ffaf831fb098b1d60207c>2.7.1.5 - euserv-describe-service-types</h1><h2 id=syntax>Syntax</h2><pre><code>euserv-describe-service-types [-a] [--show-headers]

[--show-empty-fields] [-U URL]
   [--region  USER@REGION]  [-I  KEY_ID]  [-S  KEY] [--security-token TOKEN]
   [--debug] [--debugger] [--version] [-h]
</code></pre><h2 id=options>Options</h2><table><thead><tr><th style=text-align:left>Option</th><th style=text-align:left>Description</th><th style=text-align:left>Required</th></tr></thead><tbody><tr><td style=text-align:left>-a, &ndash;all</td><td style=text-align:left>Show all service types regardless of their properties.</td><td style=text-align:left>No</td></tr><tr><td style=text-align:left>&ndash;show-headers</td><td style=text-align:left>Show column headers.</td><td style=text-align:left>No</td></tr></tbody></table><h2 id=output>Output</h2><p>Eucalyptus returns a list of service types.</p><h2 id=example>Example</h2><pre><code>euserv-describe-service-types 
SVCTYPE  arbitrator                The Arbitrator service                                      
SVCTYPE  autoscaling     user-api  Auto Scaling API service                                    
SVCTYPE  cloudformation  user-api  Cloudformation API service                                  
SVCTYPE  cloudwatch      user-api  CloudWatch API service                                      
SVCTYPE  cluster                   The Cluster Controller service                              
SVCTYPE  compute         user-api  the Eucalyptus EC2 API service                              
SVCTYPE  dns             user-api  Eucalyptus DNS server                                       
SVCTYPE  euare           user-api  IAM API service                                             
SVCTYPE  eucalyptus                eucalyptus service implementation                           
SVCTYPE  identity        user-api  Eucalyptus identity service                                 
SVCTYPE  imaging         user-api  Eucalyptus imaging service                                  
SVCTYPE  loadbalancing   user-api  ELB API service                                             
SVCTYPE  objectstorage   user-api  S3 API service                                              
SVCTYPE  simpleworkflow  user-api  Simple Workflow API service                                 
SVCTYPE  storage                   The Storage Controller service                              
SVCTYPE  tokens          user-api  STS API service                                             
SVCTYPE  user-api                  The service group of all user-facing API endpoint services  
SVCTYPE  walrusbackend             The legacy Walrus Backend service
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-d778cb3b0aaf9315d3e4d21e5a17faf5>2.7.1.6 - euserv-describe-services</h1><h2 id=syntax>Syntax</h2><pre><code>euserv-describe-services [-a]

       [--group-by-type | --group-by-zone | --group-by-host | --expert]
         [--show-headers]   [--show-empty-fields]   [-U   URL]  [--region
         USER@REGION]  [-I  KEY_ID]  [-S  KEY]  [--security-token  TOKEN]
         [--filter  NAME=VALUE]  [--debug]  [--debugger] [--version] [-h]
         [SVCINSTANCE [SVCINSTANCE ...]]
</code></pre><h2 id=positional-arguments>Positional Arguments</h2><table><thead><tr><th style=text-align:left>Argument</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left>SVCINSTANCE</td><td style=text-align:left>Limit results to specific instances of services.</td></tr></tbody></table><h2 id=options>Options</h2><table><thead><tr><th style=text-align:left>Option</th><th style=text-align:left>Description</th><th style=text-align:left>Required</th></tr></thead><tbody><tr><td style=text-align:left>-a, &ndash;all</td><td style=text-align:left>Show all services regardless of type.</td><td style=text-align:left>No</td></tr><tr><td style=text-align:left>&ndash;group-by-type</td><td style=text-align:left>Collate services by service type (default).</td><td style=text-align:left>No</td></tr><tr><td style=text-align:left>&ndash;group-by-zone</td><td style=text-align:left>Collate services by availability zone.</td><td style=text-align:left>No</td></tr><tr><td style=text-align:left>&ndash;group-by-host</td><td style=text-align:left>Collate services by host.</td><td style=text-align:left>No</td></tr><tr><td style=text-align:left>&ndash;expert</td><td style=text-align:left>Show advanced information, including service accounts.</td><td style=text-align:left>No</td></tr><tr><td style=text-align:left>&ndash;show-headers</td><td style=text-align:left>Show column headers.</td><td style=text-align:left>No</td></tr><tr><td style=text-align:left>&ndash;filter name=value</td><td style=text-align:left>Restrict results to those that meet criteria. Allowed filter names: availability-zone. The service&rsquo;s availability zone.host. The machine running the service.internal. Whether the service is used only internally (true or false).public. Whether the service is public (true or false).service-group. Whether the service is a member of a specific service group.service-group-member. Whether the service is a member of any service group (true or false).service-type. The type of service.state. The service&rsquo;s state.</td><td style=text-align:left>No</td></tr></tbody></table><h2 id=output>Output</h2><p>Eucalyptus returns information about the services you specified.</p><h2 id=example>Example</h2><p>Verify that you are looking at the cloud controllers view of the service state by explicitly running against that host:</p><pre><code>euserv-describe-services --filter service-type=storage -U http://localhost:8773/services/Empyrean
SERVICE  storage  one  one-sc-1  enabled
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-f36f17e872bf9ed38edd86c023d9cbe8>2.7.1.7 - euserv-migrate-instances</h1><h2 id=syntax>Syntax</h2><pre><code>euserv-migrate-instances (-s HOST | -i INSTANCE)

  [--include-dest HOST | --exclude-dest HOST]
  [-U URL] [--region USER@REGION] [-I KEY_ID]  [-S  KEY]  [--security-token
  TOKEN] [--debug] [--debugger] [--version] [-h]
</code></pre><h2 id=options>Options</h2><table><thead><tr><th style=text-align:left>Option</th><th style=text-align:left>Description</th><th style=text-align:left>Required</th></tr></thead><tbody><tr><td style=text-align:left>-s, &ndash;source host</td><td style=text-align:left>Remove all instances from a specific host.</td><td style=text-align:left>No</td></tr><tr><td style=text-align:left>-i, &ndash;instance instance</td><td style=text-align:left>Remove one instance from its current host.</td><td style=text-align:left>No</td></tr><tr><td style=text-align:left>&ndash;include-dest host</td><td style=text-align:left>Allow migration to only a specific host (may be used more than once).</td><td style=text-align:left>No</td></tr><tr><td style=text-align:left>&ndash;exclude-dest host</td><td style=text-align:left>Allow migration to any host except a specific one (may be used more than once).</td><td style=text-align:left>No</td></tr></tbody></table><h2 id=output>Output</h2><p>Unless requested, no output is given. You can run the <code>euserv-describe-*</code> command to verify that the migration activity completed successfully, as shown in the example following.</p><h2 id=example>Example</h2><p>To migrate an instance from its current host:</p><pre><code>euserv-migrate-instances -i i-8eacd211 
euserv-describe-node-controllers 
NODE  zone-555  10.104.1.200  enabled    

NODE  zone-555  10.104.1.201  enabled    
INSTANCE  i-8eacd211      
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-5337787a5abaab70a9ea99454b1aa3eb>2.7.1.8 - euserv-modify-service</h1><h2 id=syntax>Syntax</h2><pre><code>euserv-modify-service -s STATE [-U URL] [--region USER@REGION]

   [-I KEY_ID] [-S KEY] [--security-token TOKEN]
   [--debug] [--debugger] [--version] [-h] SVCINSTANCE
</code></pre><h2 id=positional-arguments>Positional Arguments</h2><table><thead><tr><th style=text-align:left>Argument</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left>SVCINSTANCE</td><td style=text-align:left>The name of the service instance to modify.</td></tr></tbody></table><h2 id=options>Options</h2><table><thead><tr><th style=text-align:left>Option</th><th style=text-align:left>Description</th><th style=text-align:left>Required</th></tr></thead><tbody><tr><td style=text-align:left>-s, &ndash;state state</td><td style=text-align:left>The state to change to.</td><td style=text-align:left>Yes</td></tr></tbody></table><h2 id=output>Output</h2><p>No output is given. You can run the <code>euserv-describe-services</code> command to verify that the modification completed successfully, as shown in the example following.</p><h2 id=example>Example</h2><p>To modify the state of a storage controller service named &ldquo;two-sc-1&rdquo; to stopped:</p><pre><code>euserv-modify-service -s stopped two-sc-1
euserv-describe-services two-sc-1
SERVICE  storage  two  two-sc-1  stopped  
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-c5b48c310af33cd72b92785cce136c58>2.7.1.9 - euserv-register-service</h1><h2 id=syntax>Syntax</h2><pre><code>euserv-register-service -t TYPE -h IP [--port PORT] [-z ZONE] [-U URL]

       [--region USER@REGION] [-I KEY_ID] [-S KEY]
           [--security-token   TOKEN]  [--debug]  [--debugger]  [--version]
           [--help] SVCINSTANCE
</code></pre><h2 id=positional-arguments>Positional Arguments</h2><table><thead><tr><th style=text-align:left>Argument</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left>SVCINSTANCE</td><td style=text-align:left>The name of the new service instance to register.</td></tr></tbody></table><h2 id=options>Options</h2><table><thead><tr><th style=text-align:left>Option</th><th style=text-align:left>Description</th><th style=text-align:left>Required</th></tr></thead><tbody><tr><td style=text-align:left>-t, &ndash;type type</td><td style=text-align:left>The new service instance&rsquo;s type.</td><td style=text-align:left>Yes</td></tr><tr><td style=text-align:left>-h, &ndash;host IP</td><td style=text-align:left>The host on which the new instance of the service runs.</td><td style=text-align:left>Yes</td></tr><tr><td style=text-align:left>&ndash;port port</td><td style=text-align:left>The port on which the new instance of the service runs (default for cluster: 8774, otherwise: 8773).</td><td style=text-align:left>No</td></tr><tr><td style=text-align:left>-z, &ndash;availability-zone zone</td><td style=text-align:left>The availability zone in which to register the new service instance. This is required only for services of certain types.</td><td style=text-align:left>Conditional</td></tr></tbody></table><h2 id=output>Output</h2><p>No output is given when it succeeds.</p><h2 id=example>Example</h2><p>To register the ufs service named &ldquo;user-api-5&rdquo;:</p><pre><code>euserv-register-service -t user-api -h 10.0.0.15 user-api-5
</code></pre><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>A prerequisite for this command is to have the credentials in the shell you are running the register command. For example:</div></div><div class=td-content style=page-break-before:always><h1 id=pg-5c036c1422f881139c085dfb36899de3>2.7.2 - Eucalyptus Configuration Variables</h1><p>Eucalyptus exposes a number of variables that can be configured using the command. This topic explains what types of variables Eucalyptus uses, and lists the most common configurable variables.</p><h2 id=eucalyptus-variable-types>Eucalyptus Variable Types</h2><p>Eucalyptus uses two types of variables: ones that can be changed (as configuration options), and ones that cannot be changed (they are displayed as variables, but configured by modifying the <code>eucalyptus.conf</code> file on the CC).</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Once a cloud is in use and has started operating based on these variables, it is not safe to change them at runtime.</div><h2 id=eucalyptus-variables>Eucalyptus Variables</h2><p>The following table contains a list of common Eucalyptus cloud variables.</p><table><thead><tr><th style=text-align:left>Variable</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left>authentication.access_keys_limit</td><td style=text-align:left>Limit for access keys per user</td></tr><tr><td style=text-align:left>authentication.authorization_cache</td><td style=text-align:left>Authorization cache configuration, for credentials and authorization metadata</td></tr><tr><td style=text-align:left>authentication.authorization_expiry</td><td style=text-align:left>Default expiry for cached authorization metadata</td></tr><tr><td style=text-align:left>authentication.authorization_reuse_expiry</td><td style=text-align:left>Default expiry for re-use of cached authorization metadata on failure</td></tr><tr><td style=text-align:left>authentication.credential_download_generate_certificate</td><td style=text-align:left>Strategy for generation of certificates on credential download (Never</td></tr><tr><td style=text-align:left>authentication.credential_download_host_match</td><td style=text-align:left>CIDR to match against for host address selection</td></tr><tr><td style=text-align:left>authentication.credential_download_port</td><td style=text-align:left>Port to use in service URLs when &lsquo;bootstrap.webservices.port&rsquo; is not appropriate.</td></tr><tr><td style=text-align:left>authentication.default_password_expiry</td><td style=text-align:left>Default password expiry time</td></tr><tr><td style=text-align:left>authentication.max_policy_attachments</td><td style=text-align:left>Maximum number of attached managed policies</td></tr><tr><td style=text-align:left>authentication.max_policy_size</td><td style=text-align:left>Maximum size for an IAM policy (bytes)</td></tr><tr><td style=text-align:left>authentication.signing_certificates_limit</td><td style=text-align:left>Limit for signing certificates per user</td></tr><tr><td style=text-align:left>authentication.system_account_quota_enabled</td><td style=text-align:left>Process quotas for system accounts</td></tr><tr><td style=text-align:left>autoscaling.activityexpiry</td><td style=text-align:left>Expiry age for scaling activities. Older activities are deleted.</td></tr><tr><td style=text-align:left>autoscaling.activityinitialbackoff</td><td style=text-align:left>Initial back-off period for failing activities.</td></tr><tr><td style=text-align:left>autoscaling.activitymaxbackoff</td><td style=text-align:left>Maximum back-off period for failing activities.</td></tr><tr><td style=text-align:left>autoscaling.activitytimeout</td><td style=text-align:left>Timeout for a scaling activity.</td></tr><tr><td style=text-align:left>autoscaling.maxlaunchincrement</td><td style=text-align:left>Maximum instances to launch at one time.</td></tr><tr><td style=text-align:left>autoscaling.maxregistrationretries</td><td style=text-align:left>Number of times to attempt load balancer registration for each instance.</td></tr><tr><td style=text-align:left>autoscaling.maxtags</td><td style=text-align:left>Maximum number of user defined tags for a group</td></tr><tr><td style=text-align:left>autoscaling.pendinginstancetimeout</td><td style=text-align:left>Timeout for a pending instance.</td></tr><tr><td style=text-align:left>autoscaling.suspendedprocesses</td><td style=text-align:left>Globally suspend scaling processes; a comma-delimited list of processes (Launch,Terminate,HealthCheck, ReplaceUnhealthy,AZRebalance, AlarmNotification,ScheduledActions, AddToLoadBalancer). Default is empty, meaning the processes are not suspended.</td></tr><tr><td style=text-align:left>autoscaling.suspendedtasks</td><td style=text-align:left>Suspended scaling tasks.</td></tr><tr><td style=text-align:left>autoscaling.suspensionlaunchattemptsthreshold</td><td style=text-align:left>Minimum launch attempts for administrative suspension of scaling activities for a group.</td></tr><tr><td style=text-align:left>autoscaling.suspensiontimeout</td><td style=text-align:left>Timeout for administrative suspension of scaling activities for a group.</td></tr><tr><td style=text-align:left>autoscaling.untrackedinstancetimeout</td><td style=text-align:left>Timeout for termination of untracked auto scaling instances.</td></tr><tr><td style=text-align:left>autoscaling.zonefailurethreshold</td><td style=text-align:left>Time after which an unavailable zone should be treated as failed</td></tr><tr><td style=text-align:left>bootstrap.async.future_listener_debug_limit_secs</td><td style=text-align:left>Number of seconds a future listener can execute before a debug message is logged.</td></tr><tr><td style=text-align:left>bootstrap.async.future_listener_error_limit_secs</td><td style=text-align:left>Number of seconds a future listener can execute before an error message is logged.</td></tr><tr><td style=text-align:left>bootstrap.async.future_listener_get_retries</td><td style=text-align:left>Total number of seconds a future listener&rsquo;s executor waits to get().</td></tr><tr><td style=text-align:left>bootstrap.async.future_listener_get_timeout</td><td style=text-align:left>Number of seconds a future listener&rsquo;s executor waits to get() per call.</td></tr><tr><td style=text-align:left>bootstrap.async.future_listener_info_limit_secs</td><td style=text-align:left>Number of seconds a future listener can execute before an info message is logged.</td></tr><tr><td style=text-align:left>bootstrap.hosts.state_initialize_timeout</td><td style=text-align:left>Timeout for state initialization (in msec).</td></tr><tr><td style=text-align:left>bootstrap.hosts.state_transfer_timeout</td><td style=text-align:left>Timeout for state transfers (in msec).</td></tr><tr><td style=text-align:left>bootstrap.notifications.batch_delay_seconds</td><td style=text-align:left>Interval (in seconds) during which a notification will be delayed to allow for batching events for delivery.</td></tr><tr><td style=text-align:left>bootstrap.notifications.digest</td><td style=text-align:left>Send a system state digest periodically.</td></tr><tr><td style=text-align:left>bootstrap.notifications.digest_frequency_hours</td><td style=text-align:left>Period (in hours) with which a system state digest will be delivered.</td></tr><tr><td style=text-align:left>bootstrap.notifications.digest_only_on_errors</td><td style=text-align:left>If sending system state digests is set to true, then only send the digest when the system has failures to report.</td></tr><tr><td style=text-align:left>bootstrap.notifications.digest_frequency_hours</td><td style=text-align:left>Period (in hours) with which a system state digest will be delivered.</td></tr><tr><td style=text-align:left>bootstrap.notifications.digest_only_on_errors</td><td style=text-align:left>If sending system state digests is set to true, then only send the digest when the system has failures to report.</td></tr><tr><td style=text-align:left>bootstrap.notifications.email_from</td><td style=text-align:left>From email address used for notification delivery.</td></tr><tr><td style=text-align:left>bootstrap.notifications.email_from_name</td><td style=text-align:left>From email name used for notification delivery.</td></tr><tr><td style=text-align:left>bootstrap.notifications.email_from_name</td><td style=text-align:left>From email name used for notification delivery.</td></tr><tr><td style=text-align:left>bootstrap.notifications.email_subject_prefix</td><td style=text-align:left>Email subject used for notification delivery.</td></tr><tr><td style=text-align:left>bootstrap.notifications.email_to</td><td style=text-align:left>Email address where notifications are to be delivered.</td></tr><tr><td style=text-align:left>bootstrap.notifications.include_fault_stack</td><td style=text-align:left>Period (in hours) with which a system state digest will be delivered.</td></tr><tr><td style=text-align:left>bootstrap.notifications.email.email_smtp_host</td><td style=text-align:left>SMTP host to use when sending email. If unset, the following values are tried: 1) the value of the &lsquo;mail.smtp.host&rsquo; system variable, 2) localhost, 3) mailhost.</td></tr><tr><td style=text-align:left>bootstrap.notifications.email.email_smtp_port</td><td style=text-align:left>SMTP port to use when sending email. Defaults to 25</td></tr><tr><td style=text-align:left>bootstrap.servicebus.common_thread_pool_size</td><td style=text-align:left>Default thread pool for component message processing. When the size of the common thread pool is zero or less, Eucalyptus uses separate thread pools for each component and a pool for dispatching. Default size = 256 threads.</td></tr><tr><td style=text-align:left>bootstrap.servicebus.component_thread_pool_size</td><td style=text-align:left>Used when the size of the common thread pool is zero or less. Default size = 64 threads.</td></tr><tr><td style=text-align:left>bootstrap.servicebus.context_message_log_whitelist</td><td style=text-align:left>Message patterns to match for logging. Allows selective message logging at INFO level. A list of wildcards that allows selective logging for development or troubleshooting (e.g., on request/response, on a package, on a component). Logging can impact security; do not use as a general purpose logging feature.</td></tr><tr><td style=text-align:left>bootstrap.servicebus.context_timeout</td><td style=text-align:left>Message context timeout in seconds. Default = 60 seconds.</td></tr><tr><td style=text-align:left>bootstrap.servicebus.dispatch_thread_pool_size</td><td style=text-align:left>Used when the size of the common thread pool is zero or less. Default size = 256 threads.</td></tr><tr><td style=text-align:left>bootstrap.servicebus.hup</td><td style=text-align:left>Do a soft reset. Default = 0 (false).</td></tr><tr><td style=text-align:left>bootstrap.timer.rate</td><td style=text-align:left>Amount of time (in milliseconds) before a previously running instance which is not reported will be marked as terminated.</td></tr><tr><td style=text-align:left>bootstrap.topology.coordinator_check_backoff_secs</td><td style=text-align:left>Backoff between service state checks (in seconds).</td></tr><tr><td style=text-align:left>bootstrap.topology.local_check_backoff_secs</td><td style=text-align:left>Backoff between service state checks (in seconds).</td></tr><tr><td style=text-align:left>bootstrap.tx.concurrent_update_retries</td><td style=text-align:left>Maximum number of times a transaction may be retried before giving up.</td></tr><tr><td style=text-align:left>bootstrap.webservices.async_internal_operations</td><td style=text-align:left>Execute internal service operations from a separate thread pool (with respect to I/O).</td></tr><tr><td style=text-align:left>bootstrap.webservices.async_operations</td><td style=text-align:left>Execute service operations from a separate thread pool (with respect to I/O).</td></tr><tr><td style=text-align:left>bootstrap.webservices.async_pipeline</td><td style=text-align:left>Execute service specific pipeline handlers from a separate thread pool (with respect to I/O).</td></tr><tr><td style=text-align:left>bootstrap.webservices.channel_connect_timeout</td><td style=text-align:left>Channel connect timeout (ms).</td></tr><tr><td style=text-align:left>bootstrap.webservices.channel_keep_alive</td><td style=text-align:left>Socket keep alive.</td></tr><tr><td style=text-align:left>bootstrap.webservices.channel_nodelay</td><td style=text-align:left>Server socket TCP_NODELAY.</td></tr><tr><td style=text-align:left>bootstrap.webservices.channel_reuse_address</td><td style=text-align:left>Socket reuse address.</td></tr><tr><td style=text-align:left>bootstrap.webservices.client_http_chunk_buffer_max</td><td style=text-align:left>Server http chunk max.</td></tr><tr><td style=text-align:left>bootstrap.webservices.client_http_pool_acquire_timeout</td><td style=text-align:left>Client http pool acquire timeout</td></tr><tr><td style=text-align:left>bootstrap.webservices.client_internal_connect_timeout_millis</td><td style=text-align:left>Client connection timeout (ms)</td></tr><tr><td style=text-align:left>bootstrap.webservices.client_internal_hmac_signature_enabled</td><td style=text-align:left>Client HMAC signature version 4 enabled</td></tr><tr><td style=text-align:left>bootstrap.webservices.client_internal_timeout_secs</td><td style=text-align:left>Client idle timeout (secs).</td></tr><tr><td style=text-align:left>bootstrap.webservices.client_message_log_whitelist</td><td style=text-align:left>Client message patterns to match for logging</td></tr><tr><td style=text-align:left>bootstrap.webservices.client_pool_max_threads</td><td style=text-align:left>Server worker thread pool max.</td></tr><tr><td style=text-align:left>bootstrap.webservices.clock_skew_sec</td><td style=text-align:left>A max clock skew value (in seconds) between client and server accepted when validating timestamps in Query/REST protocol.</td></tr><tr><td style=text-align:left>bootstrap.webservices.cluster_connect_timeout_millis</td><td style=text-align:left>Cluster connect timeout (ms).</td></tr><tr><td style=text-align:left>bootstrap.webservices.default_aws_sns_uri_scheme</td><td style=text-align:left>Default scheme for AWS_SNS_URL.</td></tr><tr><td style=text-align:left>bootstrap.webservices.default_ec2_uri_scheme</td><td style=text-align:left>Default scheme for EC2_URL.</td></tr><tr><td style=text-align:left>bootstrap.webservices.default_euare_uri_scheme</td><td style=text-align:left>Default scheme for EUARE_URL.</td></tr><tr><td style=text-align:left>bootstrap.webservices.default_https_enabled</td><td style=text-align:left>Default scheme prefix.</td></tr><tr><td style=text-align:left>bootstrap.webservices.default_s3_uri_scheme</td><td style=text-align:left>Default scheme for S3_URL.</td></tr><tr><td style=text-align:left>bootstrap.webservices.disabled_soap_api_components</td><td style=text-align:left>List of services with disabled SOAP APIs.</td></tr><tr><td style=text-align:left>bootstrap.webservices.http_max_chunk_bytes</td><td style=text-align:left>Maximum HTTP chunk size (bytes).</td></tr><tr><td style=text-align:left>bootstrap.webservices.http_max_header_bytes</td><td style=text-align:left>Maximum HTTP headers size (bytes).</td></tr><tr><td style=text-align:left>bootstrap.webservices.http_max_initial_line_bytes</td><td style=text-align:left>Maximum HTTP initial line size (bytes).</td></tr><tr><td style=text-align:left>bootstrap.webservices.http_max_requests_per_connection</td><td style=text-align:left>Maximum HTTP requests per persistent connection</td></tr><tr><td style=text-align:left>bootstrap.webservices.http_server_header</td><td style=text-align:left>HTTP server header returned for responses. If set to &ldquo;default&rdquo;, the standard version header is returned, e.g. Eucalyptus/4.3.1. If set to another value, that value is returned in the header, except for an empty value, which results in no server header being returned.Default: default</td></tr><tr><td style=text-align:left>bootstrap.webservices.listener_address_match</td><td style=text-align:left>CIDRs matching addresses to bind on Default interface is always bound regardless.</td></tr><tr><td style=text-align:left>bootstrap.webservices.log_requests</td><td style=text-align:left>Enable request logging.</td></tr><tr><td style=text-align:left>bootstrap.webservices.oob_internal_operations</td><td style=text-align:left>Execute internal service operations out of band from the normal service bus.</td></tr><tr><td style=text-align:left>bootstrap.webservices.pipeline_enable_query_decompress</td><td style=text-align:left>Enable Query Pipeline http request decompression</td></tr><tr><td style=text-align:left>bootstrap.webservices.pipeline_idle_timeout_seconds</td><td style=text-align:left>Server socket idle time-out.</td></tr><tr><td style=text-align:left>bootstrap.webservices.pipeline_max_query_request_size</td><td style=text-align:left>Maximum Query Pipeline http chunk size (bytes).</td></tr><tr><td style=text-align:left>bootstrap.webservices.port</td><td style=text-align:left>Port to bind Port 8773 is always bound regardless.</td></tr><tr><td style=text-align:left>bootstrap.webservices.replay_skew_window_sec</td><td style=text-align:left>Time interval duration (in seconds) during which duplicate signatures will be accepted to accommodate collisions.</td></tr><tr><td style=text-align:left>bootstrap.webservices.server_boss_pool_max_mem_per_conn</td><td style=text-align:left>Server max selector memory per connection.</td></tr><tr><td style=text-align:left>bootstrap.webservices.server_boss_pool_max_threads</td><td style=text-align:left>Server selector thread pool max.</td></tr><tr><td style=text-align:left>bootstrap.webservices.server_boss_pool_timeout_millis</td><td style=text-align:left>Service socket select timeout (ms).</td></tr><tr><td style=text-align:left>bootstrap.webservices.server_boss_pool_total_mem</td><td style=text-align:left>Server worker thread pool max.</td></tr><tr><td style=text-align:left>bootstrap.webservices.server_channel_nodelay</td><td style=text-align:left>Server socket TCP_NODELAY.</td></tr><tr><td style=text-align:left>bootstrap.webservices.server_channel_reuse_address</td><td style=text-align:left>Server socket reuse address.</td></tr><tr><td style=text-align:left>bootstrap.webservices.server_pool_max_mem_per_conn</td><td style=text-align:left>Server max worker memory per connection.</td></tr><tr><td style=text-align:left>bootstrap.webservices.server_pool_max_threads</td><td style=text-align:left>Server worker thread pool max.</td></tr><tr><td style=text-align:left>bootstrap.webservices.server_pool_timeout_millis</td><td style=text-align:left>Service socket select timeout (ms).</td></tr><tr><td style=text-align:left>bootstrap.webservices.server_pool_total_mem</td><td style=text-align:left>Server max worker memory total.</td></tr><tr><td style=text-align:left>bootstrap.webservices.statistics</td><td style=text-align:left>Record and report service times.</td></tr><tr><td style=text-align:left>bootstrap.webservices.unknown_parameter_handling</td><td style=text-align:left>Request unknown parameter handling (default</td></tr><tr><td style=text-align:left>bootstrap.webservices.use_dns_delegation</td><td style=text-align:left>Use DNS delegation.</td></tr><tr><td style=text-align:left>bootstrap.webservices.use_instance_dns</td><td style=text-align:left>Use DNS names for instances.</td></tr><tr><td style=text-align:left>bootstrap.webservices.ssl.client_https_enabled</td><td style=text-align:left>Client HTTPS enabled</td></tr><tr><td style=text-align:left>bootstrap.webservices.ssl.client_https_server_cert_verify</td><td style=text-align:left>Client HTTPS verify server certificate enabled</td></tr><tr><td style=text-align:left>bootstrap.webservices.ssl.client_ssl_ciphers</td><td style=text-align:left>Client HTTPS ciphers for internal use</td></tr><tr><td style=text-align:left>bootstrap.webservices.ssl.client_ssl_protocols</td><td style=text-align:left>Client HTTPS protocols for internal use</td></tr><tr><td style=text-align:left>bootstrap.webservices.ssl.server_alias</td><td style=text-align:left>Alias of the certificate entry in euca.p12 to use for SSL for webservices.</td></tr><tr><td style=text-align:left>bootstrap.webservices.ssl.server_password</td><td style=text-align:left>Password of the private key corresponding to the specified certificate for SSL for web services.</td></tr><tr><td style=text-align:left>bootstrap.webservices.ssl.server_ssl_ciphers</td><td style=text-align:left>SSL ciphers for web services.</td></tr><tr><td style=text-align:left>bootstrap.webservices.ssl.server_ssl_protocols</td><td style=text-align:left>SSL protocols for web services.</td></tr><tr><td style=text-align:left>bootstrap.webservices.ssl.user_ssl_ciphers</td><td style=text-align:left>SSL ciphers for external use.</td></tr><tr><td style=text-align:left>bootstrap.webservices.ssl.user_ssl_default_cas</td><td style=text-align:left>Use default CAs with SSL for external use.</td></tr><tr><td style=text-align:left>bootstrap.webservices.ssl.user_ssl_enable_hostname_verification</td><td style=text-align:left>SSL hostname validation for external use.</td></tr><tr><td style=text-align:left>bootstrap.webservices.ssl.user_ssl_protocols</td><td style=text-align:left>SSL protocols for external use.</td></tr><tr><td style=text-align:left>cloud.db_check_poll_time</td><td style=text-align:left>Poll time (ms) for db connection check</td></tr><tr><td style=text-align:left>cloud.db_check_threshold</td><td style=text-align:left>Threshold (number of connections or %) for db connection check</td></tr><tr><td style=text-align:left>cloud.euca_log_level</td><td style=text-align:left>Log level for dynamic override.</td></tr><tr><td style=text-align:left>cloud.identifier_canonicalizer</td><td style=text-align:left>Name of the canonicalizer for resource identifiers.</td></tr><tr><td style=text-align:left>cloud.log_file_disk_check_poll_time</td><td style=text-align:left>Poll time (ms) for log file disk check</td></tr><tr><td style=text-align:left>cloud.log_file_disk_check_threshold</td><td style=text-align:left>Threshold (bytes or %) for log file disk check</td></tr><tr><td style=text-align:left>cloud.memory_check_poll_time</td><td style=text-align:left>Poll time (ms) for memory check</td></tr><tr><td style=text-align:left>cloud.memory_check_ratio</td><td style=text-align:left>Ratio (of post-garbage collected old-gen memory) for memory check</td></tr><tr><td style=text-align:left>cloud.trigger_fault</td><td style=text-align:left>Fault id last used to trigger test</td></tr><tr><td style=text-align:left>cloud.cluster.disabledinterval</td><td style=text-align:left>The time period between service state checks for a Cluster Controller which is DISABLED.</td></tr><tr><td style=text-align:left>cloud.cluster.enabledinterval</td><td style=text-align:left>The time period between service state checks for a Cluster Controller which is ENABLED.</td></tr><tr><td style=text-align:left>cloud.cluster.notreadyinterval</td><td style=text-align:left>The time period between service state checks for a Cluster Controller which is NOTREADY.</td></tr><tr><td style=text-align:left>cloud.cluster.pendinginterval</td><td style=text-align:left>The time period between service state checks for a Cluster Controller which is PENDING.</td></tr><tr><td style=text-align:left>cloud.cluster.requestworkers</td><td style=text-align:left>The number of concurrent requests which will be sent to a single Cluster Controller.</td></tr><tr><td style=text-align:left>cloud.cluster.startupsyncretries</td><td style=text-align:left>The number of times a request will be retried while bootstrapping a Cluster Controller.</td></tr><tr><td style=text-align:left>cloud.images.cleanupperiod</td><td style=text-align:left>The period between runs for clean up of deregistered images.</td></tr><tr><td style=text-align:left>cloud.images.defaultvisibility</td><td style=text-align:left>The default value used to determine whether or not images are marked &lsquo;public&rsquo; when first registered.</td></tr><tr><td style=text-align:left>cloud.images.maximagesizegb</td><td style=text-align:left>The maximum registerable image size in GB</td></tr><tr><td style=text-align:left>cloud.images.maxmanifestsizebytes</td><td style=text-align:left>The maximum allowed image manifest size in bytes</td></tr><tr><td style=text-align:left>cloud.long_identifier_prefixes</td><td style=text-align:left>List of resource identifier prefixes for long identifiers or * for all</td></tr><tr><td style=text-align:left>cloud.monitor.default_poll_interval_mins</td><td style=text-align:left>How often the CLC requests data from the CC. Default value is 5 minutes.</td></tr><tr><td style=text-align:left>cloud.monitor.history_size</td><td style=text-align:left>How many data value samples are sent from the CC to the CLC. The default value is 5.</td></tr><tr><td style=text-align:left>cloud.network.address_pending_timeout</td><td style=text-align:left>Minutes before a pending system public address allocation times out and is released. Default: 35 minutes.</td></tr><tr><td style=text-align:left>cloud.network.ec2_classic_additional_protocols_allowed</td><td style=text-align:left>Comma delimited list of protocol numbers supported in EDGE mode for security group rules beyond the EC2-Classic defaults (TCP,UDP,ICMP). Only valid IANA protocol numbers are accepted. Default: None<a href></a></td></tr><tr><td style=text-align:left>cloud.network.max_broadcast_apply</td><td style=text-align:left>Maximum time to apply network information. Default: 120 seconds.</td></tr><tr><td style=text-align:left>cloud.network.min_broadcast_interval</td><td style=text-align:left>Minimum interval between broadcasts of network information. Default: 5 seconds.</td></tr><tr><td style=text-align:left>cloud.network.network_index_pending_timeout</td><td style=text-align:left>Minutes before a pending index allocation times out and is released. Default: 35 minutes.</td></tr><tr><td style=text-align:left>cloud.short_identifier_prefixes</td><td style=text-align:left>List of resource identifier prefixes for short identifiers or * for all</td></tr><tr><td style=text-align:left>cloud.vmstate.buried_time</td><td style=text-align:left>Amount of time (in minutes) to retain unreported terminated instance data.</td></tr><tr><td style=text-align:left>cloud.vmstate.ebs_root_device_name</td><td style=text-align:left>Name for root block device mapping</td></tr><tr><td style=text-align:left>cloud.vmstate.ebs_volume_creation_timeout</td><td style=text-align:left>Amount of time (in minutes) before a EBS volume backing the instance is created</td></tr><tr><td style=text-align:left>cloud.vmstate.instance_private_prefix</td><td style=text-align:left>Private name prefix for instance DNS</td></tr><tr><td style=text-align:left>cloud.vmstate.instance_public_prefix</td><td style=text-align:left>Public name prefix for instance DNS</td></tr><tr><td style=text-align:left>cloud.vmstate.instance_reachability_timeout</td><td style=text-align:left>Amount of time (in minutes) before a VM which is not reported by a cluster will fail a reachability test.</td></tr><tr><td style=text-align:left>cloud.vmstate.instance_subdomain</td><td style=text-align:left>Subdomain to use for instance DNS.</td></tr><tr><td style=text-align:left>cloud.vmstate.instance_timeout</td><td style=text-align:left>Amount of time (default unit minutes) before a previously running instance which is not reported will be marked as terminated.</td></tr><tr><td style=text-align:left>cloud.vmstate.instance_touch_interval</td><td style=text-align:left>Amount of time (in minutes) between updates for a running instance.</td></tr><tr><td style=text-align:left>cloud.vmstate.mac_prefix</td><td style=text-align:left>Default prefix to use for instance / network interface MAC addresses.</td></tr><tr><td style=text-align:left>cloud.vmstate.max_state_threads</td><td style=text-align:left>Maximum number of threads the system will use to service blocking state changes.</td></tr><tr><td style=text-align:left>cloud.vmstate.migration_refresh_time</td><td style=text-align:left>Maximum amount of time (in seconds) that migration state will take to propagate state changes (e.g., to tags).</td></tr><tr><td style=text-align:left>cloud.vmstate.pending_time</td><td style=text-align:left>Amount of time (in minutes) before a pending instance will be terminated.</td></tr><tr><td style=text-align:left>cloud.vmstate.shut_down_time</td><td style=text-align:left>Amount of time (in minutes) before a VM which is not reported by a cluster will be marked as terminated.</td></tr><tr><td style=text-align:left>cloud.vmstate.stopping_time</td><td style=text-align:left>Amount of time (in minutes) before a stopping VM which is not reported by a cluster will be marked as terminated.</td></tr><tr><td style=text-align:left>cloud.vmstate.terminated_time</td><td style=text-align:left>Amount of time (in minutes) that a terminated VM will continue to be reported.</td></tr><tr><td style=text-align:left>cloud.vmstate.tx_retries</td><td style=text-align:left>Number of times to retry transactions in the face of potential concurrent update conflicts.</td></tr><tr><td style=text-align:left>cloud.vmstate.unknown_instance_handlers</td><td style=text-align:left>Comma separated list of handlers to use for unknown instances (&lsquo;restore&rsquo;, &lsquo;restore-failed&rsquo;, &rsquo;terminate&rsquo;, &rsquo;terminate-done&rsquo;)</td></tr><tr><td style=text-align:left>cloud.vmstate.user_data_max_size_kb</td><td style=text-align:left>Max length (in KB) that the user data file can be for an instance (after base 64 decoding)</td></tr><tr><td style=text-align:left>cloud.vmstate.vm_initial_report_timeout</td><td style=text-align:left>Amount of time (in seconds) since completion of the creating run instance operation that the new instance is treated as unreported if not&mldr; reported.</td></tr><tr><td style=text-align:left>cloud.vmstate.vm_metadata_generated_cache</td><td style=text-align:left>Instance metadata generated data cache configuration. The cache is used for IAM metadata (../latest/meta-data/iam/) and instance identity (../latest/dynamic/instance-identity/).Default: maximumSize=1000, expireAfterWrite=5m</td></tr><tr><td style=text-align:left>cloud.vmstate.vm_metadata_instance_cache</td><td style=text-align:left>Instance metadata cache configuration.</td></tr><tr><td style=text-align:left>cloud.vmstate.vm_metadata_request_cache</td><td style=text-align:left>Instance metadata instance resolution cache configuration.</td></tr><tr><td style=text-align:left>cloud.vmstate.vm_metadata_user_data_cache</td><td style=text-align:left>Instance metadata user data cache configuration.</td></tr><tr><td style=text-align:left>cloud.vmstate.vm_state_settle_time</td><td style=text-align:left>Amount of time (in seconds) to let instance state settle after a transition to either stopping or shutting-down.</td></tr><tr><td style=text-align:left>cloud.vmstate.volatile_state_interval_sec</td><td style=text-align:left>Period (in seconds) between state updates for actively changing state.</td></tr><tr><td style=text-align:left>cloud.vmstate.volatile_state_timeout_sec</td><td style=text-align:left>Timeout (in seconds) before a requested instance terminate will be repeated.</td></tr><tr><td style=text-align:left>cloud.vmtypes.default_type_name</td><td style=text-align:left>Default type used when no instance type is specified for run instances.</td></tr><tr><td style=text-align:left>cloud.vmtypes.format_ephemeral_storage</td><td style=text-align:left>Format first ephemeral disk by defaut with ext3</td></tr><tr><td style=text-align:left>cloud.vmtypes.merge_ephemeral_storage</td><td style=text-align:left>Merge non-root ephemeral disks</td></tr><tr><td style=text-align:left>cloud.volumes.deleted_time</td><td style=text-align:left>Amount of time (in minutes) that a deleted volume will continue to be reported</td></tr><tr><td style=text-align:left>cloud.vpc.defaultvpc</td><td style=text-align:left>Enable default VPC.</td></tr><tr><td style=text-align:left>cloud.vpc.defaultvpccidr</td><td style=text-align:left>CIDR to use when creating default VPCs</td></tr><tr><td style=text-align:left>cloud.vpc.networkaclspervpc</td><td style=text-align:left>Maximum number of network ACLs for each VPC.</td></tr><tr><td style=text-align:left>cloud.vpc.reservedcidrs</td><td style=text-align:left>Comma separated list of reserved CIDRs</td></tr><tr><td style=text-align:left>cloud.vpc.routespertable</td><td style=text-align:left>Maximum number of routes for each route table.</td></tr><tr><td style=text-align:left>cloud.vpc.routetablespervpc</td><td style=text-align:left>Maximum number of route tables for each VPC.</td></tr><tr><td style=text-align:left>cloud.vpc.rulespernetworkacl</td><td style=text-align:left>Maximum number of rules per direction for each network ACL.</td></tr><tr><td style=text-align:left>cloud.vpc.rulespersecuritygroup</td><td style=text-align:left>Maximum number of associated security groups for each network interface .</td></tr><tr><td style=text-align:left>cloud.vpc.securitygroupspernetworkinterface</td><td style=text-align:left>Maximum number of associated security groups for each network interface .</td></tr><tr><td style=text-align:left>cloud.vpc.securitygroupspervpc</td><td style=text-align:left>Maximum number of security groups for each VPC.</td></tr><tr><td style=text-align:left>cloud.vpc.subnetspervpc</td><td style=text-align:left>Maximum number of subnets for each VPC.</td></tr><tr><td style=text-align:left>cloudformation.autoscaling_group_deleted_max_delete_retry_secs</td><td style=text-align:left>The amount of time (in seconds) to wait for an autoscaling group to be deleted after deletion)</td></tr><tr><td style=text-align:left>cloudformation.autoscaling_group_zero_instances_max_delete_retry_secs</td><td style=text-align:left>The amount of time (in seconds) to wait for an autoscaling group to have zero instances during delete</td></tr><tr><td style=text-align:left>cloudformation.cfn_instance_auth_cache</td><td style=text-align:left>CloudFormation instance credential authentication cache</td></tr><tr><td style=text-align:left>cloudformation.instance_attach_volume_max_create_retry_secs</td><td style=text-align:left>The amount of time (in seconds) to wait for an instance to have volumes attached after creation)</td></tr><tr><td style=text-align:left>cloudformation.instance_running_max_create_retry_secs</td><td style=text-align:left>The amount of time (in seconds) to wait for an instance to be running after creation)</td></tr><tr><td style=text-align:left>cloudformation.instance_terminated_max_delete_retry_secs</td><td style=text-align:left>The amount of time (in seconds) to wait for an instance to be terminated after deletion)</td></tr><tr><td style=text-align:left>cloudformation.max_attributes_per_mapping</td><td style=text-align:left>The maximum number of attributes allowed in a mapping in a template</td></tr><tr><td style=text-align:left>cloudformation.max_mappings_per_template</td><td style=text-align:left>The maximum number of mappings allowed in a template</td></tr><tr><td style=text-align:left>cloudformation.max_outputs_per_template</td><td style=text-align:left>The maximum number of outputs allowed in a template</td></tr><tr><td style=text-align:left>cloudformation.max_parameters_per_template</td><td style=text-align:left>The maximum number of outputs allowed in a template</td></tr><tr><td style=text-align:left>cloudformation.max_resources_per_template</td><td style=text-align:left>The maximum number of resources allowed in a template</td></tr><tr><td style=text-align:left>cloudformation.nat_gateway_available_max_create_retry_secs</td><td style=text-align:left>The amount of time (in seconds) to wait for a nat gateway to be available after create)</td></tr><tr><td style=text-align:left>cloudformation.network_interface_attachment_max_create_or_update_retry_secs</td><td style=text-align:left>The amount of time (in seconds) to wait for a network interface to be attached during create or update)</td></tr><tr><td style=text-align:left>cloudformation.network_interface_available_max_create_retry_secs</td><td style=text-align:left>The amount of time (in seconds) to wait for a network interface to be available after create)</td></tr><tr><td style=text-align:left>cloudformation.network_interface_deleted_max_delete_retry_secs</td><td style=text-align:left>The amount of time (in seconds) to wait for a network interface to be deleted)</td></tr><tr><td style=text-align:left>cloudformation.network_interface_detachment_max_delete_or_update_retry_secs</td><td style=text-align:left>The amount of time (in seconds) to wait for a network interface to detach during delete or update)</td></tr><tr><td style=text-align:left>cloudformation.pseudo_param_partition</td><td style=text-align:left>CloudFormation AWS::Partition (default: eucalyptus)</td></tr><tr><td style=text-align:left>cloudformation.pseudo_param_urlsuffix</td><td style=text-align:left>CloudFormation AWS::URLSuffix (default: dns domain)</td></tr><tr><td style=text-align:left>cloudformation.region</td><td style=text-align:left>The value of AWS::Region and value in CloudFormation ARNs for Region</td></tr><tr><td style=text-align:left>cloudformation.request_template_body_max_length_bytes</td><td style=text-align:left>The maximum number of bytes in a request-embedded template</td></tr><tr><td style=text-align:left>cloudformation.request_template_url_max_content_length_bytes</td><td style=text-align:left>The maximum number of bytes in a template referenced via a URL</td></tr><tr><td style=text-align:left>cloudformation.security_group_max_delete_retry_secs</td><td style=text-align:left>The amount of time (in seconds) to retry security group deletes (may fail if instances from autoscaling group)</td></tr><tr><td style=text-align:left>cloudformation.subnet_max_delete_retry_secs</td><td style=text-align:left>The amount of time (in seconds) to retry subnet deletes</td></tr><tr><td style=text-align:left>cloudformation.swf_activity_worker_config</td><td style=text-align:left>JSON configuration for the cloudformation simple workflow activity worker</td></tr><tr><td style=text-align:left>cloudformation.swf_domain</td><td style=text-align:left>The simple workflow service domain for cloudformation</td></tr><tr><td style=text-align:left>cloudformation.swf_tasklist</td><td style=text-align:left>The simple workflow service task list for cloudformation</td></tr><tr><td style=text-align:left>cloudformation.url_domain_whitelist</td><td style=text-align:left>A comma separated white list of domains (other than Eucalyptus S3 URLs) allowed by CloudFormation URL parameters</td></tr><tr><td style=text-align:left>cloudformation.volume_attachment_max_create_retry_secs</td><td style=text-align:left>The amount of time (in seconds) to wait for a volume to be attached during create)</td></tr><tr><td style=text-align:left>cloudformation.volume_available_max_create_retry_secs</td><td style=text-align:left>The amount of time (in seconds) to wait for a volume to be available after create)</td></tr><tr><td style=text-align:left>cloudformation.volume_deleted_max_delete_retry_secs</td><td style=text-align:left>The amount of time (in seconds) to wait for a volume to be deleted)</td></tr><tr><td style=text-align:left>cloudformation.volume_detachment_max_delete_retry_secs</td><td style=text-align:left>The amount of time (in seconds) to wait for a volume to detach during delete)</td></tr><tr><td style=text-align:left>cloudformation.volume_snapshot_complete_max_delete_retry_secs</td><td style=text-align:left>The amount of time (in seconds) to wait for a snapshot to be complete (if specified as the deletion policy) before a volume is deleted)</td></tr><tr><td style=text-align:left>cloudformation.wait_condition_bucket_prefix</td><td style=text-align:left>The prefix of the bucket used for wait condition handles</td></tr><tr><td style=text-align:left>cloudwatch.disable_cloudwatch_service</td><td style=text-align:left>Set this to true to stop cloud watch alarm evaluation and new alarm/metric data entry</td></tr><tr><td style=text-align:left>dns.dns_listener_address_match</td><td style=text-align:left>Additional address patterns to listen on for DNS requests.</td></tr><tr><td style=text-align:left>dns.enabled</td><td style=text-align:left>Enable pluggable DNS resolvers. This must be &rsquo;true&rsquo; for any pluggable resolver to work. Also, each resolver may need to be separately enabled.</td></tr><tr><td style=text-align:left>dns.search</td><td style=text-align:left>Comma separated list of domains to search, OS settings used if none specified (a change requires restart).</td></tr><tr><td style=text-align:left>dns.server</td><td style=text-align:left>Comma separated list of name servers; OS settings used if none specified (change requires restart)</td></tr><tr><td style=text-align:left>dns.server_pool_max_threads</td><td style=text-align:left>Server worker thread pool max.</td></tr><tr><td style=text-align:left>dns.server_pool_max_threads</td><td style=text-align:left>Server worker thread pool max.</td></tr><tr><td style=text-align:left>dns.instancedata.enabled</td><td style=text-align:left>Enable the instance-data resolver. dns.enabled must also be &rsquo;true&rsquo;.</td></tr><tr><td style=text-align:left>dns.negative_ttl</td><td style=text-align:left>Time-to-live for negative caching on authoritative records. Since version 5.1.</td></tr><tr><td style=text-align:left>dns.ns.enabled</td><td style=text-align:left>Enable the NS resolver. dns.enabled must also be &rsquo;true&rsquo;.</td></tr><tr><td style=text-align:left>dns.recursive.enabled</td><td style=text-align:left>Enable the recursive DNS resolver. dns.enabled must also be &rsquo;true&rsquo;.</td></tr><tr><td style=text-align:left>dns.services.enabled</td><td style=text-align:left>Enable the service topology resolver. dns.enabled must also be &rsquo;true&rsquo;.</td></tr><tr><td style=text-align:left>dns.split_horizon.enabled</td><td style=text-align:left>Enable the split-horizon DNS resolution for internal instance public DNS name queries. dns.enabled must also be &rsquo;true'.</td></tr><tr><td style=text-align:left>dns.spoof_regions.enabled</td><td style=text-align:left>Enable the spoofing resolver which allows for AWS DNS name emulation for instances.</td></tr><tr><td style=text-align:left>dns.spoof_regions.region_name</td><td style=text-align:left>Internal region name. If set, the region name to expect as the second label in the DNS name. For example, to treat your Eucalyptus install like a region named &rsquo;eucalyptus&rsquo;, set this value to eucalyptus. Then, e.g., autoscaling.eucalyptus.amazonaws.com will resolve to the service address when using this DNS server. The specified name creates a pseudo-region with DNS names like ec2.pseudo-region.amazonaws.com will resolve to Eucalyptus endpoints from inside of instances. Here ec2 is any service name supported by Eucalyptus. Those that are not supported will continue to resolve through AWS&rsquo;s DNS.</td></tr><tr><td style=text-align:left>dns.spoof_regions.spoof_aws_default_regions</td><td style=text-align:left>Enable spoofing of the default AWS DNS names, e.g., ec2.amazonaws.com would resolve to the ENABLED Cloud Controller. Here ec2 is any service name supported by Eucalyptus. Those that are not supported will continue to resolve through AWS&rsquo;s DNS.</td></tr><tr><td style=text-align:left>dns.spoof_regions.spoof_aws_regions</td><td style=text-align:left>Enable spoofing for the normal AWS regions, e.g., ec2.us-east-1.amazonaws.com would resolve to the ENABLED Cloud Controller. Here ec2 is any service name supported by Eucalyptus. Those that are not supported will continue to resolve through AWS&rsquo;s DNS.</td></tr><tr><td style=text-align:left>dns.tcp.timeout_seconds</td><td style=text-align:left>Variable controlling tcp handler timeout in seconds.</td></tr><tr><td style=text-align:left>dns.ttl</td><td style=text-align:left>Default time-to-live for authoritative records. Since version 5.1.</td></tr><tr><td style=text-align:left>dns.dns_listener_port</td><td style=text-align:left>Port number to listen on for DNS requests</td></tr><tr><td style=text-align:left>objectstorage.bucket_creation_wait_interval_seconds</td><td style=text-align:left>Interval, in seconds, during which buckets in creating-state are valid. After this interval, the operation is assumed failed.</td></tr><tr><td style=text-align:left>objectstorage.bucket_naming_restrictions</td><td style=text-align:left>The S3 bucket naming restrictions to enforce. Values are &lsquo;dns-compliant&rsquo; or &rsquo;extended&rsquo;. Default is &rsquo;extended&rsquo;. dns_compliant is non-US region S3 names, extended is for US-Standard Region naming. See  <a href=http://docs.aws.amazon.com/AmazonS3/latest/dev/BucketRestrictions.html.%5B%5D()>http://docs.aws.amazon.com/AmazonS3/latest/dev/BucketRestrictions.html.[]()</a></td></tr><tr><td style=text-align:left>objectstorage.bucket_reserved_cnames</td><td style=text-align:left>List of host names that may not be used as bucket cnames</td></tr><tr><td style=text-align:left>objectstorage.cleanup_task_interval_seconds</td><td style=text-align:left>Interval, in seconds, at which cleanup tasks are initiated for removing old/stale objects.</td></tr><tr><td style=text-align:left>objectstorage.dogetputoncopyfail</td><td style=text-align:left>Should provider client attempt a GET / PUT when backend does not support Copy operation</td></tr><tr><td style=text-align:left>objectstorage.failed_put_timeout_hrs</td><td style=text-align:left>Number of hours to wait for object PUT operations to be allowed to complete before cleanup.</td></tr><tr><td style=text-align:left>objectstorage.max_buckets_per_account</td><td style=text-align:left>Maximum number of buckets per account</td></tr><tr><td style=text-align:left>objectstorage.max_tags</td><td style=text-align:left>Maximum number of user defined tags for a bucket</td></tr><tr><td style=text-align:left>objectstorage.max_total_reporting_capacity_gb</td><td style=text-align:left>Total ObjectStorage storage capacity for Objects solely for reporting usage percentage. Not a size restriction. No enforcement of this value</td></tr><tr><td style=text-align:left>objectstorage.providerclient</td><td style=text-align:left>Object Storage Provider client to use for backend</td></tr><tr><td style=text-align:left>objectstorage.queue_size</td><td style=text-align:left>Channel buffer queue size for uploads</td></tr><tr><td style=text-align:left>objectstorage.queue_timeout</td><td style=text-align:left>Channel buffer queue timeout (in seconds)</td></tr><tr><td style=text-align:left>objectstorage.s3client.buffer_size</td><td style=text-align:left>Internal S3 client buffer size</td></tr><tr><td style=text-align:left>objectstorage.s3client.connection_timeout_ms</td><td style=text-align:left>Internal S3 client connection timeout in ms</td></tr><tr><td style=text-align:left>objectstorage.s3client.max_connections</td><td style=text-align:left>Internal S3 client maximum connections</td></tr><tr><td style=text-align:left>objectstorage.s3client.max_error_retries</td><td style=text-align:left>Internal S3 client maximum retries on error</td></tr><tr><td style=text-align:left>objectstorage.s3client.socket_read_timeout_ms</td><td style=text-align:left>Internal S3 client socket read timeout in ms</td></tr><tr><td style=text-align:left>objectstorage.s3provider.s3accesskey</td><td style=text-align:left>Local Store S3 Access Key.</td></tr><tr><td style=text-align:left>objectstorage.s3provider.s3endpoint</td><td style=text-align:left>External S3 endpoint.</td></tr><tr><td style=text-align:left>objectstorage.s3provider.s3secretkey</td><td style=text-align:left>Local Store S3 Secret Key.</td></tr><tr><td style=text-align:left>objectstorage.s3provider.s3usebackenddns</td><td style=text-align:left>Use DNS virtual-hosted-style bucket names for communication to service backend.</td></tr><tr><td style=text-align:left>objectstorage.s3provider.s3usehttps</td><td style=text-align:left>Use HTTPS for communication to service backend.</td></tr><tr><td style=text-align:left>region.region_enable_ssl</td><td style=text-align:left>Enable SSL (HTTPS) for regions.</td></tr><tr><td style=text-align:left>region.region_name</td><td style=text-align:left>Region name.</td></tr><tr><td style=text-align:left>region.region_ssl_ciphers</td><td style=text-align:left>Ciphers to use for region SSL</td></tr><tr><td style=text-align:left>region.region_ssl_default_cas</td><td style=text-align:left>Use default CAs for region SSL connections.</td></tr><tr><td style=text-align:left>region.region_ssl_protocols</td><td style=text-align:left>Protocols to use for region SSL</td></tr><tr><td style=text-align:left>region.region_ssl_verify_hostnames</td><td style=text-align:left>Verify hostnames for region SSL connections.</td></tr><tr><td style=text-align:left>services.imaging.import_task_expiration_hours</td><td style=text-align:left>expiration hours of import volume/instance tasks</td></tr><tr><td style=text-align:left>services.imaging.import_task_timeout_minutes</td><td style=text-align:left>expiration time in minutes of import tasks</td></tr><tr><td style=text-align:left>services.imaging.worker.availability_zones</td><td style=text-align:left>availability zones for imaging worker</td></tr><tr><td style=text-align:left>services.imaging.worker.configured</td><td style=text-align:left>Prepare imaging service so a worker can be launched. If something goes south with the service there is a big chance that setting it to false and back to true would solve issues.</td></tr><tr><td style=text-align:left>services.imaging.worker.expiration_days</td><td style=text-align:left>the days after which imaging work VMs expire</td></tr><tr><td style=text-align:left>services.imaging.worker.healthcheck</td><td style=text-align:left>enabling imaging worker health check</td></tr><tr><td style=text-align:left>services.imaging.worker.image</td><td style=text-align:left>EMI containing imaging worker</td></tr><tr><td style=text-align:left>services.imaging.worker.init_script</td><td style=text-align:left>bash script that will be executed before service configuration and start up</td></tr><tr><td style=text-align:left>services.imaging.worker.instance_type</td><td style=text-align:left>instance type for imaging worker</td></tr><tr><td style=text-align:left>services.imaging.worker.keyname</td><td style=text-align:left>keyname to use when debugging imaging worker</td></tr><tr><td style=text-align:left>services.imaging.worker.log_server</td><td style=text-align:left>address/ip of the server that collects logs from imaging wokrers</td></tr><tr><td style=text-align:left>services.imaging.worker.log_server_port</td><td style=text-align:left>UDP port that log server is listening to</td></tr><tr><td style=text-align:left>services.imaging.worker.log_server_port</td><td style=text-align:left>UDP port that log server is listening to</td></tr><tr><td style=text-align:left>services.imaging.worker.ntp_server</td><td style=text-align:left>address of the NTP server used by imaging worker</td></tr><tr><td style=text-align:left>services.loadbalancing.dns_resolver_enabled</td><td style=text-align:left>Enable the load balancing DNS resolver. dns.enabled must also be &rsquo;true&rsquo;.</td></tr><tr><td style=text-align:left>services.loadbalancing.dns_subdomain</td><td style=text-align:left>loadbalancer dns subdomain</td></tr><tr><td style=text-align:left>services.loadbalancing.dns_ttl</td><td style=text-align:left>loadbalancer dns ttl value</td></tr><tr><td style=text-align:left>services.loadbalancing.max_tags</td><td style=text-align:left>Maximum number of user defined tags for a load balancer</td></tr><tr><td style=text-align:left>services.loadbalancing.restricted_ports</td><td style=text-align:left>The ports restricted for use as a loadbalancer port. Format should be port(, port) or port-port</td></tr><tr><td style=text-align:left>services.loadbalancing.vm_per_zone</td><td style=text-align:left>number of VMs per loadbalancer zone</td></tr><tr><td style=text-align:left>services.loadbalancing.vpc_cidrs</td><td style=text-align:left>Comma separated list of CIDRs for use with ELB VPCs</td></tr><tr><td style=text-align:left>services.loadbalancing.worker.app_cookie_duration</td><td style=text-align:left>duration of app-controlled cookie to be kept in-memory (hours)</td></tr><tr><td style=text-align:left>services.loadbalancing.worker.expiration_days</td><td style=text-align:left>the days after which the loadbalancer VMs expire</td></tr><tr><td style=text-align:left>services.loadbalancing.worker.image</td><td style=text-align:left>EMI containing haproxy and the controller</td></tr><tr><td style=text-align:left>services.loadbalancing.worker.init_script</td><td style=text-align:left>bash script that will be executed before service configuration and start up</td></tr><tr><td style=text-align:left>services.loadbalancing.worker.instance_type</td><td style=text-align:left>instance type for loadbalancer instances</td></tr><tr><td style=text-align:left>services.loadbalancing.worker.keyname</td><td style=text-align:left>keyname to use when debugging loadbalancer VMs</td></tr><tr><td style=text-align:left>services.loadbalancing.worker.ntp_server</td><td style=text-align:left>the address of the NTP server used by loadbalancer VMs</td></tr><tr><td style=text-align:left>services.simpleworkflow.activitytypesperdomain</td><td style=text-align:left>Maximum number of activity types for each domain.</td></tr><tr><td style=text-align:left>services.simpleworkflow.deprecatedactivitytyperetentionduration</td><td style=text-align:left>Deprecated activity type retention time.</td></tr><tr><td style=text-align:left>services.simpleworkflow.deprecateddomainretentionduration</td><td style=text-align:left>Deprecated domain minimum retention time.</td></tr><tr><td style=text-align:left>services.simpleworkflow.deprecatedworkflowtyperetentionduration</td><td style=text-align:left>Deprecated workflow type minimum retention time.</td></tr><tr><td style=text-align:left>services.simpleworkflow.openactivitytasksperworkflowexecution</td><td style=text-align:left>Maximum number of open activity tasks for each workflow execution.</td></tr><tr><td style=text-align:left>services.simpleworkflow.opentimersperworkflowexecution</td><td style=text-align:left>Maximum number of open timers for each workflow execution.</td></tr><tr><td style=text-align:left>services.simpleworkflow.openworkflowexecutionsperdomain</td><td style=text-align:left>Maximum number of open workflow executions for each domain.</td></tr><tr><td style=text-align:left>services.simpleworkflow.systemonly</td><td style=text-align:left>Service available for internal/administrator use only.</td></tr><tr><td style=text-align:left>services.simpleworkflow.workflowexecutionduration</td><td style=text-align:left>Maximum workflow execution time.</td></tr><tr><td style=text-align:left>services.simpleworkflow.workflowexecutionhistorysize</td><td style=text-align:left>Maximum number of events per workflow execution.</td></tr><tr><td style=text-align:left>services.simpleworkflow.workflowexecutionretentionduration</td><td style=text-align:left>Maximum workflow execution history retention time.</td></tr><tr><td style=text-align:left>services.simpleworkflow.workflowtypesperdomain</td><td style=text-align:left>Maximum number of workflow types for each domain.</td></tr><tr><td style=text-align:left>stats.config_update_check_interval_seconds</td><td style=text-align:left>Interval, in seconds, at which the sensor configuration is checked for changes</td></tr><tr><td style=text-align:left>stats.enable_stats</td><td style=text-align:left>Enable Eucalyptus internal monitoring stats</td></tr><tr><td style=text-align:left>stats.event_emitter</td><td style=text-align:left>Internal stats emitter FQ classname used to send metrics to monitoring system</td></tr><tr><td style=text-align:left>stats.file_system_emitter.stats_data_permissions</td><td style=text-align:left>group permissions to place on stats data files in string form. eg. rwxr-x&ndash;x</td></tr><tr><td style=text-align:left>stats.file_system_emitter.stats_group_name</td><td style=text-align:left>group name that owns stats data files</td></tr><tr><td style=text-align:left>storage.global_total_snapshot_size_limit_gb</td><td style=text-align:left>Maximum total snapshot capacity (GB)</td></tr><tr><td style=text-align:left>system.dns.dnsdomain</td><td style=text-align:left>Domain name to use for DNS.</td></tr><tr><td style=text-align:left>system.dns.nameserver</td><td style=text-align:left>Nameserver hostname.</td></tr><tr><td style=text-align:left>system.dns.nameserveraddress</td><td style=text-align:left>Nameserver IP address.</td></tr><tr><td style=text-align:left>system.dns.nameserveraddress</td><td style=text-align:left>Nameserver IP address.</td></tr><tr><td style=text-align:left>system.dns.registrationid</td><td style=text-align:left>Unique ID of this cloud installation.</td></tr><tr><td style=text-align:left>system.exec.io_chunk_size</td><td style=text-align:left>Size of IO chunks for streaming IO</td></tr><tr><td style=text-align:left>system.exec.max_restricted_concurrent_ops</td><td style=text-align:left>Maximum number of concurrent processes which match any of the patterns in system.exec.restricted_concurrent_ops.</td></tr><tr><td style=text-align:left>system.exec.restricted_concurrent_ops</td><td style=text-align:left>Comma-separated list of commands which are restricted by system.exec.max_restricted_concurrent_ops.</td></tr><tr><td style=text-align:left>tagging.max_tags_per_resource</td><td style=text-align:left>The maximum number of tags per resource for each account</td></tr><tr><td style=text-align:left>tokens.disabledactions</td><td style=text-align:left>Actions to disable</td></tr><tr><td style=text-align:left>tokens.enabledactions</td><td style=text-align:left>Actions to enable (ignored if empty)</td></tr><tr><td style=text-align:left>tokens.rolearnaliaswhitelist</td><td style=text-align:left>Permitted account aliases for role Amazon Resource Names (ARNs). Value is a list, for example: eucalyptus,aws,dev*,prod* in the case where multiple aliases are permitted. Default: eucalyptus</td></tr><tr><td style=text-align:left>tokens.webidentityoidcdiscoverycache</td><td style=text-align:left>Cache settings for discovered OpenID Connect metadata: provider configuration and keys. Works with tokens.webidentityoidcdiscoveryrefresh. Default: maximumSize=20, expireAfterWrite=15m</td></tr><tr><td style=text-align:left>tokens.webidentityoidcdiscoveryrefresh</td><td style=text-align:left>OpenID Connect discovery cache refresh expiry. Controls the time in seconds between checks for updated OIDC metadata. Works with tokens.webidentityoidcdiscoverycache. Default: 60</td></tr><tr><td style=text-align:left>tokens.webidentitysignaturealgorithmwhitelist</td><td style=text-align:left>List of JSON Web Signature algorithms to allow in web identity tokens. The algorithm whitelist can be used to permit use of these signature algorithms: RS256, RS384, RS512, PS256, PS384, PS512. Default: RS512</td></tr><tr><td style=text-align:left>tokens.webidentitytokenskew</td><td style=text-align:left>A clock skew value in seconds. The Web identity token expiry / not before validation is allowed within the configured skew. Default: 60</td></tr><tr><td style=text-align:left>walrusbackend.storagedir</td><td style=text-align:left>Path to buckets storage</td></tr><tr><td style=text-align:left>ZONE.storage.blockstoragemanager</td><td style=text-align:left>EBS Block Storage Manager to use for backend</td></tr><tr><td style=text-align:left>ZONE.storage.cephconfigfile</td><td style=text-align:left>Absolute path to Ceph configuration (ceph.conf) file. Default value is &lsquo;/etc/ceph/ceph.conf&rsquo;</td></tr><tr><td style=text-align:left>ZONE.storage.cephkeyringfile</td><td style=text-align:left>Absolute path to Ceph keyring (ceph.client.eucalyptus.keyring) file. Default value is &lsquo;/etc/ceph/ceph.client.eucalyptus.keyring&rsquo;</td></tr><tr><td style=text-align:left>ZONE.storage.cephsnapshotpools</td><td style=text-align:left>Ceph storage pool(s) made available to Eucalyptus for EBS snapshots. Use a comma separated list for configuring multiple pools. Default value is &lsquo;rbd&rsquo;</td></tr><tr><td style=text-align:left>ZONE.storage.cephuser</td><td style=text-align:left>Ceph username employed by Eucalyptus operations. Default value is &rsquo;eucalyptus'</td></tr><tr><td style=text-align:left>ZONE.storage.cephvolumepools</td><td style=text-align:left>Ceph storage pool(s) made available to Eucalyptus for EBS volumes. Use a comma separated list for configuring multiple pools. Default value is &lsquo;rbd&rsquo;</td></tr><tr><td style=text-align:left>ZONE.storage.chapuser</td><td style=text-align:left>User ID for CHAP authentication</td></tr><tr><td style=text-align:left>ZONE.storage.dasdevice</td><td style=text-align:left>Direct attached storage device location</td></tr><tr><td style=text-align:left>ZONE.storage.maxconcurrentsnapshots</td><td style=text-align:left>Maximum number of snapshots processed on the block storage backend at a given time</td></tr><tr><td style=text-align:left>ZONE.storage.maxconcurrentsnapshottransfers</td><td style=text-align:left>Maximum number of snapshots that can be uploaded to or downloaded from objectstorage gateway at a given time</td></tr><tr><td style=text-align:left>ZONE.storage.maxconcurrentvolumes</td><td style=text-align:left>Maximum number of volumes processed on the block storage backend at a given time</td></tr><tr><td style=text-align:left>ZONE.storage.maxsnapshotdeltas</td><td style=text-align:left>A non-zero integer value enables upload of incremental snapshots when possible. The configured value indicates the SC to create/upload that many snapshot deltas for a given EBS volume before triggering a full upload of the snapshot contents. Between any two consecutive full snapshot uploads for a given EBS volume, there will be at most maxsnapshotdeltas number of incremental snapshot uploads. A value of 0 indicates that a newly created snapshot will always be uploaded in its entirety (that is, no deltas). Snapshot deltas are only used when your backend is Ceph-RBD. ZONE.storage.shouldtransfersnapshots must be set to true to enable snapshot deltas.Default: 0</td></tr><tr><td style=text-align:left>ZONE.storage.maxsnapshotpartsqueuesize</td><td style=text-align:left>Maximum number of snapshot parts per snapshot that can be spooled on the disk</td></tr><tr><td style=text-align:left>ZONE.storage.maxtotalvolumesizeingb</td><td style=text-align:left>Total disk space reserved for volumes</td></tr><tr><td style=text-align:left>ZONE.storage.maxvolumesizeingb</td><td style=text-align:left>Max volume size</td></tr><tr><td style=text-align:left>ZONE.storage.ncpaths</td><td style=text-align:left>iSCSI Paths for NC. Default value is &rsquo;nopath'</td></tr><tr><td style=text-align:left>ZONE.storage.readbuffersizeinmb</td><td style=text-align:left>Buffer size in MB for reading data from snapshot when uploading snapshot to objectstorage gateway</td></tr><tr><td style=text-align:left>ZONE.storage.resourceprefix</td><td style=text-align:left>Prefix for resource name on SAN</td></tr><tr><td style=text-align:left>ZONE.storage.resourcesuffix</td><td style=text-align:left>Suffix for resource name on SAN</td></tr><tr><td style=text-align:left>ZONE.storage.sanhost</td><td style=text-align:left>Hostname for SAN device.</td></tr><tr><td style=text-align:left>ZONE.storage.sanpassword</td><td style=text-align:left>Password for SAN device.</td></tr><tr><td style=text-align:left>ZONE.storage.sanuser</td><td style=text-align:left>Username for SAN device.</td></tr><tr><td style=text-align:left>ZONE.storage.scpaths</td><td style=text-align:left>iSCSI Paths for SC. Default value is &rsquo;nopath'</td></tr><tr><td style=text-align:left>ZONE.storage.shouldtransfersnapshots</td><td style=text-align:left>Enable snapshot transfer to the OSG. Setting it to false will disable storing snapshots (full or delta) in object storage. While a false setting will reduce object storage requirements, it also prevents the ability to use a snapshot from one availability zone to create a volume in another zone. You can still take/use snapshots even when the setting is false, but you can only use a snapshot to create a volume in the same zone. Must be set to true to use snapshot deltas, which are managed by the ZONE.storage.maxsnapshotdeltas property.Default: true</td></tr><tr><td style=text-align:left>ZONE.storage.snapexpiration</td><td style=text-align:left>Time interval in minutes after which Storage Controller metadata for snapshots that have been physically removed from the block storage backend will be deleted</td></tr><tr><td style=text-align:left>ZONE.storage.snapshotpartsizeinmb</td><td style=text-align:left>Snapshot part size in MB for snapshot transfers using multipart upload. Minimum part size is 5MB</td></tr><tr><td style=text-align:left>ZONE.storage.snapshottransfertimeoutinhours</td><td style=text-align:left>Snapshot upload wait time in hours after which the upload will be cancelled</td></tr><tr><td style=text-align:left>ZONE.storage.storeprefix</td><td style=text-align:left>Prefix for ISCSI device</td></tr><tr><td style=text-align:left>ZONE.storage.tid</td><td style=text-align:left>Next Target ID for ISCSI device</td></tr><tr><td style=text-align:left>ZONE.storage.timeoutinmillis</td><td style=text-align:left>Timeout value in milli seconds for storage operations</td></tr><tr><td style=text-align:left>ZONE.storage.volexpiration</td><td style=text-align:left>Time interval in minutes after which Storage Controller metadata for volumes that have been physically removed from the block storage backend will be deleted</td></tr><tr><td style=text-align:left>ZONE.storage.volumesdir</td><td style=text-align:left>Storage volumes directory.</td></tr><tr><td style=text-align:left>ZONE.storage.writebuffersizeinmb</td><td style=text-align:left>Buffer size in MB for writing data to snapshot when downloading snapshot from object storage gateway</td></tr><tr><td style=text-align:left>ZONE.storage.zerofillvolumes</td><td style=text-align:left>Should volumes be zero filled.</td></tr></tbody></table></div><div class=td-content style=page-break-before:always><h1 id=pg-477d92ba2e18c93ed66a01a0a25b975d>2.8 - Advanced Storage Configuration</h1><h1 id=advanced-storage-configuration>Advanced Storage Configuration</h1><p>This section covers advanced storage provider configuration options.</p></div><div class=td-content><h1 id=pg-295d8e8f523b64cb65b220c89c352b76>2.8.1 - OSG Advanced Configuration</h1><p>The following properties are for tuning the behavior of the Object Storage service and Gateways; the defaults are reasonable and changing is not necessary, but they are available for unexpected situations.</p><table><thead><tr><th style=text-align:left>Property</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left>objectstorage.bucket_creation_wait_interval_seconds</td><td style=text-align:left>The interval, in seconds, during which buckets in a &lsquo;creating&rsquo; state are valid. After this interval, the operation is assumed failed. Valid values: integer > 0Default: 60</td></tr><tr><td style=text-align:left>objectstorage.bucket_naming_restrictions</td><td style=text-align:left>The S3 bucket naming restrictions to enforce. Use dns_compliant for non-US region S3 names. Use extended for US-Standard Region naming. For more information, see Bucket Restrictions and Limitations in the Amazon S3 documentation. Valid values: dns-compliant</td></tr><tr><td style=text-align:left>objectstorage.cleanuptaskintervalseconds</td><td style=text-align:left>The interval, in seconds, at which background cleanup tasks are run. The background cleanup tasks purge the backend of overwritten objects and clean object history. Valid values: integer > 0Default: 60</td></tr><tr><td style=text-align:left>objectstorage.dogetcopyputonfail</td><td style=text-align:left>When this property is enabled (true), the OSG attempts to perform a manual copy (performing a GET operation on the source, followed by a PUT operation on the destination) whenever the copy operation fails against the upstream provider. Because manual copies can be slow and memory-intensive, this capability is disabled (false) by default. Valid values: true</td></tr><tr><td style=text-align:left>objectstorage.failedputtimeouthours</td><td style=text-align:left>The time, in hours, after which an uncommitted object upload is considered to be failed. This allows cleansing of metadata for objects that were pending upload when an OSG fails or is stopped in the middle of a user operation. This should be kept at least as long as the longest reasonable time to upload a single large object in order to prevent unintentional cleanup of uploads in-progress. The S3 maximum single upload size is 5GB. Valid values: integer > 0Default: 168</td></tr><tr><td style=text-align:left>objectstorage.max_buckets_per_account</td><td style=text-align:left>Maximum number of buckets per account. For more information, see Bucket Restrictions and Limitations in the Amazon S3 documentation. Valid values: integer > 0Default: 100 (the AWS limit)<a href></a></td></tr><tr><td style=text-align:left>objectstorage.max_total_reporting_capacity_gb</td><td style=text-align:left>Total object storage capacity for objects, used solely for reporting usage percentage. Not a size restriction. No enforcement of this value. Valid values: integer > 0Default: 2147483647 (maximum value of an integer)</td></tr><tr><td style=text-align:left>objectstorage.queue_size</td><td style=text-align:left>The size, in chunks, of the internal buffers that queue data for transfer to the backend on a per-request basis. A larger value will allow more buffering in the OSG when the client is uploading quickly, but the backend bandwidth is lower and cannot consume data fast enough. Too large a value may result in out-of-memory (OOM) errors if the JVM does not have sufficient heap space to handle the concurrent requests * queue_size.Valid values: integer > 0Default: 100</td></tr><tr><td style=text-align:left>objectstorage.s3provider.s3usebackenddns</td><td style=text-align:left>Use DNS virtual-hosted-style bucket names for communication to service backend. Valid values: true</td></tr><tr><td style=text-align:left>objectstorage.s3provider.s3usehttps</td><td style=text-align:left>Whether or not to use HTTPS for the connections to the backend provider. If you configure this, be sure you can use the backend properly with HTTPS (certs, etc.) or the OSG will fail to connect. For RiakCS, you must configure certificates and identities to support HTTPS; it is not enabled in a default RiakCS installation.Valid values: true</td></tr></tbody></table></div><div class=td-content style=page-break-before:always><h1 id=pg-13493f4b6354d2403513e9c3ca6c28cd>3 - User Guide</h1><h1 id=user-guide>User Guide</h1><p>This User Guide instructs you how to use a Eucalyptus private cloud. As a cloud user, you will set up your account, work with images, launch instances, and so on. To install or administer and operate a Eucalyptus cloud, refer to the Eucalyptus Installation Guide and the Administration Guide, respectively.Enjoy using your Eucalyptus private cloud!</p></div><div class=td-content style=page-break-before:always><h1 id=pg-85f55646064f1dec46959e9c3daa72ab>3.1 - Eucalyptus Overview</h1><p>Eucalyptus is open source software for building AWS-compatible private and hybrid clouds. As an Infrastructure as a Service product, Eucalyptus allows you to flexibly provision your own collections of resources (both compute and storage), on an as-needed basis.</p><h2 id=who-should-read-this-guide>Who Should Read this Guide?</h2><p>This guide is for Eucalyptus users who wish to run application workloads on a Eucalyptus cloud.</p><h2 id=whats-in-this-guide>What’s in this Guide?</h2><p>This guide contains instructions for users of the Eucalyptus cloud platform. While these instructions apply generally to all tools capable of interacting with Eucalyptus, such as the Eucalyptus Management Console or the AWS S3 toolset, but the primary focus is on the use of Euca2ools (Eucalyptus command line tools). The following is an overview of the contents of this guide.</p><table><thead><tr><th style=text-align:left>How do I …?</th><th style=text-align:left>Related Topic</th></tr></thead><tbody><tr><td style=text-align:left>Begin using and configuring Eucalyptus</td><td style=text-align:left><a href=/docs/user_guide/getting_started/>getting_started</a></td></tr><tr><td style=text-align:left>Run and control with virtual machine (VM) instances</td><td style=text-align:left><a href=/docs/user_guide/using_instances/>using_instances</a></td></tr><tr><td style=text-align:left>Use Eucalyptus’ elastic block storage</td><td style=text-align:left><a href=/docs/user_guide/using_block_storage/>using_block_storage</a></td></tr><tr><td style=text-align:left>Apply tags and filters</td><td style=text-align:left><a href=/docs/user_guide/resource_and_tags/>resource_and_tags</a></td></tr><tr><td style=text-align:left>Manage access for groups and users</td><td style=text-align:left><a href=/docs/user_guide/using_access/>using_access</a></td></tr><tr><td style=text-align:left>Understand the Eucalyptus VM networking and security features</td><td style=text-align:left><a href=/docs/user_guide/networking_security/>networking_security</a></td></tr><tr><td style=text-align:left>Use Eucalyptus’ Auto Scaling features</td><td style=text-align:left><a href=/docs/user_guide/autoscaling_intro/>autoscaling_intro</a></td></tr><tr><td style=text-align:left>Use elastic load balancing</td><td style=text-align:left><a href=/docs/user_guide/elb_intro/>elb_intro</a></td></tr><tr><td style=text-align:left>Generate metrics about my cloud</td><td style=text-align:left><a href=/docs/user_guide/using_monitoring/>using_monitoring</a></td></tr><tr><td style=text-align:left>Use scalable object storage</td><td style=text-align:left><a href=/docs/user_guide/osg_using/>osg_using</a></td></tr><tr><td style=text-align:left>Use CloudFormation</td><td style=text-align:left><a href=/docs/user_guide/cf_overview/>cf_overview</a></td></tr><tr><td style=text-align:left>Use Virtual Private Cloud</td><td style=text-align:left><a href=/docs/user_guide/vpc_intro/>vpc_intro</a></td></tr></tbody></table><h2 id=eucalyptus-features>Eucalyptus Features</h2><p>Eucalyptus offers ways to implement, manage, and maintain your own collection of virtual resources (machines, network, and storage). The following is an overview of these features.</p><h3 id=aws-api-compatibility>AWS API compatibility</h3><p>Eucalyptus provides API compatibility with Amazon Web Services, to allow you to use familiar tools and commands to provision your cloud.</p><h3 id=block--and-bucket-based-storage-abstractions>Block- and bucket-based storage abstractions</h3><p>Eucalyptus provides storage options compatible with Amazon&rsquo;s EBS (block-based) and S3 (bucket-based) storage products.</p><h3 id=self-service-capabilities>Self-service capabilities</h3><p>Eucalyptus offers a Management Console, allowing your users to request the resources they need, and automatically provisioning those resources where available.</p><h3 id=web-based-interface>Web-based Interface</h3><p>The Eucalyptus Management Console is accessible from any device via a browser. The Console initial page provides a Dashboard view of components available to you to manage, configure, provision, and generate various reports.</p><h2 id=resource-management>Resource Management</h2><p>Eucalyptus offers tools to seamlessly manage a variety of virtual resources. The following is an overview of the types of resources your cloud platform.</p><h3 id=ssh-key-management>SSH Key Management</h3><p>Eucalyptus employs public and private keypairs to validate your identity when you log into VMs using SSH. You can add, describe, and delete keypairs.</p><h3 id=image-management>Image Management</h3><p>Before running instances, someone must prepare VM images for use in the cloud. This can be an administrator or a user. Eucalyptus allows you to bundle, upload, register, describe, download, unbundle, and deregister VM images.</p><h3 id=linux-guest-os-support>Linux Guest OS Support</h3><p>Eucalyptus lets you run your own VMs in the cloud. You can run, describe, terminate, and reboot a wide variety of Linux-based VMs that were prepared using image management commands.</p><h3 id=ip-address-management>IP Address Management</h3><p>Eucalyptus can allocate, associate, disassociate, describe, and release IP addresses. Depending on the networking mode, you might have access to public IP addresses that are not statically associated with a VM ( Elastic IPs ). Eucalyptus provides tools to allow users to reserve and dynamically associate these elastic IPs with virtual machines.</p><h3 id=security-group-management>Security Group Management</h3><p>Security groups are sets of firewall rules applied to VMs associated with the group. Eucalyptus lets you create, describe, delete, authorize, and revoke security groups. How much of these things can a typical user actually do?</p><h3 id=volume-and-snapshot-management>Volume and Snapshot Management</h3><p>Eucalyptus allows you to create dynamic block volumes. A dynamic block volume is similar to a raw block storage device that can be used with virtual machines. You can create, attach, detach, describe, bundle, and delete volumes. You can also create and delete snapshots of volumes and create new volumes from snapshots.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-7ccd036145111c0b3368cd5072ab982d>3.2 - Getting Started</h1><h1 id=getting-started>Getting Started</h1><p>This section helps you get started using your Eucalyptus cloud, and covers setting up your user credentials, installing and configuring command line tools, and working with images and instances. As a cloud user, you can access the Eucalyptus cloud using a command line interface such as the AWS CLI, or by using a web-based interface such as the Eucalyptus Management Console.</p><p>To access Eucalyptus via the command line, you can use the AWS CLI or Euca2ools with access key credentials. To access Eucalyptus with the Management Console, you&rsquo;ll need a password. Talk to your cloud administrator to get your keys and passwords.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-e0617e76c8036d82da2243711cac82df>3.2.1 - Getting Started with the Eucalyptus Management Console</h1><h1 id=getting-started-with-the-eucalyptus-management-console>Getting Started with the Eucalyptus Management Console</h1><p>This section helps you get started using your Eucalyptus cloud with the Eucalyptus Management Console.To access Eucalyptus with the Management Console, you&rsquo;ll need a password for the Management Console. Talk to your cloud administrator to get your keys and passwords.</p></div><div class=td-content><h1 id=pg-2f7b6c129c029052d00bc07f9cd62d79>3.2.1.1 - Console Login</h1><p>This screen allows you to log in to the Eucalyptus Management Console with either your Eucalyptus or your Amazon Web Services account. If you&rsquo;ve forgotten your password, don&rsquo;t have login credentials, or do not know the URL for the Eucalyptus Management Console for your Eucalyptus account, please contact your system administrator.Navigate to the Eucalyptus Management Console by typing the URL of the Management Console into your browser&rsquo;s navigation bar. The URL of the Eucalyptus Management Console depends on how the console was installed in your cloud; see your system administrator for the specific URL for your installation. Follow the appropriate instructions below for logging into either your Eucalyptus or your Amazon Web Services cloud.</p><h2 id=log-in-to-your-eucalyptus-cloud>Log in to your Eucalyptus cloud</h2><p>This area of the login dialog allows you to log in to your Eucalyptus cloud.Click the Log in to Eucalyptus tab. Type your account name into the Account name text box. Type your user name into the User name text box. Type your password into the Password text box. Click the Log in to Eucalyptus button.</p><h2 id=log-in-to-your-amazon-web-services-cloud>Log in to your Amazon Web Services cloud</h2><p>This area of the login dialog allows you to log in to your Amazon Web Services cloud.Click the Log in to AWS tab.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>To obtain your AWS security credentials, go to Amazon&rsquo;s page.</div>Enter your AWS access key ID into the Access key ID text box. Enter your AWS secret access key into the Secret access key text box. Click the Log in to AWS button.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-a8a8d8e2f6913a7a6ecefa02cbdb34dc>3.2.1.2 - Launch and Connect to an Instance with the Management Console</h1><p>To launch an instance:</p><p>Click on the Launch Instance button on the main console page:
<img src=https://www.eucastack.io/images/run_instance_console_1.jpg alt=image>
Select an image from the list (for this example, we&rsquo;ll select a CentOS image), then click the Next button:
<img src=https://www.eucastack.io/images/run_instance_console_2.jpg alt=image>
Select an instance type and availability zone from the Details tab. For this example, select the defaults, and then click the Next button:
<img src=https://www.eucastack.io/images/run_instance_console_3.jpg alt=image>
On the Security tab, we&rsquo;ll create a key pair and a security group to use with our new instance. A key pair will allow you to access your instance, and a security group allows you to define what kinds of incoming traffic your instance will allow.
<img src=https://www.eucastack.io/images/run_instance_console_4.jpg alt=image>
First, we will create a key pair. Click the Create key pair link to bring up the Create key pair dialog:
<img src=https://www.eucastack.io/images/run_instance_console_4a.jpg alt=image>
Type the name of your new key pair into the Name text box, and then click the Create and Download button:
<img src=https://www.eucastack.io/images/run_instance_console_4b.jpg alt=image>
The key pair automatically downloads to a location on your computer, typically in the <em>Downloads</em> folder. The Create key pair dialog will close, and the Key name text box will be populated with the name of the key pair you just created:
<img src=https://www.eucastack.io/images/run_instance_console_4d.jpg alt=image>
Next, we will create a security group. Click the Create security group link to bring up the Create security group dialog:
<img src=https://www.eucastack.io/images/run_instance_console_4e.jpg alt=image>
On the Create security group dialog, type the name of your security group into the Name text box. Type a brief description of your security group into the Description text box. We&rsquo;ll need to SSH into our instance later, so in the Rules section of the dialog, select the SSH protocol from the Protocol drop-down list box.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>In this example, we allow any IP address to access our new instance. For production use, please use appropriate caution when specifying an IP range. For more information on CIDR notation, go to .</div>You need to specify an IP address or a range of IP addresses that can use SSH to access your instance. For this example, click the Open to all addresses link. This will populate the IP Address text box with 0.0.0.0/0, which allows any IP address to access your instance via SSH.
<img src=https://www.eucastack.io/images/run_instance_console_4f.jpg alt=image>
Click the Add rule button. The Create security group dialog should now look something like this:
<img src=https://www.eucastack.io/images/run_instance_console_4g.jpg alt=image>
Click the Create security group button. The Create security group dialog will close, and the Security group text box will be populated with the name of the security group you just created:
<img src=https://www.eucastack.io/images/run_instance_console_4h.jpg alt=image>
You&rsquo;re now ready to launch your new instance. Click the Launch Instance button. The Launch Instance dialog will close, and the Instances screen will display. The instance you just created will display at the top of the list with a status of Pending:
<img src=https://www.eucastack.io/images/run_instance_console_4j.jpg alt=image>
When the status of your new instance changes to Running, click the instance in the list to bring up a page showing details of your instance. For example:
<img src=https://www.eucastack.io/images/run_instance_console_4k.jpg alt=image>
Note the Public IP address and/or the Public hostname fields. You will need this information to connect to your new instance. For example:
<img src=https://www.eucastack.io/images/run_instance_console_4l.jpg alt=image>
Using the public IP address or hostname of your new instance, you can now use SSH to log into the instance using the private key file you saved when you created a key pair. For example:</p><pre><code>ssh -i my-test-keypair.private root@10.111.57.109 
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-2240f361898c60bd0a70d9cd2335bffe>3.2.1.3 - Set Up A Web Server on an Instance</h1><p>Once you&rsquo;ve launched an instance and connected to it, you can test it by setting up a web server.</p><p>ssh into your instance.</p><pre><code>ssh 192.168.1.1 -l root
</code></pre><p>Install Apache:</p><pre><code>yum install -y httpd
</code></pre><p>You should see output similar to the following:</p><pre><code>Loaded plugins: fastestmirror, security, versionlock
Loading mirror speeds from cached hostfile
 * extras: centos.sonn.com
centos-7-x86_64-os                                       | 3.7 kB     00:00
centos-7-x86_64-updates                                  | 3.4 kB     00:00
centos-7-x86_64-updates/primary_db                       | 5.4 MB     00:00
epel-7-x86_64                                            | 4.4 kB     00:00
epel-7-x86_64/primary_db                                 | 6.3 MB     00:00
extras                                                   | 3.3 kB     00:00
Setting up Install Process
Package httpd-2.2.15-31.el7.centos.x86_64 already installed and latest version
Nothing to do
</code></pre><p>Start the web server:</p><pre><code>systemctl start httpd.service
</code></pre><p>You should see output similar to the following:</p><pre><code>Starting httpd:                                            [  OK  ]
</code></pre><p>Test connectivity to your instance by using a web browser and connecting to the web service on your instance. For example:</p><p><img src=https://www.eucastack.io/images/test_instance_web_server_connect.png alt=image></p></div><div class=td-content style=page-break-before:always><h1 id=pg-a3bcdbed84d0b1cd6dfdded6507eafb3>3.2.1.4 - Reboot an Instance with the Management Console</h1><p>Rebooting preserves the root filesystem of an instance across restarts. To reboot an instance:</p><p>On the Instances page, select Reboot from the Actions menu next to the instance you want to reboot.
<img src=https://www.eucastack.io/images/reboot_instance_console_1.jpg alt=image>
Click the Yes, Reboot button.
<img src=https://www.eucastack.io/images/reboot_instance_console_2.jpg alt=image></p></div><div class=td-content style=page-break-before:always><h1 id=pg-aec23dc55cbb9df683302eeffee5924c>3.2.1.5 - Terminate an Instance with the Management Console</h1><p><div class="alert alert-warning" role=alert><h4 class=alert-heading>Warning</h4>Terminating an instance can cause the instance and all items associated with the instance (data, packages installed, etc.) to be lost. Be sure to save any important work or data before terminating an instance.</div>To terminate instances:</p><p>On the Instances page, Select Terminate from the Actions menu next to the instance you want to terminate.
<img src=https://www.eucastack.io/images/terminate_instance_console_1.jpg alt=image>
Click the Yes, Terminate button.
<img src=https://www.eucastack.io/images/terminate_instance_console_2.jpg alt=image>
The Status field of the instance will first change to Shutting-down :
<img src=https://www.eucastack.io/images/terminate_instance_console_3.jpg alt=image>
&mldr;and then change to Terminated :
<img src=https://www.eucastack.io/images/terminate_instance_console_4.jpg alt=image></p></div><div class=td-content style=page-break-before:always><h1 id=pg-fa37186bd5f27c35edba56002937484b>3.2.2 - Getting Started with the AWS CLI</h1><p>This section helps you get started using your Eucalyptus cloud, and covers setting up your user credentials, installing and configuring the AWS CLI, and working with images and instances. As a cloud user, you can access the Eucalyptus cloud using a command line interface such as the AWS CLI, or using a web-based interface such as the Eucalyptus Management Console.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>This section primarily deals with using the AWS CLI. For complete documentation on using web-based the Eucalyptus Console, see <a href=https://www.eucastack.io/docs/user_guide/getting_started/getting_started_console/console_login/>Console Login</a>.</div><p>The install guide covers <a href=https://www.eucastack.io/docs/install_guide/installing_cli/installing_awscli/>&ldquo;AWS CLI Installation&rdquo;</a></p><h2 id=find-image>Find Image</h2><p>Enter the following command:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># aws ec2 describe-images</span>
</span></span><span style=display:flex><span>IMAGES	x86_64	2020-10-17T05:29:09.161Z	emi-0ba907069cb1845bc	ubuntu-focal/focal-server-cloudimg-amd64.raw.manifest.xml	machine	ubuntu-focal	000575948401		True	/dev/sda	instance-store	available	hvm
</span></span><span style=display:flex><span>IMAGES	x86_64	2020-10-17T05:24:08.857Z	emi-371ada125a928669e	centos-7/CentOS-7-x86_64-GenericCloud-2003.raw.manifest.xml	machine	centos-7	000575948401		True	/dev/sda	instance-store	available	hvm
</span></span></code></pre></div><p>Look for the image ID and write it down. The image ID starts with <code>emi-</code> . Once you find a suitable image to use, make sure you have a keypair to use.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Examples use the AWS CLI <em>text</em> output format. You can request this output for a command by adding an &ldquo;&ndash;output text&rdquo; argument to any command.</div><h2 id=create-keypairs>Create KeyPairs</h2><p>Enter the following command:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aws ec2 create-key-pair --key-name &lt;keypair_name&gt; &gt; &lt;keypair_name&gt;.private
</span></span></code></pre></div><p>where <code>&lt;keypair_name></code> is a unique name for your keypair. For example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aws ec2 create-key-pair --key-name <span style=color:#4e9a06>&#34;alice-keypair&#34;</span> &gt; <span style=color:#4e9a06>&#34;alice-keypair.private&#34;</span>
</span></span></code></pre></div><p>The private key is saved to a file in your local directory. Query the system to view the public key:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># aws ec2 describe-key-pairs</span>
</span></span><span style=display:flex><span>KEYPAIRS	92:40:28:cb:08:54:80:95:8d:69:d9:ab:9a:ff:28:30:40:12:6a:66	alice-keypair
</span></span></code></pre></div><h2 id=authorize-security-groups>Authorize Security Groups</h2><p>Before you can log in to an instance, you must authorize access to that instance. This done by configuring a security group for that instance.</p><p>A security group is a set of networking rules applied to instances associated with that group. When you first create an instance, it is assigned to a default security group that denies incoming network traffic from all sources. To allow login and usage of a new instance, you must authorize network access to the default security group with the authorize-security-group-ingress command.</p><p>To authorize a security group, use authorize-security-group-ingress with the name of the security group, and the options of the network rule permissions you want to apply.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aws ec2 authorize-security-group-ingress <span style=color:#ce5c00;font-weight:700>[</span>--group-id &lt;value&gt;<span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>[</span>--group-name &lt;value&gt;<span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>[</span>--ip-permissions &lt;value&gt;<span style=color:#ce5c00;font-weight:700>]</span>
</span></span></code></pre></div><p>Use the following command to grant unlimited network access using SSH (TCP, port 22) and VNC (TCP, ports 5900 to 5910) to the security group <code>default</code> :</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># aws ec2 authorize-security-group-ingress --ip-permissions &#34;IpProtocol=tcp,FromPort=22,ToPort=22,IpRanges={CidrIp=0.0.0.0/0}&#34; --group-name default </span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># aws ec2 authorize-security-group-ingress --ip-permissions &#34;IpProtocol=tcp,FromPort=5900,ToPort=5910,IpRanges={CidrIp=0.0.0.0/0}&#34; --group-name default </span>
</span></span></code></pre></div><h2 id=launch-an-instance>Launch an Instance</h2><p>Use the run-instances command and provide an image ID. For example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aws ec2 run-instances --image-id emi-371ada125a928669e
</span></span></code></pre></div><p>For additional details and options that can be used with the run-instances command. Enter the following command to get the launch status of the instance:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aws ec2 describe-instances --instance-ids &lt;instance_id&gt;
</span></span></code></pre></div><h2 id=log-in-to-an-instance>Log in to an Instance</h2><p>When you create an instance, Eucalyptus assigns the instance two IP addresses: a public IP address and a private IP address. The public IP address provides access to the instance from external network sources; the private IP address provides access to the instance from within the Eucalyptus cloud environment. For more information on Eucalyptus networking modes, see the <a href=https://www.eucastack.io/docs/admin_guide/>Eucalyptus Administrator’s Guide</a>.</p><p>To use an instance you must log into it via ssh using one of the IP addresses assigned to it. You can obtain the instance’s IP addresses using the describe-instances query as shown in the following example.</p><p>To log into a VM instance:</p><p>Enter the following command to view the IP addresses of your instance:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># aws ec2 describe-instances</span>
</span></span><span style=display:flex><span>RESERVATIONS	000332850814	r-825a2c9c04e97ee62
</span></span><span style=display:flex><span>GROUPS	sg-84741faf0bd87ea73	default
</span></span><span style=display:flex><span>INSTANCES	0	x86_64	emi-371ada125a928669e	i-131e5853a71c87f16	t2.micro	2020-10-19T16:35:36.120Z	euca-172-31-15-2.eucalyptus.internal	172.31.15.2	euca-192-168-134-74.eucalyptus.mycloud.example.com	192.168.134.74	/dev/sda1	instance-store	True	NORMAL:  -- <span style=color:#ce5c00;font-weight:700>[]</span>	subnet-1343e38b5566c8e90	hvm	vpc-bded94e5dd0a07bc3
</span></span><span style=display:flex><span>MONITORING	disabled
</span></span><span style=display:flex><span>NETWORKINTERFACES	Primary network interface	d0:0d:c1:ba:7d:64	eni-c1ba7d641cb70a7ee	000332850814	euca-172-31-15-2.eucalyptus.internal	172.31.15.2	True	in-usesubnet-1343e38b5566c8e90	vpc-bded94e5dd0a07bc3
</span></span><span style=display:flex><span>ASSOCIATION	euca-192-168-134-74.eucalyptus.mycloud.example.com	192.168.134.74
</span></span><span style=display:flex><span>ATTACHMENT	2020-10-19T16:35:36.125Z	eni-attach-d597b44874e84bbb2	True	0	attached
</span></span><span style=display:flex><span>GROUPS	sg-84741faf0bd87ea73	default
</span></span><span style=display:flex><span>PRIVATEIPADDRESSES	True	euca-172-31-15-2.eucalyptus.internal	172.31.15.2
</span></span><span style=display:flex><span>ASSOCIATION	euca-192-168-134-74.eucalyptus.mycloud.example.com	192.168.134.74
</span></span><span style=display:flex><span>PLACEMENT	cloud-1a
</span></span><span style=display:flex><span>SECURITYGROUPS	sg-84741faf0bd87ea73	default
</span></span><span style=display:flex><span>STATE	16	running
</span></span></code></pre></div><p>Note that the public IP address is on the <em>INSTANCES</em> line after &ldquo;mycloud.example.com&rdquo;, the private address is after &ldquo;eucalyptus.internal&rdquo;.</p><p>Look for the instance ID on the <em>INSTANCE</em> line and write it down. Use this ID to manipulate and terminate this instance.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Be sure that the security group for the instance allows SSH access.</div><p>Use SSH to log into the instance, using your private key and the public IP address. For example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh -i alice-keypair.private root@192.168.134.74 
</span></span></code></pre></div><p>You are now logged in to your Linux instance.</p><h2 id=terminate-an-instance>Terminate an Instance</h2><p>The terminate-instances command lets you cancel running VM instances. When you terminate instances, you must specify the ID string of the instance(s) you wish to terminate. You can obtain the ID strings of your instances using the describe-instances or describe-instance-status commands.</p><div class="alert alert-warning" role=alert><h4 class=alert-heading>Warning</h4>Terminating an instance can cause the instance and all items associated with the instance (data, packages installed, etc.) to be lost. Be sure to save any important work or data to Object Storage or EBS before terminating an instance.</div><p>To terminate VM instances:</p><p>Enter describe-instance-status to obtain the ID of the instances you wish to terminate. Note that an instance ID strings begin with the prefix <code>i-</code> followed by an 8-character string:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># aws ec2 describe-instance-status </span>
</span></span><span style=display:flex><span>INSTANCESTATUSES	cloud-1a	i-131e5853a71c87f16
</span></span><span style=display:flex><span>INSTANCESTATE	16	running
</span></span><span style=display:flex><span>INSTANCESTATUS	ok
</span></span><span style=display:flex><span>DETAILS	reachability	passed
</span></span><span style=display:flex><span>SYSTEMSTATUS	ok
</span></span><span style=display:flex><span>DETAILS	reachability	passed
</span></span></code></pre></div><p>Enter terminate-instances and the ID string(s) of the instance(s) you wish to terminate:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># aws ec2 terminate-instances --instance-ids i-131e5853a71c87f16</span>
</span></span><span style=display:flex><span>TERMINATINGINSTANCES	i-131e5853a71c87f16
</span></span><span style=display:flex><span>CURRENTSTATE	32	shutting-down
</span></span><span style=display:flex><span>PREVIOUSSTATE	16	running
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-d7a6d5f63064093cc68394c2fd2504bc>3.2.3 - Getting Started with Euca2ools</h1><p>This section helps you get started using your Eucalyptus cloud, and covers setting up your user credentials, installing and configuring the command line tools, and working with images and instances.As a cloud user, you can access the Eucalyptus cloud using a command line interface such as Euca2ools, or using a web-based interface such as the Eucalyptus Management Console.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>This section primarily deals with using the Eucalyptus command line. For complete documentation on using web-based the Eucalyptus Console, see <a href=https://www.eucastack.io/docs/user_guide/getting_started/getting_started_console/console_login/>Console Login</a>.</div><p>To access Eucalyptus via the command line tools, you need keys for Euca2ools. To access Eucalyptus with the Management Console, you&rsquo;ll need a password for the Management Console. Talk to your cloud administrator to get your keys and passwords.</p><h2 id=find-image>Find Image</h2><p>Enter the following command:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># euca-describe-images -a</span>
</span></span><span style=display:flex><span>IMAGE	emi-0ba907069cb1845bc	ubuntu-focal/focal-server-cloudimg-amd64.raw.manifest.xml	000575948401	available	public	x86_64	machine				instance-storehvm	
</span></span><span style=display:flex><span>IMAGE	emi-371ada125a928669e	centos-7/CentOS-7-x86_64-GenericCloud-2003.raw.manifest.xml	000575948401	available	public	x86_64	machine				instance-storehvm	
</span></span></code></pre></div><p>Look for the image ID in the second column and write it down. The image ID starts with <code>emi-</code> . Once you find a suitable image to use, make sure you have a keypair to use.</p><h2 id=create-keypairs>Create KeyPairs</h2><p>Enter the following command:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>euca-create-keypair -f &lt;keypair_name&gt;.private &lt;keypair_name&gt;
</span></span></code></pre></div><p>where <code>&lt;keypair_name></code> is a unique name for your keypair. For example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>euca-create-keypair -f <span style=color:#4e9a06>&#34;alice-keypair.private&#34;</span> <span style=color:#4e9a06>&#34;alice-keypair&#34;</span>
</span></span></code></pre></div><p>The private key is saved to a file in your local directory. Query the system to view the public key:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># euca-describe-keypairs</span>
</span></span><span style=display:flex><span>KEYPAIR	alice-keypair	92:40:28:cb:08:54:80:95:8d:69:d9:ab:9a:ff:28:30:40:12:6a:66
</span></span></code></pre></div><h2 id=authorize-security-groups>Authorize Security Groups</h2><p>Before you can log in to an instance, you must authorize access to that instance. This done by configuring a security group for that instance.</p><p>A security group is a set of networking rules applied to instances associated with that group. When you first create an instance, it is assigned to a default security group that denies incoming network traffic from all sources. To allow login and usage of a new instance, you must authorize network access to the default security group with the euca-authorize command.</p><p>To authorize a security group, use euca-authorize with the name of the security group, and the options of the network rules you want to apply.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>euca-authorize &lt;security_group&gt;
</span></span></code></pre></div><p>Use the following command to grant unlimited network access using SSH (TCP, port 22) and VNC (TCP, ports 5900 to 5910) to the security group <code>default</code> :</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># euca-authorize -P tcp -p 22 -s 0.0.0.0/0 default</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># euca-authorize -P tcp -p 5900-5910 -s 0.0.0.0/0 default</span>
</span></span></code></pre></div><h2 id=launch-an-instance>Launch an Instance</h2><p>Use the euca-run-instances command and provide an image ID and the user data file, in the format <code>euca-run-instances &lt;image_id></code> . For example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>euca-run-instances emi-371ada125a928669e
</span></span></code></pre></div><p>For additional details and options that can be used with the <em>euca-run-instances</em> command. Enter the following command to get the launch status of the instance:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>euca-describe-instances &lt;instance_id&gt;
</span></span></code></pre></div><h2 id=log-in-to-an-instance>Log in to an Instance</h2><p>When you create an instance, Eucalyptus assigns the instance two IP addresses: a public IP address and a private IP address. The public IP address provides access to the instance from external network sources; the private IP address provides access to the instance from within the Eucalyptus cloud environment. For more information on Eucalyptus networking modes, see the <a href=https://www.eucastack.io/docs/admin_guide/>Eucalyptus Administrator’s Guide</a>.</p><p>To use an instance you must log into it via ssh using one of the IP addresses assigned to it. You can obtain the instance’s IP addresses using the euca-describe-instances query as shown in the following example.</p><p>To log into a VM instance:</p><p>Enter the following command to view the IP addresses of your instance:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># euca-describe-instances</span>
</span></span><span style=display:flex><span>RESERVATION	r-825a2c9c04e97ee62	000332850814	default
</span></span><span style=display:flex><span>INSTANCE	i-131e5853a71c87f16	emi-371ada125a928669e	euca-192-168-134-74.eucalyptus.mycloud.example.com	euca-172-31-15-2.eucalyptus.internal	running		0		t2.micro	2020-10-19T16:35:36.120Z	cloud-1a				monitoring-disabled	192.168.134.74	172.31.15.2	vpc-bded94e5dd0a07bc3	subnet-1343e38b5566c8e90	instance-store					hvm			sg-84741faf0bd87ea73				x86_64
</span></span><span style=display:flex><span>NETWORKINTERFACE	eni-c1ba7d641cb70a7ee	subnet-1343e38b5566c8e90	vpc-bded94e5dd0a07bc3	000332850814	in-use	172.31.15.2	euca-172-31-15-2.eucalyptus.internal	<span style=color:#204a87>true</span>
</span></span><span style=display:flex><span>ATTACHMENT		eni-attach-d597b44874e84bbb2	0	attached	2020-10-19T16:35:36.125Z	<span style=color:#204a87>true</span>
</span></span><span style=display:flex><span>ASSOCIATION	192.168.134.74		172.31.15.2
</span></span><span style=display:flex><span>GROUP	sg-84741faf0bd87ea73	default
</span></span><span style=display:flex><span>PRIVATEIPADDRESS	172.31.15.2	euca-172-31-15-2.eucalyptus.internal	primary
</span></span></code></pre></div><p>Note that the public IP address appears after the <em>monitoring-disabled</em> text, with the private address immediately following.</p><p>Look for the instance ID in the second field of the <em>INSTANCE</em> line and write it down. Use this ID to manipulate and terminate this instance.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Be sure that the security group for the instance allows SSH access.</div><p>Use SSH to log into the instance, using your private key and the public IP address. For example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh -i alice-keypair.private root@192.168.134.74 
</span></span></code></pre></div><p>You are now logged in to your Linux instance.</p><h2 id=terminate-an-instance>Terminate an Instance</h2><p>The <em>euca-terminate-instances</em> command lets you cancel running VM instances. When you terminate instances, you must specify the ID string of the instance(s) you wish to terminate. You can obtain the ID strings of your instances using the <em>euca-describe-instances</em> or <em>euca-describe-instance-status</em> commands.</p><div class="alert alert-warning" role=alert><h4 class=alert-heading>Warning</h4>Terminating an instance can cause the instance and all items associated with the instance (data, packages installed, etc.) to be lost. Be sure to save any important work or data to Object Storage or EBS before terminating an instance.</div><p>To terminate VM instances:</p><p>Enter <em>euca-describe-instance-status</em> to obtain the ID of the instances you wish to terminate. Note that an instance ID strings begin with the prefix <code>i-</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># euca-describe-instance-status</span>
</span></span><span style=display:flex><span>INSTANCE	i-131e5853a71c87f16	cloud-1a	running	16	ok	ok	active	
</span></span><span style=display:flex><span>SYSTEMSTATUS	reachability	passed	
</span></span><span style=display:flex><span>INSTANCESTATUS	reachability	passed
</span></span></code></pre></div><p>Enter <em>euca-terminate-instances</em> and the ID string(s) of the instance(s) you wish to terminate:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># euca-terminate-instances i-131e5853a71c87f16</span>
</span></span><span style=display:flex><span>INSTANCE	i-131e5853a71c87f16	running	shutting-down
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-8cef1bc119dfdc0a049083c756c1e3b0>3.3 - Using Instances</h1><h1 id=using-instances>Using Instances</h1><p>Any application that runs on a cloud, whether public or private or hybrid, runs inside at least one . To start using the cloud, you must launch one or more instances. Every instance is created from stored . An image contains the basic operating system and often other software that will be needed when the instance is running. When you launch an instance, you tell the cloud what image to base the instance on. Your cloud administrator should have set up a catalog of standard or customized images for you to use.To find out more about what instances are, see <a href=https://www.eucastack.io/docs/user_guide/using_instances/understanding_instances/>Instance Overview</a> .</p><p>To find out how to use CloudWatch, see <a href=https://www.eucastack.io/docs/user_guide/using_instances/working_instance/>Instance Tasks</a> .</p></div><div class=td-content style=page-break-before:always><h1 id=pg-c8c8904933395220f6e6f02f9f38f8ab>3.3.1 - Instance Overview</h1><h1 id=instance-overview>Instance Overview</h1><p>An instance is a virtual machine (VM). Eucalyptus allows you to run instances from registered images.</p><p>The following sections describe instances in more detail.</p></div><div class=td-content><h1 id=pg-707e8d9b576f5953437508761993f01c>3.3.1.1 - Instance Concepts</h1><p>This section describes conceptual information to help you understand instances.</p><h2 id=eucalyptus-machine-image-emi>Eucalyptus Machine Image (EMI)</h2><p>A Eucalyptus machine image (EMI) is a copy of a virtual machine bootable file system stored in the Walrus storage. An EMI is a template from you can use to deploy multiple identical instances—or copies of the virtual machine.</p><p>EMIs are analogous to Amazon Machine Images (AMIs) in AWS. In fact, you can download and deploy any of the 10,000+ AMIs as EMIs in a Eucalyptus cloud without significant modification. While it is possible to build your own EMI, it is might be just as simple to find a thoroughly vetted, freely available image in AWS, download it to your Eucalyptus cloud, and use that instead.</p><p>When registered in a Eucalyptus cloud, each distinct EMI is given a unique ID for identification. The ID is in the format emi-<nnnnnnnn>.</p><p><img src=https://www.eucastack.io/images/Eucalyptus-Machine-Images.png alt=image></p><h2 id=instance>Instance</h2><p>A instance is a virtual machine deployed from an EMI. An instance then, is simply a running copy of an EMI, which means it always starts from a known baseline. There are two types of instances; instance store-backed and EBS-backed. This section describes store-backed instances. For information about EBS-backed instances, see <a href=https://www.eucastack.io/docs/user_guide/using_block_storage/>Using EBS</a> .</p><p><img src=https://www.eucastack.io/images/Instances-illustration.png alt=image></p><p>Every instance receives a unique ID in the format i-<nnnnnnnn>.</p><p>You can deploy multiple instances using a single command. In this case all the instances will have unique instance IDs but will share a common reservation ID. This reservation ID can be seen, for example, from the euca2ools <code>euca-describe-instances</code> command that lists running instances. Reservations IDs appear in the format r-<nnnnnnnn>.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>A <em>reservation</em> is an EC2 term used to describe the resources reserved for one or more instances launched in the cloud.</div><h2 id=persistence>Persistence</h2><p>Applications running in ephemeral instances that generate data that must be saved should write that data to some place other than the instance itself. There are two Eucalyptus options available. First, the data can be written to a volume that is attached to the instance. Volumes provided by the Storage Controller and attached to instances are persistent. Second, the data could be written to the Walrus using HTTP put/get operations. Walrus storage is also persistent.</p><p><img src=https://www.eucastack.io/images/Persistence-in-Ephemeral-Instances.png alt=image></p><p>If the application cannot be rewritten to send data to a volume or the Walrus, then the application should be deployed inside an EBS-backed instance. EBS-backed instances are persistent and operate in a manner more similar to a physical machine.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-c63429542400b7a279b8b1078a07fb43>3.3.1.2 - Instance Basics</h1><h1 id=instance-basics>Instance Basics</h1><p>This section describes information to help you decide which type of instance you need.</p></div><div class=td-content><h1 id=pg-b57674acf9fe6ea2a2a8008cfdff8ca2>3.3.1.2.1 - Virtual Machine Types</h1><p>A virtual machine type, known as a VM type, defines the number of CPUs, the size of memory, and the size of storage that is given to an instance when it boots. There are five pre-defined VM types in Eucalyptus. You can change the quantity of resources associated with each of the five VM types, but you cannot change the name of the VM types or the number of VM types available. If you customize the sizes they must be well-ordered. That means that the CPU, memory, and storage sizes of the next VM type must be equal to, or larger than, the size of the preceding VM type. </p><p>The VM type used to instantiate an EMI must have a defined disk size larger than the EMI file. If a 6GB EMI is loaded into an instance with a VM type defined with a 5GB disk, it will fail to boot. The status of the instance will show as <em>pending</em> .  The pending status is the result of the fact that the Walrus cannot finish downloading the image to the Node Controller because the Node Controller has not allotted sufficient disk space for the download. Starting with Eucalyptus 3.2, if the user attempts to launch an instance with a VM type that is too small, they will receive an on-screen warning and the operation will terminate.</p><h2 id=available-vm-types>Available VM Types</h2><p>Eucalyptus, like AWS, offers families of VM types. These families are composed of varying combinations of CPU, disk size, and memory. Eucalyptus offers enough VM types to give you the flexibility to choose the appropriate mix of resources for your applications. For the best experience, we recommend that you launch instance types that are appropriate for your applications.</p><ul><li><p>This family includes the M1 and M3 VM types. These types provide a balance of CPU, memory, and network resources, which makes them a good choice for many applications. The VM types in this family range in size from one virtual CPU with two GB of RAM to eight virtual CPUs with 30 GB of RAM. The balance of resources makes them ideal for running small and mid-size databases, more memory-hungry data processing tasks, caching fleets, and backend servers. M1 types offer smaller instance sizes with moderate CPU performance. M3 types offer larger number of virtual CPUs that provide higher performance. We recommend you use M3 instances if you need general-purpose instances with demanding CPU requirements.</p></li><li><p>This family includes the C1 and CC2 instance types, and is geared towards applications that benefit from high compute power. Compute-optimized VM types have a higher ratio of virtual CPUs to memory than other families but share the NCs with non optimized ones. We recommend this type if you are running any CPU-bound scale-out applications. CC2 instances provide high core count (32 virtual CPUs) and support for cluster networking. C1 instances are available in smaller sizes and are ideal for scaled-out applications at massive scale.</p></li><li><p>This family includes the CR1 and M2 VM types and is designed for memory-intensive applications. We recommend these VM types for performance-sensitive database, where your application is memory-bound. CR1 VM types provide more memory and faster CPU than do M2 types. CR1 instances also support cluster networking for bandwidth intensive applications. M2 types are available in smaller sizes, and are an excellent option for many memory-bound applications.</p></li><li><p>This Micro family contains the T1 VM type. The t1.micro provides a small amount of consistent CPU resources and allows you to increase CPU capacity in short bursts when additional cycles are available. We recommend this type for lower throughput applications like a proxy server or administrative applications, or for low-traffic websites that occasionally require additional compute cycles. We do not recommend this VM type for applications that require sustained CPU performance.
The following tables list each VM type Eucalyptus offers. Each type is listed in its associate VM family.</p></li></ul><table><thead><tr><th style=text-align:left>Instance Type</th><th style=text-align:left>Virtual CPU</th><th style=text-align:left>Disk Size</th><th style=text-align:left>Memory</th></tr></thead><tbody><tr><td style=text-align:left>m1.small</td><td style=text-align:left>1</td><td style=text-align:left>5</td><td style=text-align:left>256</td></tr><tr><td style=text-align:left>m1.medium</td><td style=text-align:left>1</td><td style=text-align:left>10</td><td style=text-align:left>512</td></tr><tr><td style=text-align:left>m1.large</td><td style=text-align:left>2</td><td style=text-align:left>10</td><td style=text-align:left>512</td></tr><tr><td style=text-align:left>m1.xlarge</td><td style=text-align:left>2</td><td style=text-align:left>10</td><td style=text-align:left>1024</td></tr><tr><td style=text-align:left>m3.xlarge</td><td style=text-align:left>4</td><td style=text-align:left>15</td><td style=text-align:left>2048</td></tr><tr><td style=text-align:left>m3.2xlarge</td><td style=text-align:left>4</td><td style=text-align:left>30</td><td style=text-align:left>4096</td></tr></tbody></table><table><thead><tr><th style=text-align:left>Instance Type</th><th style=text-align:left>Virtual Cores</th><th style=text-align:left>Disk Size</th><th style=text-align:left>Memory</th></tr></thead><tbody><tr><td style=text-align:left>c1.medium</td><td style=text-align:left>2</td><td style=text-align:left>10</td><td style=text-align:left>512</td></tr><tr><td style=text-align:left>c1.xlarge</td><td style=text-align:left>2</td><td style=text-align:left>10</td><td style=text-align:left>2048</td></tr><tr><td style=text-align:left>cc1.4xlarge</td><td style=text-align:left>8</td><td style=text-align:left>60</td><td style=text-align:left>3072</td></tr><tr><td style=text-align:left>cc2.8xlarge</td><td style=text-align:left>16</td><td style=text-align:left>120</td><td style=text-align:left>6144</td></tr></tbody></table><table><thead><tr><th style=text-align:left>Instance Type</th><th style=text-align:left>Virtual Cores</th><th style=text-align:left>Disk Size</th><th style=text-align:left>Memory</th></tr></thead><tbody><tr><td style=text-align:left>m2.xlarge</td><td style=text-align:left>2</td><td style=text-align:left>10</td><td style=text-align:left>2048</td></tr><tr><td style=text-align:left>m2.2xlarge</td><td style=text-align:left>2</td><td style=text-align:left>30</td><td style=text-align:left>4096</td></tr><tr><td style=text-align:left>m2.4xlarge</td><td style=text-align:left>8</td><td style=text-align:left>60</td><td style=text-align:left>4096</td></tr><tr><td style=text-align:left>cr1.8xlarge</td><td style=text-align:left>16</td><td style=text-align:left>240</td><td style=text-align:left>16384</td></tr></tbody></table><table><thead><tr><th style=text-align:left>Instance Type</th><th style=text-align:left>Virtual Cores</th><th style=text-align:left>Disk Size</th><th style=text-align:left>Memory</th></tr></thead><tbody><tr><td style=text-align:left>t1.micro</td><td style=text-align:left>1</td><td style=text-align:left>5</td><td style=text-align:left>256</td></tr></tbody></table></div><div class=td-content style=page-break-before:always><h1 id=pg-4e63c349678457b1b72c9935c40ac634>3.3.1.2.2 - Ephemeral Linux Instances</h1><p>Instance store-backed instances are ephemeral instances. This means that any changes made to a running instance are lost if the instance is either purposely or accidentally terminated. Applications running in ephemeral instances should write their data to persistent storage for safe keeping. Persistent storage available to instances includes Storage Controller volumes and the Walrus.</p><p>As an instance store-backed instance is launched, several files are brought together using loop devices on the Node Controller. As these files are brought together they form what looks like a disk to the instance&rsquo;s operating system. The illustration below lists a some of the files that make up a running instance. Notice that the EKI, EMI, and ERI images are presented to the instance&rsquo;s operating system as the partition <em>/dev/sda1</em> and are mounted as the <em>/</em> file system.</p><p><img src=https://www.eucastack.io/images/EC2-Backed-Ephemeral-Instances.png alt=image></p><p>Assume that the illustration above shows some of the files that make up an instance that was launched in a vmtype with 2GB of storage. Notice that the <em>eki-</em>* , <em>emi-</em>* , and <em>eri-</em>* files have been downloaded from the Walrus and cached on the Node Controller. These three files consume around 1.06GB of storage space. Notice also that a swap file was automatically created for the instance. The swap file has the string <em>swap</em> in its name and the file is approximately 500MB in size. It is presented to the instance&rsquo;s operating system as the partition <em>/dev/sda3</em> .</p><p>This means the EKI, ERI, EMI, and swap files have consumed approximately 1.5GB of the available 2GB of storage space. The remaining 500GB is allocated to the file with the string <em>ext3</em> in its name. In our example, this space is formatted as an ext3 file system and is made available to the instance as the disk partition <em>/dev/sda2</em> , and is actually mounted to the <em>/mnt</em> directory in the instance. An example of this configuration is shown below.</p><p><img src=https://www.eucastack.io/images/Ephemeral-Disk-Illustration.png alt=image></p></div><div class=td-content style=page-break-before:always><h1 id=pg-d62df5951494ee46a1ad7a21c0b7416d>3.3.1.2.3 - EBS-Backed Instances</h1><h1 id=ebs-backed-instances>EBS-Backed Instances</h1><p>Eucalyptus supports two different types of instances; instance store-backed instances and EBS-backed instances. This section describes EBS-backed instances.</p><p>With EBS-backed instances you are booting an instance from a volume rather than a bundled EMI image. The boot volume is created from a snapshot of a root device volume. The boot volume is persistent so changes to the instance are persistent.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Linux boot-from-EBS instances do not require EKI and ERI images like paravirtual instance store-backed instances.</div><p><img src=https://www.eucastack.io/images/EBS-Backed-Instances.png alt=image></p></div><div class=td-content style=page-break-before:always><h1 id=pg-502b551b05ef67f98038caf6f8a4eb57>3.3.1.2.3.1 - Comparing Instance Types</h1><p>The graphic below illustrates the differences between an instance store-backed instance and an EBS-backed instance.   Both types of instances still boot from an EMI; the difference is what is behind the EMI.   For an instance store-backed instance the EMI is backed by a bundled image.  For an EBS-backed instance the EMI is backed by a snapshot of a volume that contains bootable software, similar to a physical host&rsquo;s boot disk.</p><p><img src=https://www.eucastack.io/images/Comparing-Types.png alt=image></p><p>Note that for the instance store-backed instance, the EMI, EKI, and ERI (assuming Linux) are copied from the Walrus directly to Node Controller.  Both disk and memory on the Node Controller are used as cache so an instance store-backed instance can be considered a cache-based instance and is not persistent.  Once the instance is terminated both the RAM and the disk cache are cleared and any modifications to the instance are lost.</p><p>When an EBS-backed instance is launched, the snapshot on which the EMI is based is automatically copied to a new volume which is then attached to the instance. The instance then boots from the attached volume. Changes to the EBS-backed instance are persistent because the volume used to boot the EBS-backed instance is persistent.  As a result, EBS-backed instances can be suspended and resumed and not just terminated like an instance store-backed instance.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-c7b3795a5460a910fe5dac797f20ad4e>3.3.1.2.3.2 - Using EBS-Backed Instances</h1><p>An EBS-backed instance is very much like a physical machine in the way it boots and persists data.  Because an EBS-backed instance functions in a manner similar to physical machine, it makes it a good choice to run legacy applications that cannot be re-architected for the cloud. </p><p><img src=https://www.eucastack.io/images/Using-EBS-Instances.png alt=image></p><p>An EBS-backed boot volume can still be protected by taking a snapshot of it.  In fact, other non-boot volumes can be attached to the EBS-backed instance and they can be protected using snapshots too.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-c2fe73bb7c748d43cef3c10c00583725>3.3.1.2.3.3 - Suspending and Resuming EBS-Backed Instances</h1><p>An EBS-backed instance can be suspended and resumed, similar to the operating system and applications on a laptop.   The current state of the EBS-backed instance is saved in a suspend operation and restored in a resume operation.  Like instance store-backed instances, an EBS-backed instance can also be rebooted and terminated.</p><p>To suspend a running EBS-backed instance:</p><pre><code>euca-stop-instances i-&lt;nnnnnnnn&gt;
</code></pre><p>To resume a suspended EBS-backed instance:</p><pre><code>euca-start-instances i-&lt;nnnnnnnn&gt;
</code></pre><p>To reboot an EBS-backed instance:</p><pre><code>euca-reboot-instances i-&lt;nnnnnnnn&gt;
</code></pre><p>To terminate an EBS-backed instance:</p><pre><code>euca-terminate-instances i-&lt;nnnnnnnn&gt;
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-41690748817a78956fae5de69ab20ec6>3.3.1.2.3.4 - EBS EMI Creation Overview</h1><h1 id=ebs-emi-creation-overview>EBS EMI Creation Overview</h1><p>You can create an EBS EMI from an existing <em>.img</em> file or create your own <em>.img</em> file.  One way to create your own EBS <em>.img</em> file is to use <code>virt-install</code> as described below.</p><p>Use <code>virt-install</code> on a system with the same operating system version and hypervisor as your Node Controller. When using <code>virt-install</code> , select <em>scsi</em> as the disk type for KVM if the VIRTIO paravirtualized devices are not enabled. If you have KVM with VIRTIO enabled (the default), select <em>virtio</em> as the disk type of the virtual machine. If you create, successfully boot, and connect the virtual machine to the network in this environment, it should boot as an EBS-backed instance in the Eucalyptus cloud.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>For CentOS or RHEL images, you will typically need to edit the file and remove the line. This is because an instance&rsquo;s network interface will always be assigned a different hardware address at instantiation.</div><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>: If you use an image created by under a different distribution or hypervisor combination, it is likely that it will not install the correct drivers into the ramdisk and the image will not boot on your Node Controller.</div><p>To create an EMI for EBS-backed instances will require initial assistance from a <em>helper</em> instance.  The helper instance can be either an instance store-backed or EBS-backed instance and can be deleted when finished.  It only exists to help create the initial volume that will be the source of the snapshot behind the EMI used to boot other EBS-backed instances.</p><p>First you will need to create a volume large enough to contain the boot image file that was created by <code>virt-install</code> .  Once this volume has been created attach it to the helper instance. Then transfer the boot image file to the helper instance.  The helper instance must have enough free disk space to temporarily hold the boot image file. Once there, transfer the boot image file, using the <code>dd</code> command, to the attached volume.</p><p>At this point the volume can be detached from the helper instance, a snapshot taken, and the snapshot registered as a new EMI.</p><p>The process to create a new EMI is summarized as follows:</p><ol><li>Create the file using (the file is the virtual machine&rsquo;s disk file).</li><li>Create the helper instance.</li><li>Create and attach the volume to the helper instance.</li><li>Copy the file to the helper instance and from there to the attached volume.</li><li>Detach the volume and take a snapshot of it.</li><li>Register the snapshot as a new EMI.</li></ol><p>This process is illustrated below.</p><p><img src=https://www.eucastack.io/images/Creating-an-EBS-EMI.png alt=image></p></div><div class=td-content style=page-break-before:always><h1 id=pg-4c08ac2498e9684f659efd667898b1fc>3.3.1.2.3.4.1 - Create an EBS EMI</h1><p>To create a new EMI that is used to boot EBS-backed instances:</p><ol><li><p>Create a new volume whose size matches the size of the bootable file:</p></li><li><p>Attach the volume to a helper instance:</p></li><li><p>Log in to the instance and copy the bootable image from its source to the helper instance.</p></li><li><p>While logged in to the helper instance, copy a bootable image to the attached volume:</p></li><li><p>While logged in to the helper instance, flush the file system buffers after running the command:</p></li><li><p>Detach the volume from the instance:</p></li><li><p>Create a snapshot of the bootable volume:</p></li><li><p>Register the bootable volume as a new EMI:</p></li><li><p>Run a new EBS-backed instance:</p></li></ol><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>The snapshot cannot be deleted unless the EMI is first deregistered.</div></div><div class=td-content style=page-break-before:always><h1 id=pg-83652bc4be9268467c42ab3484f0e40a>3.3.2 - Instance Tasks</h1><h1 id=instance-tasks>Instance Tasks</h1><p>This section describes the tasks you can perform with instances in Eucalyptus.</p></div><div class=td-content><h1 id=pg-4431c3c3b61c62f799aec4295b107972>3.3.2.1 - Authorize Security Groups</h1><p>Before you can log in to an instance, you must authorize access to that instance. This done by configuring a security group for that instance.</p><p>A security group is a set of networking rules applied to instances associated with a group. When you first create an instance, it is assigned to a default security group that denies incoming network traffic from all sources. To allow login and usage of a new instance, you must authorize network access to the default security group with the euca-authorize command.</p><p>To authorize a security group, use euca-authorize with the name of the security group, and the options of the network rules you want to apply.</p><pre><code>euca-authorize &lt;security_group&gt;
</code></pre><p>Use the following command to grant unlimited network access using SSH (TCP, port 22) and VNC (TCP, ports 5900 to 5910) to the security group <code>default</code> :</p><pre><code>euca-authorize -P tcp -p 22 -s 0.0.0.0/0 default
euca-authorize -P tcp -p 5900-5910 -s 0.0.0.0/0 default
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-546931904329351c201dba64cb89bb39>3.3.2.2 - Create Key Pairs</h1><p>Eucalyptus uses cryptographic key pairs to verify access to instances. Key pairs are used if you want to connect to your instance using SSH. Creating a key pair generates two keys: a public key (saved within Eucalyptus) and a corresponding private key (output to the user as a character string). To enable this private key you must save it to a file and set appropriate access permissions (using the chmod command), as shown in the example below.</p><h2 id=create-key-pairs-with-the-console>Create Key Pairs with the Console</h2><p>From the main dashboard screen, click the Key Pairs icon. The Key Pairs page opens. Click the Create Key Pair button. The Create new key pair window opens. Type a name for the new key pair into the Name text box. The name may contain up to 255 alphanumeric and special characters. Click the Create and Download button. The private half of the key pair (.pem file) is saved to the default download location for your browser.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Keep your private key file in a safe place. If you lose it, you will be unable to access instances created with the key pair.</div>Change file permissions to enable access to the private key file in the local directory. For example, on a Linux or Mac OS X system:</p><pre><code>chmod 0600 &lt;keypair_name&gt;.private
</code></pre><h2 id=create-key-pairs-with-the-command-line>Create Key Pairs with the Command Line</h2><p>Enter the following command:</p><pre><code>euca-create-keypair &lt;keypair_name&gt; -f &lt;keypair_name&gt;.private
</code></pre><p>where <code>&lt;keypair_name></code> is a unique name for your keypair. For example:</p><pre><code>euca-create-keypair alice-keypair -f alice-keypair.private 
</code></pre><p>The private key is saved to a file in your local directory. Query the system to view the public key:</p><pre><code>euca-describe-keypairs
</code></pre><p>The command returns output similar to the following:</p><pre><code>KEYPAIR alice-keypair ad:0d:fc:6a:00:a7:e7:b2:bc:67:8e:31:12:22:c1:8a:77:8c:f9:c4
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-905ee14893a84b2745ff29c0ef61b535>3.3.2.3 - Find an Image</h1><p>To find an image:</p><p>Enter the following command:</p><pre><code>euca-describe-images
</code></pre><p>The output displays all available images.</p><pre><code>IMAGE	emi-EC1410C1	centos-32/centos.5-3.x86.img.manifest.xml ↵
admin	available	public 	x86_64	machine
IMAGE	eki-822C1344	kernel-i386/vmlinuz-2.6.28-11-server.manifest.xml ↵
admin	available	public 	x86_64	kernel
IMAGE	eri-A98C13E4  initrd-64/initrd.img-2.6.28-11-generic.manifest.xml ↵
admin	available	public 	x86_64	ramdisk
</code></pre><p>Look for the image ID in the second column and write it down. The image ID starts with <code>emi-</code> . Once you find a suitable image to use, make sure you have a keypair to use.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-525f763e09b9be41d25f1be85b460a5b>3.3.2.4 - Launch an Instance</h1><p>To launch an instance:</p><p>Use the euca-run-instances command and provide an image ID and the user data file, in the format <code>euca-run-instances &lt;image_id></code> . For example:</p><pre><code>euca-run-instances emi-EC1410C1 
</code></pre><p>For additional details and options that can be used with the <em>euca-run-instances</em> command. Enter the following command to get the launch status of the instance:</p><pre><code>euca-describe-instances &lt;instance_id&gt;
</code></pre><p>Need response from Eucalyptus then uncomment the para below.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-e176b4c3908ff2cbf5db5f64c1ebee7e>3.3.2.5 - Log in to an Instance</h1><h2 id=for-a-linux-instance>For a Linux Instance</h2><p>When you create an instance, Eucalyptus assigns the instance two IP addresses: a public IP address and a private IP address. The public IP address provides access to the instance from external network sources; the private IP address provides access to the instance from within the Eucalyptus cloud environment. Note that the two IP addresses may be the same depending on the current networking mode set by the administrator. For more information on Eucalyptus networking modes, see the Eucalyptus Administrator’s Guide.</p><p>To use an instance you must log into it via ssh using one of the IP addresses assigned to it. You can obtain the instance’s IP addresses using the euca-describe-instances query as shown in the following example.</p><p>To log into a VM instance:</p><p>Enter the following command to view the IP addresses of your instance:</p><pre><code>euca-describe-instances
</code></pre><p>Eucalyptus returns output similar to the following:</p><pre><code>RESERVATION	r-338206B5	alice	default
INSTANCE	i-4DCF092C  emi-EC1410C1  192.168.7.24	  10.17.0.130 ↵ running 	alice-keypair 	0 	m1.small  2010-03-15T21:57:45.134Z
</code></pre><p>Note that the public IP address appears after the image name, with the private address immediately following.</p><p>Look for the instance ID in the second field and write it down. Use this ID to manipulate and terminate this instance.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Be sure that the security group for the instance allows SSH access. For more information, see</div>Use SSH to log into the instance, using your private key and the external IP address. For example:</p><pre><code>ssh -i alice-keypair.private root@192.168.7.24 
</code></pre><p>You are now logged in to your Linux instance.</p><h2 id=using-ssh-to-connect-via-putty>Using SSH to Connect via PuTTY</h2><p>If you are a Windows user and want to securely connect to instances via PuTTY, you must first have a key pair.If you don&rsquo;t have a key pair, you can create one through the Management Console or the command line. For the key pair to be used with PuTTY, convert your .pem file to a .ppk file by performing the last step in the <a href=http://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-plan-access-ssh.html>Creating SSH Credentials for the Master Node: Modify Your PEM File</a> procedure.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-2f379d6e014e7c1d96aff4819e677b7c>3.3.2.6 - Reboot an Instance</h1><p>Rebooting preserves the root filesystem of an instance across restarts. To reboot an instance:</p><p>Enter the following command:</p><pre><code>euca-reboot-instances &lt;instance_id&gt;
</code></pre><p>To reboot the instance <code>i-34523332</code> , enter:</p><pre><code>euca-reboot-instances i-34523332
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-469bfcc1237864a18c2680a9642d16ba>3.3.2.7 - Terminate an Instance</h1><p>The <code>euca-terminate-instances</code> command lets you cancel running VM instances. When you terminate instances, you must specify the ID string of the instance(s) you wish to terminate. You can obtain the ID strings of your instances using the euca-describe-instances command.</p><p><div class="alert alert-warning" role=alert><h4 class=alert-heading>Warning</h4>Terminating an instance can cause the instance and all items associated with the instance (data, packages installed, etc.) to be lost. Be sure to save any important work or data to Walrus or EBS before terminating an instance.</div>To terminate VM instances:</p><p>Enter <code>euca-describe</code> instances to obtain the ID of the instances you wish to terminate. Note that an instance ID strings begin with the prefix <code>i-</code> followed by an 8-character string:</p><pre><code>euca-describe-instances
RESERVATION	r-338206B5	alice	default
INSTANCE	i-4DCF092C  emi-EC1410C1	192.168.7.24	10.17.0.130 ↵
running 	mykey 	0 	m1.small 	2010-03-15T21:57:45.134Z ↵
wind 	eki-822C1344 	eri-BFA91429
</code></pre><p>Enter <code>euca-terminate-instances</code> and the ID string(s) of the instance(s) you wish to terminate:</p><pre><code>euca-terminate-instances i-4DCF092C
 INSTANCE	i-3ED007C8
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-0be18b368f65d8d2c92834ec5538e410>3.4 - Using EBS</h1><h1 id=using-ebs>Using EBS</h1><p>This section details what you need to know about Eucalyptus Elastic Block Storage (EBS).</p></div><div class=td-content><h1 id=pg-31c75827e10c1e182a3219af935fc5ec>3.4.1 - EBS Overview</h1><p>Eucalyptus Elastic Block Storage (EBS) provides block-level storage volumes that you can attach to instances running in your Eucalyptus cloud. An EBS volume looks like any other block-level storage device when attached to a running Eucalyptus instance, and may be formatted with an appropriate file system and used as you would a regular storage device. Any changes that you make to an attached EBS volume will persist after the instance is terminated.</p><p>You can create an EBS volume by using the Eucalyptus command line tools or by using the Eucalyptus management console and specifying the desired size (up to 10GB) and availability zone. Once you&rsquo;ve created an EBS volume, you can attach it to any instance running in the same availability zone. An EBS volume can only be attached to one running instance at a time, but you can attach multiple EBS volumes to a running instance.</p><p>You can create a backup — called a <em>snapshot</em> — of any Eucalyptus EBS volume. You can create a snapshot by using the command-line tools or the Eucalyptus management console and simply specifying the volume from which you want to create the snapshot, along with a description of the snapshot. Snapshots can be used to create new volumes.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-b7ccf5028c0d51a8483e0e9dbab864c4>3.4.2 - EBS Tasks</h1><h1 id=ebs-tasks>EBS Tasks</h1><p>This section contains examples of the most common Eucalyptus EBS tasks.</p></div><div class=td-content><h1 id=pg-b35aea79c89f1e994e72383068d64b2f>3.4.2.1 - Create and Attach an EBS Volume</h1><p>The following example shows how to create a 10 gigabyte EBS volume and attach it to a running instance called <code>i-00000000</code> running in availability zone <code>zone1</code> .</p><p>Create a new EBS volume in the same availability zone as the running instance.</p><pre><code>euca-create-volume --availability-zone zone1 --size 10
</code></pre><p>The command displays the ID of the newly-created volume. Attach the newly-created volume to the instance, specifying the local device name <code>/dev/sdf</code> .</p><pre><code>euca-attach-volume vol-00000000 -i i-00000000 -d /dev/sdf
</code></pre><p>You&rsquo;ve created a new EBS volume and attached it to a running instance. You can now access the EBS volume from your running instance.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-4d27f361294d4088d42f0e2f28e4fc06>3.4.2.2 - List Available EBS Volumes</h1><p>You can use the Eucalyptus command line tools to list all available volumes and retrieve information about a specific volume.</p><p>To get a list of all available volumes in your Eucalyptus cloud, enter the following command:</p><pre><code>euca-describe-volumes
</code></pre><p>To get information about one specific volume, use the <code>euca-describe-volumes</code> command and specify the volume ID.</p><pre><code>euca-describe-volumes vol-00000000
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-342628b6c418ae44913f5db90085207b>3.4.2.3 - Detach an EBS Volume</h1><p>To detach a block volume from an instance:</p><p>Enter the following command:</p><pre><code>euca-detach-volume &lt;volume_id&gt;



euca-detach-volume vol-00000000
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-5a971a6386dcddcbeafeaec0a93954d1>3.4.2.4 - Create a Snapshot</h1><p>The following example shows how to create a snapshot.</p><p>Enter the following command:</p><pre><code>euca-create-snapshot &lt;volume_id&gt;



euca-create-snapshot vol-00000000
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-71839a6768e53254fa7a77f3762aa369>3.4.2.5 - List Available Snapshots</h1><p>You can use the Eucalyptus command line tools to list available snapshots and retrieve information about a specific snapshot.</p><p>To get a list of all available snapshots in your Eucalyptus cloud, enter the following command:</p><pre><code>euca-describe-snapshots
</code></pre><p>To get information about one specific snapshot, use the <code>euca-describe-snapshots</code> command and specify the snapshot ID.</p><pre><code>euca-describe-snapshots snap-00000000
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-67417bb3e6e5b99bc61bd05c2c357333>3.4.2.6 - Delete a Snapshot</h1><p>The following example shows how to delete a snapshot.</p><p>Enter the following command:</p><pre><code>euca-delete-snapshot &lt;snapshot_id&gt;



euca-delete-snapshot mytestsnaphot
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-bc2ec5acd11c798f24b0d13d9b265b43>3.5 - Using Tags and Filters</h1><h1 id=using-tags-and-filters>Using Tags and Filters</h1><p>This section describes features and tasks that enable you to manage your cloud resources, such as EMIs, instances, EBS volumes, and snapshots.</p></div><div class=td-content><h1 id=pg-6336ee0d735b8b532ea96ff02720c720>3.5.1 - Tagging and Filtering Overview</h1><h1 id=tagging-and-filtering-overview>Tagging and Filtering Overview</h1><p>This section describes what tagging is, its restrictions, and how tagging relates to filtering.</p></div><div class=td-content><h1 id=pg-60a80d0c9ddbf683a4e4190e48ed483e>3.5.1.1 - Tagging Resources</h1><p>To help you manage your cloud&rsquo;s instances, images, and other Eucalyptus resources, you can assign your own metadata to each resource in the form of tags. You can use tags to create user-friendly names, make resource searching easier, and improve coordination between multiple users. This section describes tags and how to create them.</p><h2 id=tagging-overview>Tagging Overview</h2><p>A tag consists of a key and an optional value for that key. You define both the key and the value for each tag. For example, you can define a tag for your instances that helps you track each instance&rsquo;s owner and stack level.</p><p>Tags let you categorize your cloud resources in various ways. For example, you can tag resources based on their purpose, their owner, or their environment. We recommend that you devise a set of tag keys that meets your needs for each resource type. Using a consistent set of tag keys makes it easier for you to manage your resources. You can search and filter the resources based on the tags you add. For more information about filtering, see <a href=https://www.eucastack.io/docs/user_guide/resource_and_tags/understanding_tagging/resource_filtering/>Filtering Resources</a> .</p><p>Eucalyptus doesn&rsquo;t apply any semantic meaning to your tags. Instead, Eucalyptus interprets your tags simply as strings of characters. Eucalyptus doesn&rsquo;t automatically assign any tags on resources.</p><p>You can only assign tags to resources that already exist. However, if you use the Management Console, you can add tags when you launch an instance. If you add a tag that has the same key as an existing tag on that resource, the new value overwrites the old value. You can edit tag keys and values, and you can remove tags from a resource at any time. You can set a tag&rsquo;s value to the empty string, but you can&rsquo;t set a tag&rsquo;s value to null.</p><h2 id=tagging-restrictions>Tagging Restrictions</h2><p>The following restrictions apply to tags:</p><table><thead><tr><th style=text-align:left>Restriction</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left>Maximum number of tags per resource</td><td style=text-align:left>10</td></tr><tr><td style=text-align:left>Maximum key length</td><td style=text-align:left>128 Unicode characters</td></tr><tr><td style=text-align:left>Maximum value length</td><td style=text-align:left>256 Unicode characters</td></tr><tr><td style=text-align:left>Unavailable prefixes</td><td style=text-align:left>You can&rsquo;t use either euca: or aws: as a prefix to either a tag name or value. These are reserved by Eucalyptus.</td></tr><tr><td style=text-align:left>Case sensitivity</td><td style=text-align:left>Tag keys and values are case sensitive.</td></tr></tbody></table><p>You can&rsquo;t terminate, stop, or delete a resource based solely on its tags. You must specify the resource identifier. For example, to delete snapshots that you tagged with a tag key called <code>temporary</code> , you must first get a list of those snapshots using euca-describe-snapshots with a filter that specifies the tag. Then you use euca-delete-snapshots with the IDs of the snapshots (for example, snap-1A2B3C4D). You can&rsquo;t call euca-delete-snapshots with a filter that specified the tag. For more information about using filters when listing your resources, see <a href=https://www.eucastack.io/docs/user_guide/resource_and_tags/understanding_tagging/resource_filtering/>Filtering Resources</a> .</p><h2 id=available-resources>Available Resources</h2><p>You can tag the following cloud resources:</p><ul><li><p>Images (EMIs, kernels, RAM disks)</p></li><li><p>Instances</p></li><li><p>Volumes</p></li><li><p>Snapshots</p></li><li><p>Security Groups
You can&rsquo;t tag the following cloud resources:</p></li><li><p>Elastic IP addresses</p></li><li><p>Key pairs</p></li><li><p>Placement groups
You can tag public or shared resources, but the tags you assign are available only to your account and not to the other accounts sharing the resource.</p></li></ul><h2 id=heading></h2></div><div class=td-content style=page-break-before:always><h1 id=pg-aa8f5aec560ade894a46a3970dfbf14e>3.5.1.2 - Filtering Resources</h1><p>You can search and filter resources based on the tags you use. For example, you can list a Eucalyptus Machine Image (EMI) using euca-describe-images, and you can list instances using euca-describe-instances .</p><h2 id=filtering-overview>Filtering Overview</h2><p>Results from describe commands can be long. Use a filter to include only the resources that match certain criteria. For example, you can filter so that a returned list shows only the EMIs that use an EBS volume as the root device volumes.</p><p>Filtering also allows you to:</p><ul><li>Specify multiple filter values: For example, you can list all the instances whose type is either m1.small or m1.large.</li><li>Specify multiple filters: for example, you can list all the instances whose type is either m1.small or m1.large, and that have an attached EBS volume that is set to delete when the instance terminates.</li><li>Use wildcards with values: For example, you can use <em>production</em> as a filter value to get all EBS snapshots that include production in the description.</li></ul><p>In each case, the instance must match all your filters to be included in the results. Filter values are case sensitive.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-6bd1385dba448291dd98302145461127>3.5.2 - Tagging and Filtering Tasks</h1><h1 id=tagging-and-filtering-tasks>Tagging and Filtering Tasks</h1><p>This section details the tasks that you can with tagging and filtering. You can use the Management Console or the command line interface.</p><p>Eucalyptus supports three commands for tagging:</p><ul><li>euca-create-tags</li><li>euca-describe-tags</li><li>euca-delete-tags</li></ul><p>Eucalyptus supports the following commands for filtering:</p><ul><li>euca-describe-addresses</li><li>euca-describe-availability-zones</li><li>euca-describe-bundle-tasks</li><li>euca-describe-groups</li><li>euca-describe-images</li><li>euca-describe-instances</li><li>euca-describe-keypairs</li><li>euca-describe-regions</li><li>euca-describe-snapshots</li><li>euca-describe-tags</li><li>euca-describe-volumes</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-dd571d37f5c80cdcde9d3a6732730c01>3.5.2.1 - Add a Tag</h1><p>Use the euca-create-tags command to add a tag to a resource.</p><p>Enter the following command and parameters:</p><pre><code>euca-create-tags [resource_id] --tag [tag_key]=[tag_value]
</code></pre><p>Eucalyptus returns a the resource identifier and its tag key and value. The following example shows how to add a tag to an EMI. This tag key is <code>dataserver</code> and has no value.</p><pre><code>euca-create-tags emi-1A2B3C4D --tag dataserver 
TAG  emi-1a2b3c4d  image  dataserver
</code></pre><p>The following example shows how to add the same two tags to both an EMI and an instance. One tag key is dataserver, which has no value, an empty string. The other tag key is stack, which has a value of <code>Production</code> .</p><pre><code>euca-create-tags emi-1A2B3C4D i-6F5D4E3A --tag dataserver --tag stack=Production
TAG  emi-1A2B3C4D  image  dataserver
TAG  emi-1A2B3C4D  image  stack  Production
TAG  i-6F5D4E3A  image  dataserver
TAG  i-6F5D4E3A  image  stack  Production
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-042b4d977236060f7f46fbed197c0590>3.5.2.2 - List Tags</h1><p>Use the euca-describe-tags command to list your tags and filter the results different ways.</p><p>Enter the following command and parameters:</p><pre><code>euca-describe-tags --filter resource-type=[resource_type]&quot; --filter
&quot;key=[key_name]&quot; --filter &quot;value=[key_value]&quot;
</code></pre><p>The following example describes all the tags belonging to your account.</p><pre><code>euca-describe-tags
TAG  emi-1A2B3C4D  image  database_server
TAG  emi-1A2B3C4D  image  stack  Production
TAG  i-5F4E3D2A  instance  database_server
TAG  i-5F4E3D2A  instance  stack  Production
TAG  i-12345678  instance  webserver
TAG  i-12345678  instance  stack  Test
</code></pre><p>The following example describes the tags for the resource with ID emi-1A2B3C4D.</p><pre><code>ec2-describe-tags --filter &quot;resource-id=emi-1A2B3C4D&quot;
TAG  emi-1A2B3C4D  image  database_server
TAG  emi-1A2B3C4D  image  stack  Production
</code></pre><p>The following example describes the tags for all your instances.</p><pre><code>ec2-describe-tags --filter &quot;resource-type=instance&quot;
TAG  i-5F4E3D2A  instance  database_server
TAG  i-5F4E3D2A  instance  stack  Production
TAG  i-12345678  instance  webserver
TAG  i-12345678  instance  stack  Test
</code></pre><p>The following example describes the tags for all your instances that have a tag with the key webserver.</p><pre><code>ec2-describe-tags --filter &quot;resource-type=instance&quot; --filter &quot;key=database_server&quot;
TAG  i-5F4E3D2A  instance  database_server
</code></pre><p>The following example describes the tags for all your instances that have a tag with the key stack that has a value of either Test or Production.</p><pre><code>ec2-describe-tags --filter &quot;resource-type=instance&quot; --filter &quot;key=stack&quot; 
--filter &quot;value=Test&quot; --filter &quot;value=Production&quot;
TAG  i-5F4E3D2A  instance  stack  Production
TAG  i-12345678  instance  stack  Test
</code></pre><p>The following example describes the tags for all your instances that have a tag with the key Purpose that has no value.</p><pre><code>ec2-describe-tags --filter &quot;resource-type=instance&quot; --filter &quot;key=Purpose&quot; --filter &quot;value=&quot;
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-1855209f1ecefb64ccd88f7af8b7c8b8>3.5.2.3 - Change a Tag's Value</h1><p>To change a tag&rsquo;s value:</p><p>Enter the following command and parameters:</p><pre><code>euca-create-tags [resource]  --tag [key=value]
</code></pre><p>Eucalyptus returns a the resource identifier and its tag key and value. The following example changes the value of the stack tag for one of your EMIs from prod to test:</p><pre><code>euca-create-tags emi-1a2b3c4d  --tag stack=dev
TAG  emi-1a2b3c4d  image  stack  dev
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-9b1a43ba2107a4f7eafe77b5ee38d4ec>3.5.2.4 - Delete a Tag</h1><p>To delete a tag:</p><p>Enter the following command and parameters:</p><pre><code>euca-delete-tags resource_id [resource_id]&quot; --tag
&quot;key=[key_value]&quot; --tag &quot;value=[key_value]&quot;
</code></pre><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If you specify a value, the tag is deleted only if its value matches the one you specified. If you specify an empty string as the value, the tag is deleted only if the tag&rsquo;s value is an empty string.</div><p>Eucalyptus does not return a message. The following example deletes two tags assigned to an EMI and an instance:</p><pre><code>euca-delete-tags emi-1A2B3C4D i-6F5D4E3A --tag appserver --tag stack
</code></pre><p>The following example deletes a tag only if the value is an empty string:</p><pre><code>euca-delete-tags snap-1A2B3C4D --tag Owner=
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-1270c26578adb8e744d48ed49e2f1e74>3.5.2.5 - Filter by Tag</h1><p>You can describe your resources and filter the results based on the tags. To filter by tag:</p><p>Enter the following command and parameter:</p><pre><code>euca-describe-tags --filter resource-type=[resource_type]
</code></pre><p>The following example describes all your tags.</p><pre><code>euca-describe-tags
TAG  emi-1A2B3C4D  image  appserver
TAG  emi-1A2B3C4D  image  stack  dev
TAG  i-5F4E3D2A  instance  appserver
TAG  i-5F4E3D2A  instance  stack  dev
TAG  i-12345678  instance  database_server
TAG  i-12345678  instance  stack  test
</code></pre><p>The following example describes the tags for a resource with ID emi-1A2B3C4D.</p><pre><code>euca-describe-tags --filter &quot;resource-id=emi-1A2B3C4D&quot;
TAG  emi-1A2B3C4D  image  appserver
TAG  emi-1A2B3C4D  image  stack  dev
</code></pre><p>The following example describes the tags for all your instances.</p><pre><code>euca-describe-tags --filter &quot;resource-type=instance&quot;
TAG  i-5F4E3D2A  instance  appserver
TAG  i-5F4E3D2A  instance  stack  dev
TAG  i-12345678  instance  database_server
TAG  i-12345678  instance  stack  test
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-ab7c354e5ad78e7429a5dc9aa9029889>3.6 - Managing Access</h1><h1 id=managing-access>Managing Access</h1><p>Eucalyptus manages access to the cloud by policies attached to accounts, groups, and users. This section details access-related tasks you can perform once your administrator allows you access to Eucalyptus. These tasks are split into the following areas: tasks for groups, and tasks for users, and tasks for credential management.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-3d2989c89b0e9dd4fb0ef6ef92ac4a1c>3.6.1 - Groups</h1><h1 id=groups>Groups</h1><p>Groups are used to share resource access authorizations among a set of users within an account. Users can belong to multiple groups.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>A group in the context of access is not the same as a security group.</div>This section details tasks that can be performed on groups.</p></div><div class=td-content><h1 id=pg-6f28ff1ca761e9e3262daf843ecc60eb>3.6.1.1 - Create a Group</h1><p>To create a group perform the steps listed in this topic.Enter the following command:</p><pre><code>euare-groupcreate -g &lt;group_name&gt;
</code></pre><p>Eucalyptus does not return anything.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-efab8a77484ceb68ddfd46bb2d03f60d>3.6.1.2 - Add a Group Policy</h1><p>To add a group policy perform the steps listed in this topic.Enter the following command:</p><pre><code>euare-groupaddpolicy -g &lt;group_name&gt; -p &lt;policy_name&gt; -e &lt;effect&gt; -a
							&lt;actions&gt; -o
</code></pre><p>The optional <code>-o</code> parameter tells Eucalyptus to return the JSON policy, as in this example:</p><pre><code>{&quot;Version&quot;:&quot;2008-10-17&quot;,&quot;Statement&quot;:[{&quot;Effect&quot;:&quot;Allow&quot;, &quot;Action&quot;:[&quot;ec2:RunInstances&quot;], &quot;Resource&quot;:[&quot;*&quot;]}]}
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-c9e870f9faf2341d92203254dc47199e>3.6.1.3 - Modify a Group</h1><p>To modify a group perform the steps listed in this topic.Modifying a group is similar to a &ldquo;move&rdquo; operation. Whoever wants to modify the group must have permission to do it on both sides of the move. That is, you need permission to remove the group from its current path or name, and put that group in the new path or name.</p><p>For example, if a group changes from one area in a company to another, you can change the group&rsquo;s path from <em>/area_abc/</em> to <em>/area_efg/</em> . You need permission to remove the group from <em>/area_abc/</em> . You also need permission to put the group into <em>/area_efg/</em> . This means you need permission to call <code>UpdateGroup</code> on both <em>arn:aws:iam::123456789012:group/area_abc/</em>* and <em>arn:aws:iam::123456789012:group/area_efg/</em>* .</p><p>Enter the following command to modify the group&rsquo;s name:</p><pre><code>euare-groupmod -g &lt;group_name&gt; --new-group-name &lt;new_name&gt;
</code></pre><p>Eucalyptus does not return a message. Enter the following command to modify a group&rsquo;s path:</p><pre><code>euare-groupmod -g &lt;group_name&gt; -p &lt;new_path&gt;
</code></pre><p>Eucalyptus does not return a message.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-22f88efb8f7b4230c617ce233958b08e>3.6.1.4 - Add a User to a Group</h1><p>To add a user to a group perform the steps listed in this topic.Enter the following command:</p><pre><code>euare-groupadduser -g &lt;group_name&gt; -u &lt;user-name&gt; 
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-e86d20ce4bd225b0dc141c155d554ca3>3.6.1.5 - Remove a User from a Group</h1><p>To remove a user from a group perform the steps listed in this topic.Enter the following command:</p><pre><code>euare-groupremoveuser -g &lt;group_name&gt; -u &lt;user-name&gt; 
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-0ffc021482c3305f0a60954b22bcd807>3.6.1.6 - List Groups</h1><p>To list groups perform the steps listed in this topic.Enter the following command:</p><pre><code>euare-grouplistbypath
</code></pre><p>Eucalyptus returns a list of paths followed by the ARNs for the groups in each path. For example:</p><pre><code>arn:aws:iam::eucalyptus:group/groupa
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-24fe2284a9b4c5dac4de4e3b984907ea>3.6.1.7 - Delete a Group</h1><p>To delete a group perform the steps listed in this topic.When you delete a group, you have to remove users from the group and delete any policies from the group. You can do this with one command, using the <code>euare-groupdel</code> command with the <code>-r</code> option. Or you can follow the following steps to specify who and what you want to delete.</p><p>Individually remove all users from the group.</p><pre><code>euare-groupremoveuser -g &lt;group_name&gt; -u &lt;user_name&gt;
</code></pre><p>Delete the policies attached to the group.</p><pre><code>euare-groupdelpolicy -g &lt;group_name&gt; -p &lt;policy_name&gt;
</code></pre><p>Delete the group.</p><pre><code>euare-groupdel -g &lt;group_name&gt;
</code></pre><p>The group is now deleted.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-6820a056ed00ccc938ab0e1d5bc2fbbc>3.6.2 - Users</h1><h1 id=users>Users</h1><p>Users are subsets of accounts and are added to accounts by an appropriately credentialed administrator. While the term <strong>user</strong> typically refers to a specific person, in Eucalyptus, a <strong>user</strong> is defined by a specific set of credentials generated to enable access to a given account. Each set of user credentials is valid for accessing only the account for which they were created. Thus a user only has access to one account within a Eucalyptus system. If an individual person wishes to have access to more than one account within a Eucalyptus system, a separate set of credentials must be generated (in effect a new ‘user’) for each account (though the same username and password can be used for different accounts).</p><p>When you need to add a new user to your Eucalyptus cloud, you&rsquo;ll go through the following process:</p><ol><li>Create a user</li><li>Add user to a group</li><li>Give user a login profile</li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-342fe017ac5a34ef1d0f3e3591560d1b>3.6.2.1 - Add a User</h1><p>To add a user, perform the steps in this topic.Enter the following command</p><pre><code>euare-usercreate -u &lt;user_name&gt; -g &lt;group_name&gt; -k
</code></pre><p>Eucalyptus does not return a response.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If you include the parameter, Eucalyptus returns a response that includes the user&rsquo;s ARN and GUID.</div></p></div><div class=td-content style=page-break-before:always><h1 id=pg-752c1c6d43c0a1ec40de40e16ac7757b>3.6.2.2 - Create a Login Profile</h1><p>To create a login profile, perform the tasks in this topic.Enter the following command:</p><pre><code>euare-useraddloginprofile -u &lt;user_name&gt; -p &lt;password&gt;
</code></pre><p>Eucalyptus does not return a response.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-52fdb183c537a61661d91b13998619b4>3.6.2.3 - Modify a User</h1><p>Modifying a user is similar to a &ldquo;move&rdquo; operation. To modify a user, you need permission to remove the user from the current path or name, and put that user in the new path or name.For example, if a user changes from one team in a company to another, you can change the user&rsquo;s path from <em>/team_abc/</em> to <em>/team_efg/</em> . You need permission to remove the user from <em>/team_abc/</em> . You also need permission to put the user into <em>/team_efg/</em> . This means you need permission to call UpdateUser on both <em>arn:aws:iam::123456789012:user/team_abc/</em>* and <em>arn:aws:iam::123456789012:user/team_efg/</em>* .</p><p>To rename a user:</p><p>Enter the following command to rename a user:</p><pre><code>euare-usermod -u &lt;user_name&gt; --new-user-name &lt;new_name&gt;
</code></pre><p>Eucalyptus does not return a message. Enter the following command:</p><pre><code>euare-groupmod -u &lt;user_name&gt; -p &lt;new_path&gt;
</code></pre><p>Eucalyptus does not return a message.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-26affa6e4f189906a2479f938e44bf6e>3.6.2.4 - Change User Path</h1><p>Enter the following command:</p><pre><code>euare-usermod -u &lt;user_name&gt; -p &lt;new_path&gt;
</code></pre><p>Eucalyptus does not return a message.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-732f9e3d6d25d353e49876081277ff93>3.6.2.5 - Change User Password</h1><p>To change a user&rsquo;s password using the CLI:</p><p>Enter the following command:</p><pre><code>euare-usermodloginprofile -u [username] -p [password]
</code></pre><p>Eucalyptus does not return a message.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-7b318b328661bcfbe169389beddb17a1>3.6.2.6 - List Users</h1><p>To list users within a path, perform the steps in this topic.Use the <code>euare-userlistbypath</code> command to list all the users in an account or to list all the users with a particular path prefix. The output lists the ARN for each resulting user.</p><pre><code>euare-userlistbypath -p &lt;path&gt;
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-0a09544f1e4b3297bc5e07fddde2cc06>3.6.2.7 - Delete a User</h1><p>To delete a user, perform the tasks in this topic.Enter the following command</p><pre><code>euare-userdel -u &lt;user_name&gt;
</code></pre><p>Eucalyptus does not return a response.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-407c51194c7080ffe59d541454978bdc>3.6.3 - Credentials</h1><h1 id=credentials>Credentials</h1><p>Eucalyptus uses different types of credentials for different purposes. This section details tasks needed to allow access to Eucalyptus services.</p></div><div class=td-content><h1 id=pg-2fa37849f9c1f6c20198b2ea31557ca7>3.6.3.1 - Create Credentials</h1><p>The first time you get credentials using the Eucalyptus Administrator Console, a new secret access key is generated. On each subsequent request to get credentials, an existing active secret Key is returned. You can also generate new keys using the command.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Each request to get a user&rsquo;s credentials generates a new pair of a private key and X.509 certificate.</div>To generate a new key for a user by an account administrator, enter the following</p><pre><code>euare-useraddkey USERNAME
</code></pre><p>To generate a private key and an X.509 certificate pair, enter the following:</p><pre><code>euare-usercreatecert USERNAME
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-ef53b52e534f0ea94eba216f4cbef56f>3.6.3.2 - Upload a Certificate</h1><p>To upload a certificate provided by a user:</p><p>Enter the following command:</p><pre><code>euare-useraddcert -u &lt;user_name&gt; -f &lt;cert_file&gt;
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-771685f3698cbf9f2500bba7717c4bf1>3.7 - Using VM Networking and Security</h1><h1 id=using-vm-networking-and-security>Using VM Networking and Security</h1><p>The Eucalyptus networking mode used, and it&rsquo;s configuration, determine the features available to users; such as elastic IPs, which are public (external) IP addresses that users can reserve and dynamically associate with VM instance; and security groups, which are sets of firewall rules applied to VM instances associated with the group.</p><p>Euca2ools or the AWS CLI provide means for users to interact with these features with commands for allocating and associating IP addresses, as well as creating, deleting, and modifying security groups.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-8e5e2d308d2a6de61e0cdec278497495>3.7.1 - Associate an IP Address with an Instance</h1><p>To associate an IP address with an instance:</p><p>Allocate an IP address:</p><pre><code>euca-allocate-address ADDRESS &lt;IP_address&gt;
</code></pre><p>Associate the allocated IP address with an instance ID:</p><pre><code>euca-associate-address -i &lt;instance_ID&gt; &lt;IP_address&gt; 



euca-associate-address -i i-56785678 192.168.17.103
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-eba6d058af5f53c724aac0b09f2ead69>3.7.2 - Release an IP Address</h1><p>Use euca-disassociate-address and euca-release-address to disassociate an IP address from an instance and to release the IP address to the global pool, respectively.</p><p>To release an IP address:</p><p>Enter the following command to disassociate an IP address from an instance:</p><pre><code>euca-disassociate-address &lt;IP_address&gt;
</code></pre><p>Enter the following command to release an IP address:</p><pre><code>euca-disassociate-address &lt;IP_address&gt;
</code></pre><p>The following example releases the IP address, <code>192.168.17.103</code></p><pre><code>euca-release-address 192.168.17.103
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-a708dbaf6ae500e2811936c10cba1ada>3.7.3 - Create a Security Group</h1><p>Security groups let you control network access to instances by applying network rules to instances associated with a group.</p><p>To create a security group:</p><p>Enter the following command:</p><pre><code>euca-add-group -d &lt;description&gt; &lt;group_name&gt;
</code></pre><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>You can also create a security group you run an instance. Use the command with the option. Security group rules only apply to incoming traffic thus all outbound traffic is permitted.</div><p>The following example creates a new security group named <code>mygroup</code> and described as <code>newgroup</code> .</p><pre><code>euca-add-group -d &quot;newgroup&quot; mygroup
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-ca7e9523da8da1f44b9a178664b281e5>3.7.4 - Delete a Security Group</h1><p>The euca-delete-group command lets you delete security groups. To delete a security group:</p><p>Enter the following command:</p><pre><code>euca-delete-group &lt;group_name&gt;
</code></pre><p>The following example deletes the security group, <code>mygroup</code> .</p><pre><code>euca-delete-group mygroup
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-fcb1a70c1a948cba1ca649d72cbb7c99>3.7.5 - Authorize Security Group Rules</h1><p>By default, a security group prevents incoming network traffic from all sources. You can modify network rules and allow incoming traffic to security groups from specified sources using the euca-authorize command.</p><p>To authorize security group rules:</p><p>Use <code>euca-authorize</code> to authorize port 22 access to your default group. Enter the following command:</p><pre><code>euca-authorize -P &lt;protocol&gt; -p &lt;port_number&gt; \
-s &lt;CIDR_source_network&gt; &lt;group_name&gt;
</code></pre><p>The following example allows all incoming SSH traffic on port 22 to access to the security group <code>mygroup</code> . The CIDR source network, <code>0.0.0.0/0</code> , refers to any source.</p><pre><code>euca-authorize -P tcp -p 22 -s 0.0.0.0/0 mygroup 
 GROUP	mygroup ↵
 PERMISSION	mygroup	ALLOWS	tcp	22	22	FROM	CIDR
</code></pre><p>Instead of specifying a CIDR source, you can specify another security group. The following example allows access to the security group <code>mygroup</code> from the <code>someothergroup</code> security group using SSH on port 22.</p><pre><code>euca-authorize --source-group someothergroup \
--source-group-user someotheruser -P tcp -p 22 mygroup
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-c85449799b2f17c043704492a4a20e32>3.7.6 - Revoke Security Group Rules</h1><p>To revoke security group rules:</p><p>Enter the following command:</p><pre><code>euca-revoke -P &lt;protocol&gt; -p &lt;port_number&gt; -s &lt;CIDR_source_network&gt; &lt;group_name&gt;
</code></pre><p>The following example revokes the network rules authorized for the security group <code>mygroup</code> .</p><pre><code>euca-revoke -P tcp -p 22 -s 0.0.0.0/0 mygroup 
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-9b7bdc22a4ccce9fcccfa599c27cb642>3.8 - Using Auto Scaling</h1><h1 id=using-auto-scaling>Using Auto Scaling</h1><p>Eucalyptus Auto Scaling automatically adds and removes instances based on demand. Auto Scaling scales dynamically based on metrics (for example, CPU utilization). The Auto Scaling service works in conjunction with the ElasticLoad Balancing and CloudWatch services.</p></div><div class=td-content><h1 id=pg-eca302cc14efa49f00bba5ea410e31e7>3.8.1 - How Auto Scaling Works</h1><p>Eucalyptus Auto Scaling is designed to address a common web application scenario: that you are running multiple copies of an application across several identical instances to adequately handle a certain volume of user requests. Eucalyptus Auto Scaling can help you make more efficient use of the computing resources in your cloud by automatically launching and terminating these instances, based on metrics and/or a schedule that you can define. There are three main Auto Scaling components that work together to provide this functionality: the <em>Auto Scaling group</em> , the <em>launch configuration</em> , and the <em>scaling plan</em> .</p><p>The <em>Auto Scaling group</em> contains the information about the instances that will be actually be used for scaling operations. The Auto Scaling group defines the minimum, desired, and maximum number of instances that you will use to scale your application.</p><p>The <em>launch configuration</em> contains all of the information necessary for Auto Scaling to launch instances, including instance type, image ID, key pairs, security groups, and block device mappings.</p><p>The <em>scaling policy</em> defines how to perform scaling actions. Scaling policies can execute automatically in response to CloudWatch alarms, or they you can execute them manually.</p><p>In addition to performing scaling operations based on the criteria defined in the scaling plan, Auto Scaling will periodically perform health checks to ensure that the instances in your Auto Scaling group are up and running. If an instance is determined to be unhealthy, Auto Scaling will terminate that instance and launch a new instance in order to maintain the minimum or desired number of instances in the scaling group.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-18877d04bc0954a2d14b9a825becf87e>3.8.2 - Auto Scaling Concepts</h1><h1 id=auto-scaling-concepts>Auto Scaling Concepts</h1><p>This section discusses Auto Scaling concepts and terminology.</p></div><div class=td-content><h1 id=pg-ec71d585508ba55ce2779a64496f9175>3.8.2.1 - Understanding Launch Configurations</h1><p>The launch configuration defines the settings used by the Eucalyptus instances launched within an Auto Scaling group. This includes the image name, the instance type, key pairs, security groups, and block device mappings. You associate the launch configuration with an Auto Scaling group. Each Auto Scaling group can have one (and only one) associated launch configuration.</p><p>Once you&rsquo;ve created a launch configuration, you can&rsquo;t change it; you must create a new launch configuration and then associate it with an Auto Scaling group. After you&rsquo;ve created and attached a new launch configuration to an Auto Scaling group, any new instances will be launched using parameters defined in the new launch configuration; existing instances in the Auto Scaling group are not affected.</p><p>For more information, see <a href=https://www.eucastack.io/docs/user_guide/autoscaling_intro/autoscaling_examples_intro/autoscaling_examples_basic_config/>Creating a Basic Auto Scaling Configuration</a> .</p></div><div class=td-content style=page-break-before:always><h1 id=pg-3f7496825c64b070eef53cc4acc6b30d>3.8.2.2 - Understanding Auto Scaling Groups</h1><p>An Auto Scaling group is the central component of Auto Scaling. An Auto Scaling group defines the parameters for the Eucalyptus instances are used for scaling, as well as the minimum, maximum, and (optionally) the desired number of instances to use for Auto Scaling your application. If you don&rsquo;t specify the desired number of instances in your Auto Scaling group, the default value will be the same as the minimum number of instances defined.</p><p>In addition to instance and capacity definitions, each Auto Scaling group must specify one (and only one) launch configuration.</p><p>For more information, see <a href=https://www.eucastack.io/docs/user_guide/autoscaling_intro/autoscaling_examples_intro/autoscaling_examples_basic_config/>Creating a Basic Auto Scaling Configuration</a> .</p></div><div class=td-content style=page-break-before:always><h1 id=pg-21224594ae25d8659105c5691ab05af7>3.8.2.3 - Understanding Auto Scaling Policies</h1><p>An Auto Scaling policy defines how to perform scaling actions in response to CloudWatch alarms. Auto scaling policies can either <em>scale-in</em> , which terminates instances in your Auto Scaling group, or <em>scale-out</em> , which will launch new instances in your Auto Scaling group. You can define an Auto Scaling policy based on demand, or based on a fixed schedule.</p><p><strong>Demand-Based Auto Scaling Policies</strong></p><p>Demand-based Auto Scaling policies scale your application dynamically based on CloudWatch metrics (such as average CPU utilization) gathered from the instances running in your scaling group. For example, you can configure a CloudWatch alarm to monitor the CPU usages of the instances in your Auto Scaling group. A CloudWatch alarm definition includes <em>thresholds</em> - minimum and maximum values for the defined metric - that will cause the alarm to fire.</p><p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>For more information on CloudWatch, go to .</div>For example, you can define the lower and upper thresholds of the CloudWatch alarm at 40% and 80% CPU usage. Once you&rsquo;ve created the CloudWatch alarm, you can create a scale-out policy that launches 10 new instances when the CloudWatch alarm breaches the upper threshold (the average CPU usage is at or above 80%), and a scale-in policy that terminates 10 instances when the CloudWatch alarm breaches the lower threshold (the average CPU usage of the instances in the Auto Scaling group falls below 40%). Your Auto Scaling group will execute the appropriate Auto Scaling policy when it receives the message from the CloudWatch alarm.</p><p><strong>Cooldown Period</strong></p><p>A <em>cooldown period</em> is the amount of time after an Auto Scaling activity takes place where further Auto Scaling activity is suspended. This is to allow time for the Auto Scaling activities (such as new instance launches or terminations) to fully complete so that resources are not unnecessarily launched or terminated. You can specify this amount of time; if you don&rsquo;t specify a cooldown period, Auto Scaling uses a default cooldown period of 300 seconds (5 minutes).</p><p>For more information, go to <a href=https://www.eucastack.io/docs/user_guide/autoscaling_intro/autoscaling_examples_intro/autoscaling_examples_scaling_plan_demand/>Configuring a Demand-Based Scaling Policy</a> .</p></div><div class=td-content style=page-break-before:always><h1 id=pg-1039aae90fb93b25460c6a3f9b056d4c>3.8.2.4 - Understanding Health Checks</h1><p>Auto scaling periodically performs <em>health checks</em> on the instances in your Auto Scaling group. By default, Auto Scaling group determines the health state of each instance by periodically checking the results of Eucalyptus instance status checks. When Auto Scaling determines that an instance is unhealthy, it terminates that instance and launches a new one.</p><p>If your Auto Scaling group is using elastic load balancing, Auto Scaling can determine the health status of the instances by checking the results of both Eucalyptus instance status checks and elastic load balancing instance health.</p><p>Auto scaling determines an instance is unhealthy if the calls to either Eucalyptus instance status checks or elastic load balancing instance health status checks return any state other than <code>OK</code> (or  <code>InService</code> ).</p><p>If there are multiple elastic load balancers associated with your Auto Scaling group, Auto Scaling will make health check calls to each load balancer. If any of the health check calls return any state other than  <code>InService</code> , that instance will be marked as unhealthy. After Auto Scaling marks an instance as unhealthy, it will remain marked in that state, even if subsequent calls from other load balancers return an  <code>InService</code>  state for the same instance.</p><p>For more information, go to <a href=https://www.eucastack.io/docs/user_guide/autoscaling_intro/autoscaling_examples_intro/autoscaling_examples_health_checks/>Configuring Health Checks</a> .</p></div><div class=td-content style=page-break-before:always><h1 id=pg-8566326bbd9883d42b15b0bac8e468f1>3.8.2.5 - Understanding Instance Termination Policies</h1><p>Before Auto Scaling selects an instance to terminate, it first identifies the availability zone used by the group that contains the most instances. If all availability zones have the same number of instances, Auto Scaling selects a random availability zone, and then uses the termination policy to select the instance within that randomly selected availability zone for termination.</p><p>By default, Auto Scaling chooses the instance that was launched with the oldest launch configuration. If more than one instance was launched using the oldest launch configuration, Auto Scaling the instance that was created first using the oldest launch configuration.</p><p>You can override the default instance termination policy for your Auto Scaling group with one of the following options:</p><table><thead><tr><th style=text-align:left>Option</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left>OldestInstance</td><td style=text-align:left>The oldest instance in the Auto Scaling group should be terminated.</td></tr><tr><td style=text-align:left>NewestInstance</td><td style=text-align:left>The newest instance in the Auto Scaling group should be terminated.</td></tr><tr><td style=text-align:left>OldestLaunchConfiguration</td><td style=text-align:left>The first instance created using the oldest launch configuration should be terminated.</td></tr><tr><td style=text-align:left>Default</td><td style=text-align:left>Use the default instance termination policy.</td></tr></tbody></table><p>You can have more than one termination policy per Auto Scaling group. The termination policies are executed in the order they were created.</p><p>For more information, go to <a href=https://www.eucastack.io/docs/user_guide/autoscaling_intro/autoscaling_examples_intro/autoscaling_examples_instance_termination_policy/>Configuring an Instance Termination Policy</a> .</p></div><div class=td-content style=page-break-before:always><h1 id=pg-d921ce29126b5c99559b331c22229ef0>3.8.3 - Auto Scaling Usage Examples</h1><h1 id=auto-scaling-usage-examples>Auto Scaling Usage Examples</h1><p>This section contains examples of many common usage scenarios for Auto Scaling.</p></div><div class=td-content><h1 id=pg-c036ed77e65d33988a1baddd590db82e>3.8.3.1 - Creating a Basic Auto Scaling Configuration</h1><p>Auto scaling requires two basic elements to function properly: a launch configuration and an Auto Scaling group. The following examples show how to set up the basic elements of an Auto Scaling configuration.</p><h2 id=create-a-launch-configuration>Create a Launch Configuration</h2><p>The launch configuration specifies the parameters that Auto Scaling will use when launching new instances for your Auto Scaling group. In this example, we will create a launch configuration with the minimum required parameters - in this case, we set up a launch configuration that specifies that all instances launched in the Auto Scaling group will be of instance type and use the image.To create a launch configuration:</p><p>Enter the following command: <code>euscale-create-launch-config MyLaunchConfig --image-id emi-00123456 --instance-type m1.small</code> To verify the launch configuration, enter the following command: <code>euscale-describe-launch-configs MyLaunchConfig</code> You should see output similar to the following:</p><pre><code>LAUNCH-CONFIG	MyLaunchConfig	emi-00123456	m1.small
</code></pre><p>You&rsquo;ve now created a launch configuration..</p><h2 id=create-an-auto-scaling-group>Create an Auto Scaling Group</h2><p>The Auto Scaling group contains settings like the minimum, maximum, and desired number of Eucalyptus instances. At minimum, you must specify the name of the Auto Scaling group, the name of an existing launch configuration, the availability zone, and the minimum and maximum number of instances that should be running. In the following example, we will create an Auto Scaling group called MyScalingGroup in availability zone PARTI00, with a minimum size of 2 and a maximum size of 5.To create an Auto Scaling group: Enter the following command:</p><pre><code>euscale-create-auto-scaling-group MyScalingGroup --launch-configuration
                    		MyLaunchConfig --availability-zones PARTI00 --min-size 2 --max-size 5
                    		--desired-capacity 2
</code></pre><p>Enter the following command to verify the Auto Scaling group you just created:</p><pre><code>euscale-describe-auto-scaling-groups MyScalingGroup
</code></pre><p>This command will return output similar to the following:</p><pre><code>AUTO-SCALING-GROUP	MyScalingGroup	MyLaunchConfig	PARTI00		2	5	2	Default
INSTANCE	i-1B853EC3	PARTI00	InService	Healthy	MyLaunchConfig
INSTANCE	i-ABC53ED7	PARTI00	InService	Healthy	MyLaunchConfig
</code></pre><p>Once you&rsquo;ve created the Auto Scaling group, Auto Scaling will launch the appropriate number of instances.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-cdb324072ca0c83712273c2e73d1192a>3.8.3.2 - Configuring a Demand-Based Scaling Policy</h1><p>An Auto Scaling group needs a scaling policy to determine when to perform scaling activities. Auto scaling policies work with CloudWatch to identify metrics and set alarms, which are triggered when the metrics fall outside of a specified value range. To configure a scale-based policy, you need to create the policy, and then create CloudWatch alarms to associate with the policy.In the following example, we will create a demand-based scaling policy.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>For more information on CloudWatch, go to .</div></p><h2 id=create-auto-scaling-policies>Create Auto Scaling Policies</h2><p>To create the scaling policies:</p><p>Create a scale-out policy using the following command:</p><pre><code>euscale-put-scaling-policy MyScaleoutPolicy --auto-scaling-group MyScalingGroup --adjustment=30 --type PercentChangeInCapacity
</code></pre><p>This command will return a unique Amazon Resource Name (ARN) for the new policy.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>You will need this ARN to create the Cloudwatch alarms in subsequent steps.</div></p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>The following example has been split into two lines for legibility.</div><pre><code>arn:aws:autoscaling::706221218191:scalingPolicy:5d02981b-f440-4c8f-98f2-8a620dc2b787:
    autoScalingGroupName/MyScalingGroup:policyName/MyScaleoutPolicy
</code></pre><p>Create a scale-in policy using the following command:</p><pre><code>euscale-put-scaling-policy MyScaleinPolicy -g MyScalingGroup --adjustment=-2  --type ChangeInCapacity
</code></pre><p>This command will return output containing a unique Amazon Resource Name (ARN) for the new policy, similar to the following:<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>You will need this ARN to create the Cloudwatch alarms in subsequent steps.</div></p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>The following example has been split into two lines for legibility.</div><pre><code>arn:aws:autoscaling::706221218191:scalingPolicy:d28c6ffc-e9f1-4a48-a79c-8b431794c367:
    autoScalingGroupName/MyScalingGroup:policyName/MyScaleinPolicy
</code></pre><h2 id=create-cloudwatch-alarms>Create CloudWatch Alarms</h2><p>To create CloudWatch alarms:</p><p>Create a Cloudwatch alarm for scaling out when the average CPU usage exceeds 80 percent:<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>The following example has been split into multiple lines for legibility.</div></p><pre><code>euwatch-put-metric-alarm AddCapacity  --metric-name CPUUtilization --unit Percent
--namespace &quot;AWS/EC2&quot; --statistic Average --period 120 --threshold 80 --comparison-operator 
GreaterThanOrEqualToThreshold --dimensions &quot;AutoScalingGroupName=MyScalingGroup&quot; 
--evaluation-periods 2 --alarm-actions 
arn:aws:autoscaling::706221218191:scalingPolicy:5d02981b-f440-4c8f-98f2-8a620dc2b787:
   autoScalingGroupName/MyScalingGroup:policyName/MyScaleoutPolicy
</code></pre><p>Create a Cloudwatch alarm for scaling in when the average CPU usage falls below 40 percent:<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>The following example has been split into multiple lines for legibility.</div></p><pre><code>euwatch-put-metric-alarm RemoveCapacity --metric-name CPUUtilization --unit Percent
--namespace &quot;AWS/EC2&quot; --statistic Average  --period 120  --threshold 40  --comparison-operator 
LessThanOrEqualToThreshold  --dimensions &quot;AutoScalingGroupName=MyScalingGroup&quot; --evaluation-periods 2 
--alarm-actions 
 arn:aws:autoscaling::706221218191:scalingPolicy:d28c6ffc-e9f1-4a48-a79c-8b431794c367:
  autoScalingGroupName/MyScalingGroup:policyName/MyScaleinPolicy
</code></pre><h2 id=verify-your-alarms-and-policies>Verify Your Alarms and Policies</h2><p>Once you&rsquo;ve created your Auto Scaling policies and CloudWatch alarms, you should verify them.To verify your alarms and policies:</p><p>Use the CloudWatch command <code>euwatch-describe-alarms</code> to see a list of the alarms you&rsquo;ve created:</p><pre><code>euwatch-describe-alarms 
</code></pre><p>This will return output similar to the following:</p><pre><code>AddCapacity	INSUFFICIENT_DATA	arn:aws:autoscaling::706221218191:scalingPolicy:5d02981b-f440-4c8f-98f2-8a620dc2b787:
   autoScalingGroupName/MyScalingGroup:policyName/MyScaleoutPolicy	
   AWS/EC2	CPUUtilization	120	Average	2	GreaterThanOrEqualToThreshold	80.0
RemoveCapacity	INSUFFICIENT_DATA	arn:aws:autoscaling::706221218191:scalingPolicy:d28c6ffc-e9f1-4a48-a79c-8b431794c367:
autoScalingGroupName/MyScalingGroup:policyName/MyScaleinPolicy	
   AWS/EC2	CPUUtilization	120	Average	2	LessThanOrEqualToThreshold	40.0
</code></pre><p>Use the euscale-describe-policies command to see the scaling policies you&rsquo;ve created:</p><pre><code>euscale-describe-policies --auto-scaling-group MyScalingGroup
</code></pre><p>This will return output similar to the following (note that this output has been split into multiple lines for legibility):</p><pre><code>SCALING-POLICY	MyScalingGroup	MyScaleinPolicy	-2	ChangeInCapacity	arn:aws:autoscaling::706221218191:
  scalingPolicy:d28c6ffc-e9f1-4a48-a79c-8b431794c367:
  autoScalingGroupName/MyScalingGroup:policyName/MyScaleinPolicy
SCALING-POLICY	MyScalingGroup	MyScaleoutPolicy	30	PercentChangeInCapacity	arn:aws:autoscaling::706221218191:
  scalingPolicy:5d02981b-f440-4c8f-98f2-8a620dc2b787:
  autoScalingGroupName/MyScalingGroup:policyName/MyScaleoutPolicy
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-b0cf01cf054f73b508f76b8e16b3106d>3.8.3.3 - Configuring Health Checks</h1><p>By default, Auto Scaling group determines the health state of each instance by periodically checking the results of instance status checks. You can specify using the ELB health check method in addition to using the instance health check method.To use load balancing health checks for an Auto Scaling group:</p><p>Use the following command to specify ELB health checks for an Auto Scaling group:</p><pre><code>euscale-update-auto-scaling-group MyScalingGroup –-health-check-type ELB –-grace-period 300 
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-c0a0eccf064a86028174691a2cc3ab0f>3.8.3.4 - Configuring an Instance Termination Policy</h1><p>You can control how Auto Scaling determines which instances to terminate. You can specify a termination policy when you create an Auto Scaling group, and you can change the termination policy at any time using the command.You can override the default instance termination policy for your Auto Scaling group with one of the following options:</p><table><thead><tr><th style=text-align:left>Option</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left>OldestInstance</td><td style=text-align:left>The oldest instance in the Auto Scaling group should be terminated.</td></tr><tr><td style=text-align:left>NewestInstance</td><td style=text-align:left>The newest instance in the Auto Scaling group should be terminated.</td></tr><tr><td style=text-align:left>OldestLaunchConfiguration</td><td style=text-align:left>The first instance created using the oldest launch configuration should be terminated.</td></tr><tr><td style=text-align:left>Default</td><td style=text-align:left>Use the default instance termination policy.</td></tr></tbody></table><p>To configure an instance termination policy:</p><p>Specify the &ndash;termination-policies parameter when creating or updating the Auto Scaling group. For example:</p><pre><code>euscale-update-auto-scaling-group MyScalingGroup --termination-policies &quot;NewestInstance&quot;
</code></pre><p>Verify that your Auto Scaling group has updated the termination policy by running the following command: <code>euscale-describe-auto-scaling-groups MyScalingGroup</code> This command should return output similar to the following:</p><pre><code>AUTO-SCALING-GROUP	MyScalingGroup	MyLaunchConfig	PARTI00		2	5	2	NewestInstance
INSTANCE	i-1B853EC3	PARTI00	InService	Healthy	MyLaunchConfig
INSTANCE	i-ABC53ED7	PARTI00	InService	Healthy	MyLaunchConfig
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-85971fafb1ec1756b89b860719894dc1>3.8.3.5 - Configuring Auto Scaling with Elastic Load Balancing</h1><p>This example shows how to set up Auto Scaling with Elastic Load Balancing.To set up a load-balanced auto scaling configuration:</p><p>If you don&rsquo;t already have a launch configuration, create one: <code>euscale-create-launch-config MyLaunchConfig --image-id emi-50783D25 --instance-type m1.medium --group mysecuritygroup</code> Create a new auto scaling group associated with a load balancer: <code>euscale-create-auto-scaling-group MyScalingGroup --launch-configuration MyLaunchConfig --load-balancers MyLoadBalancer --availability-zones AcmeAvailabilityZone --min-size 2 --max-size 4</code> Authorize the security group used by the load balancer for back-end port communication. For example:</p><pre><code>$ eulb-describe-lbs --show-long
LOAD_BALANCER	MyLoadBalancer	MyLoadBalancer-408396244283.elb.acme.eucalyptus-systems.com			
{interval=200,target=HTTP:80/,timeout=3,healthy-threshold=2,unhealthy-threshold=4}		AcmeAvailabilityZone		
{protocol=HTTP,lb-port=80,instance-protocol=HTTP,instance-port=80}					
{owner-alias=944786667073,group-name=euca-internal-408396244283-MyLoadBalancer}		
2014-05-28T18:13:17.902Z
</code></pre><p><code>euca-authorize mysecuritygroup -u 944786667073 -o euca-internal-408396244283-MyLoadBalancer -p -1</code> Verify that your Auto Scaling group has been created with a load balancer:</p><pre><code>$ euscale-describe-auto-scaling-groups
AUTO-SCALING-GROUP	MyScalingGroup	MyLaunchConfig	AcmeAvailabilityZone	MyLoadBalancer	2	4	2	Default
INSTANCE	i-DFCD0CBC	AcmeAvailabilityZone	InService	Healthy	MyLaunchConfig
INSTANCE	i-B3431043	AcmeAvailabilityZone	InService	Healthy	MyLaunchConfig
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-fa9c57ce9cf0f118403555c12854216f>3.9 - Using Elastic Load Balancing</h1><h1 id=using-elastic-load-balancing>Using Elastic Load Balancing</h1><p>Elastic Load Balancing automatically distributes incoming traffic across your Eucalyptus cloud. It enables you to achieve even greater fault tolerance by automatically detecting instances that are overloaded, and rerouting traffic to other instances as needed.Elastic Load Balancing works in conjunction with Eucalyptus&rsquo;s Auto Scaling and Cloud Watch services, to make your cloud more robust and efficient.</p><p>The following section describes how load balancing works, provides an overview of load balancing concepts, and includes a series of usage scenarios that will show you how to perform common load balancing tasks.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-3efded6de8291ff4c6b94c2482944aa9>3.9.1 - Elastic Load Balancing Overview</h1><h1 id=elastic-load-balancing-overview>Elastic Load Balancing Overview</h1><p>Elastic Load Balancing is designed to provide an easy-to-use fault tolerant cloud platform. Using Elastic Load Balancing, you can automatically balance incoming traffic, ensuring that requests are sent to an instance that has the capacity to serve them. It allows you to add and remove instances as needed, without interrupting the operation of your cloud. If an instance fails or is removed, the load balancer stops routing traffic to that instance. If that instance is restored, or an instance is added, the load balancer automatically resumes or starts routing traffic to that instance.</p><p>If your cloud is serving traffic over HTTP, the Elastic Load Balancing service can provide session stickiness, allowing you to bind specific virtual instances to your load balancers.</p><p>Elastic Load Balancing can balance requests within a cluster, or across multiple clusters. If there are no more healthy instances in a cluster, the load balancer will route traffic to other clusters, until healthy instances are restored to that cluster.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-52af6b78792afd89a364bc84e5671daa>3.9.1.1 - Elastic Load Balancing Concepts</h1><p>This section describes the terminology and concepts you need for understanding and using the Elastic Load Balancing service.</p><h2 id=dns>DNS</h2><p>When a new load balancer is created, Eucalyptus will assign a unique DNS A record to the load balancer. After the load balancer has been launched and configured, the IP address of its interface will be added to the DNS name. If more than one cluster is specified, there can be more than one IP addresses mapped to the DNS name.</p><p>The load balancers in one cluster will distribute traffic to the instances only in the same cluster. Application users can query the application service using the DNS name and the Eucalyptus DNS service will respond to the query with the list of IP addresses on a round-robin basis.</p><p>Eucalyptus generates a DNS name automatically (e.g., lb001.euca-cloud.example.com). Typically there will also be a CNAME record that maps from the meaningful domain name (e.g., service.example.com) to the automatically-generated DNS name. The CNAME records can be serviced anywhere on Internet.</p><h2 id=health-check>Health Check</h2><p>In order to route traffic to healthy instances, and prevent traffic from being routed to unhealthy instances, the Elastic Load Balancing service routinely checks the health of your service instances. The health check uses metrics such as latency, RequestCount and HTTP response code counts to ensure that service instances are responding appropriately to user traffic.</p><h2 id=load-balancer>Load Balancer</h2><p>Load balancers are the core of the Elastic Load Balancing service. Load balancers are special instances created from a Eucalyptus-provided VM image, and are managed by Eucalyptus. Instances off the image forward packets to your service instances using load-balancing software to ensure no instances are overloaded.</p><p>There may be a brief delay between the time that the first service instance is registered to a load balancer and the time the load balancer becomes operational. This is due to the virtual machine instantiation, and will not adversely affect the operation of your load balancer.</p><p>Each balancer VM will service only one load balancer. Launching unnecessary load balancers may be detrimental to your cloud&rsquo;s performance.</p><h2 id=service-instance>Service Instance</h2><p>A service instance is an instance created from an image in your cloud. These are the instances that serve your application and users. The Elastic Load Balancing service monitors the health of these instances and routes traffic only to healthy instances.</p><h2 id=sticky-sessions>Sticky Sessions</h2><p>By default, a load balancer routes each request independently to the application instance with the smallest load. However, you can use the sticky session feature (also known as session affinity), which enables the load balancer to bind a user&rsquo;s session to a specific application instance. This ensures that all requests coming from the user during the session will be sent to the same application instance.</p><p>The key to managing the sticky session is determining how long your load balancer should consistently route the user&rsquo;s request to the same application instance. If your application has its own session cookie, then you can set Elastic Load Balancing to create the session cookie to follow the duration specified by the application&rsquo;s session cookie. If your application does not have its own session cookie, then you can set Elastic Load Balancing to create a session cookie by specifying your own stickiness duration. You can associate stickiness duration for only HTTP/HTTPS load balancer listeners.</p><p>An application instance must always receive and send two cookies: A cookie that defines the stickiness duration and a special Elastic Load Balancing cookie named AWSELB, that has the mapping to the application instance.</p><h2 id=httpsssl-support>HTTPS/SSL Support</h2><p>HTTPS Support is a feature that allows you to use the SSL/TLS protocol for encrypted connections (also known as SSL offload). This feature enables traffic encryption between the clients that initiate HTTPS sessions with your load balancer and also for connections between the load balancer and your back-end instances.</p><p>There are several advantages to using HTTPS/SSL connections with your load balancer:</p><ul><li><p>The SSL server certificate used to terminate client connections can be managed centrally on the load balancer, rather than on every individual application instance.</p></li><li><p>The work of encrypting and decrypting SSL traffic is moved from the application instance to the load balancer.</p></li><li><p>The load balancer can ensure session affinity or &ldquo;sticky sessions&rdquo; by terminating the incoming HTTPS request and then re-encrypting the content to send to the back-end application instance.</p></li><li><p>All of the features available for HTTP can be used with HTTPS connections.</p></li></ul><p>Using HTTPS/SSL protocols for both front-end and back-end connections ensures end-to-end traffic encryption. If you are using SSL and do not want Elastic Load Balancing to terminate, you can use a TCP listener and install certificates on all the back-end instances handling requests.</p><p>To enable HTTPS support for your load balancer, you&rsquo;ll have to install an SSL server certificate on your load balancer by using Identity and Access Management (IAM) to upload your SSL certificate and key. After you upload your certificate, specify its Amazon Resource Name (ARN) when you create a new load balancer or update an existing load balancer. The load balancer uses the certificate to terminate and then decrypt requests before sending them to the back-end instances.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-0ef117021b7f2e69b6b89b62164a657f>3.9.2 - Eucalyptus Load Balancing Usage Examples</h1><h1 id=eucalyptus-load-balancing-usage-examples>Eucalyptus Load Balancing Usage Examples</h1><p>This section contains examples of common usage scenarios for Eucalyptus Load Balancing.</p></div><div class=td-content><h1 id=pg-d435e90ef9d0abe8cf8635997f7c2916>3.9.2.1 - Eucalyptus ELB Listener Configurations</h1><p>This section provides a reference to various possible ways to configure your listener, depending on how secure you want your load balancer. Currently, Eucalyptus supports the following HTTP/HTTPS Load Balancer use cases:</p><ul><li>Basic HTTP load balancer</li><li>Secure website or application using ELB to offload SSL decryption.</li><li>Secure website or application using end-to-end encryption</li></ul><table><thead><tr><th style=text-align:left>Use Case</th><th style=text-align:left>Front-end Protocol</th><th style=text-align:left>Front-end Options</th><th style=text-align:left>Back-end Protocol</th><th style=text-align:left>Back-end Options</th><th style=text-align:left>Notes</th></tr></thead><tbody><tr><td style=text-align:left>Basic HTTP load balancer</td><td style=text-align:left>HTTP</td><td style=text-align:left>NA</td><td style=text-align:left>HTTP</td><td style=text-align:left>NA</td><td style=text-align:left>Supports X-forward for header. Go to AWS X-forwarding for more information.<a href></a></td></tr><tr><td style=text-align:left>Secure website or application using Elastic Load Balancing to offload SSL decryption</td><td style=text-align:left>HTTPS</td><td style=text-align:left>SSL Negotiation.</td><td style=text-align:left>HTTP</td><td style=text-align:left>NA</td><td style=text-align:left>Supports X-forward for header. Go to AWS X-forwarding for more information. Requires an SSL certificate installed on the load balancer.</td></tr><tr><td style=text-align:left>Secure website or application using end-to-end encryption</td><td style=text-align:left>HTTPS</td><td style=text-align:left>SSL Negotiation.</td><td style=text-align:left>HTTPS</td><td style=text-align:left>Back-end authentication</td><td style=text-align:left>Supports X-forward for header. Go to AWS X-forwarding for more information. Requires an SSL certificate installed on the load balancer and registered instances.</td></tr></tbody></table></div><div class=td-content style=page-break-before:always><h1 id=pg-441800215b6afae35e19bd054f75affd>3.9.2.2 - Creating a Basic Elastic Load Balancing Configuration</h1><p>Elastic load balancing requires two basic elements to function properly: a load balancer and instances registered with that load balancer. The following examples show how to set up the basic elements of an elastic load balancer configuration.</p><h2 id=create-a-load-balancer>Create a Load Balancer</h2><p>The load balancer manages incoming traffic, and monitors the health of your instances. The load balancer ensures that traffic is only sent to healthy instances.To create a load balancer:</p><p>Enter the following command, specifying availability zones:</p><pre><code>eulb-create-lb -z one -l &quot;lb-port=80, protocol=HTTP, instance-port=80, 
instance-protocol=HTTP&quot; MyLoadBalancer
</code></pre><p>To verify the elastic load balancer has been created, enter the following command: <code>eulb-describe-lbs MyLoadBalancer</code> You should see output similar to the following:</p><pre><code>LOAD_BALANCER	MyLoadBalancer	MyLoadBalancer-587773761872.lb.localhost	2013-01-01T01:23:45.678Z
</code></pre><p>Optionally, you can create listeners for the load balancer as follows:</p><pre><code>eulb-create-lb-listeners --listener &quot;lb-port=80, protocol=HTTP,
    instance-port=80, instance-protocol=HTTP&quot;
</code></pre><p>You&rsquo;ve now created an elastic load balancer.</p><h2 id=register-instances-with-the-load-balancer>Register instances with the Load Balancer</h2><p>The load balancer monitors the health of registered instances, and balances incoming traffic across the healthy instances.To register an instance with the load balancer: Enter the following command:</p><pre><code>eulb-register-instances-with-lb --instances i-e0636aca,i-0c9c3967 MyLoadBalancer
</code></pre><p>Enter the following command to verify that the instances are registered with the load balancer: <code>eulb-describe-instance-health MyLoadBalancer</code> This command will return output similar to the following:</p><pre><code>INSTANCE	i-6FAD3F7B	InService
INSTANCE	i-70FE4541	InService
</code></pre><p>Once you&rsquo;ve created the load balancer and registered your instances with it, the load balancer will automatically route traffic from its endpoint URL to healthy instances.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-9b07046d5cfd7a621ae1abebbaa563bb>3.9.2.3 - Configuring the Health Check</h1><p>To determine which instances are healthy, the load balancer periodically polls the registered instances. You can use the command as described in this topic.Perform the following step to configure how the instances should be polled, how long to wait for a response, and how many consecutive successes or failures are required to mark an instance as healthy or unhealthy.</p><p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>After you initially set up your load balancer, Eucalyptus automatically performs a health check to protect against potential side-effects caused by instances being terminated without being deregistered. This health check uses the instance port defined in the load balancer configuration</div>The following shows an example health check configuration command:</p><pre><code>eulb-configure-healthcheck --healthy-threshold 5 --unhealthy-threshold 5 --interval 30 --timeout 120 --target HTTP:80/ MyLoadBalancer
</code></pre><p>Use <code>--healthy-threshold</code> and <code>--unhealthy-threshold</code> to specify the number of consecutive health checks required to mark an instance as Healthy or Unhealthy respectively. Use <code>--target</code> to specify the connection target on your instances for these health checks. Use <code>--interval</code> and <code>--timeout</code> to specify the approximate frequency and maximum duration of these health checks.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-174d97ee16b0c7ca97b9cd8e0d1c14d1>3.9.2.4 - Modifying an Elastic Load Balancing Configuration</h1><p>Elastic load balancing requires two basic elements to function properly: a load balancer and instances registered with that load balancer. The following examples show how to modify the basic elements of an elastic load balancer configuration.</p><h2 id=de-register-instances-from-the-load-balancer>De-register instances from the Load Balancer</h2><p>The load balancer monitors the health of registered instances, and balances incoming traffic across the healthy instances.To deregister an instance from the load balancer: Enter the following command:</p><pre><code>eulb-deregister-instances-from-lb --instances INSTANCE1,INSTANCE2,... MyLoadBalancer
</code></pre><p>Enter the following command to verify that the instances are deregistered from the load balancer: <code>eulb-describe-instance-health MyLoadBalancer</code> This command will return output similar to the following:</p><pre><code>INSTANCE	i-6FAD3F7B	InService
</code></pre><h2 id=delete-load-balancer-listeners>Delete Load Balancer Listeners</h2><p>To delete a load balancer listener:</p><p>Enter the following command:</p><pre><code>eulb-delete-lb-listeners --lb-ports PORT1,PORT2,... MyLoadBalancer
</code></pre><h2 id=delete-load-balancer>Delete Load Balancer</h2><p>To delete a load balancer:</p><p>Enter the following command:</p><pre><code>eulb-delete-lb MyLoadBalancer
</code></pre><p>You&rsquo;ve now deleted the elastic load balancer.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-5d3d174a5842b1b8c026080102c901df>3.9.2.5 - Creating Elastic Load Balancing Sticky Sessions</h1><p>By default, a load balancer routes each request independently to the application instance with the smallest load. However, you can use the sticky session feature (also known as session affinity) which enables the load balancer to bind a user&rsquo;s session to a specific application instance. This ensures that all requests coming from the user during the session will be sent to the same application instance.</p><h2 id=enable-duration-based-session-stickiness>Enable Duration-Based Session Stickiness</h2><p>To enable duration-based sticky sessions for a load balancer:</p><p>Use the <code>eulb-create-lb-cookie-stickiness-policy</code> command to create a load-balancer-generated cookie stickiness policy with a cookie expiration period of 60 seconds. <code>eulb-create-lb-cookie-stickiness-policy MyLoadBalancer --policy-name MyLoadBalancerPolicy --expiration-period 60</code> Use the <code>eulb-set-lb-policies-of-listener</code> command to enable session stickiness for a load balancer using the MyLoadBalancerPolicy. <code>eulb-set-lb-policies-of-listener MyLoadBalancer --lb-port 80 --policy-names MyLoadBalancerPolicy</code> You can use the <code>eulb-describe-lb-policies</code> command to list the policies created for the load balancer. <code>eulb-describe-lb-policies MyLoadBalancer --show-long</code></p><h2 id=enable-application-controlled-session-stickiness>Enable Application-Controlled Session Stickiness</h2><p>To enable application-controlled session stickiness: Use the <code>eulb-create-app-cookie-stickiness-policy</code> command to create a load application-generated cookie stickiness policy: <code>eulb-create-app-cookie-stickiness-policy my-load-balancer -p my-app-cookie-lb-policy -c my-cookie</code> Use the <code>eulb-set-lb-policies-of-listener</code> command to enable session stickiness for a load balancer using the my-load-balancer policy. <code>eulb-set-lb-policies-of-listener example-lb --lb-port 80 --policy-names my-app-cookie-lb-policy</code> You can use the <code>eulb-describe-lb-policies</code> command to list the policies created for the load balancer. <code>eulb-describe-lb-policies example-lb --show-long</code></p></div><div class=td-content style=page-break-before:always><h1 id=pg-f1ad054efec9e95d751013d7b0f2103c>3.9.2.6 - Uploading SSL Certificates for Elastic Load Balancing</h1><p>You must install an X.509 certificate on your load balancer in order to use HTTPS or SSL termination. The X.509 certificate is issued by a central Certificate Authority (CA) and contains identifying information, including a digital signature. X.509 certificates have a validity period. Once an X.509 certificate expires, you must create and install a new certificate.</p><h2 id=upload-a-certificate>Upload a Certificate</h2><p>Once you&rsquo;ve created a certificate, you must upload it to your cloud using the command.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>You must create the certificate and get it signed by a certificate authority (CA) before you can upload the certificate using the AWS Identity and Access Management (IAM) service. For instructions, go to .</div>To upload a certificate :</p><p>Enter the <code>euare-servercertupload</code> command, specifying the name of your certificate, the contents of the PEM-encoded public- and private-keys:</p><pre><code>euare-servercertupload -s cert-name --certificate-file ssl_server_cert.crt --private-key-file ssl_server_cert.pem
</code></pre><p>You&rsquo;ve now created an elastic load balancer.</p><h2 id=verify-server-certificate>Verify Server Certificate</h2><p>You can verify that an uploaded certificate is stored in IAM. Each certificate object has a unique Amazon Resource Name (ARN) and ID.To verify an uploaded certificate: Use the <code>euare-servercertlistbypath</code> command to verify the certificate is stored in IAM:</p><pre><code>euare-servercertgetattributes -s elb-ssl-cert
</code></pre><p>The command will return the ARN, followed by the GUID. For example:</p><pre><code>arn:aws:iam::495375389014:server-certificate/elb-ssl-cert
ASCWDKTJBXPSZTHWFERVP
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-84660b0f56fa561f8e7dd7fd39147d84>3.9.2.7 - Adding SSL Support</h1><p>This topic describes how to add SSL support to a new or existing load balancer.</p><h2 id=creating-a-new-listener-with-ssl-support>Creating a new listener with SSL support</h2><p>This task shows how to create a new listener with SSL support.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>In order to use HTTPS support, you&rsquo;ll need to install an SSL server certificate on your load balancer. If you haven&rsquo;t already done this, see .</div>To add a new listener to your load balancer: Using the ARN for the certificate you installed, use the <code>eulb-create-listener</code> command to create a new listener. For example: <code>eulb-create-lb-listeners MyLoadBalancer --listener "protocol=HTTPS,lb-port=443,instance-port=80,instance-protocol=HTTP, cert-id=arn:aws:iam::12345678901:my-server-certificate/testing/myNewCert"</code> Use the <code>eulb-describe-lbs</code> command to see the details of your load balancer. For example: <code>eulb-describe-lbs MyLoadBalancer</code></p><h2 id=updating-a-listener-with-a-new-ssl-certificate>Updating a listener with a new SSL certificate</h2><p>This task shows how to replace an SSL server certificate configured with listeners"<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>In order to use HTTPS support, you&rsquo;ll need to install an SSL server certificate on your load balancer. If you haven&rsquo;t already done this, see .</div>To update an existing listener with SSL support: Use the <code>eulb-set-lb-listener-ssl-certcommand</code> with the ARN of your new server certificate to replace the certificate configured with listeners For example: <code>eulb-set-lb-listener-ssl-cert MyLoadBalancer --lb-port 443 --cert-id arn:aws:iam::12345678901:my-server-certificate/testing/myNewCert</code> Use the <code>eulb-describe-lbs</code> command to see the details of your load balancer. For example: <code>eulb-describe-lbs MyLoadBalancer</code></p></div><div class=td-content style=page-break-before:always><h1 id=pg-6daed41591ecf089789af6ae6c4f4c9c>3.9.2.8 - Updating the SSL Negotiation Configuration</h1><p>Eucalyptus Elastic Load Balancing (ELB) uses SSL negotiation configurations to determine how SSL connections to your load balancer behave. This topic shows how to update an existing load balancer with an SSL negotiation configuration.</p><p>Get a list of predefined security policies using the <code>eulb-describe-lb-policies</code> command: <code>eulb-describe-lb-policies</code> This produces output similar to the following:</p><pre><code>POLICY	ELBSample-AppCookieStickinessPolicy	AppCookieStickinessPolicyType
POLICY	ELBSample-LBCookieStickinessPolicy	LBCookieStickinessPolicyType
POLICY	ELBSecurityPolicy-2014-10	SSLNegotiationPolicyType
POLICY	ELBSecurityPolicy-2015-02	SSLNegotiationPolicyType
POLICY	ELBSecurityPolicy-2011-08	SSLNegotiationPolicyType
POLICY	ELBSecurityPolicy-2015-05	SSLNegotiationPolicyType
POLICY	ELBSecurityPolicy-2014-01	SSLNegotiationPolicyType
</code></pre><p>Use the <code>eulb-create-lb-policy</code> command to update the SSL negotiation configuration to use one of the predefined security policies. For example: <code>eulb-create-lb-policy --policy-name mypredefinedsslpolicy --policy-type SSLNegotiationPolicyType --attributes "Reference-Security-Policy=ELBSecurityPolicy-2011-08" myloadbalancer</code> Use the <code>eulb-describe-lbs</code> command to verify the update. For example: <code>eulb-describe-lbs myloadbalancer</code></p></div><div class=td-content style=page-break-before:always><h1 id=pg-ad3df4530193d2f58cafb2565733cba6>3.9.2.9 - Adding and Editing Predefined Security Policies</h1><p>This topic describes how to add and edit ELB security policies.Default ELB policies are stored as JSON files in the <code>/etc/eucalyptus/cloud.d/elb-security-policy</code> directory. You can add or edit policy files here, and the changes will take effect when the CLC is restarted.</p><p>Copy one of the ELB policy files to a new file and edit the file. You must change the <code>PolicyName</code> attribute to a new name, with the name ending in a date. For example: <code>ELBSecurityPolicy-2015-09</code> The policy file with the most recent date appended to the name will be used as the default policy when users create HTTPS/SSL listeners. The following is an example of an ELB policy file. You can modify this file and save it with a new filename in the <code>/etc/eucalyptus/cloud.d/elb-security-policy</code> directory.</p><pre><code>{
    &quot;PolicyAttributeDescriptions&quot;: [
        {
            &quot;AttributeName&quot;: &quot;Protocol-SSLv2&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;Protocol-TLSv1&quot;,
            &quot;AttributeValue&quot;: &quot;true&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;Protocol-SSLv3&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;Protocol-TLSv1.1&quot;,
            &quot;AttributeValue&quot;: &quot;true&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;Protocol-TLSv1.2&quot;,
            &quot;AttributeValue&quot;: &quot;true&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;Server-Defined-Cipher-Order&quot;,
            &quot;AttributeValue&quot;: &quot;true&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;ECDHE-ECDSA-AES128-GCM-SHA256&quot;,
            &quot;AttributeValue&quot;: &quot;true&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;ECDHE-RSA-AES128-GCM-SHA256&quot;,
            &quot;AttributeValue&quot;: &quot;true&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;ECDHE-ECDSA-AES128-SHA256&quot;,
            &quot;AttributeValue&quot;: &quot;true&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;ECDHE-RSA-AES128-SHA256&quot;,
            &quot;AttributeValue&quot;: &quot;true&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;ECDHE-ECDSA-AES128-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;true&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;ECDHE-RSA-AES128-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;true&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;DHE-RSA-AES128-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;ECDHE-ECDSA-AES256-GCM-SHA384&quot;,
            &quot;AttributeValue&quot;: &quot;true&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;ECDHE-RSA-AES256-GCM-SHA384&quot;,
            &quot;AttributeValue&quot;: &quot;true&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;ECDHE-ECDSA-AES256-SHA384&quot;,
            &quot;AttributeValue&quot;: &quot;true&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;ECDHE-RSA-AES256-SHA384&quot;,
            &quot;AttributeValue&quot;: &quot;true&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;ECDHE-RSA-AES256-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;true&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;ECDHE-ECDSA-AES256-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;true&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;AES128-GCM-SHA256&quot;,
            &quot;AttributeValue&quot;: &quot;true&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;AES128-SHA256&quot;,
            &quot;AttributeValue&quot;: &quot;true&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;AES128-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;true&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;AES256-GCM-SHA384&quot;,
            &quot;AttributeValue&quot;: &quot;true&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;AES256-SHA256&quot;,
            &quot;AttributeValue&quot;: &quot;true&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;AES256-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;true&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;DHE-DSS-AES128-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;CAMELLIA128-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;EDH-RSA-DES-CBC3-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;DES-CBC3-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;true&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;ECDHE-RSA-RC4-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;RC4-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;ECDHE-ECDSA-RC4-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;DHE-DSS-AES256-GCM-SHA384&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;DHE-RSA-AES256-GCM-SHA384&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;DHE-RSA-AES256-SHA256&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;DHE-DSS-AES256-SHA256&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;DHE-RSA-AES256-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;DHE-DSS-AES256-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;DHE-RSA-CAMELLIA256-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;DHE-DSS-CAMELLIA256-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;CAMELLIA256-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;EDH-DSS-DES-CBC3-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;DHE-DSS-AES128-GCM-SHA256&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;DHE-RSA-AES128-GCM-SHA256&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;DHE-RSA-AES128-SHA256&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;DHE-DSS-AES128-SHA256&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;DHE-RSA-CAMELLIA128-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;DHE-DSS-CAMELLIA128-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;ADH-AES128-GCM-SHA256&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;ADH-AES128-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;ADH-AES128-SHA256&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;ADH-AES256-GCM-SHA384&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;ADH-AES256-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;ADH-AES256-SHA256&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;ADH-CAMELLIA128-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;ADH-CAMELLIA256-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;ADH-DES-CBC3-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;ADH-DES-CBC-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;ADH-RC4-MD5&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;ADH-SEED-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;DES-CBC-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;DHE-DSS-SEED-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;DHE-RSA-SEED-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;EDH-DSS-DES-CBC-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;EDH-RSA-DES-CBC-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;IDEA-CBC-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;RC4-MD5&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;SEED-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;DES-CBC3-MD5&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;DES-CBC-MD5&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;RC2-CBC-MD5&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;PSK-AES256-CBC-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;PSK-3DES-EDE-CBC-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;KRB5-DES-CBC3-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;KRB5-DES-CBC3-MD5&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;PSK-AES128-CBC-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;PSK-RC4-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;KRB5-RC4-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;KRB5-RC4-MD5&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;KRB5-DES-CBC-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;KRB5-DES-CBC-MD5&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;EXP-EDH-RSA-DES-CBC-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;EXP-EDH-DSS-DES-CBC-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;EXP-ADH-DES-CBC-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;EXP-DES-CBC-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;EXP-RC2-CBC-MD5&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;EXP-KRB5-RC2-CBC-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;EXP-KRB5-DES-CBC-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;EXP-KRB5-RC2-CBC-MD5&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;EXP-KRB5-DES-CBC-MD5&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;EXP-ADH-RC4-MD5&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;EXP-RC4-MD5&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;EXP-KRB5-RC4-SHA&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        },
        {
            &quot;AttributeName&quot;: &quot;EXP-KRB5-RC4-MD5&quot;,
            &quot;AttributeValue&quot;: &quot;false&quot;
        }
    ],
    &quot;PolicyName&quot;: &quot;ELBSecurityPolicy-2015-05&quot;,
    &quot;PolicyTypeName&quot;: &quot;SSLNegotiationPolicyType&quot;
}
</code></pre><p>Using a text editor, change the <code>PolicyName</code> attribute. For example: <code>"PolicyName": "ELBSecurityPolicy-2015-05"</code> Once you&rsquo;ve edited and saved the JSON file, restart the CLC. Once the CLC has restarted, use the <code>eulb-describe-lb-policies</code> command to verify that your new policy is listed. For example:</p><pre><code>POLICY	ELBSample-AppCookieStickinessPolicy	AppCookieStickinessPolicyType
POLICY	ELBSample-LBCookieStickinessPolicy	LBCookieStickinessPolicyType
POLICY	ELBSecurityPolicy-2014-10	SSLNegotiationPolicyType
POLICY	ELBSecurityPolicy-2015-02	SSLNegotiationPolicyType
POLICY	ELBSecurityPolicy-2011-08	SSLNegotiationPolicyType
POLICY	ELBSecurityPolicy-2015-05	SSLNegotiationPolicyType
POLICY	ELBSecurityPolicy-2014-01	SSLNegotiationPolicyType
POLICY	MyNewELBSecurityPolicy-2015-09	SSLNegotiationPolicyType
</code></pre><p>You can now use your new security policy using the <code>eulb-create-lb-policy</code> command. For more information, see <a href=https://www.eucastack.io/docs/user_guide/elb_intro/elb_examples_intro/elb_examples_ssl_negotiation/>Updating the SSL Negotiation Configuration</a> .</p></div><div class=td-content style=page-break-before:always><h1 id=pg-9eafb00077fc3a1a35dfa444899e3962>3.9.2.10 - Configuring Back-end Server Authentication</h1><p>When running a web application with HTTPS or SSL as the backend server’s protocol, you might want to authenticate the back-end servers using the public key of the back-end server’s certificate. This authentication can be used to ensure that back-end servers accept only encrypted communication and to ensure that the back-end servers have the correct certificate.To configure back-end server authentication:</p><p>Create a new loadbalancer with HTTPS as backend instance’s protocol:</p><pre><code>eulb-create-lb -l &quot;protocol=HTTPS,lb-port=443,instance-protocol=HTTPS,instance-port=8443,cert-id=arn:aws:iam::000550595745:server-certificate/mycert01&quot;\
                        -z one myloadbalancer
</code></pre><p>Create a new PublicKeyPolicyType policy for the load balancer. In the example below, ‘server.crt’ is the file containing the public key of the backend server’s certificate.</p><pre><code>eulb-create-lb-policy -n webservercert -t PublicKeyPolicyType -a &quot;name=PublicKey, value=$(&lt;./server.crt)&quot; myloadbalancer
</code></pre><p>Use the <code>eulb-describe-lb-policies</code> to ensure that the policy was created. For example:</p><pre><code>eulb-describe-lb-policies -p webservercert myloadbalancer
</code></pre><p>Create a new <code>BackendServerAuthenticationPolicyType</code> policy that refers to the public key policy created above.</p><pre><code>eulb-create-lb-policy -n webserverauthentication -t BackendServerAuthenticationPolicyType -a &quot;name=PublicKeyPolicyName, value=webservercert&quot; myloadbalancer
</code></pre><p>Make sure the policy is created. For example:</p><pre><code>eulb-describe-lb-policies -p webserverauthentication myloadbalancer
</code></pre><p>Set the created policy to the listener by specifying the instance&rsquo;s port number. For example:</p><pre><code>eulb-set-lb-policies-for-backend-server -i 443 -p webserverauthentication myloadbalancer
</code></pre><p>Make sure the policy is attached to the intended listener. For example:</p><pre><code>eulb-describe-lbs --show-long myloadbalancer
LOAD_BALANCER myloadbalancer
myloadbalancer-000550595745.lb.c-04.autoqa.qa1.eucalyptus-systems.com
{interval=30,target=TCP:8443,timeout=5,healthy-threshold=3,unhealthy-threshold=3} one \
{protocol=HTTPS,lb-port=443,instance-protocol=HTTPS,instance-port=8443,cert-id=arn:aws:iam::000550595745:server-certificate/mycert01,\
{ELBSecurityPolicy-2015-05}}
{instance-port=8443,policies={webserverauthentication}}
{ELBSecurityPolicy-2015-05,webservercert,webserverauthentication}
{owner-alias=000936883517,group-name=euca-internal-000550595745-myloadbalancer}
2015-10-12T20:55:52.08Z
internet-facing
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-43db79d13bfc91251cd4fc4343275495>3.9.2.11 - Enabling Cross-Zone Load Balancing</h1><p>When an ELB has instances in multiple available zones, enabling cross-zone load balancing will distribute traffics to instances across availability zones. If disabled, the load balancer in a zone will distribute traffics to instances within the zone. For example, if a Zone A has 10 instances, and a Zone B has 1 instance, and the client happens to use the load balancer of Zone B (via round-robin DNS), cross-zone load balancing will ensure that the clients will use all 11 instances, not just the one instance in Zone B.To enable cross-zone load balancing:</p><p>By default, cross-zone load balancing is not enabled for a new load balancer. To enable, modify the load balancer attribute using the eulb-modify-lb-attributes command. For example: <code>eulb-modify-lb-attributes myloadbalancer CrossZoneLoadBalancing.Enabled=true</code> Make sure the attribute is enabled. For example:</p><pre><code>eulb-describe-lb-attributes myloadbalancer
AccessLog.Enabled false
ConnectionDraining.Enabled  false
ConnectionSettings.IdleTimeout 60
CrossZoneLoadBalancing.Enabled true                
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-65ae084284fdc29b9fc2bf4bf58cabf6>3.9.2.12 - Accessing Load Balancer Logs</h1><p>To help analyze an application’s performances or troubleshoot problems, you can capture detailed information for all requests coming through your load balancers. When enabled, such access logs will be captured and stored in the S3 bucket.To access ELB logs:</p><p>Before enabling the access logs, update the access control of your S3 (Eucalyptus object-storage-gateway) bucket so that Eucalyptus’ load balancer has write permissions. The access control list requires the canonical ID of the grantee. To obtain the canonical ID of the load balancing service:<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If your cloud is using VPCMIDO networking mode, use the command in the next step.</div></p><pre><code>eulb-describe-lbs --show-long --region devops-admin@region-1
LOAD_BALANCER myloadbalancer	
myloadbalancer-000476918024.lb.a-18.autoqa.qa1.eucalyptus-systems.com			
{interval=30,target=TCP:80,timeout=5,healthy-threshold=3,unhealthy-threshold=3	
cash,money i-6f2a1874,i-be660343	
{protocol=HTTP,lb-port=80,instance-protocol=HTTP,instance-port=80}					
{owner-alias=000865102303,group-name=euca-internal-000476918024-myloadbalancer}		
2015-09-29T18:11:33.761Z	
internet-facing
</code></pre><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Save the number at the end of the output to update the bucket&rsquo;s ACL in .</div><p>To obtain the canonical ID of the load balancing service in VPCMIDO networking mode:<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If your cloud is not using VPCMIDO networking mode, use the command in the previous step.</div></p><pre><code>euserv-describe-services --filter service-type=loadbalancing --expert
SERVICE arn:euca:bootstrap:API_10.111.1.19:loadbalancing:API_10.111.1.19.loadbalancing/ enabled 25 
http://10.111.1.19:8773/services/LoadBalancing 
(eucalyptus)loadbalancing=000036660381:28323c32338354b20255a633830524c1224434cb1a5254c1d614614841586042
</code></pre><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Save the number at the end of the output to update the bucket&rsquo;s ACL in .</div><p>Use any S3 client tools to update the bucket’s ACL. For example:</p><pre><code># aws --endpoint-url http://objectstorage.a-18.autoqa.qa1.eucalyptus-systems.com:8773/ s3 s3://webserverlog
# aws --endpoint-url http://objectstorage.a-18.autoqa.qa1.eucalyptus-systems.com:8773/ s3api put-bucket-acl --grant-write &quot;id=000865102303&quot; --bucket s3://webserverlog
</code></pre><p>Modify your load balancer’s attributes to enable the access logs. For example:</p><pre><code>eulb-modify-lb-attributes myloadbalancer AccessLog.Enabled=true AccessLog.S3BucketName=webserverlog AccessLog.EmitInterval=5 AccessLog.S3BucketPrefix=myprefix
</code></pre><p>Check that the attribute has been updated correctly by using the <code>eulb-describe-lb-attributes</code> command:</p><pre><code>eulb-describe-lb-attributes myloadbalancer
AccessLog.EmitInterval  5
AccessLog.Enabled true
AccessLog.S3BucketName  webserverlog
AccessLog.S3BucketPrefix  myprefix
ConnectionDraining.Enabled  false
ConnectionSettings.IdleTimeout 60
CrossZoneLoadBalancing.Enabled true      
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-e2537d6cae270c2662113e6704686e49>3.10 - Using CloudWatch</h1><h1 id=using-cloudwatch>Using CloudWatch</h1><p>CloudWatch is a Eucalyptus service that enables you to monitor, manage, and publish various metrics, as well as configure alarm actions based on data from metrics. You can use the default metrics that come with Eucalyptus, or you can use your own metrics.CloudWatch collects raw data from your cloud&rsquo;s resources and generates the information into readable, near real-time metrics. These metrics are recorded for a period of two weeks. This allows you to access historical information and provides you with information about how your resource is performing.</p><p>To find out more about what CloudWatch is, see <a href=https://www.eucastack.io/docs/user_guide/using_monitoring/monitoring_oview/>CloudWatch Overview</a> .</p><p>To find out how to use CloudWatch, see <a href=https://www.eucastack.io/docs/user_guide/using_monitoring/monitoring_tasks/>CloudWatch Tasks</a> .</p></div><div class=td-content style=page-break-before:always><h1 id=pg-ba38e0f8d65765ef9bcbb48ac325b0fd>3.10.1 - CloudWatch Overview</h1><h1 id=cloudwatch-overview>CloudWatch Overview</h1><p>This section describes the concepts and details you need to understand the CloudWatch service. This section also includes procedures to complete the most common tasks for CloudWatch.CloudWatch is a Eucalyptus service that collects, aggregates, and dispenses data from your cloud&rsquo;s resources. This data allows you to make operational and business decisions based on actual performance metrics. You can use CloudWatch to collect metrics about your cloud resources, such as the performance of your instances. You can also publish your own metrics directly to CloudWatch.</p><p>CloudWatch monitors the following cloud resources:</p><ul><li>instances</li><li>Elastic Block Store (EBS) volumes</li><li>Auto Scaling instances</li><li>Eucalyptus Load Balancers (ELB)</li></ul><h2 id=alarms>Alarms</h2><p>CloudWatch alarms help you make decisions more easily by automatically making changes to the resources you are monitoring, based on rules that you define. For example, you can create alarms that initiate Auto Scaling actions on your behalf. For more information about alarm tasks, see <a href=https://www.eucastack.io/docs/user_guide/using_monitoring/monitoring_tasks/monitoring_alarm/>Configuring Alarms</a> .</p><h2 id=common-use-cases>Common Use Cases</h2><p>A common use for CloudWatch is to keep your applications and services healthy and running efficiently. For example, CloudWatch can determine that your application runs best when network traffic remains below a certain threshold level on your instances. You can then create an automated procedure to ensure that you always have the right number of instances to match the amount of traffic you have.</p><p>Another use for CloudWatch is to diagnose problems by looking at system performance before and after a problem occurs. CloudWatch helps you identify the cause and verify your fix by tracking performance in real time.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-de26569f213c700b3e57db3b7012fd27>3.10.1.1 - CloudWatch Concepts</h1><p>This section describes the terminology and concepts you need in order to understand and use CloudWatch.</p><h2 id=metric>Metric</h2><p>A metric is a time-ordered set of data points. You can get metric data from Eucalyptus cloud resources (like instances or volumes), or you can publish your own set of custom metric data points to CloudWatch. You then retrieve statistics about those data points as an ordered set of time-series data.</p><p>Data points represent values of a variable over time. For example you can get metrics for the CPU usage of a particular instance, or for the latency of an elastic load balancer (ELB).</p><p>Each metric is uniquely defined by a name, a namespace, and zero or more dimensions. Each data point has a time stamp, and (optionally) a unit of measure. When you request statistics, the returned data stream is identified by namespace, metric name, dimension, and (optionally) the unit. For more information about Eucalyptus-supported metrics, see <a href=https://www.eucastack.io/docs/user_guide/using_monitoring/monitoring_oview/monitoring_metric_ref/>Namespaces, Metrics, and Dimensions</a> .</p><p>CloudWatch stores your metric data for two weeks. You can publish metric data from multiple sources, such as incoming network traffic from dozens of different instances, or requested page views from several different web applications. You can request statistics on metric data points that occur within a specified time window.</p><h2 id=namespace>Namespace</h2><p>A namespace is a conceptual container for a collection of metrics. Eucalyptus treats metrics in different namespaces as unique. This means that metrics from different services cannot mistakenly be aggregated into the same statistical set.</p><p>Namespace names are strings you define when you create a metric. The names must be valid XML characters, typically containing the alphanumeric characters &ldquo;0-9A-Za-z&rdquo; plus &ldquo;."(period), &ldquo;-&rdquo; (hyphen), &ldquo;_&rdquo; (underscore), &ldquo;/&rdquo; (slash), &ldquo;#&rdquo; (hash), and &ldquo;:&rdquo; (colon). All Eucalyptus services that provide CloudWatch data follow the convention AWS/<service>, such as AWS/EC2 and AWS/ELB. For more information, see <a href=https://www.eucastack.io/docs/user_guide/using_monitoring/monitoring_oview/monitoring_metric_ref/monitoring_namespaces/>Namespaces</a> .</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>A namespace name must be less than 256 characters. There is no default namespace. You must specify a namespace for each data element you put into CloudWatch.</div><h2 id=dimension>Dimension</h2><p>A dimension is a name-value pair that uniquely identifies a metric. A dimension helps you design a conceptual structure for your statistics plan. Because dimensions are part of the unique identifier for a metric, metric name, namespace, and dimension key-value pairs define unique metrics.</p><p>You specify dimensions when you create a metric with the euwatch-put-data command. Eucalyptus services that report data to CloudWatch also attach dimensions to each metric. You can use dimensions to filter result sets that CloudWatch queries return. For example, you can get statistics for a specific instance by calling euwatch-get-stats with the InstanceID dimension set to a specific instance ID.</p><p>For Eucalyptus metrics, CloudWatch can aggregate data across select dimensions. For example, if you request a metric in the AWS/EC2 namespace and do not specify any dimensions, CloudWatch aggregates all data for the specified metric to create the statistic that you requested. However, CloudWatch does not aggregate across dimensions for custom metrics</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>You can assign up to ten dimensions to a metric.</div><h2 id=time-stamp>Time Stamp</h2><p>Each metric data point must be marked with a time stamp. The time stamp can be up to two weeks in the past and up to two hours into the future. If you do not provide a time stamp, CloudWatch creates a time stamp for you based on the time the data element was received.</p><p>The time stamp you use in the request must be a dateTime object, with the complete date plus hours, minutes, and seconds. For example: 2007-01-31T23:59:59Z. For more information, go to <a href=http://www.w3.org/TR/xmlschema-2/#dateTime>http://www.w3.org/TR/xmlschema-2/#dateTime</a> . Although it is not required, we recommend you provide the time stamp in the Coordinated Universal Time (UTC or Greenwich Mean Time) time zone. When you retrieve your statistics from CloudWatch, all times reflect the UTC time zone.</p><h2 id=unit>Unit</h2><p>A unit represents a statistic&rsquo;s measurement in time or amount. For example, the units for the instance NetworkIn metric is Bytes because NetworkIn tracks the number of bytes that an instance receives on all network interfaces.</p><p>You can also specify a unit when you create a custom metric. Units help provide conceptual meaning to your data. Metric data points you create that specify a unit of measure, such as Percent, will be aggregated separately. The following list provides some of the more common units that CloudWatch supports:</p><ul><li>Seconds</li><li>Bytes</li><li>Bits</li><li>Percent</li><li>Count</li><li>Bytes/Second (bytes per second)</li><li>Bits/Second (bits per second)</li><li>Count/Second (counts per second)</li><li>None (default when no unit is specified)
Though CloudWatch attaches no significance to a unit, other applications can derive semantic information based on the unit you choose. When you publish data without specifying a unit, CloudWatch associates it with the None unit. When you get statistics without specifying a unit, CloudWatch aggregates all data points of the same unit together. If you have two otherwise identical metrics with different units, two separate data streams will be returned, one for each unit.</li></ul><h2 id=statistic>Statistic</h2><p>A statistic is computed aggregation of metric data over a specified period of time. CloudWatch provides statistics based on the metric data points you or Eucalyptus provide. Aggregations are made using the namespace, metric name, dimensions, and the data point unit of measure, within the time period you specify. The following table describes the available statistics.</p><table><thead><tr><th style=text-align:left>Statistic</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left>Minimum</td><td style=text-align:left>The lowest value observed during the specified period. You can use this value to determine low volumes of activity for your application.</td></tr><tr><td style=text-align:left>Maximum</td><td style=text-align:left>The highest value observed during the specified period. You can use this value to determine high volumes of activity for your application.</td></tr><tr><td style=text-align:left>Sum</td><td style=text-align:left>All values submitted for the matching metric added together. You can use this statistic for determining the total volume of a metric.</td></tr><tr><td style=text-align:left>Average</td><td style=text-align:left>The value of Sum / SampleCount during the specified period. By comparing this statistic with the Minimum and Maximum, you can determine the full scope of a metric and how close the average use is to the Minimum and Maximum. This comparison helps you to know when to increase or decrease your resources as needed.</td></tr><tr><td style=text-align:left>SampleCount</td><td style=text-align:left>The count (number) of data points used for the statistical calculation.</td></tr></tbody></table><h2 id=period>Period</h2><p>A period is the length of time, in seconds, associated with a specific CloudWatch statistic. Each statistic represents an aggregation of the metrics data collected for a specified period of time. You can adjust how the data is aggregated by varying the length of the period. A period can be as short as one minute (60 seconds) or as long as two weeks (1,209,600 seconds).</p><p>The values you select for the StartTime and EndTime options determine how many periods CloudWatch returns. For example, if you set values for the Period, EndTime, and StartTime options for 60 seconds, CloudWatch returns an aggregated set of statistics for each minute of the previous hour. If you want statistics aggregated into ten-minute blocks, set Period to 600. For statistics aggregated over the entire hour, use a Period value of 3600.</p><p>Periods are also an important part of the CloudWatch alarms feature. When you create an alarm to monitor a specific metric, you are asking CloudWatch to compare that metric to the threshold value that you supplied. You have control over how CloudWatch makes that comparison. You can specify the period over which the comparison is made, as well as how many consecutive periods the threshold must be breached before you are notified.</p><h2 id=aggregation>Aggregation</h2><p>CloudWatch aggregates statistics according a length of time that you set. You can publish as many data points as you want with the same or similar time stamps. CloudWatch aggregates these data points by period length. You can publish data points for a metric that share not only the same time stamp, but also the same namespace and dimensions.</p><p>Subsequent calls to euwatch-get-stats return aggregated statistics about those data points. You can even do this in one euwatch-put-data request. CloudWatch accepts multiple data points in the same euwatch-put-data call with the same time stamp. You can also publish multiple data points for the same or different metrics, with any time stamp. The size of a euwatch-put-data request, however, is limited to 8KB for HTTP GET requests and 40KB for HTTP POST requests. You can include a maximum of 20 data points in one PutMetricData request.</p><p>For large data sets that would make the use of euwatch-put-data impractical, CloudWatch allows you to insert a pre-aggregated data set called a StatisticSet. With StatisticSets you give CloudWatch the Min, Max, Sum, and SampleCount of a number of data points. A common use case for StatisticSets is when you are collecting data many times in a minute. For example, if you have a metric for the request latency of a server, it doesn’t make sense to do a euwatch-put-data request with every request. We suggest you collect the latency of all hits to that server, aggregate them together once a minute and send that StatisticSet to CloudWatch.</p><p>CloudWatch doesn&rsquo;t differentiate the source of a metric. If you publish a metric with the same namespace and dimensions from different sources, CloudWatch treats this as a single metric. This can be useful for service metrics in a distributed, scaled system. For example, all the hosts in a web server application could publish identical metrics representing the latency of requests they are processing. CloudWatch treats these as a single metric, allowing you to get the statistics for minimum, maximum, average, and sum of all requests across your application.</p><h2 id=alarm>Alarm</h2><p>An alarm watches a single metric over a time period you set, and performs one or more actions based on the value of the metric relative to a given threshold over a number of time periods. CloudWatch alarms will not invoke actions just because they are in a particular state. The state must have changed and been maintained for a specified number of periods.</p><p>For example, <a href=https://www.eucastack.io/docs/user_guide/autoscaling_intro/>Auto Scaling</a> works with CloudWatch alarms to perform scaling activities. When an Auto Scaling activity reacts to a CloudWatch alarm, the cooldown period is the amount of time after the activity takes place where further Auto Scaling activity is suspended. This is to allow time for the Auto Scaling activities (such as new instance launches or terminations) to fully complete so that resources are not unnecessarily launched or terminated. You can specify this amount of time; if you don&rsquo;t specify a cooldown period, Auto Scaling uses a default cooldown period of 300 seconds (5 minutes).</p><p>After an alarm invokes an action due to a change in state, the alarm continues to invoke the action for every period that the alarm remains in the new state.</p><p>An alarm has three possible states:</p><ul><li><p>: The metric is within the defined threshold.</p></li><li><p>: The metric is outside of the defined threshold.</p></li><li><p>: The alarm has just started, the metric is not available, or not enough data is available for the metric to determine the alarm state.
The following lists some common features of alarms:</p></li><li><p>You can create up to 5000 alarms per Eucalyptus account. To create or update an alarm, use the command.</p></li><li><p>You can list any or all of the currently configured alarms, and list any alarms in a particular state using the command.</p></li><li><p>You can disable and enable alarms by using the and commands</p></li><li><p>You can test an alarm by setting it to any state using the command. This temporary state change lasts only until the next alarm comparison occurs.</p></li><li><p>Finally, you can view an alarm&rsquo;s history using the command. CloudWatch preserves alarm history for two weeks. Each state transition is marked with a unique time stamp. In rare cases, your history might show more than one notification for a state change. The time stamp enables you to confirm unique state changes.</p></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-3b5b122efee1ace175c6ccba6745c721>3.10.1.2 - Namespaces, Metrics, and Dimensions</h1><h1 id=namespaces-metrics-and-dimensions>Namespaces, Metrics, and Dimensions</h1><p>This section discusses the namespaces, metrics, and dimensions that CloudWatch supports for Eucalyptus services.</p></div><div class=td-content><h1 id=pg-88efa26658a001d560fce3ae313b2d65>3.10.1.2.1 - Namespaces</h1><p>All Eucalyptus services that provide CloudWatch data use a namespace string, beginning with &ldquo;AWS/&rdquo;. This section describes the service namespaces.The following table lists the namespaces for services that push metric data points to CloudWatch.</p><table><thead><tr><th style=text-align:left>Service</th><th style=text-align:left>Namespace</th></tr></thead><tbody><tr><td style=text-align:left>Elastic Block Store</td><td style=text-align:left>AWS/EBS</td></tr><tr><td style=text-align:left>Elastic Compute Cloud</td><td style=text-align:left>AWS/EC2</td></tr><tr><td style=text-align:left>Auto Scaling</td><td style=text-align:left>AWS/Autoscaling</td></tr><tr><td style=text-align:left>Elastic Load Balancing</td><td style=text-align:left>AWS/ELB</td></tr></tbody></table></div><div class=td-content style=page-break-before:always><h1 id=pg-47515a2b2793917872c10fdb522c10da>3.10.1.2.2 - Instance Metrics and Dimensions</h1><p>This section describes the instance metrics and dimensions available to CloudWatch.</p><h2 id=available-metrics-for-instances>Available Metrics for Instances</h2><table><thead><tr><th style=text-align:left>Metric</th><th style=text-align:left>Description</th><th style=text-align:left>Unit</th></tr></thead><tbody><tr><td style=text-align:left>CPUUtilization</td><td style=text-align:left>The percentage of allocated EC2 compute units that are currently in use on the instance. This metric identifies the processing power required to run an application upon a selected instance.</td><td style=text-align:left>Percent</td></tr><tr><td style=text-align:left>DiskReadOps</td><td style=text-align:left>Completed read operations from all ephemeral disks available to the instance (if your instance uses EBS, see EBS Metrics.) This metric identifies the rate at which an application reads a disk. This can be used to determine the speed in which an application reads data from a hard disk.</td><td style=text-align:left>Count</td></tr><tr><td style=text-align:left>DiskWriteOps</td><td style=text-align:left>Completed write operations to all ephemeral disks available to the instance (if your instance uses Amazon EBS, see Amazon EBS Metrics.) This metric identifies the rate at which an application writes to a hard disk. This can be used to determine the speed in which an application saves data to a hard disk.</td><td style=text-align:left>Count</td></tr><tr><td style=text-align:left>DiskReadBytes</td><td style=text-align:left>Bytes read from all ephemeral disks available to the instance (if your instance uses Amazon EBS, see Amazon EBS Metrics.) This metric is used to determine the volume of the data the application reads from the hard disk of the instance. This can be used to determine the speed of the application.</td><td style=text-align:left>Bytes</td></tr><tr><td style=text-align:left>DiskWriteBytes</td><td style=text-align:left>Bytes written to all ephemeral disks available to the instance (if your instance uses Amazon EBS, see Amazon EBS Metrics.) This metric is used to determine the volume of the data the application writes onto the hard disk of the instance. This can be used to determine the speed of the application.</td><td style=text-align:left>Bytes</td></tr><tr><td style=text-align:left>NetworkIn</td><td style=text-align:left>The number of bytes received on all network interfaces by the instance. This metric identifies the volume of incoming network traffic to an application on a single instance.</td><td style=text-align:left>Bytes</td></tr><tr><td style=text-align:left>NetworkOut</td><td style=text-align:left>The number of bytes sent out on all network interfaces by the instance. This metric identifies the volume of outgoing network traffic to an application on a single instance.</td><td style=text-align:left>Bytes</td></tr><tr><td style=text-align:left>StatusCheckFailed</td><td style=text-align:left>A combination of StatusCheckFailed_Instance and StatusCheckFailed_System that reports if either of the status checks has failed. Values for this metric are either 0 (zero) or 1 (one.) A zero indicates that the status check passed. A one indicates a status check failure.</td><td style=text-align:left>Count</td></tr><tr><td style=text-align:left>StatusCheckFailed_Instance</td><td style=text-align:left>Reports whether the instance has passed the EC2 instance status check in the last 5 minutes. Values for this metric are either 0 (zero) or 1 (one.) A zero indicates that the status check passed. A one indicates a status check failure.</td><td style=text-align:left>Count</td></tr><tr><td style=text-align:left>StatusCheckFailed_System</td><td style=text-align:left>Reports whether the instance has passed the EC2 system status check in the last 5 minutes. Values for this metric are either 0 (zero) or 1 (one.) A zero indicates that the status check passed. A one indicates a status check failure.</td><td style=text-align:left>Count</td></tr></tbody></table><h2 id=available-dimensions-for-instances>Available Dimensions for Instances</h2><p>You can filter the instance data using any of the dimensions in the following table.</p><table><thead><tr><th style=text-align:left>Dimension</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left>AutoScalingGroupName</td><td style=text-align:left>This dimension filters the data you request for all instances in a specified capacity group. An AutoScalingGroup is a collection of instances you define if you&rsquo;re using the Auto Scaling service. This dimension is available only for instance metrics when the instances are in such an Auto Scaling group.</td></tr><tr><td style=text-align:left>ImageId</td><td style=text-align:left>This dimension filters the data you request for all instances running this Eucalyptus Machine Image (EMI).</td></tr><tr><td style=text-align:left>InstanceId</td><td style=text-align:left>This dimension filters the data you request for the identified instance only. This helps you pinpoint an exact instance from which to monitor data.</td></tr><tr><td style=text-align:left>InstanceType</td><td style=text-align:left>This dimension filters the data you request for all instances running with this specified instance type. This helps you categorize your data by the type of instance running. For example, you might compare data from an m1.small instance and an m1.large instance to determine which has the better business value for your application.</td></tr></tbody></table></div><div class=td-content style=page-break-before:always><h1 id=pg-efeec537c451e9e7ddb811e740c25c4b>3.10.1.2.3 - EBS Metrics and Dimensions</h1><p>This section describes the Elastic Block Store (EBS) metrics and dimensions available to CloudWatch.</p><h2 id=available-metrics-for-ebs>Available Metrics for EBS</h2><table><thead><tr><th style=text-align:left>Metric</th><th style=text-align:left>Description</th><th style=text-align:left>Unit</th></tr></thead><tbody><tr><td style=text-align:left>VolumeReadBytes</td><td style=text-align:left>The total number of bytes transferred in the period.</td><td style=text-align:left>Bytes</td></tr><tr><td style=text-align:left>VolumeWriteBytes</td><td style=text-align:left>The total number of bytes transferred in the period.</td><td style=text-align:left>Bytes</td></tr><tr><td style=text-align:left>VolumeReadOps</td><td style=text-align:left>The total number of operations in the period.</td><td style=text-align:left>Count</td></tr><tr><td style=text-align:left>VolumeWriteOps</td><td style=text-align:left>The total number of operations in the period.</td><td style=text-align:left>Count</td></tr><tr><td style=text-align:left>VolumeTotalReadTime</td><td style=text-align:left>The total number of seconds spent by all operations that completed in the period. If multiple requests are submitted at the same time, this total could be greater than the length of the period. For example, say the period is 5 minutes (300 seconds); if 700 operations completed during that period, and each operation took 1 second, the value would be 700 seconds.</td><td style=text-align:left>Seconds</td></tr><tr><td style=text-align:left>VolumeTotalWriteTime</td><td style=text-align:left>The total number of seconds spent by all operations that completed in the period. If multiple requests are submitted at the same time, this total could be greater than the length of the period. For example, say the period is 5 minutes (300 seconds); if 700 operations completed during that period, and each operation took 1 second, the value would be 700 seconds.</td><td style=text-align:left>Seconds</td></tr><tr><td style=text-align:left>VolumeIdleTime</td><td style=text-align:left>The total number of seconds in the period when no read or write operations were submitted.</td><td style=text-align:left>Seconds</td></tr><tr><td style=text-align:left>VolumeQueueLength</td><td style=text-align:left>The number of read and write operation requests waiting to be completed in the period.</td><td style=text-align:left>Count</td></tr></tbody></table><h2 id=available-dimensions-for-ebs>Available Dimensions for EBS</h2><p>The only dimension that EBS sends to CloudWatch is the Volume ID. This means that all available statistics are filtered by Volume ID.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-6310ab278a92a17016f53fc8d51fd556>3.10.1.2.4 - Auto Scaling Metrics and Dimensions</h1><p>This section discusses the Auto Scaling metrics and dimensions available to CloudWatch.</p><h2 id=available-metrics-for-auto-scaling>Available Metrics for Auto Scaling</h2><table><thead><tr><th style=text-align:left>Metric</th><th style=text-align:left>Description</th><th style=text-align:left>Unit</th></tr></thead><tbody><tr><td style=text-align:left>GroupMinSize</td><td style=text-align:left>The minimum size of the Auto Scaling group.</td><td style=text-align:left>Count</td></tr><tr><td style=text-align:left>GroupMaxSize</td><td style=text-align:left>The maximum size of the Auto Scaling group.</td><td style=text-align:left>Count</td></tr><tr><td style=text-align:left>GroupDesiredCapacity</td><td style=text-align:left>The number of instances that the Auto Scaling group attempts to maintain.</td><td style=text-align:left>Count</td></tr><tr><td style=text-align:left>GroupInServiceInstances</td><td style=text-align:left>The number of instances that are running as part of the Auto Scaling group. This metric does not include instances that are pending or terminating.</td><td style=text-align:left>Count</td></tr><tr><td style=text-align:left>GroupPendingInstances</td><td style=text-align:left>The number of instances that are pending. A pending instance is not yet in service. This metric does not include instances that are in service or terminating.</td><td style=text-align:left>Count</td></tr><tr><td style=text-align:left>GroupTerminatingInstances</td><td style=text-align:left>The number of instances that are in the process of terminating. This metric does not include instances that are in service or pending.</td><td style=text-align:left>Count</td></tr><tr><td style=text-align:left>GroupTotalInstances</td><td style=text-align:left>The total number of instances in the Auto Scaling group. This metric identifies the number of instances that are in service, pending, and terminating.</td><td style=text-align:left>Count</td></tr></tbody></table><h2 id=available-dimensions-for-auto-scaling>Available Dimensions for Auto Scaling</h2><p>The only dimension that Auto Scaling sends to CloudWatch is the name of the Auto Scaling group. This means that all available statistics are filtered by Auto Scaling group name.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-fcd023d86753d7a388178c89e8d61668>3.10.1.2.5 - ELB Metrics and Dimensions</h1><p>This section discusses the Elastic Load Balancing (ELB) metrics and dimensions available to CloudWatch.</p><h2 id=available-metrics-for-elb>Available Metrics for ELB</h2><table><thead><tr><th style=text-align:left>Metric</th><th style=text-align:left>Description</th><th style=text-align:left>Unit</th></tr></thead><tbody><tr><td style=text-align:left>Latency</td><td style=text-align:left>Time elapsed after the request leaves the load balancer until it receives the corresponding response. Valid Statistics: Minimum</td><td style=text-align:left>Maximum</td></tr><tr><td style=text-align:left>RequestCount</td><td style=text-align:left>The number of requests handled by the load balancer.</td><td style=text-align:left>Count</td></tr><tr><td style=text-align:left>HealthyHostCount</td><td style=text-align:left>The number of healthy instances registered with the load balancer in a specified availability zone. Healthy instances are those that have not failed more health checks than the value of the unhealthy threshold. Constraints: You must provide both LoadBalancerName and AvailabilityZone dimensions for this metric.Valid Statistics: Minimum</td><td style=text-align:left>Maximum</td></tr><tr><td style=text-align:left>UnHealthyHostCount</td><td style=text-align:left>The number of unhealthy instances registered with the load balancer. These are instances that have failed more health checks than the value of the unhealthy threshold. Constraints: You must provide both LoadBalancerName and AvailabilityZone dimensions for this metric.Valid Statistics: Minimum</td><td style=text-align:left>Maximum</td></tr><tr><td style=text-align:left>HTTPCode_ELB_4XX</td><td style=text-align:left>Count of HTTP response codes generated by ELB that are in the 4xx (client error) series. Valid Statistics: Sum</td><td style=text-align:left>Count</td></tr><tr><td style=text-align:left>HTTPCode_ELB_5XX</td><td style=text-align:left>Count of HTTP response codes generated by ELB that are in the 5xx (server error) series. ELB can generate 5xx errors if no back-end instances are registered, no healthy back-end instances, or the request rate exceeds ELB&rsquo;s current available capacity. This response count does not include any responses that were generated by back-end instances. Valid Statistics: Sum</td><td style=text-align:left>Count</td></tr><tr><td style=text-align:left>HTTPCode_Backend_2XX</td><td style=text-align:left>Count of HTTP response codes generated by back-end instances that are in the 2xx (success) series. Valid Statistics: Sum</td><td style=text-align:left>Count</td></tr><tr><td style=text-align:left>HTTPCode_Backend_3XX</td><td style=text-align:left>Count of HTTP response codes generated by back-end instances that are in the 3xx (user action required) series. Valid Statistics: Sum</td><td style=text-align:left>Count</td></tr><tr><td style=text-align:left>HTTPCode_Backend_4XX</td><td style=text-align:left>Count of HTTP response codes generated by back-end instances that are in the 4xx (client error) series. This response count does not include any responses that were generated by ELB. Valid Statistics: Sum</td><td style=text-align:left>Count</td></tr><tr><td style=text-align:left>HTTPCode_Backend_5XX</td><td style=text-align:left>Count of HTTP response codes generated by back-end instances that are in the 5xx (server error) series. This response count does not include any responses that were generated by ELB. Valid Statistics: Sum</td><td style=text-align:left>Count</td></tr></tbody></table><h2 id=available-dimensions-for-elb>Available Dimensions for ELB</h2><p>You can use the currently available dimensions for ELB to refine the metrics returned by a query. For example, you could use <code>HealthyHostCount</code> and dimensions <code>LoadBalancerName</code> and <code>AvailabilityZone</code> to get the average number of healthy instances behind the specified load balancer within the specified Availability Zone for a given period of time.</p><p>You can aggregate ELB data along any of the following dimensions shown in the following table.</p><table><thead><tr><th style=text-align:left>Metric</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left>LoadBalancerName</td><td style=text-align:left>Limits the metric data to instances that are connected to the specified load balancer.</td></tr><tr><td style=text-align:left>AvailabilityZone</td><td style=text-align:left>Limits the metric data to load balancers in the specified availability zone.</td></tr></tbody></table></div><div class=td-content style=page-break-before:always><h1 id=pg-8335412c70063736f4ead3d2c0b2a905>3.10.2 - CloudWatch Tasks</h1><h1 id=cloudwatch-tasks>CloudWatch Tasks</h1><p>This section details the tasks you can perform using CloudWatch.This section expands on the basic concepts presented in the preceding section (see <a href=https://www.eucastack.io/docs/user_guide/using_monitoring/monitoring_oview/>CloudWatch Overview</a> and includes procedures for using CloudWatch. This section also shows you how to view metrics that Eucalyptus services provide to CloudWatch and how to publish custom metrics with CloudWatch.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-510e16c7fba8408b8a3310fa823896df>3.10.2.1 - Configuring Monitoring</h1><h1 id=configuring-monitoring>Configuring Monitoring</h1><p>This section describes how to enable and disable monitoring for your cloud resources.</p></div><div class=td-content><h1 id=pg-09a589afd5cc8a4a8d929168058bb87f>3.10.2.1.1 - Enable Monitoring</h1><p>This section describes steps for enabling monitoring on your cloud resources.To enable monitoring on your resources, following the steps for your resource.</p><h2 id=enable-monitoring-for-an-instance>Enable monitoring for an instance</h2><p>To enable monitoring for a running instance, enter the following command:</p><pre><code>euca-monitor-instances [instance_id]
</code></pre><p>To enable monitoring when you launch an instance, enter the following command:</p><pre><code>euca-run-instances [image_id] -k gsg-keypair --monitor
</code></pre><h2 id=enable-monitoring-for-a-scaling-group>Enable monitoring for a scaling group</h2><p>To enable monitoring for an existing Auto Scaling group: Create a launch configuration with <code>--monitoring-enabled</code> option. Make a euscale-update-auto-scaling-group request to update your Auto Scaling group with the launch configuration you created in the previous step. Auto Scaling will enable monitoring for new instances that it creates. Choose one of the following actions to deal with all existing instances in the Auto Scaling group:</p><table><thead><tr><th style=text-align:left>To . . .</th><th style=text-align:left>Do this . . .</th></tr></thead><tbody><tr><td style=text-align:left>Preserve existing instances</td><td style=text-align:left>Make a euca-monitor-instances request for all existing instances to enable monitoring.</td></tr><tr><td style=text-align:left>Terminate existing instances</td><td style=text-align:left>Make a euscale-terminate-instance-in-auto-scaling-group request for all existing instances. Auto Scaling will use the updated launch configuration to create replacement instances with monitoring enabled.</td></tr></tbody></table><p>To enable monitoring when you create a new Auto Scaling group: Create a launch configuration with <code>--monitoring-enabled</code> option.</p><h2 id=enable-monitoring-for-a-load-balancer>Enable monitoring for a load balancer</h2><p>Elastic Load Balancing (ELB) sends metrics and dimensions for all load balancers to CloudWatch. By default, you do not need to specifically enable monitoring.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>ELB only sends CloudWatch metrics when requests are sent through the load balancer. If there are no requests or data for a given metric, ELB does not report to CloudWatch. If there are requests sent through the load balancer, ELB measures and sends metrics for that load balancer in 60-second intervals.</div></div><div class=td-content style=page-break-before:always><h1 id=pg-507278909208e5e78085e4cb24776f25>3.10.2.1.2 - Disable Monitoring</h1><p>This section describes steps for disabling monitoring on your cloud resources.To disable monitoring on your resources, following the steps for your resource.</p><h2 id=disable-monitoring-for-an-instance>Disable monitoring for an instance</h2><p>To disable monitoring for a running instance, enter the following command:</p><pre><code>euca-unmonitor-instances [instance_id]
</code></pre><h2 id=disable-monitoring-for-a-scaling-group>Disable monitoring for a scaling group</h2><p>To enable monitoring for an existing Auto Scaling group: Create a launch configuration with <code>--monitoring-disabled</code> option. Make a euscale-update-auto-scaling-group request to update your Auto Scaling group with the launch configuration you created in the previous step. Auto Scaling will disable monitoring for new instances that it creates. Choose one of the following actions to deal with all existing instances in the Auto Scaling group:</p><table><thead><tr><th style=text-align:left>To . . .</th><th style=text-align:left>Do this . . .</th></tr></thead><tbody><tr><td style=text-align:left>Preserve existing instances</td><td style=text-align:left>Make a euca-unmonitor-instances request for all existing instances to disable monitoring.</td></tr><tr><td style=text-align:left>Terminate existing instances</td><td style=text-align:left>Make a euscale-terminate-instance-in-auto-scaling-group request for all existing instances. Auto Scaling will use the updated launch configuration to create replacement instances with monitoring disabled.</td></tr></tbody></table><p>To enable monitoring when you create a new Auto Scaling group: Create a launch configuration with <code>--monitoring-disabled</code> option.</p><h2 id=disable-monitoring-for-a-load-balancer>Disable monitoring for a load balancer</h2><p>There is no way to disable monitoring for a load balancer.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-0d91fb6ab60e290d5d3123d4919a2041>3.10.2.2 - Viewing and Publishing Metrics</h1><h1 id=viewing-and-publishing-metrics>Viewing and Publishing Metrics</h1><p>This section describes how to view Eucalyptus metrics as well as how to publish your own metrics.</p></div><div class=td-content><h1 id=pg-31655e3bc3911b43dbbd5461613ac43d>3.10.2.2.1 - List Available Metrics</h1><p>You can list available metrics via Euca2ools.<strong>To list available metrics:</strong></p><p>Enter the following command.</p><pre><code>euwatch-list-metrics
</code></pre><p>Eucalyptus returns a listing of all metrics, as shown in the following partial example output:</p><pre><code>Metric Name         Namespace  Dimensions
CPUUtilization      AWS/EC2    {InstanceId=i-5431413d}
CPUUtilization      AWS/EC2    {InstanceType=m1.medium}
DiskReadBytes       AWS/EC2    {InstanceId=i-1d3d4d74}
DiskReadBytes       AWS/EC2    {InstanceType=m1.medium}
DiskReadOps         AWS/EC2    {InstanceId=i-d3c8baba}
DiskReadOps         AWS/EC2    {InstanceType=m1.medium}
DiskWriteBytes      AWS/EC2    {InstanceId=i-6732420e}	
DiskWriteBytes      AWS/EC2    {InstanceType=m1.medium}
DiskWriteOps        AWS/EC2    {InstanceId=i-e03d4d89}
DiskWriteOps        AWS/EC2    {InstanceType=m1.medium}
NetworkIn           AWS/EC2    {InstanceId=i-e0304089}
NetworkIn           AWS/EC2    {InstanceType=m1.medium}
NetworkOut          AWS/EC2    {InstanceId=i-69334300}
NetworkOut          AWS/EC2    {InstanceType=m1.medium}
StatusCheckFailed		 AWS/EC2 {InstanceId=i-6f8418e6}
StatusCheckFailed      	  AWS/EC2 {InstanceType=m1.medium}
StatusCheckFailed_Instance      AWS/EC2 {InstanceId=i-6f8418e6}
StatusCheckFailed_Instance      AWS/EC2 {InstanceType=m1.medium}
StatusCheckFailed_System        AWS/EC2 {InstanceId=i-6f8418e6}
StatusCheckFailed_System        AWS/EC2 {InstanceType=m1.medium}
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-4a58c6e031aaa184531b2d009b2ee36a>3.10.2.2.2 - Get Statistics for a Metric</h1><p>You can get statistics for metrics via Euca2ools.<strong>To get statistics for a metric:</strong></p><p>Enter the following command.</p><pre><code> euwatch-get-stats -n NAMESPACE -s STAT1,STAT2,...
            			[--dimensions KEY1=VALUE1,KEY2=VALUE2,...]
            			[--start-time YYYY-MM-DDThh:mm:ssZ]
            			[--end-time YYYY-MM-DDThh:mm:ssZ] [--period SECONDS]
            			[--unit UNIT] [--show-empty-fields] [-U URL]
            			[--region USER@REGION] [-I KEY_ID] [-S KEY]
            			[--security-token TOKEN] [--debug] [--debugger]
            			[--version] [-h]
            			METRIC
</code></pre><p>The following example returns the average CPU utilization for the i-c08804a9 instance at one hour resolution.</p><pre><code>euwatch-get-stats --namespace &quot;AWS/EC2&quot; --statistics &quot;Average&quot; \
--dimensions &quot;InstanceId=i-c08804a9&quot; --start-time 2016-12-14T23:00:00.000Z \
--end-time 2016-12-15T23:00:00.000Z --period 3600  CPUUtilization
</code></pre><p>The following example returns CPU utilization for all of your cloud&rsquo;s instances.</p><pre><code>euwatch-get-stats --namespace &quot;AWS/EC2&quot; --statistics &quot;Average,Minimum,Maximum&quot; \
--start-time 2016-02-14T23:00:00.000Z --end-time 2016-03-14T23:00:00.000Z \
--period 3600 CPUUtilization
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-c0f64dfbb19c23bdb97ba7dd7a1ec5dc>3.10.2.2.3 - Publish Custom Metrics</h1><p>CloudWatch allows you to publish your own metrics, such as application performance, system health, or customer usage.</p><h2 id=publish-a-single-data-point>Publish a single data point</h2><p>To publish a single data point for a new or existing metric, call euwatch-put-data with one value and time stamp. For example, the following actions each publish one data point:</p><pre><code>euwatch-put-data --metric-name PageViewCount --namespace &quot;TestService&quot; --value 2 --timestamp 2011-03-14T12:00:00.000Z
euwatch-put-data --metric-name PageViewCount --namespace &quot;TestService&quot; --value 4 --timestamp 2011-03-14T12:00:01.000Z
euwatch-put-data --metric-name PageViewCount --namespace &quot;TestService&quot; --value 5 --timestamp 2011-03-14T12:00:02.000Z
</code></pre><p>You can publish data points with time stamps as granular as one-thousandth of a second. However, CloudWatch aggregates the data to a minimum granularity of 60 seconds. For example, the <code>PageViewCount</code> metric from the previous examples contains three data points with time stamps just seconds apart. CloudWatch aggregates the three data points because they all have time stamps within a 60-second period.</p><p>CloudWatch uses 60-second boundaries when aggregating data points. For example, CloudWatch aggregates the data points from the previous example because all three data points fall within the 60-second period that begins at 2011-03-14T12:00:00.000Z and ends at 2011-03-14T12:00:59.999Z.</p><h2 id=publish-statistic-sets>Publish statistic sets</h2><p>You can also aggregate your data before you publish to CloudWatch. When you have multiple data points per minute, aggregating data minimizes the number of calls to euwatch-put-data . For example, instead of calling euwatch-put-data multiple times for three data points that are within three seconds of each other, you can aggregate the data into a statistic set that you publish with one call:</p><pre><code>euwatch-put-data --metric-name PageViewCount --namespace &quot;TestService&quot; -s &quot;Sum=11,Minimum=2,Maximum=5,SampleCount=3&quot; --timestamp 2011-03-14T12:00:00.000
</code></pre><h2 id=publish-the-value-zero>Publish the value zero</h2><p>When your data is more sporadic and you have periods that have no associated data, you can choose to publish the value zero (0) for that period or no value at all. You might want to publish zero instead of no value if you use periodic calls to PutMetricData to monitor the health of your application. For example, you can set an Amazon CloudWatch alarm to notify you if your application fails to publish metrics every five minutes. You want such an application to publish zeros for periods with no associated data.</p><p>You might also publish zeros if you want to track the total number of data points or if you want statistics such as minimum and average to include data points with the value 0.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-a6b482304590bdee0ed027c6050cf792>3.10.2.2.4 - Modify Metric Polling Timing</h1><p>You can modify metrics timing and reporting defaults.When using the default CloudWatch properties, metrics reporting can take around 15 minutes:</p><ol><li>5 minutes to receive a sensor data point for an instance.</li><li>5 more minutes to receive a second sensor data point for an instance.</li><li>1 more minute to calculate the difference between these two and send a single data point to CloudWatch.</li><li>1 more minute for CloudWatch to put the data in the database, making it available for a call.</li><li>5 more minutes for info to be available in the database.</li></ol><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>The above workflow is sequential and cumulative.</div><p>The sensor data point timing values can be shortened by changing variables in the CLC.</p><p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>These changes will increase network traffic as polling will be done more frequently.</div><strong>To modify metrics defaults:</strong></p><p>Modify the default polling interval CLC variable to a number less than 5.</p><pre><code>cloud.monitor.default_poll_interval_mins
</code></pre><p>This is how often the CLC sends a request to the CC for sensor data. Default value is 5 minutes. Modify the history size CLC variable to a number less than 5.</p><pre><code>cloud.monitor.history_size
</code></pre><p>This is how many data value samples are sent in each sensor data request. The default value is 5. The frequency requests is either 1 minute (if the <code>cloud.monitor.default_poll_interval_mins</code> is 1 minute) or half the value of <code>cloud.monitor.default_poll_interval_mins</code> if that value is greater). So by default, with a <code>cloud.monitor.default_poll_interval_mins</code> of 5 minutes and <code>cloud.monitor.history_size</code> size of 5, every 5 minutes the CLC asks for the last 5 data points from the CC, which should be timed for every 2.5 minutes (e.g., 2.5 minutes ago, 5 minutes ago, 7.5 minutes ago, and 10 minutes ago).<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>These values may be skewed a bit based on the time the CC uses.</div></p></div><div class=td-content style=page-break-before:always><h1 id=pg-4ffb6602b363163032c20bc9576ac0ca>3.10.2.3 - Configuring Alarms</h1><h1 id=configuring-alarms>Configuring Alarms</h1><p>This section describes how to create, test, and delete and alarm.</p></div><div class=td-content><h1 id=pg-b324598b5d78202fe7038ed12b933f84>3.10.2.3.1 - Create an Alarm</h1><p>You can create a CloudWatch alarm using a resource&rsquo;s metric, and then add an action using the action’s dedicated Amazon Resource Name (ARN). You can add the action to any alarm state.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Eucalyptus currently only supports actions for executing Auto Scaling policies.</div>To create an alarm, perform the following step.</p><p>Enter the following command:</p><pre><code>euwatch-put-metric-alarm [alarm_name] --unit Percent --namespace &quot;AWS/EC2&quot; 
-- dimensions &quot;InstanceId=[instance_id]&quot; --statistic [statistic] --metric-name	
[metric] --comparison-operator [operator] --threshold [value] --period	
[seconds] --evaluation-periods [value] -- alarm-actions [action]
</code></pre><p>For example, the following triggers an Auto Scaling policy if the average CPUUtilization is less than 10 percent over a 24 hour period.</p><pre><code>euwatch-put-metric-alarm test-Alarm --unit Percent --namespace &quot;AWS/EC2&quot; 
-- dimensions &quot;InstanceId=i-abc123&quot; --statistic Average --metric-name CPUUtilization 
--comparison-operator LessThanThreshold --threshold 10 --period 86400 
--evaluation-periods 4 -- alarm-actions arn:aws:autoscaling::429942273585:scalingPolicy:
12ad560b-58b2-4051-a6d3-80e53b674de4:autoScalingGroupName/testgroup01:
policyName/testgroup01-pol01
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-4505c07adc12e8c41df5e2928668541d>3.10.2.3.2 - Test an Alarm</h1><p>You can test the CloudWatch alarms by temporarily changing the state of your alarm to &ldquo;ALARM&rdquo; using the command: euwatch-set-alarm-state .</p><pre><code>euwatch-set-alarm-state --alarm-name TestAlarm --state ALARM
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-5953f3e5b73a1493608731018d21703d>3.10.2.3.3 - Delete an Alarm</h1><p>To delete an alarm, perform the following step.</p><p>Enter the following command:</p><pre><code>euwatch-delete-alarms [alarm_name]
</code></pre><p>For example, to delete an alarm named <code>TestAlarm</code> enter:</p><pre><code>euwatch-delete-alarms TestAlarm
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-88e53ce2fba838d96249ddad99d4cbf9>3.11 - Using Object Storage</h1><h1 id=using-object-storage>Using Object Storage</h1><p>Scalable object storage is composed of two parts: the object storage gateway and the object storage backend. This section explains storage and how to access it.The object storage gateway (OSG) receives user requests and authorizes these requests using the Eucalyptus identity services. For more information about identity services, see <a href=https://www.eucastack.io/docs/user_guide/using_access/>Managing Access</a> .</p></div><div class=td-content style=page-break-before:always><h1 id=pg-28970e2b1f6059613beb141748479142>3.11.1 - Access Object Storage</h1><p>You can use your favorite S3 client (for example, ) to interact with Eucalyptus.To access object storage:</p><p>Replace your S3_URL with the IP address of the OSG you wish to interact with and the service path with <code>/services/objectstorage</code> instead of <code>/services/Walrus</code> . For example:</p><pre><code>S3_URL = http://&lt;OSG IP&gt;:8773/services/objectstorage
</code></pre><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If you have DNS enabled, you may use the &ldquo;objectstorage&rdquo; prefix to access your object storage. Eucalyptus will return a list of IPs that correspond to OSGs that are in the state.</div></div><div class=td-content style=page-break-before:always><h1 id=pg-02cba64fa23838de5af5870774334303>3.12 - Using Route53</h1><h1 id=using-route53>Using Route53</h1><p>Eucalyptus Route53 is an integrated Domain Name System (DNS) web service. Route53 allows end users to access your cloud resources using names that you control.</p><p>Route53 seamlessly connects user requests to Eucalyptus controlled infrastructure – including EC2 instances, Elastic Load Balancers, and S3 buckets – it can also be used to route users to external infrastructure.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Route53 is a tech preview service so should be used accordingly.</div></div><div class=td-content style=page-break-before:always><h1 id=pg-99545870fdb7b8ece45ca25e77436db3>3.12.1 - Route53 Concepts</h1><p>This section describes the important concepts for the Route53 service and for Domain Name System (DNS)</p><h3 id=public-and-private-hosted-zones>Public and Private Hosted Zones</h3><p>A public hosted zone describes how to route traffic for a public domain, such as <strong>example.com</strong>, and its subdomains. Information in a public hosted zone is available to anyone that can connect to your Eucalyptus deployment.</p><p>A private hosted zone describes how to route traffic for a domain and its subdomains within a VPC managed using Eucalyptus EC2 VPC service. Private zones are useful for repeatable deployments using well-known names.</p><h3 id=resource-record-sets>Resource Record Sets</h3><p>After you create a hosted zone for your domain, such as <strong>example.com</strong>, you create resource record sets to tell the Domain Name System (DNS) how to route traffic for that domain.</p><p>For example you would create an <strong>A</strong> record to map the name <strong>resource.example.com</strong> to the public IP address of an EC2 instance.</p><h2 id=dns-concepts>DNS Concepts</h2><p>Important concepts related to underlying DNS functionality are:</p><ul><li><strong>Alias</strong> : An alias connects a name to a cloud resource such as an Elastic Load Balancer</li><li><strong>CName</strong> : A <em>CNAME</em> resource record redirects to another name. <em>CNAMES</em> are often used with S3 buckets.</li><li><strong>IP Address</strong> : An <em>A</em> resource record maps a name to an IP address used to access a resource such as an EC2 instance.</li><li><strong>TTL</strong> : The Time To Live (TTL) of a resource record is important for controlling how long clients can cache DNS information.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-f146d3642318659063bc98995e4793ad>3.12.2 - Route53 Usage</h1><p>This section describes some options for access to the Route53 service and shows some example usage.</p><h2 id=using-the-aws-cli>Using the AWS CLI</h2><p>The AWS CLI can be used to access Route53. Use of the Eucalyptus AWS CLI plug-in is assumed in these examples.</p><p>To list hosted zones:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># aws route53 list-hosted-zones</span>
</span></span><span style=display:flex><span>HOSTEDZONES	e001e659-32ac-4fd5-b45a-f7e6d6420f9b	/hostedzone/ZAAW4ODX2K7WOL	subdomain.example.com.	<span style=color:#0000cf;font-weight:700>3</span>
</span></span><span style=display:flex><span>CONFIG	Private zone <span style=color:#204a87;font-weight:700>for</span> subdomain.example.com in vpc-837bc081de161f8c0	True
</span></span></code></pre></div><p>To list resource records for a hosted zone:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># aws route53 list-resource-record-sets --hosted-zone-id ZAAW4ODX2K7WOL</span>
</span></span><span style=display:flex><span>RESOURCERECORDSETS	alias.subdomain.example.com.	0	A
</span></span><span style=display:flex><span>RESOURCERECORDSETS	cname.subdomain.example.com.	300	CNAME
</span></span><span style=display:flex><span>RESOURCERECORDS	name.subdomain.example.com
</span></span><span style=display:flex><span>RESOURCERECORDSETS	name.subdomain.example.com.	300	A
</span></span><span style=display:flex><span>RESOURCERECORDS	10.20.30.43
</span></span></code></pre></div><p>The AWS CLI can be used to create and delete hosted zones and to change resource record sets.</p><h2 id=using-cloudformation>Using CloudFormation</h2><p>A CloudFormation template can be used to manage Route53 resources. The following template is an example showing the:</p><ul><li><em>AWS::Route53::HostedZone</em></li><li><em>AWS::Route53::RecordSet</em></li><li><em>AWS::Route53::RecordSetGroup</em></li></ul><p>CloudFormation resources:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>AWSTemplateFormatVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>2010-09-09</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Description</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>&gt;-</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>  </span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#000>Route53 private HostedZone</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Parameters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Vpc</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Description</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>The VPC to create the Zone for</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>String</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Zone</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Description</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>The zone to create</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>String</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Default</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example.com</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Resources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>MyHostedZone</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AWS::Route53::HostedZone</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Properties</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>!<span style=color:#000>Ref Zone</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>HostedZoneConfig</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>Comment</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>!<span style=color:#000>Sub &#34;Private zone for ${Zone} in ${Vpc}&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>VPCs</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>VPCId</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>!<span style=color:#000>Ref Vpc</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>VPCRegion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>!<span style=color:#000>Ref AWS::Region</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>HostedZoneTags</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>Key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>example-tag</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>Value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>!<span style=color:#000>Ref Zone</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>MyRecordSet</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AWS::Route53::RecordSet</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>DependsOn</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>MyHostedZone</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Properties</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>HostedZoneName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>!<span style=color:#000>Ref Zone</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>!<span style=color:#000>Sub &#34;name.${Zone}&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>ResourceRecords</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#4e9a06>&#34;10.20.30.43&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>TTL</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>300</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>A</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>MyRecordSetGroup</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AWS::Route53::RecordSetGroup</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>DependsOn</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>MyHostedZone</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Properties</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>HostedZoneName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>!<span style=color:#000>Ref Zone</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>RecordSets</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>!<span style=color:#000>Sub &#34;cname.${Zone}&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>ResourceRecords</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span>- !<span style=color:#000>Sub &#34;name.${Zone}&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>TTL</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>300</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>CNAME</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>Name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>!<span style=color:#000>Sub &#34;alias.${Zone}&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>A</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>AliasTarget</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>DNSName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>!<span style=color:#000>Sub &#34;name.${Zone}&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>EvaluateTargetHealth</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>no</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>HostedZoneId</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>!<span style=color:#000>Ref MyHostedZone</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Outputs</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>HostedZoneId</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Description</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>The identifier for the private hosted zone</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>!<span style=color:#000>Ref MyHostedZone</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The output for the stack will show the identifier for the hosted zone.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-1b5e6b30624788fc3ce78b0d4f182d8c>3.12.3 - Route53 Delegated Subdomain</h1><p>When using Route53 the Hosted Zone is often a subdomain for a domain managed using external DNS. In this case the external DNS must be updated to delegate management of the subdomain to your
hosted zones name servers.</p><h2 id=hosted-zone-name-servers>Hosted Zone Name Servers</h2><p>When you create a public Hosted Zone in Eucalyptus it will be allocated some nameservers. You can use the AWS CLI to determine the Name Servers for your zone:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># aws route53 list-hosted-zones</span>
</span></span><span style=display:flex><span>HOSTEDZONES	87a20e2b-f835-4775-a6ad-16f14033668a	/hostedzone/ZAAKJGJPMUHV32	subdomain.example.com.	<span style=color:#0000cf;font-weight:700>2</span>
</span></span><span style=display:flex><span>CONFIG	False
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># aws route53 list-resource-record-sets --hosted-zone-id ZAAKJGJPMUHV32 --query &#34;ResourceRecordSets[?Type == &#39;NS&#39;]&#34;</span>
</span></span><span style=display:flex><span>subdomain.example.com.	900	NS
</span></span><span style=display:flex><span>RESOURCERECORDS	ns1.mycloud.example.com.
</span></span></code></pre></div><p>To discover the nameservers, first list the hosted zone to find the identifer and then pass the identifer to <em>list-resource-record-sets</em>. The example above uses a query to output only the <em>NS</em> information.</p><h2 id=external-name-server-records>External Name Server records</h2><p>The external DNS should be updated to add a Name Server <em>NS</em> record and a corresponding <em>A</em> record to map that name to an IP address:</p><pre tabindex=0><code>subdomain.example.com	    NS	ns1.mycloud.example.com.
ns1.mycloud.example.com	A	1.X.Y.123
</code></pre><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>The external DNS must not have an SOA record for the delegated subdomain as your Hosted Zone in Eucalyptus Route53 is authoritative.</div></div><div class=td-content style=page-break-before:always><h1 id=pg-f6982d0753d21dc2259ad3af26fbdd7f>3.13 - Using Simple Queue Service</h1><h1 id=using-simple-queue-service>Using Simple Queue Service</h1><p>Eucalyptus Simple Queue Service (SQS) is a message queuing service that enables you to decouple your services and distributed systems.</p><p>SQS reduces the overhead of managing and operating message oriented middleware and facilitates robust cloud architectures when used with other services such as Auto Scaling.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Simple Queue Service (SQS) is a tech preview service so should be used accordingly.</div></div><div class=td-content style=page-break-before:always><h1 id=pg-a945a3681424452a865a77f09ee6c361>3.13.1 - Simple Queue Service Concepts</h1><p>This section describes the important concepts for the Simple Queue Service (SQS)</p><h3 id=queues-and-queue-urls>Queues and Queue URLs</h3><p>A queue is a named destination for messages in an account. A queue has a URL that uniquely identifies it on the cloud.</p><h3 id=delivery-and-visiblity>Delivery and Visiblity</h3><p>When a message is delivered to a client it is hidden from other clients for a period to prevent duplicate handling. If the message is not handled by the first client it will later become visible for handling by other clients.</p><h3 id=dead-letter-queues>Dead-letter Queues</h3><p>A dead-letter queue can be used for undeliverable messages. Using a dead-letter queue allows for handling of messages that would otherwise not be processed.</p><h3 id=delay-queue>Delay Queue</h3><p>A delay queue allows messages to be available from a queue after a delay period rather than as soon as messages are sent to the queue.</p><h3 id=polling-style>Polling Style</h3><p>Short or long polling can be used when receiving messages. For short polling there is an immediate response whether a message is available or not. For long polling a delay of up to 20 seconds is used and the response will occur when a message is available or when the given timeout is reached even if there is no message.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-4695109097ddeeb95b11f0f914f20676>3.13.2 - Simple Queue Service Overview</h1><h2 id=using-the-aws-cli>Using the AWS CLI</h2><p>The AWS CLI can be used to access the Simple Queue Service (SQS). Use of the Eucalyptus AWS CLI plug-in is assumed in these examples.</p><p>To list queues:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># aws sqs list-queues</span>
</span></span><span style=display:flex><span>QUEUEURLS	http://sqs.mycloud.example.com:8773/000575948401/queue1
</span></span><span style=display:flex><span>QUEUEURLS	http://sqs.mycloud.example.com:8773/000575948401/sqs-1-DeadLetterQueue-N7AHZIWZEW3H5
</span></span></code></pre></div><p>Send a message:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># aws sqs send-message --queue-url http://sqs.mycloud.example.com:8773/000575948401/queue1 --message-body &#34;TEST MESSAGE&#34;</span>
</span></span><span style=display:flex><span>d41d8cd98f00b204e9800998ecf8427e	2b3ce69548da118bf617bfdd33a06108	daedefab-669b-47a4-a801-8b84e747c11c
</span></span></code></pre></div><p>Receive a messge:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># aws sqs receive-message --queue-url http://sqs.mycloud.example.com:8773/000575948401/queue1</span>
</span></span><span style=display:flex><span>MESSAGES	TEST MESSAGE	2b3ce69548da118bf617bfdd33a06108	d41d8cd98f00b204e9800998ecf8427e	9cc9bc8c-c201-4a27-9f7f-94924a79968a	000575948401:queue1:9cc9bc8c-c201-4a27-9f7f-94924a79968a:3
</span></span></code></pre></div><h2 id=using-cloudformation>Using CloudFormation</h2><p>A CloudFormation template can be used to manage SQS resources. The following template is an example showing the:</p><ul><li><em>AWS::SQS::Queue</em></li><li><em>AWS::SQS::QueuePolicy</em></li></ul><p>CloudFormation resources:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>AWSTemplateFormatVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>2010-09-09</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Description</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>&gt;-</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>  SQS queue and queue policy template
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>  </span><span style=color:#f8f8f8;text-decoration:underline>  
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Resources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>Queue</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AWS::SQS::Queue</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Properties</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>RedrivePolicy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>deadLetterTargetArn</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>!<span style=color:#000>GetAtt &#39;DeadLetterQueue.Arn&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>maxReceiveCount</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>DelaySeconds</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;10&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>MaximumMessageSize</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;65536&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>MessageRetentionPeriod</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;1209600&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>VisibilityTimeout</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;20&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>ReceiveMessageWaitTimeSeconds</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;5&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>QueueName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>queue1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>DeadLetterQueue</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AWS::SQS::Queue</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>QueuePolicy</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AWS::SQS::QueuePolicy</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Properties</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>PolicyDocument</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>Statement</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>Action</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>sqs:*</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>Principal</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>AWS</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>!<span style=color:#000>Ref &#39;AWS::AccountId&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>Effect</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Allow</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>Queues</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- !<span style=color:#000>Ref Queue</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- !<span style=color:#000>Ref DeadLetterQueue</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Outputs</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>QueueURL</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Description</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>URL of the queue</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>!<span style=color:#000>Ref &#39;Queue&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>QueueARN</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Description</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ARN of the queue</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>!<span style=color:#000>GetAtt &#39;Queue.Arn&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>DeadLetterQueueURL</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Description</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>URL of the dead letter queue</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>!<span style=color:#000>Ref &#39;DeadLetterQueue&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>DeadLetterQueueARN</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Description</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>ARN of the dead letter queue</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>!<span style=color:#000>GetAtt &#39;DeadLetterQueue.Arn&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>The output for the stack will show the URLs and ARNs for the created queue resources.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-c590edd3b622a7fa8a549679149755fd>3.14 - Using CloudFormation</h1><p>This topic describes the Eucalyptus implementation of the AWS CloudFormation web service, how CloudFormation works, and some details and examples of how to add CloudFormation to your Eucalyptus deployment.</p><h2 id=why-use-cloudformation>Why use CloudFormation?</h2><p>Cloud computing allows for application repeatability and redundancy. This means that you can spin up as many virtual machines as you need, but the application configuration only needs to happen when the images are created. CloudFormation takes this concept to the next level: it allows you to configure an entire set of resources (instances, security groups, user roles and policies, and more) in a single template. Then you can create a stack of all those resources from the template using a single command. So, you don&rsquo;t just get machine repeatability, you get environment repeatability. CloudFormation allows you to clone environments in different cloud setups, as well as giving applications the ability to be set up and torn down in a repeatable manner.</p><h2 id=how-does-cloudformation-work>How does CloudFormation Work?</h2><p>CloudFormation manages a set of resources, called a stack, in batch operations (create, update, or delete). Stacks are described in templates, which can be simple, as the following example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>Resources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>MyInstance</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AWS::EC2::Instance</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Properties</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>ImageId</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>emi-371ada125a928669e</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>This stack creates a single instance, based on the image with ID <code>emi-371ada125a928669e</code>. However, this stack is not portable because different clouds might have different image IDs.</p><p>CloudFormation allows stack customization through user parameters that are passed in at stack creation time. The following is an example of the template above with a user parameter called <em>MyImageId</em>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>Parameters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>MyImageId</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Description</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Image id</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>String</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Resources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>MyInstance</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AWS::EC2::Instance</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Properties</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>ImageId</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>!<span style=color:#000>Ref MyImageId</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>This stack creates a single instance, but the image ID will be required to be passed in using the command line. For example, the following example uses the <em>euform-create-stack</em> command in Euca2ools:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>euform-create-stack --template-file template.yaml -p <span style=color:#000>MyImageId</span><span style=color:#ce5c00;font-weight:700>=</span>emi-371ada125a928669e MyStack
</span></span></code></pre></div><p>or using the AWS CLI:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aws cloudformation create-stack --template-body file://template.yaml --parameters <span style=color:#000>ParameterKey</span><span style=color:#ce5c00;font-weight:700>=</span>MyImageId,ParameterValue<span style=color:#ce5c00;font-weight:700>=</span>emi-371ada125a928669e --stack-name MyStack
</span></span></code></pre></div><p>These example commands pass the parameter <em>MyImageId</em> with value <code>emi-371ada125a928669e</code> into the stack creation process.</p><p>You can also use templates to create multiple resources and associate them with each other. For example, the following template creates an instance with its own security group and ingress rule.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>Parameters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>MyImageId</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Description</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Image id</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>String</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Resources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>MySecurityGroup</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AWS::EC2::SecurityGroup</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Properties</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>GroupDescription</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Security Group with Ingress Rule for MyInstance</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>SecurityGroupIngress</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>IpProtocol</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>tcp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>FromPort</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;22&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>ToPort</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;22&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>CidrIp</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;0.0.0.0/0&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>MyInstance</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AWS::EC2::Instance</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Properties</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>ImageId</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>!<span style=color:#000>Ref &#39;MyImageId&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>SecurityGroups</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- !<span style=color:#000>Ref &#39;MySecurityGroup&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Templates can be more complicated than the ones shown above, but CloudFormation allows many resources to be deployed in one operation. Resources from most Eucalyptus services are supported.</p><h2 id=cloudformation-requirements>CloudFormation Requirements</h2><p>To run CloudFormation on Eucalyptus, you need the following:</p><ul><li>A running Eucalyptus cloud, version 4.0 or later, with at least one Cloud Controller, Node Controller, and Cluster Controller up, running and registered</li><li>At least one active running service of each of the following: CloudWatch, AutoScaling, Load Balancing, Compute, and IAM</li><li>A registered active CloudFormation service</li></ul><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Eucalyptus versions earlier than 5 support JSON CloudFormation templates but not the newer YAML format</div><h2 id=supported-resources>Supported Resources</h2><p>The following resources are supported by CloudFormation in Eucalyptus.</p><table><thead><tr><th style=text-align:left>Resource</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left>AWS::AutoScaling::AutoScalingGroup</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported except: HealthCheckType.</td></tr><tr><td style=text-align:left>AWS::AutoScaling::LaunchConfiguration</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported except AssociatePublicIpAddress.</td></tr><tr><td style=text-align:left>AWS::AutoScaling::ScalingPolicy</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::CloudFormation::Stack</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::CloudFormation::WaitCondition</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::CloudFormation::WaitConditionHandle.</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::CloudWatch::Alarm</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::EC2::CustomerGateway</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::EC2::DHCPOptions</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::EC2::EIP</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::EC2::EIPAssociation</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported except: PrivateIpAddress.</td></tr><tr><td style=text-align:left>AWS::EC2::Instance</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported except: SourceDestCheck, Tags, and Tenancy.</td></tr><tr><td style=text-align:left>AWS::EC2::InternetGateway</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::EC2::LaunchTemplate</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::EC2::NatGateway</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::EC2::NetworkAcl</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::EC2::NetworkAclEntry</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::EC2::NetworkInterface</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::EC2::NetworkInterfaceAttachment</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::EC2::Route</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::EC2::RouteTable</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::EC2::SecurityGroup</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::EC2::SecurityGroupEgress</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::EC2::SecurityGroupIngress</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported except SourceSecurityGroupId.</td></tr><tr><td style=text-align:left>AWS::EC2::Subnet</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::EC2::SubnetNetworkAclAssociation</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::EC2::SubnetRouteTableAssociation</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::EC2::Volume</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported except: HealthCheckType and Tags.</td></tr><tr><td style=text-align:left>AWS::EC2::VolumeAttachment</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::EC2::VPC</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::EC2::VPCDHCPOptionsAssociation</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::EC2::VPCGatewayAttachment</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::ElasticLoadBalancing::LoadBalancer</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported except: AccessLoggingPolicy, ConnectionDrainingPolicy, CrossZone, Policies.InstancePorts, and Policies.LoadBalanerPorts. All other properties are passed through to the LoadBalancing service internally but some features are not implemented so properties may be ignored there.</td></tr><tr><td style=text-align:left>AWS::IAM::AccessKey</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported except Serial.</td></tr><tr><td style=text-align:left>AWS::IAM::Group</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::IAM::InstanceProfile</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::IAM::ManagedPolicy</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::IAM::Policy</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::IAM::Role</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::IAM::User</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::IAM::UserToGroupAddition</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::Route53::HostedZone</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::Route53::RecordSet</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::Route53::RecordSetGroup</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::S3::Bucket</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::S3::BucketPolicy</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::SQS::Queue</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr><tr><td style=text-align:left>AWS::SQS::QueuePolicy</td><td style=text-align:left>All properties in the Template Reference section of the AWS CloudFormation User Guide are supported.</td></tr></tbody></table><h2 id=cloudformation-endpoint>CloudFormation Endpoint</h2><p>The service endpoint for CloudFormation is of the form:</p><pre tabindex=0><code>http://cloudformation.mycloud.example.com:8773/
</code></pre><p>If DNS is not availble for your cloud, then an endpoint with a service path can be used:</p><pre tabindex=0><code>http://&lt;host-ip&gt;:8773/services/CloudFormation
</code></pre><p>CloudFormation follows the same convention as the other user facing services.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-16f6676bbc04702c9aa113b96e8208bb>3.14.1 - CloudFormation Use Case</h1><p>This topic describes a use case for creating a stack, checking the stack progress, and deleting the stack. For this use case, we will use the following template:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>Parameters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>MyImageId</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Description</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Image id</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>String</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>MyKeyPair</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Description</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Key Pair</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>String</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>Resources</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>MySecurityGroup</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AWS::EC2::SecurityGroup</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Properties</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>GroupDescription</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Security Group with Ingress Rule for MyInstance</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>SecurityGroupIngress</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>IpProtocol</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>tcp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>FromPort</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;22&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>ToPort</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;22&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>CidrIp</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;0.0.0.0/0&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>MyInstance</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Type</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>AWS::EC2::Instance</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>Properties</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>ImageId</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>!<span style=color:#000>Ref &#39;MyImageId&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>SecurityGroups</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- !<span style=color:#000>Ref &#39;MySecurityGroup&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>KeyName</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span>!<span style=color:#000>Ref &#39;MyKeyPair&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>This template creates an instance with a security group that allows global SSH access (port 22), but uses a keypair to log in. It requires two parameters, <em>MyImageId</em> , which is the image ID of the instance to create, and <em>MyKeyPair</em> , which is the name of the keypair to use to log in with. You could use both values with the <em>euca-run-instances</em> or <em>aws ec2 run-instances</em> commands to create an instance manually (for example, <code>euca-run-instances -k mykey emi-371ada125a928669e</code> ) so the arguments needed here are standard instance arguments.</p><p>The steps to run this template through the system are explained in the following steps.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>These steps require that you have an available image and that the CloudFormation service is running</div><p>Verify connectivity to the CloudFormation service.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>euform-describe-stacks 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Or</span>
</span></span><span style=display:flex><span>aws cloudformation describe-stacks
</span></span></code></pre></div><p>You should not see anything returned, including any errors. Create a file called <em>ex_template.yaml</em> that contains the YAML template content shown in the introduction above.</p><p>Create a keypair.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>euca-create-keypair myKey &gt; myKey.pem
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Or</span>
</span></span><span style=display:flex><span>aws ec2 create-key-pair --key-name myKey &gt; myKey.pem
</span></span></code></pre></div><p>Set the permissions on the keypair.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>chmod <span style=color:#0000cf;font-weight:700>0600</span> myKey.pem
</span></span></code></pre></div><p>Find what resources have been created., run the command and the euca-describe-groups commands. Make note of the output for later. Run:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>euca-describe-images -a
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Or</span>
</span></span><span style=display:flex><span>aws ec2 describe-images
</span></span></code></pre></div><p>Note the output for later use.</p><p>Create the stack referencing the existing resources.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># euform-create-stack --template-file ex_template.yaml -p MyImageId=&lt;image_id&gt; -p MyKeyPair=myKey MyStack</span>
</span></span><span style=display:flex><span>arn:aws:cloudformation::000575948401:stack/MyStack/26daf046-3776-4b97-9444-5edae2f2eceb
</span></span></code></pre></div><p>of with the AWS CLI:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># aws cloudformation create-stack --template-body file://ex_template.yaml --parameters ParameterKey=MyImageId,ParameterValue=emi-371ada125a928669e ParameterKey=MyKeyPair,ParameterValue=myKey --stack-name MyStack</span>
</span></span><span style=display:flex><span>arn:aws:cloudformation::000575948401:stack/MyStack/26daf046-3776-4b97-9444-5edae2f2eceb
</span></span></code></pre></div><p>Run the checks you want on your stack. Check the status of the stack.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># euform-describe-stacks</span>
</span></span><span style=display:flex><span>STACK	MyStack	CREATE_COMPLETE			2020-10-20T18:31:15.662Z
</span></span><span style=display:flex><span>PARAMETER	MyImageId		emi-371ada125a928669e
</span></span><span style=display:flex><span>PARAMETER	MyKeyPair		myKey
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># aws cloudformation describe-stacks</span>
</span></span><span style=display:flex><span>STACKS	2020-10-20T18:31:15.662Z	False	2020-10-20T18:31:51.316Z	arn:aws:cloudformation::000575948401:stack/MyStack/26daf046-3776-4b97-9444-5edae2f2eceb	MyStack	CREATE_COMPLETE	
</span></span><span style=display:flex><span>PARAMETERS	MyImageId	emi-371ada125a928669e
</span></span><span style=display:flex><span>PARAMETERS	MyKeyPair	myKey
</span></span></code></pre></div><p>Check the stack at any time to see all the events that have occurred during the stack lifecycle.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># euform-describe-stack-events MyStack</span>
</span></span><span style=display:flex><span>EVENT	MyStack	d87c4381-b765-4d44-a5ba-a952855ffd79	AWS::CloudFormation::Stack	MyStack	arn:aws:cloudformation::000575948401:stack/MyStack/26daf046-3776-4b97-9444-5edae2f2eceb	2020-10-20T18:31:51.310Z	CREATE_COMPLETE	
</span></span><span style=display:flex><span>EVENT	MyStack	MyInstance-CREATE_COMPLETE-1603218711063	AWS::EC2::Instance	MyInstance	i-687f112f4c99e9a98	2020-10-20T18:31:51.063Z	CREATE_COMPLETE	
</span></span><span style=display:flex><span>EVENT	MyStack	MyInstance-CREATE_IN_PROGRESS-1603218676951	AWS::EC2::Instance	MyInstance	i-687f112f4c99e9a98	2020-10-20T18:31:16.951Z	CREATE_IN_PROGRESS	Resource creation Initiated
</span></span><span style=display:flex><span>EVENT	MyStack	MyInstance-CREATE_IN_PROGRESS-1603218676783	AWS::EC2::Instance	MyInstance		2020-10-20T18:31:16.783Z	CREATE_IN_PROGRESS	
</span></span><span style=display:flex><span>EVENT	MyStack	MySecurityGroup-CREATE_COMPLETE-1603218676599	AWS::EC2::SecurityGroup	MySecurityGroup	MyStack-MySecurityGroup-SWUBTU8TQ9MBV	2020-10-20T18:31:16.599Z	CREATE_COMPLETE	
</span></span><span style=display:flex><span>EVENT	MyStack	MySecurityGroup-CREATE_IN_PROGRESS-1603218676174	AWS::EC2::SecurityGroup	MySecurityGroup	MyStack-MySecurityGroup-SWUBTU8TQ9MBV	2020-10-20T18:31:16.174Z	CREATE_IN_PROGRESS	Resource creation Initiated
</span></span><span style=display:flex><span>EVENT	MyStack	MySecurityGroup-CREATE_IN_PROGRESS-1603218676038	AWS::EC2::SecurityGroup	MySecurityGroup		2020-10-20T18:31:16.038Z	CREATE_IN_PROGRESS	
</span></span><span style=display:flex><span>EVENT	MyStack	9212e1ff-6c7a-4710-96a2-d83606a3c34f	AWS::CloudFormation::Stack	MyStack	arn:aws:cloudformation::000575948401:stack/MyStack/26daf046-3776-4b97-9444-5edae2f2eceb	2020-10-20T18:31:15.780Z	CREATE_IN_PROGRESS	User Initiated
</span></span></code></pre></div><p>Run <em>euca-describe-instances</em> and <em>euca-describe-groups</em> to see the newly created resources:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># euca-describe-instances i-687f112f4c99e9a98</span>
</span></span><span style=display:flex><span>RESERVATION	r-2381c3e652dd942f2	000575948401	MyStack-MySecurityGroup-SWUBTU8TQ9MBV
</span></span><span style=display:flex><span>INSTANCE	i-687f112f4c99e9a98	emi-371ada125a928669e	euca-192-168-134-181.eucalyptus.mycloud.example.com	euca-172-31-15-210.eucalyptus.internal	running	myKey	0		t2.micro	2020-10-20T18:31:16.920Z	cloud-1a				monitoring-disabled	192.168.134.181	172.31.15.210	vpc-837bc081de161f8c0	subnet-1503566df094fe78a	instance-store					hvm			sg-98da12246d91375e3				x86_64
</span></span><span style=display:flex><span>NETWORKINTERFACE	eni-42a4a3bf7d1075735	subnet-1503566df094fe78a	vpc-837bc081de161f8c0	000575948401	in-use	172.31.15.210	euca-172-31-15-210.eucalyptus.internal	<span style=color:#204a87>true</span>
</span></span><span style=display:flex><span>ATTACHMENT		eni-attach-cc38f4f4ef78a6469	0	attached	2020-10-20T18:31:16.923Z	<span style=color:#204a87>true</span>
</span></span><span style=display:flex><span>ASSOCIATION	192.168.134.181		172.31.15.210
</span></span><span style=display:flex><span>GROUP	sg-98da12246d91375e3	MyStack-MySecurityGroup-SWUBTU8TQ9MBV
</span></span><span style=display:flex><span>PRIVATEIPADDRESS	172.31.15.210	euca-172-31-15-210.eucalyptus.internal	primary
</span></span><span style=display:flex><span>TAG	instance	i-687f112f4c99e9a98	aws:cloudformation:logical-id	MyInstance
</span></span><span style=display:flex><span>TAG	instance	i-687f112f4c99e9a98	aws:cloudformation:stack-id	arn:aws:cloudformation::000575948401:stack/MyStack/26daf046-3776-4b97-9444-5edae2f2eceb
</span></span><span style=display:flex><span>TAG	instance	i-687f112f4c99e9a98	aws:cloudformation:stack-name	MyStack
</span></span><span style=display:flex><span>TAG	instance	i-687f112f4c99e9a98	euca:node	10.117.111.18
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># euca-describe-groups sg-98da12246d91375e3</span>
</span></span><span style=display:flex><span>GROUP	sg-98da12246d91375e3	000575948401	MyStack-MySecurityGroup-SWUBTU8TQ9MBV	Security Group with Ingress Rule <span style=color:#204a87;font-weight:700>for</span> MyInstance	vpc-837bc081de161f8c0
</span></span><span style=display:flex><span>PERMISSION	000575948401	MyStack-MySecurityGroup-SWUBTU8TQ9MBV	ALLOWS	tcp	22	22	FROM	CIDR	0.0.0.0/0	ingress
</span></span><span style=display:flex><span>PERMISSION	000575948401	MyStack-MySecurityGroup-SWUBTU8TQ9MBV	ALLOWS	-1			TO	CIDR	0.0.0.0/0	egress
</span></span><span style=display:flex><span>TAG	security-group	sg-98da12246d91375e3	aws:cloudformation:logical-id	MySecurityGroup
</span></span><span style=display:flex><span>TAG	security-group	sg-98da12246d91375e3	aws:cloudformation:stack-id	arn:aws:cloudformation::000575948401:stack/MyStack/26daf046-3776-4b97-9444-5edae2f2eceb
</span></span><span style=display:flex><span>TAG	security-group	sg-98da12246d91375e3	aws:cloudformation:stack-name	MyStack
</span></span></code></pre></div><p>To SSH into the instance:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh -i myKey.pem root@192.168.134.181
</span></span></code></pre></div><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Username might depend on the image, and might be root, centos, ubuntu or ec2-user.</div><p>Delete the stack.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>euform-delete-stack MyStack
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Or</span>
</span></span><span style=display:flex><span>aws cloudformation delete-stack --stack-name MyStack
</span></span></code></pre></div><p>You can run <em>euform-describe-stacks</em> and all the other describe commands to check the progress until the delete is complete.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-70fe51a9080ba0a3a8dd4d5b64a0c516>3.14.2 - CloudFormation Templates</h1><p>This topic details templates that have been tested with Eucalyptus.</p><div class="alert alert-warning" role=alert><h4 class=alert-heading>Warning</h4>These examples use the older JSON format, YAML format is recommended for Eucalyptus 5</div><h2 id=accesskeystemplate>AccessKeys.template</h2><pre><code>{
  &quot;AWSTemplateFormatVersion&quot;:&quot;2010-09-09&quot;,
  &quot;Parameters&quot;:{
    &quot;Username&quot;:{
      &quot;Description&quot;:&quot;Username&quot;,
      &quot;Type&quot;:&quot;String&quot;
    }
  },
  &quot;Resources&quot;:{
    &quot;Key1&quot;:{
      &quot;Type&quot;:&quot;AWS::IAM::AccessKey&quot;,
      &quot;Properties&quot;:{
        &quot;UserName&quot;:{&quot;Ref&quot;:&quot;Username&quot;},
        &quot;Serial&quot;:&quot;1&quot;,
        &quot;Status&quot;:&quot;Active&quot;
      }
    },
    &quot;Key2&quot;:{
      &quot;Type&quot;:&quot;AWS::IAM::AccessKey&quot;,
      &quot;Properties&quot;:{
        &quot;UserName&quot;:{&quot;Ref&quot;:&quot;Username&quot;},
       &quot;Serial&quot;:&quot;1&quot;,
       &quot;Status&quot;:&quot;Inactive&quot;
      }
    }
  },
  &quot;Outputs&quot;:{
    &quot;Key1AK&quot;:{
      &quot;Value&quot;:{&quot;Ref&quot;:&quot;Key1&quot;}
    },
    &quot;Key1SK&quot;:{
      &quot;Value&quot;:{&quot;Fn::GetAtt&quot;:[&quot;Key1&quot;,&quot;SecretAccessKey&quot;]}
    },
    &quot;Key2AK&quot;:{
      &quot;Value&quot;:{&quot;Ref&quot;:&quot;Key2&quot;}
    },
    &quot;Key2SK&quot;:{
      &quot;Value&quot;:{&quot;Fn::GetAtt&quot;:[&quot;Key2&quot;,&quot;SecretAccessKey&quot;]}
    }
  }
}
</code></pre><h2 id=autoscalinggroupsandcloudwatchalarmtemplate>AutoscalingGroupsAndCloudWatchAlarm.template</h2><pre><code>{
  &quot;AWSTemplateFormatVersion&quot;:&quot;2010-09-09&quot;,
  &quot;Parameters&quot;:{
    &quot;ImageId&quot;:{
      &quot;Description&quot;:&quot;Image id&quot;,
      &quot;Type&quot;:&quot;String&quot;
    }
  },
  &quot;Resources&quot;:{
    &quot;LaunchConfig&quot;:{
      &quot;Type&quot;:&quot;AWS::AutoScaling::LaunchConfiguration&quot;,
      &quot;Properties&quot;:{
        &quot;ImageId&quot;:{&quot;Ref&quot;:&quot;ImageId&quot;},
        &quot;InstanceType&quot;:&quot;m1.small&quot;,
        &quot;BlockDeviceMappings&quot;:[
          {&quot;DeviceName&quot;:&quot;/dev/sdc&quot;,&quot;VirtualName&quot;:&quot;ephemeral0&quot;},
          {&quot;DeviceName&quot;:&quot;/dev/sdc&quot;,&quot;Ebs&quot;:{&quot;VolumeSize&quot;:&quot;10&quot;}}
        ],
        &quot;SecurityGroups&quot;:[{&quot;Ref&quot;:&quot;InstanceSecurityGroup&quot;}]}
      },
      &quot;ASG1&quot;:{
        &quot;UpdatePolicy&quot;:{
          &quot;AutoScalingRollingUpdate&quot;:{
            &quot;MinInstancesInService&quot;:&quot;1&quot;,
            &quot;MaxBatchSize&quot;:&quot;1&quot;,
            &quot;PauseTime&quot;:&quot;PT12M5S&quot;
          }
        },
        &quot;Type&quot;:&quot;AWS::AutoScaling::AutoScalingGroup&quot;,
        &quot;Properties&quot;:{
          &quot;AvailabilityZones&quot;:{&quot;Fn::GetAZs&quot;:{&quot;Ref&quot;:&quot;AWS::Region&quot;}
        },
        &quot;LaunchConfigurationName&quot;:{&quot;Ref&quot;:&quot;LaunchConfig&quot;},
        &quot;MaxSize&quot;:&quot;3&quot;,
        &quot;MinSize&quot;:&quot;1&quot;
      }
    },
    &quot;ScaleUpPolicy&quot;:{
      &quot;Type&quot;:&quot;AWS::AutoScaling::ScalingPolicy&quot;,
        &quot;Properties&quot;:{
          &quot;AdjustmentType&quot;:&quot;ChangeInCapacity&quot;,
          &quot;AutoScalingGroupName&quot;:{&quot;Ref&quot;:&quot;ASG1&quot;},
          &quot;Cooldown&quot;:&quot;1&quot;,
          &quot;ScalingAdjustment&quot;:&quot;1&quot;
        }
      },
      &quot;CPUAlarmHigh&quot;:{
        &quot;Type&quot;:&quot;AWS::CloudWatch::Alarm&quot;,
        &quot;Properties&quot;:{
          &quot;EvaluationPeriods&quot;:&quot;1&quot;,
          &quot;Statistic&quot;:&quot;Average&quot;,
          &quot;Threshold&quot;:&quot;10&quot;,
          &quot;AlarmDescription&quot;:&quot;Alarm if CPU too high or metric disappears indicating instance is down&quot;,
          &quot;Period&quot;:&quot;60&quot;,
          &quot;AlarmActions&quot;:[{&quot;Ref&quot;:&quot;ScaleUpPolicy&quot;}],
          &quot;Namespace&quot;:&quot;AWS/EC2&quot;,
          &quot;Dimensions&quot;:[{
            &quot;Name&quot;:&quot;AutoScalingGroupName&quot;,
            &quot;Value&quot;:{&quot;Ref&quot;:&quot;ASG1&quot;}
          }],
          &quot;ComparisonOperator&quot;:&quot;GreaterThanThreshold&quot;,
          &quot;MetricName&quot;:&quot;CPUUtilization&quot;
        }
      },
      &quot;InstanceSecurityGroup&quot;:{
        &quot;Type&quot;:&quot;AWS::EC2::SecurityGroup&quot;,
        &quot;Properties&quot;:{
          &quot;GroupDescription&quot;:&quot;Cloudformation Group&quot;,
          &quot;SecurityGroupIngress&quot;:[{
            &quot;IpProtocol&quot;:&quot;tcp&quot;,
            &quot;FromPort&quot;:&quot;22&quot;,
            &quot;ToPort&quot;:&quot;22&quot;,
             &quot;CidrIp&quot;:&quot;0.0.0.0/0&quot;
          }]
        }
      },
      &quot;IngressRule&quot;:{
        &quot;Type&quot;:&quot;AWS::EC2::SecurityGroupIngress&quot;,
        &quot;Properties&quot;:{
          &quot;GroupName&quot;:{&quot;Ref&quot;:&quot;InstanceSecurityGroup&quot;},
          &quot;FromPort&quot;:&quot;80&quot;,
          &quot;ToPort&quot;:&quot;80&quot;,
          &quot;IpProtocol&quot;:&quot;tcp&quot;,
          &quot;SourceSecurityGroupName&quot;:{&quot;Ref&quot;:&quot;InstanceSecurityGroup&quot;}
      }
    }
  }
}
</code></pre><h2 id=blockdevicemappingstemplate>BlockDeviceMappings.template</h2><pre><code>{
  &quot;AWSTemplateFormatVersion&quot;:&quot;2010-09-09&quot;,
  &quot;Description&quot;:&quot;Create an EC2 instance running a specified EMI with block device mappings.&quot;,
  &quot;Parameters&quot;:{
    &quot;ImageId&quot;:{
      &quot;Description&quot;:&quot;Image id&quot;,
      &quot;Type&quot;:&quot;String&quot;
    },
    &quot;KeyName&quot;:{
      &quot;Description&quot;:&quot;KeyName&quot;,
      &quot;Type&quot;:&quot;String&quot;
    },
    &quot;SnapshotId&quot;:{
      &quot;Type&quot;:&quot;String&quot;
    }
  },
  &quot;Resources&quot;:{
    &quot;Ec2Instance1&quot;:{
      &quot;Type&quot;:&quot;AWS::EC2::Instance&quot;,
      &quot;Properties&quot;:{
        &quot;ImageId&quot;:{&quot;Ref&quot;:&quot;ImageId&quot;},
        &quot;BlockDeviceMappings&quot;:[{&quot;DeviceName&quot;:&quot;/dev/sdc&quot;,&quot;VirtualName&quot;:&quot;ephemeral0&quot;}]
      }
    },
    &quot;Ec2Instance2&quot;:{
      &quot;Type&quot;:&quot;AWS::EC2::Instance&quot;,
      &quot;Properties&quot;:{
        &quot;ImageId&quot;:{&quot;Ref&quot;:&quot;ImageId&quot;},
        &quot;KeyName&quot;:{&quot;Ref&quot;:&quot;KeyName&quot;},
        &quot;BlockDeviceMappings&quot;:[{
          &quot;DeviceName&quot;:&quot;/dev/sdc&quot;,
          &quot;Ebs&quot;:{&quot;SnapshotId&quot;:{&quot;Ref&quot;:&quot;SnapshotId&quot;},&quot;DeleteOnTermination&quot;:&quot;false&quot;}
        }]
      }
    },
    &quot;Ec2Instance3&quot;:{
      &quot;Type&quot;:&quot;AWS::EC2::Instance&quot;,
      &quot;Properties&quot;:{
        &quot;ImageId&quot;:{&quot;Ref&quot;:&quot;ImageId&quot;},
        &quot;KeyName&quot;:{&quot;Ref&quot;:&quot;KeyName&quot;},
        &quot;BlockDeviceMappings&quot;:[{
          &quot;DeviceName&quot;:&quot;/dev/sdc&quot;,
          &quot;Ebs&quot;:{&quot;VolumeSize&quot;:&quot;10&quot;,&quot;DeleteOnTermination&quot;:&quot;true&quot;}
        }]
      }
    }
  }
}
</code></pre><h2 id=conditionsandfunctionstemplate>ConditionsAndFunctions.template</h2><pre><code>{
  &quot;Mappings&quot;:{
    &quot;Mapping01&quot;:{
      &quot;Key01&quot;:{&quot;Value&quot;:[&quot;1&quot;,&quot;2&quot;]},
      &quot;Key02&quot;:{&quot;Value&quot;:&quot;3&quot;},
      &quot;Key03&quot;:{&quot;Value&quot;:&quot;4&quot;}
    }
  },
  &quot;AWSTemplateFormatVersion&quot;:&quot;2010-09-09&quot;,
  &quot;Description&quot;:&quot;Create an EC2 instance running a specified EMI, also test functions and conditions.&quot;,
  &quot;Parameters&quot;:{
    &quot;ImageId&quot;:{
      &quot;Description&quot;:&quot;Image id&quot;,
      &quot;Type&quot;:&quot;String&quot;,
      &quot;NoEcho&quot;:&quot;True&quot;
    },
    &quot;Split&quot;:{
      &quot;Default&quot;:&quot;1,2,3&quot;,
      &quot;Type&quot;:&quot;CommaDelimitedList&quot;
    }
  },
  &quot;Resources&quot;:{
    &quot;Ec2Instance1&quot;:{
      &quot;Type&quot;:&quot;AWS::EC2::Instance&quot;,
        &quot;Properties&quot;:{
          &quot;ImageId&quot;:{&quot;Ref&quot;:&quot;ImageId&quot;}
        },
      &quot;Condition&quot;:&quot;True&quot;
    },
    &quot;Ec2Instance2&quot;:{
      &quot;Type&quot;:&quot;AWS::EC2::Instance&quot;,
      &quot;Properties&quot;:{
        &quot;ImageId&quot;:{&quot;Ref&quot;:&quot;ImageId&quot;}
      },
      &quot;Condition&quot;:&quot;False&quot;
    }
  },
  &quot;Conditions&quot;:{
    &quot;True&quot;:{&quot;Fn::Equals&quot;:[&quot;x&quot;,&quot;x&quot;]},
    &quot;False&quot;:{&quot;Fn::Not&quot;:[{&quot;Condition&quot;:&quot;True&quot;}]},
    &quot;NotTrue&quot;:{&quot;Fn::Not&quot;:[{&quot;Condition&quot;:&quot;True&quot;}]},
    &quot;NotFalse&quot;:{&quot;Fn::Not&quot;:[{&quot;Condition&quot;:&quot;False&quot;}]},
    &quot;TrueAndTrue&quot;:{&quot;Fn::And&quot;:[{&quot;Condition&quot;:&quot;True&quot;},{&quot;Condition&quot;:&quot;True&quot;}]},
    &quot;TrueAndFalse&quot;:{&quot;Fn::And&quot;:[{&quot;Condition&quot;:&quot;True&quot;},{&quot;Condition&quot;:&quot;False&quot;}]},
    &quot;FalseAndTrue&quot;:{&quot;Fn::And&quot;:[{&quot;Condition&quot;:&quot;False&quot;},{&quot;Condition&quot;:&quot;True&quot;}]},
    &quot;FalseAndFalse&quot;:{&quot;Fn::And&quot;:[{&quot;Condition&quot;:&quot;False&quot;},{&quot;Condition&quot;:&quot;False&quot;}]},
    &quot;TrueOrTrue&quot;:{&quot;Fn::Or&quot;:[{&quot;Condition&quot;:&quot;True&quot;},{&quot;Condition&quot;:&quot;True&quot;}]},
    &quot;TrueOrFalse&quot;:{&quot;Fn::Or&quot;:[{&quot;Condition&quot;:&quot;True&quot;},{&quot;Condition&quot;:&quot;False&quot;}]},
    &quot;FalseOrTrue&quot;:{&quot;Fn::Or&quot;:[{&quot;Condition&quot;:&quot;False&quot;},{&quot;Condition&quot;:&quot;True&quot;}]},
    &quot;FalseOrFalse&quot;:{&quot;Fn::Or&quot;:[{&quot;Condition&quot;:&quot;False&quot;},{&quot;Condition&quot;:&quot;False&quot;}]}
  },
  &quot;Outputs&quot;:{
    &quot;Region&quot;:{
      &quot;Value&quot;:{&quot;Ref&quot;:&quot;AWS::Region&quot;}
    },
    &quot;JoinAndAZ&quot;:{
      &quot;Value&quot;:{&quot;Fn::Join&quot;:[&quot;,&quot;,{&quot;Fn::GetAZs&quot;:&quot;&quot;}]}
    },
    &quot;FindInMap1AndSelect&quot;:{
      &quot;Value&quot;:{&quot;Fn::Select&quot;:[&quot;0&quot;,{&quot;Fn::FindInMap&quot;:[&quot;Mapping01&quot;,&quot;Key01&quot;,&quot;Value&quot;]}]}
    },
    &quot;FindInMap2AndSelect&quot;:{
     &quot;Value&quot;:{&quot;Fn::Select&quot;:[&quot;1&quot;,&quot;Fn::FindInMap&quot;:[&quot;Mapping01&quot;,&quot;Key01&quot;,&quot;Value&quot;]}]}
    },
    &quot;FindInMap3AndSelect&quot;:{
      &quot;Value&quot;:{&quot;Fn::FindInMap&quot;:[&quot;Mapping01&quot;,&quot;Key02&quot;,&quot;Value&quot;]}
    },
    &quot;FindInMap4AndSelect&quot;:{
      &quot;Value&quot;:{&quot;Fn::FindInMap&quot;:[&quot;Mapping01&quot;,&quot;Key03&quot;,&quot;Value&quot;]}
    },
    &quot;GetAtt&quot;:{
      &quot;Value&quot;:{&quot;Fn::GetAtt&quot;:[&quot;Ec2Instance1&quot;,&quot;PrivateIp&quot;]}
    },
    &quot;StackId&quot;:{
      &quot;Value&quot;:{&quot;Ref&quot;:&quot;AWS::StackId&quot;}
    },
    &quot;StackName&quot;:{
      &quot;Value&quot;:{&quot;Ref&quot;:&quot;AWS::StackName&quot;}
    },
    &quot;AccountId&quot;:{
      &quot;Value&quot;:{&quot;Ref&quot;:&quot;AWS::AccountId&quot;}
    },
    &quot;True&quot;:{
      &quot;Value&quot;:{&quot;Fn::Join&quot; : [&quot;,&quot;,[{&quot;Fn::If&quot;: [&quot;True&quot;,&quot;True&quot;,&quot;False&quot;]}]]}},
    },
    &quot;False&quot;:{
      &quot;Value&quot;:{&quot;Fn::Join&quot; : [&quot;,&quot;,[{&quot;Fn::If&quot;: [&quot;False&quot;,&quot;True&quot;,&quot;False&quot;]}]]}},
    },
    &quot;NotTrue&quot;:{
      &quot;Value&quot;:{&quot;Fn::Join&quot; : [&quot;,&quot;,[{&quot;Fn::If&quot;: [&quot;NotTrue&quot;,&quot;True&quot;,&quot;False&quot;]}]]}},
    },
    &quot;NotFalse&quot;:{
      &quot;Value&quot;:{&quot;Fn::Join&quot; : [&quot;,&quot;,[{&quot;Fn::If&quot;: [&quot;NotFalse&quot;,&quot;True&quot;,&quot;False&quot;]}]]}},
    },
    &quot;TrueAndTrue&quot;:{
      &quot;Value&quot;:{&quot;Fn::Join&quot; : [&quot;,&quot;,[{&quot;Fn::If&quot;: [&quot;TrueAndTrue&quot;,&quot;True&quot;,&quot;False&quot;]}]]}},
    },
    &quot;TrueAndFalse&quot;:{
      &quot;Value&quot;:{&quot;Fn::Join&quot; : [&quot;,&quot;,[{&quot;Fn::If&quot;: [&quot;TrueAndFalse&quot;,&quot;True&quot;,&quot;False&quot;]}]]}},
    },
    &quot;FalseAndTrue&quot;:{
      &quot;Value&quot;:{&quot;Fn::Join&quot; : [&quot;,&quot;,[{&quot;Fn::If&quot;: [&quot;FalseAndTrue&quot;,&quot;True&quot;,&quot;False&quot;]}]]}},
    },
    &quot;FalseAndFalse&quot;:{
      &quot;Value&quot;:{&quot;Fn::Join&quot; : [&quot;,&quot;,[{&quot;Fn::If&quot;: [&quot;FalseAndFalse&quot;,&quot;True&quot;,&quot;False&quot;]}]]}},
    },
    &quot;TrueOrTrue&quot;:{
      &quot;Value&quot;:{&quot;Fn::Join&quot; : [&quot;,&quot;,[{&quot;Fn::If&quot;: [&quot;TrueOrTrue&quot;,&quot;True&quot;,&quot;False&quot;]}]]}},
    },
    &quot;TrueOrFalse&quot;:{
      &quot;Value&quot;:{&quot;Fn::Join&quot; : [&quot;,&quot;,[{&quot;Fn::If&quot;: [&quot;TrueOrFalse&quot;,&quot;True&quot;,&quot;False&quot;]}]]}},
    },
    &quot;FalseOrTrue&quot;:{
      &quot;Value&quot;:{&quot;Fn::Join&quot; : [&quot;,&quot;,[{&quot;Fn::If&quot;: [&quot;FalseOrTrue&quot;,&quot;True&quot;,&quot;False&quot;]}]]}},
    },
    &quot;FalseOrFalse&quot;:{
      &quot;Value&quot;:{&quot;Fn::Join&quot; : [&quot;,&quot;,[{&quot;Fn::If&quot;: [&quot;FalseOrFalse&quot;,&quot;True&quot;,&quot;False&quot;]}]]}},
    }
  }
}
</code></pre><h2 id=elasticiptemplate>ElasticIP.template</h2><p>This template attaches an Elastic IP to a new and existing instance. You must pass along the existing instance ID.</p><pre><code>{
  &quot;AWSTemplateFormatVersion&quot;:&quot;2010-09-09&quot;,
  &quot;Description&quot;:&quot;Create an EC2 instance running a specified EMI and some elastic IP addresses.&quot;,
  &quot;Parameters&quot;:{
    &quot;ImageId&quot;:{
      &quot;Description&quot;:&quot;Image id&quot;,
      &quot;Type&quot;:&quot;String&quot;
    },
    &quot;OtherInstanceId&quot;:{
      &quot;Description&quot;:&quot;Other instance id&quot;,
      &quot;Type&quot;:&quot;String&quot;
    }
    },
    &quot;Resources&quot;:{
      &quot;Ec2Instance1&quot;:{
        &quot;Type&quot;:&quot;AWS::EC2::Instance&quot;,
        &quot;Properties&quot;:{
          &quot;ImageId&quot;:{&quot;Ref&quot;:&quot;ImageId&quot;}
        }
      },
      &quot;EIP1&quot;:{
        &quot;Type&quot;:&quot;AWS::EC2::EIP&quot;,
        &quot;Properties&quot;:{
          &quot;InstanceId&quot;:{&quot;Ref&quot;:&quot;Ec2Instance1&quot;}
        }
      },
      &quot;EIP2&quot;:{
        &quot;Type&quot;:&quot;AWS::EC2::EIP&quot;,
        &quot;Properties&quot;:{
        }
      },
      &quot;EIPAssociation2&quot;:{
        &quot;Type&quot;:&quot;AWS::EC2::EIPAssociation&quot;,
        &quot;Properties&quot;:{
          &quot;InstanceId&quot;:{&quot;Ref&quot;:&quot;OtherInstanceId&quot;},
          &quot;EIP&quot;:{&quot;Ref&quot;:&quot;EIP2&quot;}
        }
      }
    },
    &quot;Outputs&quot;:{
      &quot;Output1&quot;:{
        &quot;Value&quot;:{&quot;Ref&quot;:&quot;EIPAssociation2&quot;}
      }
  }
}
</code></pre><h2 id=elasticloadbalancertemplate>ElasticLoadBalancer.template</h2><p>There is a hard-coded image ID in the <code>Mapping</code> section here to test <code>FindInMap</code> . Change the value to an instance that exists in your cloud.</p><pre><code>{
  &quot;AWSTemplateFormatVersion&quot;:&quot;2010-09-09&quot;,
  &quot;Description&quot;:&quot;Based on the AWS Cloudformation Sample Template for ELB.  Modify this template, and put the correct emi-XXXX in the value fields with a blank key of the AWSRegionArch2AMI mapping.&quot;,
  &quot;Parameters&quot;:{
    &quot;InstanceType&quot;:{
      &quot;Description&quot;:&quot;WebServer EC2 instance type&quot;,
      &quot;Type&quot;:&quot;String&quot;,
      &quot;Default&quot;:&quot;m1.small&quot;,
      &quot;AllowedValues&quot;:[&quot;t1.micro&quot;,&quot;m1.small&quot;,&quot;m1.medium&quot;,&quot;m1.large&quot;,&quot;m1.xlarge&quot;,&quot;m2.xlarge&quot;,&quot;m2.2xlarge&quot;,
                       &quot;m2.4xlarge&quot;,&quot;m3.xlarge&quot;,&quot;m3.2xlarge&quot;,&quot;c1.medium&quot;,&quot;c1.xlarge&quot;,&quot;cc1.4xlarge&quot;,
                       &quot;cc2.8xlarge&quot;,&quot;cg1.4xlarge&quot;],
      &quot;ConstraintDescription&quot;:&quot;must be a valid EC2 instance type.&quot;
    },
    &quot;WebServerPort&quot;:{
      &quot;Description&quot;:&quot;TCP/IP port of the web server&quot;,
      &quot;Type&quot;:&quot;String&quot;,
      &quot;Default&quot;:&quot;8888&quot;
    },
    &quot;KeyName&quot;:{
      &quot;Description&quot;:&quot;Name of an existing EC2 KeyPair to enable SSH access to the instances&quot;,
      &quot;Type&quot;:&quot;String&quot;,
      &quot;MinLength&quot;:&quot;1&quot;,
      &quot;MaxLength&quot;:&quot;255&quot;,
      &quot;AllowedPattern&quot;:&quot;[\\x20-\\x7E]*&quot;,
      &quot;ConstraintDescription&quot;:&quot;can contain only ASCII characters.&quot;
    },
    &quot;SSHLocation&quot;:{
      &quot;Description&quot;:&quot;The IP address range that can be used to SSH to the EC2 instances&quot;,
      &quot;Type&quot;:&quot;String&quot;,
      &quot;MinLength&quot;:&quot;9&quot;,
      &quot;MaxLength&quot;:&quot;18&quot;,
      &quot;Default&quot;:&quot;0.0.0.0/0&quot;,
      &quot;AllowedPattern&quot;:&quot;(\\d{1,3})\\.(\\d{1,3})\\.(\\d{1,3})\\.(\\d{1,3})/(\\d{1,2})&quot;,
      &quot;ConstraintDescription&quot;:&quot;must be a valid IP CIDR range of the form x.x.x.x/x.&quot;
    }
  },
  &quot;Mappings&quot;:{
    &quot;AWSInstanceType2Arch&quot;:{
      &quot;t1.micro&quot;:{&quot;Arch&quot;:&quot;64&quot;},
      &quot;m1.small&quot;:{&quot;Arch&quot;:&quot;64&quot;},
      &quot;m1.medium&quot;:{&quot;Arch&quot;:&quot;64&quot;},
      &quot;m1.large&quot;:{&quot;Arch&quot;:&quot;64&quot;},
      &quot;m1.xlarge&quot;:{&quot;Arch&quot;:&quot;64&quot;},
      &quot;m2.xlarge&quot;:{&quot;Arch&quot;:&quot;64&quot;},
      &quot;m2.2xlarge&quot;:{&quot;Arch&quot;:&quot;64&quot;},
      &quot;m3.xlarge&quot;:{&quot;Arch&quot;:&quot;64&quot;},
      &quot;m3.2xlarge&quot;:{&quot;Arch&quot;:&quot;64&quot;},
      &quot;m2.4xlarge&quot;:{&quot;Arch&quot;:&quot;64&quot;},
      &quot;c1.medium&quot;:{&quot;Arch&quot;:&quot;64&quot;},
      &quot;c1.xlarge&quot;:{&quot;Arch&quot;:&quot;64&quot;}
    },
    &quot;AWSRegionArch2AMI&quot;:{
      &quot;&quot;:{&quot;32&quot;:&quot;emi-ddbacddf&quot;,&quot;64&quot;:&quot;emi-ddbacddf&quot;}
    }
  },
  &quot;Resources&quot;:{
    &quot;ElasticLoadBalancer&quot;:{
      &quot;Type&quot;:&quot;AWS::ElasticLoadBalancing::LoadBalancer&quot;,
      &quot;Properties&quot;:{
        &quot;AvailabilityZones&quot;:{&quot;Fn::GetAZs&quot;:&quot;&quot;},
        &quot;Instances&quot;:[{&quot;Ref&quot;:&quot;Ec2Instance1&quot;},{&quot;Ref&quot;:&quot;Ec2Instance2&quot;}],
        &quot;Listeners&quot;{&quot;LoadBalancerPort&quot;:&quot;80&quot;,&quot;InstancePort&quot;:{&quot;Ref&quot;:&quot;WebServerPort&quot;},&quot;Protocol&quot;:&quot;HTTP&quot;}],
        &quot;HealthCheck&quot;:{
          &quot;Target&quot;:{&quot;Fn::Join&quot;:[&quot;&quot;,[&quot;HTTP:&quot;,{&quot;Ref&quot;:&quot;WebServerPort&quot;},&quot;/&quot;]]},
          &quot;HealthyThreshold&quot;:&quot;3&quot;,
          &quot;UnhealthyThreshold&quot;:&quot;5&quot;,
          &quot;Interval&quot;:&quot;30&quot;,
          &quot;Timeout&quot;:&quot;5&quot;
        }
      }
    },
    &quot;Ec2Instance1&quot;:{
      &quot;Type&quot;:&quot;AWS::EC2::Instance&quot;,
      &quot;Properties&quot;:{
        &quot;SecurityGroups&quot;:[{&quot;Ref&quot;:&quot;InstanceSecurityGroup&quot;}],
        &quot;KeyName&quot;:{&quot;Ref&quot;:&quot;KeyName&quot;},
        &quot;InstanceType&quot;:{&quot;Ref&quot;:&quot;InstanceType&quot;},
        &quot;ImageId&quot;:{
          &quot;Fn::FindInMap&quot;:[
            &quot;AWSRegionArch2AMI&quot;,
            {&quot;Ref&quot;:&quot;AWS::Region&quot;},
            {&quot;Fn::FindInMap&quot;:[&quot;AWSInstanceType2Arch&quot;,{&quot;Ref&quot;:&quot;InstanceType&quot;},&quot;Arch&quot;]}
          ]
        },
        &quot;UserData&quot;:{&quot;Fn::Base64&quot;:{&quot;Ref&quot;:&quot;WebServerPort&quot;}}
      }
    },
    &quot;Ec2Instance2&quot;:{
      &quot;Type&quot;:&quot;AWS::EC2::Instance&quot;,
      &quot;Properties&quot;:{
        &quot;SecurityGroups&quot;:[{&quot;Ref&quot;:&quot;InstanceSecurityGroup&quot;}],
        &quot;KeyName&quot;:{&quot;Ref&quot;:&quot;KeyName&quot;},
        &quot;InstanceType&quot;:{&quot;Ref&quot;:&quot;InstanceType&quot;},
        &quot;ImageId&quot;:{
          &quot;Fn::FindInMap&quot;:[
            &quot;AWSRegionArch2AMI&quot;,
            {&quot;Ref&quot;:&quot;AWS::Region&quot;},
            {&quot;Fn::FindInMap&quot;:[&quot;AWSInstanceType2Arch&quot;,{&quot;Ref&quot;:&quot;InstanceType&quot;},&quot;Arch&quot;]}
          ]
        },
        &quot;UserData&quot;:{&quot;Fn::Base64&quot;:{&quot;Ref&quot;:&quot;WebServerPort&quot;}}
      }
    },
    &quot;InstanceSecurityGroup&quot;:{
      &quot;Type&quot;:&quot;AWS::EC2::SecurityGroup&quot;,
      &quot;Properties&quot;:{
        &quot;GroupDescription&quot;:&quot;Enable SSH access and HTTP access on the inbound port&quot;,
        &quot;SecurityGroupIngress&quot;:[
          {
            &quot;IpProtocol&quot;:&quot;tcp&quot;,
            &quot;FromPort&quot;:&quot;22&quot;,
            &quot;ToPort&quot;:&quot;22&quot;,
            &quot;CidrIp&quot;:{&quot;Ref&quot;:&quot;SSHLocation&quot;}
          },
          {
             &quot;IpProtocol&quot;:&quot;tcp&quot;,
             &quot;FromPort&quot;:{&quot;Ref&quot;:&quot;WebServerPort&quot;},
             &quot;ToPort&quot;:{&quot;Ref&quot;:&quot;WebServerPort&quot;},
             &quot;CidrIp&quot;:&quot;0.0.0.0/0&quot;
          }
        ]
      }
    }
  },
  &quot;Outputs&quot;:{
    &quot;URL&quot;:{
      &quot;Description&quot;:&quot;URL of the sample website&quot;,
      &quot;Value&quot;:{&quot;Fn::Join&quot;:[&quot;&quot;,[&quot;http://&quot;,{&quot;Fn::GetAtt&quot;:[&quot;ElasticLoadBalancer&quot;,&quot;DNSName&quot;]}]]}
    }
  }
}
</code></pre><h2 id=iamgrouptemplate>IAMGroup.template</h2><pre><code>{
  &quot;AWSTemplateFormatVersion&quot;:&quot;2010-09-09&quot;,
  &quot;Resources&quot;:{
    &quot;Group1&quot;:{
      &quot;Type&quot;:&quot;AWS::IAM::Group&quot;,
      &quot;Properties&quot;:{
        &quot;Path&quot;:&quot;/myapplication/&quot;,
        &quot;Policies&quot;:[{
          &quot;PolicyName&quot;:&quot;myapppolicy&quot;,
          &quot;PolicyDocument&quot;:{
            &quot;Version&quot;:&quot;2012-10-17&quot;,
            &quot;Statement&quot;:[
              {&quot;Effect&quot;:&quot;Allow&quot;,&quot;Action&quot;:[&quot;ec2:*&quot;],&quot;Resource&quot;:[&quot;*&quot;]},
              {&quot;Effect&quot;:&quot;Deny&quot;,&quot;Action&quot;:[&quot;s3:*&quot;],&quot;NotResource&quot;:[&quot;*&quot;]}
            ]
          }
        }]
      }
    }
  },
  &quot;Outputs&quot;:{
    &quot;Group1Ref&quot;:{
      &quot;Value&quot;:{&quot;Ref&quot;:&quot;Group1&quot;}
    },
    &quot;Group1Arn&quot;:{
      &quot;Value&quot;:{&quot;Fn::GetAtt&quot;:[&quot;Group1&quot;,&quot;Arn&quot;]}
    }
  }
}
</code></pre><h2 id=iamroletemplate>IAMRole.template</h2><pre><code>{
  &quot;AWSTemplateFormatVersion&quot;:&quot;2010-09-09&quot;,
  &quot;Resources&quot;:{
    &quot;Role1&quot;:{
      &quot;Type&quot;:&quot;AWS::IAM::Role&quot;,
      &quot;Properties&quot;:{
        &quot;AssumeRolePolicyDocument&quot;:{
          &quot;Version&quot;:&quot;2012-10-17&quot;,
          &quot;Statement&quot;:[{
            &quot;Effect&quot;:&quot;Allow&quot;,
            &quot;Principal&quot;:{&quot;Service&quot;:[&quot;ec2.amazonaws.com&quot;]},
            &quot;Action&quot;:[&quot;sts:AssumeRole&quot;]
          }]
        },
        &quot;Path&quot;:&quot;/&quot;,
        &quot;Policies&quot;:[{
          &quot;PolicyName&quot;:&quot;root&quot;,
          &quot;PolicyDocument&quot;:{
            &quot;Version&quot;:&quot;2012-10-17&quot;,
            &quot;Statement&quot;:[{&quot;Effect&quot;:&quot;Allow&quot;,&quot;Action&quot;:&quot;*&quot;,&quot;Resource&quot;:&quot;*&quot;}]
          }
        }]
      }
    },
    &quot;IP1&quot;:{
      &quot;Type&quot;:&quot;AWS::IAM::InstanceProfile&quot;,
      &quot;Properties&quot;:{
        &quot;Path&quot;:&quot;/&quot;,
        &quot;Roles&quot;:[{&quot;Ref&quot;:&quot;Role1&quot;}]
      }
    }
  },
  &quot;Outputs&quot;:{
    &quot;Role1Ref&quot;:{
      &quot;Value&quot;:{&quot;Ref&quot;:&quot;Role1&quot;}
    },
    &quot;Role1Arn&quot;:{
      &quot;Value&quot;:{&quot;Fn::GetAtt&quot;:[&quot;Role1&quot;,&quot;Arn&quot;]}
    },
    &quot;IP1Ref&quot;:{
      &quot;Value&quot;:{&quot;Ref&quot;:&quot;IP1&quot;}
    },
    &quot;IP1Arn&quot;:{
      &quot;Value&quot;:{&quot;Fn::GetAtt&quot;:[&quot;IP1&quot;,&quot;Arn&quot;]}
    }
  }
}
</code></pre><h2 id=iam_users_groups_and_policiestemplate>IAM_Users_Groups_and_Policies.template</h2><pre><code>{
  &quot;AWSTemplateFormatVersion&quot;:&quot;2010-09-09&quot;,
  &quot;Description&quot;:&quot;AWS CloudFormation Sample Template IAM_Users_Groups_and_Policies: Sample template showing how to create IAM users, groups and policies. It creates a single user that is a member of a users group and an admin group. The groups each have different IAM policies associated with them. Note: This example also creates an AWSAccessKeyId/AWSSecretKey pair associated with the new user. The example is somewhat contrived since it creates all of the users and groups, typically you would be creating policies, users and/or groups that contain references to existing users or groups in your environment. Note that you will need to specify the CAPABILITY_IAM flag when you create the stack to allow this template to execute. You can do this through the AWS management console by clicking on the check box acknowledging that you understand this template creates IAM resources or by specifying the CAPABILITY_IAM flag to the cfn-create-stack command line tool or CreateStack API call. &quot;,
  &quot;Parameters&quot;:{
    &quot;Password&quot;:{
      &quot;NoEcho&quot;:&quot;true&quot;,
      &quot;Type&quot;:&quot;String&quot;,
      &quot;Description&quot;:&quot;New account password&quot;,
      &quot;MinLength&quot;:&quot;1&quot;,
      &quot;MaxLength&quot;:&quot;41&quot;
    }
  },
  &quot;Resources&quot;:{
    &quot;CFNUser&quot;:{
      &quot;Type&quot;:&quot;AWS::IAM::User&quot;,
      &quot;Properties&quot;:{
        &quot;LoginProfile&quot;:{&quot;Password&quot;:{&quot;Ref&quot;:&quot;Password&quot;}}
      }
    },
    &quot;Role1&quot;:{
      &quot;Type&quot;:&quot;AWS::IAM::Role&quot;,
      &quot;Properties&quot;:{
        &quot;AssumeRolePolicyDocument&quot;:{
          &quot;Version&quot;:&quot;2012-10-17&quot;,
          &quot;Statement&quot;:[{
            &quot;Effect&quot;:&quot;Allow&quot;,
            &quot;Principal&quot;:{&quot;Service&quot;:[&quot;ec2.amazonaws.com&quot;]},
            &quot;Action&quot;:[&quot;sts:AssumeRole&quot;]
          }]
        },
        &quot;Path&quot;:&quot;/&quot;,
        &quot;Policies&quot;:[{
          &quot;PolicyName&quot;:&quot;root&quot;,
          &quot;PolicyDocument&quot;:{
            &quot;Version&quot;:&quot;2012-10-17&quot;,
            &quot;Statement&quot;:[{&quot;Effect&quot;:&quot;Allow&quot;,&quot;Action&quot;:&quot;*&quot;,&quot;Resource&quot;:&quot;*&quot;}]
          }
        }]
      }
    },
    &quot;CFNUserGroup&quot;:{
      &quot;Type&quot;:&quot;AWS::IAM::Group&quot;
    },
    &quot;CFNAdminGroup&quot;:{
      &quot;Type&quot;:&quot;AWS::IAM::Group&quot;
    },
    &quot;Users&quot;:{
      &quot;Type&quot;:&quot;AWS::IAM::UserToGroupAddition&quot;,
      &quot;Properties&quot;:{
        &quot;GroupName&quot;:{&quot;Ref&quot;:&quot;CFNUserGroup&quot;},
        &quot;Users&quot;:[{&quot;Ref&quot;:&quot;CFNUser&quot;}]
      }
    },
    &quot;Admins&quot;:{
      &quot;Type&quot;:&quot;AWS::IAM::UserToGroupAddition&quot;,
      &quot;Properties&quot;:{
        &quot;GroupName&quot;:{&quot;Ref&quot;:&quot;CFNAdminGroup&quot;},
        &quot;Users&quot;:[{&quot;Ref&quot;:&quot;CFNUser&quot;}]
      }
    },
    &quot;CFNUserPolicies&quot;:{
      &quot;Type&quot;:&quot;AWS::IAM::Policy&quot;,
      &quot;Properties&quot;:{
        &quot;PolicyName&quot;:&quot;CFNUsers&quot;,
        &quot;PolicyDocument&quot;:{
          &quot;Statement&quot;:[{
            &quot;Effect&quot;:&quot;Allow&quot;,
            &quot;Action&quot;:[&quot;cloudformation:Describe*&quot;,&quot;cloudformation:List*&quot;,&quot;cloudformation:Get*&quot;],
            &quot;Resource&quot;:&quot;*&quot;
          }]
        },
        &quot;Groups&quot;:[{&quot;Ref&quot;:&quot;CFNUserGroup&quot;}],
        &quot;Users&quot;:[{&quot;Ref&quot;:&quot;CFNUser&quot;}],
        &quot;Roles&quot;:[{&quot;Ref&quot;:&quot;Role1&quot;}]
      }
    },
    &quot;CFNAdminPolicies&quot;:{
      &quot;Type&quot;:&quot;AWS::IAM::Policy&quot;,
      &quot;Properties&quot;:{
        &quot;PolicyName&quot;:&quot;CFNAdmins&quot;,
        &quot;PolicyDocument&quot;:{
          &quot;Statement&quot;:[{&quot;Effect&quot;:&quot;Allow&quot;,&quot;Action&quot;:&quot;cloudformation:*&quot;,&quot;Resource&quot;:&quot;*&quot;}]
        },
        &quot;Groups&quot;:[{&quot;Ref&quot;:&quot;CFNAdminGroup&quot;}]
      }
    },
    &quot;CFNKeys&quot;:{
      &quot;Type&quot;:&quot;AWS::IAM::AccessKey&quot;,
      &quot;Properties&quot;:{
        &quot;UserName&quot;:{&quot;Ref&quot;:&quot;CFNUser&quot;}
      }
    }
  },
  &quot;Outputs&quot;:{
    &quot;AccessKey&quot;:{
      &quot;Value&quot;:{&quot;Ref&quot;:&quot;CFNKeys&quot;},
      &quot;Description&quot;:&quot;AWSAccessKeyId of new user&quot;
    },
    &quot;SecretKey&quot;:{
      &quot;Value&quot;:{&quot;Fn::GetAtt&quot;:[&quot;CFNKeys&quot;,&quot;SecretAccessKey&quot;]},
      &quot;Description&quot;:&quot;AWSSecretKey of new user&quot;
    }
  }
}
</code></pre><h2 id=iamusertemplate>IAMUser.template</h2><pre><code>{
  &quot;AWSTemplateFormatVersion&quot;:&quot;2010-09-09&quot;,
  &quot;Parameters&quot;:{
    &quot;Password&quot;:{
      &quot;NoEcho&quot;:&quot;true&quot;,
      &quot;Type&quot;:&quot;String&quot;,
      &quot;Description&quot;:&quot;New account password&quot;,
      &quot;MinLength&quot;:&quot;1&quot;,
      &quot;MaxLength&quot;:&quot;41&quot;
    }
  },
  &quot;Resources&quot;:{
    &quot;CFNUserGroup&quot;:{
      &quot;Type&quot;:&quot;AWS::IAM::Group&quot;,
      &quot;Properties&quot;:{
        &quot;Policies&quot;:[{
          &quot;PolicyName&quot;:&quot;CFNUsers&quot;,
          &quot;PolicyDocument&quot;:{
            &quot;Statement&quot;:[{
              &quot;Effect&quot;:&quot;Allow&quot;,
              &quot;Action&quot;:[&quot;cloudformation:Describe*&quot;,&quot;cloudformation:List*&quot;,&quot;cloudformation:Get*&quot;],
              &quot;Resource&quot;:&quot;*&quot;
            }]
          }
        }]
      }
    },
    &quot;CFNAdminGroup&quot;:{
      &quot;Type&quot;:&quot;AWS::IAM::Group&quot;
    },
    &quot;CFNUser&quot;:{
      &quot;Type&quot;:&quot;AWS::IAM::User&quot;,
      &quot;Properties&quot;:{
        &quot;LoginProfile&quot;:{&quot;Password&quot;:{&quot;Ref&quot;:&quot;Password&quot;}},
        &quot;Groups&quot;:[{&quot;Ref&quot;:&quot;CFNUserGroup&quot;},{&quot;Ref&quot;:&quot;CFNAdminGroup&quot;}],
        &quot;Policies&quot;:[{
          &quot;PolicyName&quot;:&quot;CFNUsers&quot;,
          &quot;PolicyDocument&quot;:{
            &quot;Statement&quot;:[{
              &quot;Effect&quot;:&quot;Allow&quot;,
              &quot;Action&quot;:[&quot;cloudformation:Describe*&quot;,&quot;cloudformation:List*&quot;,&quot;cloudformation:Get*&quot;],
              &quot;Resource&quot;:&quot;*&quot;
            }]
          }
        }]
      }
    }
  }
}
</code></pre><h2 id=securitygroupruletemplate>SecurityGroupRule.template</h2><pre><code>{
&quot;AWSTemplateFormatVersion&quot;:&quot;2010-09-09&quot;,
  &quot;Description&quot;:&quot;Create an EC2 instance running a specified EMI, a security group, and an ingress rule.&quot;,
  &quot;Parameters&quot;:{
    &quot;ImageId&quot;:{
      &quot;Description&quot;:&quot;Image id&quot;,
      &quot;Type&quot;:&quot;String&quot;
    }
  },
  &quot;Resources&quot;:{
    &quot;Ec2Instance1&quot;:{
      &quot;Description&quot;:&quot;My instance&quot;,
      &quot;Type&quot;:&quot;AWS::EC2::Instance&quot;,
      &quot;Properties&quot;:{
        &quot;ImageId&quot;:{&quot;Ref&quot;:&quot;ImageId&quot;}
      },
      &quot;DependsOn&quot;:&quot;Ec2Instance2&quot;
    },
    &quot;Ec2Instance2&quot;:{
      &quot;Type&quot;:&quot;AWS::EC2::Instance&quot;,
      &quot;Properties&quot;:{
        &quot;ImageId&quot;:{&quot;Ref&quot;:&quot;ImageId&quot;},
        &quot;SecurityGroups&quot;:[{&quot;Ref&quot;:&quot;InstanceSecurityGroup&quot;}]
      }
    },
    &quot;InstanceSecurityGroup&quot;:{
      &quot;Type&quot;:&quot;AWS::EC2::SecurityGroup&quot;,
      &quot;Properties&quot;:{
        &quot;GroupDescription&quot;:&quot;Cloudformation Group&quot;,
        &quot;SecurityGroupIngress&quot;:[{&quot;IpProtocol&quot;:&quot;tcp&quot;,&quot;FromPort&quot;:&quot;22&quot;,&quot;ToPort&quot;:&quot;22&quot;,&quot;CidrIp&quot;:&quot;0.0.0.0/0&quot;}]
      }
    },
    &quot;IngressRule&quot;:{
      &quot;Type&quot;:&quot;AWS::EC2::SecurityGroupIngress&quot;,
      &quot;Properties&quot;:{
        &quot;GroupName&quot;:{&quot;Ref&quot;:&quot;InstanceSecurityGroup&quot;},
        &quot;FromPort&quot;:&quot;80&quot;,
        &quot;ToPort&quot;:&quot;80&quot;,
        &quot;IpProtocol&quot;:&quot;tcp&quot;,
        &quot;SourceSecurityGroupName&quot;:{&quot;Ref&quot;:&quot;InstanceSecurityGroup&quot;}
      }
    }
  }
}
</code></pre><h2 id=volumestemplate>Volumes.template</h2><pre><code>{
  &quot;AWSTemplateFormatVersion&quot;:&quot;2010-09-09&quot;,
  &quot;Description&quot;:&quot;Create an EC2 instance running a specified EMI and attached volumes.&quot;,
  &quot;Parameters&quot;:{
    &quot;ImageId&quot;:{
      &quot;Description&quot;:&quot;Image id&quot;,
      &quot;Type&quot;:&quot;String&quot;
    }
  },
  &quot;Resources&quot;:{
    &quot;Volume1&quot;:{
      &quot;Type&quot;:&quot;AWS::EC2::Volume&quot;,
      &quot;Properties&quot;:{
        &quot;Size&quot;:&quot;5&quot;,
        &quot;AvailabilityZone&quot;:{&quot;Fn::GetAtt&quot;:[&quot;Instance1&quot;,&quot;AvailabilityZone&quot;]}
      }
    },
    &quot;Volume2&quot;:{
      &quot;Type&quot;:&quot;AWS::EC2::Volume&quot;,
      &quot;Properties&quot;:{
        &quot;Size&quot;:&quot;5&quot;,
        &quot;AvailabilityZone&quot;:{&quot;Fn::GetAtt&quot;:[&quot;Instance1&quot;,&quot;AvailabilityZone&quot;]}
      }
    },
    &quot;MountPoint1&quot;:{
      &quot;Type&quot;:&quot;AWS::EC2::VolumeAttachment&quot;,
      &quot;Properties&quot;:{
        &quot;InstanceId&quot;:{&quot;Ref&quot;:&quot;Instance1&quot;},
        &quot;VolumeId&quot;:{&quot;Ref&quot;:&quot;Volume1&quot;},
        &quot;Device&quot;:&quot;/dev/sdc&quot;
      }
    },
    &quot;Instance1&quot;:{
      &quot;Type&quot;:&quot;AWS::EC2::Instance&quot;,
      &quot;Properties&quot;:{
        &quot;ImageId&quot;:{&quot;Ref&quot;:&quot;ImageId&quot;}
      }
    },
    &quot;Instance2&quot;:{
      &quot;Type&quot;:&quot;AWS::EC2::Instance&quot;,
      &quot;Properties&quot;:{
        &quot;ImageId&quot;:{&quot;Ref&quot;:&quot;ImageId&quot;},
        &quot;Volumes&quot;:[{&quot;VolumeId&quot;:{&quot;Ref&quot;:&quot;Volume2&quot;},&quot;Device&quot;:&quot;/dev/sdc&quot;}]
      } 
    }
  }
}
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-21e29648ce96484797f4155e4f10cac0>3.14.3 - Troubleshooting CloudFormation</h1><p>This topic describes some of the issues that can happen with CloudFormation. It also talks about how you can detect these issues, and offers some ways to fix the issues.</p><h2 id=invalid-json>Invalid JSON</h2><p>JSON must be syntactically valid. For example, if you don&rsquo;t type in the final <code>}</code> character in a template, the <code>euform-create-stack</code> command returns an error message.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>euform-create-stack: error <span style=color:#ce5c00;font-weight:700>(</span>ValidationError<span style=color:#ce5c00;font-weight:700>)</span>: Unexpected end-of-input: 
</span></span><span style=display:flex><span>expected close marker <span style=color:#204a87;font-weight:700>for</span> OBJECT <span style=color:#ce5c00;font-weight:700>(</span>from <span style=color:#ce5c00;font-weight:700>[</span>Source: java.io.StringReader@56b3916d<span style=color:#000;font-weight:700>;</span> 
</span></span><span style=display:flex><span>line: 1, column: 0<span style=color:#ce5c00;font-weight:700>])</span> at <span style=color:#ce5c00;font-weight:700>[</span>Source: java.io.StringReader@56b3916d<span style=color:#000;font-weight:700>;</span> line: 38, 
</span></span><span style=display:flex><span>column : 849<span style=color:#ce5c00;font-weight:700>]</span>
</span></span></code></pre></div><p>If you see an error like this, there is most likely something syntactically wrong with your JSON template. Some editors can detect things like unbalanced parentheses, but in the worst case you can paste your template into this URL <a href=http://jsonparseronline.com/>http://jsonparseronline.com/</a> and it will help you find syntax errors.</p><h2 id=invalid-argument>Invalid Argument</h2><p>If you try to create, for example, a stack that already exists, you will get a simple error message.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>euform-create-stack: error <span style=color:#ce5c00;font-weight:700>(</span>AlreadyExists<span style=color:#ce5c00;font-weight:700>)</span>: Stack already exists
</span></span></code></pre></div><h2 id=invalid-reference>Invalid Reference</h2><p>If you use an invalid reference to, for example, a resource that doesn&rsquo;t exit, Eucalyptus returns a simple error message.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>euform-create-stack: error <span style=color:#ce5c00;font-weight:700>(</span>ValidationError<span style=color:#ce5c00;font-weight:700>)</span>: Template format error: Unresolved resource dependencies <span style=color:#ce5c00;font-weight:700>[</span>MySecurityGroup2<span style=color:#ce5c00;font-weight:700>]</span> in the Resources block of the template&gt;
</span></span></code></pre></div><h2 id=complex-errors>Complex Errors</h2><p>Not all errors are simple. We recommend that you use <code>euform-describe-stacks</code> (or <code>aws cloudformation describe-stacks</code>) and <code>euform-describe-stack-resources</code> to determine the current state of the stack. If there&rsquo;s an error, it will usually be shown in the <code>euform-describe-stack-events</code> output. Otherwise, you will have to dig into the <em>cloud-output.log</em> file for further information. You can also manually delete resources if they are causing issues. If a <code>euform-delete-stack</code> fails, you can delete the offending resource and try again.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-54de08f31ea3a000e9d4c449e213742a>3.15 - Using Virtual Private Cloud</h1><h1 id=using-virtual-private-cloud>Using Virtual Private Cloud</h1><p>Eucalyptus Virtual Private Cloud (VPC) is an implementation of Amazon VPC that allows you to define a logically isolated virtual network that can contain Eucalyptus resources. A virtual network enhances security by allowing you to have fine-grained, explicit control over network gateways, subnets, IP address ranges, and inbound and outbound connectivity. This section of the User Guide covers how Eucalyptus VPC works and how to use it.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>For more information about Amazon Virtual Private Cloud, see the .</div></p></div><div class=td-content style=page-break-before:always><h1 id=pg-98a4c8eabd3123e6c2febb3fc85d9a08>3.15.1 - How VPC Works</h1><h1 id=how-vpc-works>How VPC Works</h1><p>Eucalyptus Virtual Private Cloud (VPC) is an implementation of Amazon VPC that allows you to run instances inside an isolated virtual network that you define. Eucalyptus VPC enables you to have control over subnets, internet gateways, and IP address ranges and allocations inside of this virtual network, as well as the ability to define and use multiple layers of security with security groups.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-1476e25db6444279c953d0bf4910fee1>3.15.1.1 - Default VPCs</h1><p>Starting with Eucalyptus versions 4.1 and later, when you create an account in your Eucalyptus cloud in VPCMIDO network mode, you get a default VPC with a single public subnet and an attached Internet gateway. All instances that are created in this account that do not explicitly specify a VPC are placed into this default VPC and given a public IP address and behave like &lsquo;classic&rsquo; AWS EC2 instances.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-90f3cb02a25b58e0f1210668106b6e0b>3.15.1.2 - Subnets and IP Addressing</h1><p>A virtual private cloud (VPC) is a virtual network that is logically isolated from other virtual networks in your Eucalyptus cloud.</p><p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>For more information about CIDR notation, see the on Wikipedia.</div><strong>Private IP Addresses</strong></p><p>When you create a VPC, you can specify the range of IP addresses for your VPC using Classless Inter-Domain Routing (CIDR) notation. When you launch an instance (VM) in your VPC, you can assign a private IP address to the instance from this IP address range. If you don&rsquo;t explicitly assign a private IP address, one is assigned to the instance for you.</p><p><strong>Public IP Addresses</strong></p><p>By default, instances launched into the default subnet in your VPC receive a public IP address. This public IP address is assigned from a pool of public IP addresses, and is not associated with your account. This public IP address can&rsquo;t be manually added or removed from the VPC instance. The public IP address is mapped to the instance&rsquo;s private IP address using Network Address Translation (NAT).</p><p>You can control whether or not your VPC instances get a public IP address by either enabling/disabling the public IP address attribute of the subnet, or by overriding the subnet&rsquo;s behavior when launching an instance into the VPC.</p><p>If you want a persistent IP address for your VPC instance, you can use the <code>euca-allocate-address</code> to create an elastic IP address, and then use <code>euca-associate-address</code> to assign this address.</p><p><strong>Subnets</strong></p><p>Once you&rsquo;ve created a VPC, you can create one or more subnets inside the VPC. A subnet is simply a logical subdivision of a network of IP addresses. Subnets can be used to enable tighter security, allow separate administration of the network by organization, and enable more efficient network traffic by containing traffic between nodes in a subnet and using route tables for traffic that needs to move between subnets.</p><p>Note that subnets in a VPC cannot overlap; and the first four IP addresses and the last IP address are reserved for internal use. For example, of the 16 IP addresses of a /28 subnet, 11 are available for instances; of the 256 IP addresses of a /24 subnet, 251 are available for instances. Subnets must be larger than /28 and smaller than /16.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>For more information about subnets, see the on Wikipedia.</div></div><div class=td-content style=page-break-before:always><h1 id=pg-9696b58e42c55b3f2386909aefa32a8d>3.15.2 - Understanding VPC Networking Concepts</h1><h1 id=understanding-vpc-networking-concepts>Understanding VPC Networking Concepts</h1><p>This section discusses VPC networking concepts and terminology.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>This documentation assumes that you have some knowledge of IP addressing, CIDR, route tables, and subnets. See the links included throughout the documentation for more information on these topics.</div></p></div><div class=td-content><h1 id=pg-a2fc9c3cb43048d3dba6174f4d88338c>3.15.2.1 - Domain Name System (DNS)</h1><p>The Domain Name System (DNS) is an Internet standard that maps unique DNS names (for example: <a href=https://www.example.com>www.example.com</a>) to the underlying public IP address (for example: 128.0.0.1).</p><p>Eucalyptus provides a DNS service with your cloud. By default, EC2 classic (EDGE mode) and VPCMIDO mode default subnet instances that are launched in your Eucalyptus cloud are automatically assigned public and private DNS names from the Eucalyptus DNS service.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-c0b77bfe05ecbbbc8b0c5c63a84365ae>3.15.2.2 - Elastic Network Interfaces (ENIs)</h1><p>In Eucalyptus VPC, networking to instances (VMs) is delivered in the form of Elastic Network Interfaces (ENIs). ENIs are virtual network interfaces that can be attached to and/or detached from instances in a VPC.</p><p>Attributes of an ENI (private address, public address, Elastic IP, MAC address, security groups, and source/destination check flag) follow the ENI as it is detached from an instance and attached to another instance. An instance in a VPC has a default ENI attached, which is called the primary ENI. The Primary ENI cannot be detached.</p><p>Additional ENIs (up to a total of eight) can be attached to instances as needed. ENIs in different subnets can be attached to the same instance, but all ENIs and the instance must reside in the same Availability Zone. Users may need to manually bring up and configure secondary ENIs from within instances.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-17b230366694602b68dca7534531c6b5>3.15.2.3 - Route Tables</h1><p>A route table defines how traffic is directed in your network. Each subnet in your network has to be associated with one (and only one) route table, but a route table can have multiple subnets associated with it. A default route table (which simply contains a local route that allows communication within the VPC) is automatically created for you when you create your VPC. New subnets will get this route table by default, but you can replace it with a custom route table that enables you to explicitly control subnet traffic.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>For more information on route tables, see the on Wikipedia.</div></div><div class=td-content style=page-break-before:always><h1 id=pg-813b39755fd2696456e6c9e942b46520>3.15.2.4 - Internet Gateways</h1><p>An Internet gateway is an object that runs inside of your VPC and provides communication between VPC instances and the Internet.</p><p>To use an Internet gateway in your VPC, you attach the gateway to your VPC, make sure your route tables direct Internet traffic to the Internet gateway, and configure your security groups to allow traffic through.</p><p>By default, instances loaded into any non-default VPC have private IP addresses (so they can communicate with other instances in the same VPC), but they do not have public IP addresses. For an instance to be able to communicate with the Internet gateway, it must have an associated public IP address. The default VPC comes with a pre-configured Internet gateway, and all instances that are launched into the default subnet receive a public IP address, so these instances have Internet access.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-16a25a9a6d471ed2564d98fdb25c53e7>3.15.2.5 - Network Address Translation (NAT) Gateways</h1><p>NAT Gateways enable instances in private VPC subnets to initiate communication with the Internet (and receive responses), but prevents connections to be initiated from the Internet. Traffic bound to the Internet from instances in private subnets should be directed to a NAT gateway (through the use of route tables), which will translate the source address to its own Elastic IP and route it to the Internet. The destination will send a response back to the Elastic IP (i.e., the NAT gateway), where the address translation will be reversed and delivered to the originating private IP.</p><p>NAT Gateways should be created in public VPC subnets, and have an Elastic IP associated. Private VPC subnets should have its route table manually updated to direct Internet-bound traffic to a NAT gateway.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-364ac051523babdcea4194ceefceb519>3.15.3 - VPC Security Concepts</h1><h1 id=vpc-security-concepts>VPC Security Concepts</h1><p>This section discusses VPC security concepts and terminology.</p></div><div class=td-content><h1 id=pg-e051c24ce8cd658239c4695c54061aff>3.15.3.1 - Security Groups</h1><p>A security group is a mechanism that allows you to control inbound and outbound traffic for your VPC. A security group has rules that specify what kinds of traffic are allowed in and out of instances (VMs) running in your VPC.</p><p>A VPC comes with a default security group that allows inbound traffic from other instances assigned to the same security group, and allows all outbound traffic. You can change the rules for the default security group, but you can&rsquo;t delete it.</p><p>If you don&rsquo;t specify a security group when you launch an instance in your VPC, the instance will be associated with the default security group.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-48f04918ab7d0b3b8f48499011af68a2>4 - Identity and Access Management (IAM) Guide</h1><h1 id=identity-and-access-management-iam-guide>Identity and Access Management (IAM) Guide</h1><p>This section contains concepts and tasks to help you securely control access to services and resources for your Eucalyptus cloud users.</p></div><div class=td-content><h1 id=pg-f6da8fc8ef0827125e645306bec13ada>4.1 - IAM Overview</h1><p>Welcome to the IAM Guide. IAM is an acronymn for Identity Access Management. IAM is used for account management where a cloud administrator establishs accounts, users and their identities. You can do many things with IAM, including:</p><ul><li>Create and manage IAM users and groups</li><li>Set quotas</li><li>Establish access policies</li><li>Create and manage roles</li></ul><p>This document is intended to be a reference. You do not need to read it in order, unless you are following the directions for a particular task.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-69ad99986647a1ebf7fd6be4ffbfa240>4.2 - Work with IAM</h1><p>The Eucalyptus IAM design provides more layers in the hierarchical organization of user identities, and more refined control over resource access. This complies with the Amazon AWS IAM service. There are a few Eucalyptus-specific extensions to meet the needs of enterprise customers. The IAM service is a global service, meaning a user can interact with any region using the same credentials, subjected to the same policies, and having uniformly accessible and structured principals (accounts, users, groups, roles, etc.)</p></div><div class=td-content style=page-break-before:always><h1 id=pg-90c01c24a1427f3b5047b1d987236d28>4.3 - Manage Identities Overview</h1><p>Like IAM, the user identities in Eucalyptus are organized into Accounts. An account is the unit of resource usage accounting, and also a separate name space for many resources, for example, security groups, key pairs, users, and so on. Unique ID (UUID) or a unique name identifies an account. The account name is equivalent to IAM’s account alias. In Eucalyptus, the account name is used to manipulate accounts in most cases. However, to be compatible with AWS, the EC2 commands often use account ID to display resource ownership. There are command line tools to discover the correspondence of account ID with the account name. For example, lists all the accounts with both their IDs and names.
<img src=https://www.eucastack.io/images/iam_diagram.png alt=image>
An account can have multiple users, but a user can only be in one account. Within an account, users can be associated with Groups. A Group is used to attach access permissions to multiple users. A user can be associated with multiple groups. Because an account is a separate name space, user names and group names have to be unique only within an account. Therefore, user X in account A and user X in account B are two different identities. Both users and groups are identified by their names, which are unique within an account (they also have UUIDs, but rarely used).</p></div><div class=td-content style=page-break-before:always><h1 id=pg-96fced99c900b9e11c51c5f599ea87fa>4.4 - Authentication and Access Control Best Practices</h1><p>This topic describes best practices for Identity and Access Management and the account.</p><h2 id=identity-and-access-management>Identity and Access Management</h2><p>Eucalyptus manages access control through an authentication, authorization, and accounting system. This system manages user identities, enforces access controls over resources, and provides reporting on resource usage as a basis for auditing and managing cloud activities. The user identity organizational model and the scheme of authorizations used to access resources are based on and compatible with the AWS Identity and Access Management (IAM) system, with some Eucalyptus extensions provided that support ease-of-use in a private cloud environment.</p><p>For a general introduction to IAM in Eucalyptus, see <a href=https://www.eucastack.io/docs/iam_guide/managing_auth/understanding_identities/concepts_eiam/>Access Concepts</a> in the IAM Guide. For information about using IAM quotas to enforce limits on resource usage by users and accounts in Eucalyptus, see the <a href=https://www.eucastack.io/docs/iam_guide/managing_auth/understanding_identities/access_policies/access_policy_quota/>Quotas</a> section in the IAM Guide.</p><p>The <a href=http://docs.aws.amazon.com/IAM/latest/UserGuide/IAMBestPractices.html>Amazon Web Services IAM Best Practices</a> are also generally applicable to Eucalyptus.</p><h2 id=credential-management>Credential Management</h2><p>Protection and careful management of user credentials (passwords, access keys, X.509 certificates, and key pairs) is critical to cloud security. When dealing with credentials, we recommend:</p><ul><li>Limit the number of active credentials and do not create more credentials than needed.</li><li>Only create users and credentials for the interfaces that you will actually use. For example, if a user is only going to use the Management Console, do not create credentials access keys for that user.</li><li>Use and or to get a specific set of credentials if needed.</li><li>Regularly check for active credentials using commands and remove unused credentials. Ideally, only one pair of active credentials should be available at any time.</li><li>Rotate credentials regularly and delete old credentials as soon as possible. Credentials can be created and deleted using commands, such as and .</li><li>When rotating credentials, there is an option to deactivate, instead of removing, existing access/secret keys and X.509 certificates. Requests made using deactivated credentials will not be accepted, but the credentials remain in the Eucalyptus database and can be restored if needed. You can deactivate credentials using and .</li></ul><h2 id=privileged-roles>Privileged Roles</h2><p>The <code>eucalyptus</code> account is a super-privileged account in Eucalyptus. It has access to all cloud resources, cloud setup, and management. The users within this account do not obey IAM policies and compromised credentials can result in a complete cloud compromisation that is not easy to contain. We recommend limiting the use of this account and associated users&rsquo; credentials as much as possible.</p><p>For all unprivileged operations, use regular accounts. If you require super-privileged access (for example, management of resources across accounts and cloud setup administration), we recommend that you use one of the predefined privileged roles.</p><p>The Account, Infrastructure, and Resource Administrator <a href=https://www.eucastack.io/docs/iam_guide/managing_auth/understanding_identities/concepts_eiam/access_roles/>roles</a> provide a more secure way to gain super privileges in the cloud. Credentials returned by an assume-role operation are short-lived (unlike regular user credentials). Privileges available to each role are limited in scope and can be revoked easily by modifying the trust or access policy for the role.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-5085d7067a5b593ef29e26bb3ecd627d>4.5 - Manage Users and Groups</h1><h1 id=manage-users-and-groups>Manage Users and Groups</h1><p>Eucalyptus IAM supports user, group, and role based access controls and STS (Security Token Service) for temporary credentials.</p></div><div class=td-content><h1 id=pg-5fca87e4a6c9e3079871a4b36ee5dedb>4.5.1 - Access Overview</h1><h1 id=access-overview>Access Overview</h1><p>The Eucalyptus design of user identity and access management provides layers in the organization of user identities. This gives you refined control over resource access. Though compatible with the AWS IAM, there are also a few Eucalyptus-specific extensions.</p></div><div class=td-content><h1 id=pg-b42155c89673875a0b80cbb32539bc6e>4.5.1.1 - Access Concepts</h1><h1 id=access-concepts>Access Concepts</h1><p>This section describes what Eucalyptus access is and what you need to know about it so that you can configure access to your cloud.</p></div><div class=td-content><h1 id=pg-3a29bfab6ef24865dd5d8def713c0463>4.5.1.1.1 - User Identities</h1><p>In Eucalyptus, user identities are organized into accounts. An account is the unit of resource usage accounting, and also a separate namespace for many resources (security groups, key pairs, users, etc.).Accounts are identified by either a unique ID (UUID) or a unique name. The account name is like IAM’s account alias. It is used to manipulate accounts. However, for AWS compatibility, the EC2 commands often use account ID to display resource ownership.</p><p>There are command line tools to discover the correspondence of account ID and account name. For example, euare-accountlist lists all the accounts with both their IDs and names.</p><p>An account can have multiple users, but a user can only be in one account. Within an account, users can be associated with Groups. Group is used to attach access permissions to multiple users. A user can be associated with multiple groups. Because an account is a separate name space, user names and group names have to be unique only within an account. Therefore, user X in account A and user X in account B are two different identities.</p><p>Both users and groups are identified by their names, which are unique within an account (they also have UUIDs, but are rarely used).</p></div><div class=td-content style=page-break-before:always><h1 id=pg-41f08888d693ab8ca7df8e8896ef2b2c>4.5.1.1.2 - Special Identities</h1><p>Eucalyptus has two special identities for the convenience of administration and use of the system.</p><ul><li>The account: Each user in the eucalyptus account has unrestricted access to all of the cloud&rsquo;s resources, similar to the superuser on a typical Linux system. These users are often referred to as system administrators or cloud administrators. This account is automatically created when the system starts for the first time. You cannot remove the eucalyptus account from the system.</li><li>The user of an account: Each account, including the eucalyptus account, has a user named admin. This user is created automatically by the system when an account is created. The admin of an account has full access to the resources owned by the account. You can not remove the admin user from an account. The admin can delegate resource access to other users in the account by using policies.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-5f719c74a4c9fdeafacfb5d3a81eed5b>4.5.1.1.3 - Credentials</h1><p>This topic describes the different types of credentials used by Eucalyptus.Each user has a unique set of credentials. These credentials are used to authenticate access to resources. There are three types of credentials:</p><ul><li>An is used to authenticate requests to the SOAP API service.</li><li>A is used to authenticate requests to the REST API service.
You can manage credentials using the command line tools (the <code>euare-</code> commands).</li></ul><p>In IAM, each account has its own credentials. In Eucalyptus, the equivalent of account credentials are the credentials of admin user of the account.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-2b47b57b4394be60269a788523a4d435>4.5.1.1.4 - Account Creation</h1><p>This topic describes the process for creating an account using the command line tool.You must be a cloud administrator to use this command. Accounts created are available for immediate access.</p><p>To create an account, run the following command:</p><pre><code>euare-accountcreate -a account_name
</code></pre><p>When an account is created by <code>euare-accountcreate</code> command, an &ldquo;admin&rdquo; user is created by default.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Note the following security considerations of the &ldquo;admin&rdquo; user when an account is initially created:</div><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Eucalyptus has discontinued account registration status retrieval, however, for compatibility with older versions of Eucalyptus, the ability to view and manipulate registration status is limited to the system administrator through Euca2ools. For more information about the command line tools, see the .</div></div><div class=td-content style=page-break-before:always><h1 id=pg-ef6bd0d48c0481e73fc7d1380b447e84>4.5.1.1.5 - Special User Attributes</h1><p>Eucalyptus extends the IAM model by providing the following extra attributes for a user.</p><ul><li>This is only meaningful for the account administrator (that is, the account level).</li><li>. Use this attribute to temporarily disable a user.</li><li></li><li>Add any name-value pair to a user’s custom information attribute. This is useful for attaching pure text information, like an address, phone number, or department.
You can retrieve and modify the registration status, enabled status, and password expiration date using the <code>euare-usergetattributes</code> and <code>euare-usermod</code> commands. You can retrieve and modify custom information using <code>euare-usergetinfo</code> and <code>euare-userupdateinfo</code> commands.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-4c249034d75e75bbe34ed2b982efd5ef>4.5.1.1.6 - Roles</h1><p>A <em>role</em> A role is a mechanism that enables the delegation of access to users or applications.</p><p>A role is associated with an account, and has a set of permissions associated with it that are defined in the form of an IAM <em>policy</em> . A policy specifies a set of actions and resources within that account that the role is allowed to access.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>For more information on policies, see Policy Overview.</div></p><p>By assuming a role, a user or an applications gets a set of permissions associated with that role. When a role is assumed, the Eucalyptus STS service returns a set of temporary security credentials that can then be used to make programmatic requests to resources in your account. This eliminates the need to share or hardcode security credentials with applications that need access to resources in your cloud.</p><p>Eucalyptus roles are managed through the Eucalyptus Euare service, which is compatible with Amazon&rsquo;s Identity and Access Management service. For more information on IAM and roles, please see the <a href=http://docs.aws.amazon.com/IAM/latest/UserGuide/WorkingWithRoles.html>Amazon IAM User Guide</a> .</p><h2 id=usage-scenarios-for-roles>Usage Scenarios for Roles</h2><p>There are several scenarios in which roles can be useful, including:</p><p><strong>Applications</strong></p><p>Applications running on instances in your Eucalyptus cloud will often need access to other resources in your cloud. Instead of creating AWS credentials for each application, or distributing your own credentials,, you can use roles to enable you to delegate permission to the application to make API requests. For more information, see <a href=https://www.eucastack.io/docs/iam_guide/managing_auth/eiam_task_oview/roles_tasks/roles_tasks_create_role_application/>Launch an Instance with a Role</a> .</p><p><strong>Account Delegation</strong></p><p>You can use roles to allow one account to access resources owned by another account. IAM Roles under the &rsquo;eucalyptus&rsquo; account can be assumed by users under &rsquo;non-eucalyptus&rsquo; account(s). For example, if you had an &lsquo;infrastructure auditing&rsquo; account, and an audit was needed to be performed on all the cloud resources used on the cloud, a user could assume the &lsquo;Resource Administrator&rsquo; role and audit all the resources used by all the accounts on the cloud. For more information on IAM account delegation, see <a href=http://docs.aws.amazon.com/IAM/latest/UserGuide/roles-toplevel.html>Using Roles to Delegate Permissions and Federate Identities</a> . Also, go to the walkthrough provided in the <a href=http://docs.aws.amazon.com/IAM/latest/UserGuide/roles-walkthrough-crossacct.html>AWS Identity and Access Management</a> section of the AWS documentation.</p><h2 id=pre-defined-roles>Pre-Defined Roles</h2><p>Eucalyptus offers a number of pre-defined privileged roles. These roles are associated with the <code>eucalyptus</code> account, and have privileges to manage resources across the cloud and non-privileged accounts. Only the eucalyptus account can manage or modify these roles.</p><p>To see the pre-defined roles, use <code>euare-rolelistbypath</code> with the credentials of a user that is part of the <code>eucalyptus</code> account. For example:</p><pre><code># euare-rolelistbypath 
arn:aws:iam::944786667073:role/eucalyptus/AccountAdministrator
arn:aws:iam::944786667073:role/eucalyptus/InfrastructureAdministrator
arn:aws:iam::944786667073:role/eucalyptus/ResourceAdministrator
</code></pre><p><strong>Account Administrator</strong></p><p>The Account Administrator (AA) can manage Eucalyptus accounts. To view the policy associated with the Account Administrator role, use <code>euare-rolelistpolicies</code> with the credentials of a user that is part of the <code>eucalyptus</code> account. For example:</p><pre><code># euare-rolelistpolicies --role-name AccountAdministrator --verbose
AccountAdministrator
{
  &quot;Statement&quot;:[ {
    &quot;Effect&quot;: &quot;Allow&quot;,
    &quot;Action&quot;: [
      &quot;iam:*&quot;
    ],
    &quot;NotResource&quot;: &quot;arn:aws:iam::eucalyptus:*&quot;,
    &quot;Condition&quot;: {
      &quot;Bool&quot;: { &quot;iam:SystemAccount&quot;: &quot;false&quot; }
    }
  } ]
}
IsTruncated: false
</code></pre><p><strong>Resource Administrator</strong></p><p>The Resource Administrator (RA) can manage AWS-defined resources (such as S3 objects, instances, users, etc) across accounts. To view the policy associated with the Resource Administrator role, use <code>euare-rolelistpolicies</code> with the credentials of a user that is part of the <code>eucalyptus</code> account. For example:</p><pre><code># euare-rolelistpolicies --role-name ResourceAdministrator --verbose
ResourceAdministrator
{
  &quot;Statement&quot;:[ {
    &quot;Effect&quot;: &quot;Allow&quot;,
    &quot;Action&quot;: [
      &quot;autoscaling:*&quot;,
      &quot;cloudwatch:*&quot;,
      &quot;ec2:DescribeInstanceAttribute&quot;,
      &quot;ec2:DescribeInstances&quot;,
      &quot;ec2:DescribeInstanceStatus&quot;,
      &quot;ec2:DescribeInstanceTypes&quot;,
      &quot;ec2:GetConsoleOutput&quot;,
      &quot;ec2:GetPasswordData&quot;,
      &quot;ec2:ImportInstance&quot;,
      &quot;ec2:ModifyInstanceAttribute&quot;,
      &quot;ec2:MonitorInstances&quot;,
      &quot;ec2:RebootInstances&quot;,
      &quot;ec2:ReportInstanceStatus&quot;,
      &quot;ec2:ResetInstanceAttribute&quot;,
      &quot;ec2:RunInstances&quot;,
      &quot;ec2:StartInstances&quot;,
      &quot;ec2:StopInstances&quot;,
      &quot;ec2:TerminateInstances&quot;,
      &quot;ec2:UnmonitorInstances&quot;,
      &quot;ec2:*AccountAttributes*&quot;,
      &quot;ec2:*Address*&quot;,
      &quot;ec2:*AvailabilityZones*&quot;,
      &quot;ec2:*Bundle*&quot;,
      &quot;ec2:*ConversionTask*&quot;,
      &quot;ec2:*CustomerGateway*&quot;,
      &quot;ec2:*DhcpOptions*&quot;,
      &quot;ec2:*ExportTask*&quot;,
      &quot;ec2:*Image*&quot;,
      &quot;ec2:*InternetGateway*&quot;,
      &quot;ec2:*KeyPair*&quot;,
      &quot;ec2:*NetworkAcl*&quot;,
      &quot;ec2:*NetworkInterface*&quot;,
      &quot;ec2:*PlacementGroup*&quot;,
      &quot;ec2:*ProductInstance*&quot;,
      &quot;ec2:*Region*&quot;,
      &quot;ec2:*ReservedInstance*&quot;,
      &quot;ec2:*Route*&quot;,
      &quot;ec2:*SecurityGroup*&quot;,
      &quot;ec2:*Snapshot*&quot;,
      &quot;ec2:*SpotDatafeedSubscription*&quot;,
      &quot;ec2:*SpotInstance*&quot;,
      &quot;ec2:*SpotPrice*&quot;,
      &quot;ec2:*Subnet*&quot;,
      &quot;ec2:*Tag*&quot;,
      &quot;ec2:*Volume*&quot;,
      &quot;ec2:*Vpc*&quot;,
      &quot;ec2:*Vpn*&quot;,
      &quot;ec2:*VpnGateway*&quot;,
      &quot;elasticloadbalancing:*&quot;,
      &quot;s3:*&quot;
    ],
    &quot;Resource&quot;: &quot;*&quot;
  }, {
    &quot;Effect&quot;: &quot;Allow&quot;,
    &quot;Action&quot;: [
      &quot;iam:Get*&quot;,
      &quot;iam:List*&quot;
    ],
    &quot;NotResource&quot;: &quot;arn:aws:iam::eucalyptus:*&quot;
  } ]
}
IsTruncated: false
</code></pre><p><strong>Infrastructure Administrator</strong></p><p>The Infrastructre Administrator (IA) can perform operations related to cloud setup and management. Typical responibilities include:</p><ul><li><p>Installation and configuration (prepare environment, install Eucalyptus, configure Eucalyptus)</p></li><li><p>Monitoring and maintenance (infrastructure supporting the cloud, cloud management layer, upgrades, security patches, diagnostics and troubleshooting)</p></li><li><p>Backup and restoration
To view the policy associated with the Infrastructure Administrator role, use <code>euare-rolelistpolicies</code> with the credentials of a user that is part of the <code>eucalyptus</code> account. For example:</p><h1 id=euare-rolelistpolicies---role-name-infrastructureadministrator---verbose>euare-rolelistpolicies &ndash;role-name InfrastructureAdministrator &ndash;verbose</h1><p>InfrastructureAdministrator
{
&ldquo;Statement&rdquo;:[ {
&ldquo;Effect&rdquo;: &ldquo;Allow&rdquo;,
&ldquo;Action&rdquo;: [
&ldquo;euprop:<em>&rdquo;,
&ldquo;euserv:</em>&rdquo;,
&ldquo;euconfig:<em>&rdquo;,
&ldquo;ec2:MigrateInstances&rdquo;
],
&ldquo;Resource&rdquo;: &ldquo;</em>&rdquo;
} ]
}
IsTruncated: false</p></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-10ac73830e44db67e0bd489683d323c9>4.5.1.2 - Policy Overview</h1><h1 id=policy-overview>Policy Overview</h1><p>Eucalyptus uses the policy language to specify user level permissions as AWS IAM. Policies are written in JSON. Each policy file can contain multiple statements, each specifying a permission.A permission statement specifies whether to allow or deny a list of actions to be performed on a list of resources, under specific conditions.</p><p>A permission statement has the following components:</p><ul><li>Begins the decision that applies to all following components. Either: or</li><li>Indicates service-specific and case-sensitive commands. For example:</li><li>Indicates selected resources, each specified as an Amazon resource name (ARN). For example:</li><li>Indicates additional constraints of the permission. For example:</li></ul><p>The following policy example contains a statement that gives a user with full permission. This is the same access as the account administrator:</p><pre><code>{
  &quot;Version&quot;:&quot;2011-04-01&quot;,
 	&quot;Statement&quot;:[{
 	  &quot;Sid&quot;:&quot;1&quot;,
 	  &quot;Effect&quot;:&quot;Allow&quot;,
 	  &quot;Action&quot;:&quot;*&quot;,
 	  &quot;Resource&quot;:&quot;*&quot;
 	}]
}
</code></pre><p>For more information about policy language, go to the <a href=http://docs.amazonwebservices.com/IAM/latest/UserGuide/PermissionsOverview.html>IAM User Guide</a> .</p><h2 id=policy-notes>Policy Notes</h2><p>You can combine IAM policies with account level permissions. For example, the admin of account A can give users in account B permission to launch one of account A’s images by changing the image attributes. Then the admin of account B can use IAM policy to designate the users who can actually use the shared images.</p><p>You can attach IAM policies to both users and groups. When attached to groups, a policy is equivalent to attaching the same policy to the users within that group. Therefore, a user might have multiple policies attached, both policies attached to the user, and policies attached to the group that the user belongs to.</p><p>Do not attach IAM policies (except quota policies, a Eucalyptus extension) to account admins. At this point, doing so won’t result in a failure but may have unexpected consequences.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-5b6c57aa0721763e54d72328818b1489>4.5.1.2.1 - Default Permissions</h1><p>Different identities have different default access permissions. When no policy is associated with them, these identities have the permission listed in the following table.</p><table><thead><tr><th style=text-align:left>Identity</th><th style=text-align:left>Permission</th></tr></thead><tbody><tr><td style=text-align:left>System admin</td><td style=text-align:left>Access to all resources in the system</td></tr><tr><td style=text-align:left>Account admin</td><td style=text-align:left>Access to all account resources, including those shared resources from other accounts like public images and shared snapshots</td></tr><tr><td style=text-align:left>Regular user</td><td style=text-align:left>No access to any resource</td></tr></tbody></table></div><div class=td-content style=page-break-before:always><h1 id=pg-1df740d0f1d9b6aee225cc02210fdb78>4.5.1.2.2 - Quotas</h1><p>Eucalyptus adds quota enforcement to resource usage. To avoid introducing another configuration language into Eucalyptus, and simplify the management, we extend the IAM policy language to support quotas.The only addition added to the language is the new <code>limit</code> effect. If a policy statement’s <code>effect</code> is <code>limit</code> , it is a quota statement.</p><p>A quota statement also has action and resource fields. You can use these fields to match specific requests, for example, quota only being checked on matched requests. The actual quota type and value are specified using special quota keys, and listed in the <code>condition</code> part of the statement. Only condition type <code>NumericLessThanEquals</code> can be used with quota keys.</p><p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>An account can only have a quota policy. Accounts can only accept IAM policies where Effect is &ldquo;Deny&rdquo; or &ldquo;Limit&rdquo;. If you attach an IAM policy to an account where the Effect is &ldquo;Allow&rdquo;, you will get unexpected results.</div>The following quota policy statement limits the attached user to only launch a maximum of 16 instances in an account.</p><pre><code>{
 &quot;Version&quot;:&quot;2011-04-01&quot;,
 &quot;Statement&quot;:[{
   &quot;Sid&quot;:&quot;4&quot;,
   &quot;Effect&quot;:&quot;Limit&quot;,
   &quot;Action&quot;:&quot;ec2:RunInstances&quot;,
   &quot;Resource&quot;:&quot;*&quot;,
   &quot;Condition&quot;:{
     “NumericLessThanEquals”:{
       “ec2:quota-vminstancenumber”:”16”
     }
   }
 }]
}
</code></pre><p>You can attach quotas to both users and accounts, although some of the quotas only apply to accounts. Quota attached to groups will take no effect.</p><p>When a quota policy is attached to an account, it actually is attached to the account administrator user. Since only system administrator can specify account quotas, the account administrator can only inspect quotas but can&rsquo;t change the quotas attached to herself.</p><p>The following is all the quota keys implemented in Eucalyptus:</p><table><thead><tr><th style=text-align:left>Quota Key</th><th style=text-align:left>Description</th><th style=text-align:left>Applies to</th></tr></thead><tbody><tr><td style=text-align:left>autoscaling:quota-autoscalinggroupnumber</td><td style=text-align:left>The number of Autoscaling Groups</td><td style=text-align:left>account and user</td></tr><tr><td style=text-align:left>autoscaling:quota-launchconfigurationnumber</td><td style=text-align:left>Number of Autoscaling Group Launch Configurations</td><td style=text-align:left>account and user</td></tr><tr><td style=text-align:left>autoscaling:quota-scalingpolicynumber</td><td style=text-align:left>Number of Autoscaling Group Scaling Policies</td><td style=text-align:left>account and user</td></tr><tr><td style=text-align:left>cloudformation:quota-stacknumber</td><td style=text-align:left>Number of Cloudformation stacks allowed to create</td><td style=text-align:left>account</td></tr><tr><td style=text-align:left>ec2:quota-addressnumber</td><td style=text-align:left>Number of elastic IPs</td><td style=text-align:left>account and user</td></tr><tr><td style=text-align:left>ec2:quota-cputotalsize</td><td style=text-align:left>Number of Total CPUs Used by EC2 Instances</td><td style=text-align:left>account and user</td></tr><tr><td style=text-align:left>ec2:quota-disktotalsize</td><td style=text-align:left>Number of Total Disk Space (in GB) of EC2 Instances</td><td style=text-align:left>account and user</td></tr><tr><td style=text-align:left>ec2:quota-imagenumber</td><td style=text-align:left>Number of EC2 images</td><td style=text-align:left>account and user</td></tr><tr><td style=text-align:left>ec2:quota-internetgatewaynumber</td><td style=text-align:left>Number of EC2 VPC Internet Gateways</td><td style=text-align:left>account and user</td></tr><tr><td style=text-align:left>ec2:quota-memorytotalsize</td><td style=text-align:left>Number of Total Amount of Memory Used by EC2 Instances</td><td style=text-align:left>account and user</td></tr><tr><td style=text-align:left>ec2:quota-securitygroupnumber</td><td style=text-align:left>Number of EC2 security groups</td><td style=text-align:left>account and user</td></tr><tr><td style=text-align:left>ec2:quota-snapshotnumber</td><td style=text-align:left>Number of EC2 snapshots</td><td style=text-align:left>account and user</td></tr><tr><td style=text-align:left>ec2:quota-vminstancenumber</td><td style=text-align:left>Number of EC2 instances</td><td style=text-align:left>account and user</td></tr><tr><td style=text-align:left>ec2:quota-vminstanceactivenumber</td><td style=text-align:left>Number of EC2 Instances Using Node Resources (pending, running, shutting-down, etc.)</td><td style=text-align:left>account and user</td></tr><tr><td style=text-align:left>ec2:quota-volumenumber</td><td style=text-align:left>Number of EC2 volumes</td><td style=text-align:left>account and user</td></tr><tr><td style=text-align:left>ec2:quota-volumetotalsize</td><td style=text-align:left>Number of total volume size, in GB</td><td style=text-align:left>account and user</td></tr><tr><td style=text-align:left>ec2:quota-vpcnumber</td><td style=text-align:left>Number of EC2 VPCs</td><td style=text-align:left>account and user</td></tr><tr><td style=text-align:left>elasticloadbalancing:quota-loadbalancernumber</td><td style=text-align:left>Number of Elastic Load Balancers</td><td style=text-align:left>account</td></tr><tr><td style=text-align:left>iam:quota-groupnumber</td><td style=text-align:left>Number of IAM groups</td><td style=text-align:left>account</td></tr><tr><td style=text-align:left>iam:quota-instanceprofilenumber</td><td style=text-align:left>Number of IAM Instance Profiles</td><td style=text-align:left>account and user</td></tr><tr><td style=text-align:left>iam:quota-rolenumber</td><td style=text-align:left>Number of IAM Roles</td><td style=text-align:left>account and user</td></tr><tr><td style=text-align:left>iam:quota-servercertificatenumber</td><td style=text-align:left>Number of IAM Server Certificates</td><td style=text-align:left>account and user</td></tr><tr><td style=text-align:left>iam:quota-usernumber</td><td style=text-align:left>Number of IAM users</td><td style=text-align:left>account</td></tr><tr><td style=text-align:left>s3:quota-bucketnumber</td><td style=text-align:left>Number of S3 buckets</td><td style=text-align:left>account and user</td></tr><tr><td style=text-align:left>s3:quota-bucketobjectnumber</td><td style=text-align:left>Number of objects in each bucket</td><td style=text-align:left>account and user</td></tr><tr><td style=text-align:left>s3:quota-bucketsize</td><td style=text-align:left>Size of bucket, in MB</td><td style=text-align:left>account and user</td></tr><tr><td style=text-align:left>s3:quota-buckettotalsize</td><td style=text-align:left>total size of all buckets, in MB</td><td style=text-align:left>account and user</td></tr></tbody></table><h2 id=default-quota>Default Quota</h2><p>Contrary to IAM policies, by default, there is no quota limits (except the hard system limit) on any resource allocations for a user or an account. Also, system administrators are not constrained by any quota. Account administrators are only be constrained by account quota.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-2fd1500750414686247b9a98920b6a79>4.5.1.2.3 - Algorithms</h1><p>This topic describes the algorithms used by Eucalyptus to determine access.</p><h2 id=policy-evaluation-algorithm>Policy Evaluation Algorithm</h2><p>You can associated multiple policies and permission statements with a user. The way these are combined together to control the access to resources in an account is defined by the policy evaluation algorithm. Eucalyptus implements the <a href=http://docs.aws.amazon.com/IAM/latest/UserGuide/AccessPolicyLanguage_EvaluationLogic.html>same policy evaluation algorithm as AWS IAM</a> :</p><ol><li>If the request user is account admin, access is allowed.</li><li>Otherwise, collect all the policy statements associated with the request user (attached to the user and all the groups the user belongs to), which match the incoming request (i.e. based on the API being invoked and the resources it is going to access).</li></ol><h2 id=access-evaluation-algorithm>Access Evaluation Algorithm</h2><p>Now we give the overall access evaluation combining both account level permissions and IAM permissions, which decides whether a request is accepted by Eucalyptus:</p><ol><li>If the request user is sys admin, access is allowed.</li><li>Otherwise, check account level permissions, e.g. image launch permission, to see if the request user’s account has access to the specific resources.</li></ol><h2 id=quota-evaluation-algorithm>Quota Evaluation Algorithm</h2><p>Like the normal IAM policies, a user may be associated with multiple quota policies (and multiple quota statements). How all the quota policies are combined to take effect is defined by the quota evaluation algorithm:</p><ol><li>If the request user is sys admin, there is no limit on resource usage.</li><li>Otherwise, collect all the quotas associated with the request user, including those attached to the request user’s account and those attached to the request user himself/herself (for account admin, we only need collect account quotas).</li><li>Evaluate each quota one by one. Reject the request as long as there is one quota being exceeded by the request. Otherwise, accept the request.</li></ol><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>The hard limits on some resources override quota limits. For example, (system property) overrides the (quota key).</div></div><div class=td-content style=page-break-before:always><h1 id=pg-a50cea07654bcd0b3fba9751d30080ef>4.5.1.2.4 - Sample Policies</h1><p>A few example use cases and associated policies.Here are some example use cases and associated polices. You can edit these polices for your use, or use them as examples of JSON syntax and form.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>For more information about JSON syntax used with AWS resources, go to .</div><h2 id=examples-allowing-specific-actions>Examples: Allowing Specific Actions</h2><p>The following policy allows a user to only run instances and describe things.</p><pre><code>{
   &quot;Statement&quot;:[{
      &quot;Effect&quot;:&quot;Allow&quot;,
      &quot;Action&quot;:[&quot;ec2:*Describe*&quot;,​&quot;ec2:*Run*&quot;],
      &quot;Resource&quot;:&quot;*&quot;,
      }
   ]
   }
</code></pre><p>The following policy allows a user to only list things:</p><pre><code>{
  &quot;Statement&quot;: [
    {
      &quot;Sid&quot;: &quot;Stmt1313686153864&quot;,
      &quot;Action&quot;: [
        &quot;iam:List*&quot;
      ],
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Resource&quot;: &quot;*&quot;
    }
  ]
  }
</code></pre><p>The following policy grants a generic basic user permission for running instances and describing things.</p><pre><code>{
  &quot;Statement&quot;: [
    {
      &quot;Sid&quot;: &quot;Stmt1313605116084&quot;,
      &quot;Action&quot;: [
        &quot;ec2:AllocateAddress&quot;,
        &quot;ec2:AssociateAddress&quot;,
        &quot;ec2:AttachVolume&quot;,
        &quot;ec2:Authorize*&quot;,
        &quot;ec2:CreateKeyPair&quot;,
        &quot;ec2:CreateSecurityGroup&quot;,
        &quot;ec2:CreateSnapshot&quot;,
        &quot;ec2:CreateVolume&quot;,
        &quot;ec2:DeleteKeyPair&quot;,
        &quot;ec2:DeleteSecurityGroup&quot;,
        &quot;ec2:DeleteSnapshot&quot;,
        &quot;ec2:DeleteVolume&quot;,
        &quot;ec2:Describe*&quot;,
        &quot;ec2:DetachVolume&quot;,
        &quot;ec2:DisassociateAddress&quot;,
        &quot;ec2:GetConsoleOutput&quot;,
        &quot;ec2:RunInstances&quot;,
        &quot;ec2:TerminateInstances&quot;
        &quot;ec2:ReleaseAddress&quot;
      ],
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Resource&quot;: &quot;*&quot;
    }
  ]
}
</code></pre><h2 id=examples-denying-specific-actions>Examples: Denying Specific Actions</h2><p>The following policy allows a user to do anything but delete.</p><pre><code>{
  &quot;Statement&quot;: [
    {
      &quot;Action&quot;: [
        &quot;ec2:Delete*&quot;
      ],
      &quot;Effect&quot;: &quot;Deny&quot;,
      &quot;Resource&quot;: &quot;*&quot;
    }
  ]
  }
</code></pre><p>The following policy denies a user from creating other users.</p><pre><code>{
  &quot;Statement&quot;: [
    {
      &quot;Sid&quot;: &quot;Stmt1313686153864&quot;,
      &quot;Action&quot;: [
        &quot;iam:CreateUser&quot;
      ],
      &quot;Effect&quot;: &quot;Deny&quot;,
      &quot;Resource&quot;: &quot;*&quot;
    }
  ]
}
</code></pre><h2 id=examples-specifying-time-limits>Examples: Specifying Time Limits</h2><p>The following policy allows a user to run instances within a specific time.</p><pre><code>{
  &quot;Statement&quot;: [
    {
      &quot;Sid&quot;: &quot;Stmt1313453084396&quot;,
      &quot;Action&quot;: [
        &quot;ec2:RunInstances&quot;
      ],
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Resource&quot;: &quot;*&quot;,
      &quot;Condition&quot;: {
        &quot;DateLessThanEquals&quot;: {
          &quot;aws:CurrentTime&quot;: &quot;2011-08-16T00:00:00Z&quot;
        }
      }
    }
  ]
}
</code></pre><p>The following policy blocks users from running instances at a specific time.</p><pre><code>{
  &quot;Statement&quot;: [
    {
      &quot;Sid&quot;: &quot;Stmt1313453084396&quot;,
      &quot;Action&quot;: [
        &quot;ec2:RunInstances&quot;
      ],
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Resource&quot;: &quot;*&quot;,
      &quot;Condition&quot;: {
        &quot;DateLessThanEquals&quot;: {
          &quot;aws:CurrentTime&quot;: &quot;2011-08-16T00:00:00Z&quot;
        }
      }
    }
  ]
  }
</code></pre><p>The following policy keeps alive an instance for 1,000 hours (60,000 minutes).</p><pre><code>{
  &quot;Statement&quot;: [
    {
      &quot;Action&quot;: [&quot;ec2:RunInstances&quot; ],
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Resource&quot;: &quot;*&quot;,
      &quot;Condition&quot;: { &quot;NumericEquals&quot;:{&quot;ec2:KeepAlive&quot;:&quot;60000&quot;}}
    }
  ]
  }
</code></pre><p>The following policy sets an expiration date on running instances.</p><pre><code>{
  &quot;Statement&quot;: [
    {
      &quot;Action&quot;: [&quot;ec2:RunInstances&quot; ],
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Resource&quot;: &quot;*&quot;,
      &quot;Condition&quot;: { &quot;DateEquals&quot;:{&quot;ec2:ExpirationTime&quot;:&quot;2011-08-16T00:00:00Z&quot;}}
    }
  ]
}
</code></pre><h2 id=examples-restricting-resources>Examples: Restricting Resources</h2><p>The following policy allows users to only launch instances with a large image type.</p><pre><code>{
  &quot;Statement&quot;: [
    {
      &quot;Action&quot;: [
        &quot;ec2:RunInstances&quot;
      ],
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Resource&quot;: &quot;arn:aws:ec2:::vmtype/m1.xlarge&quot;
    }
  ]
  }
</code></pre><p>The following policy restricts users from launching instances with a specific image ID.</p><pre><code>{
  &quot;Statement&quot;: [
    {
      &quot;Action&quot;: [
        &quot;ec2:RunInstances&quot;
      ],
      &quot;Effect&quot;: &quot;Deny&quot;,
      &quot;Resource&quot;: &quot;arn:aws:ec2:::image/emi-0FFF1874&quot;
    }
  ]
  }
</code></pre><p>The following policy restricts users from allocating addresses to a specific elastic IP address.</p><pre><code>{
  &quot;Statement&quot;: [
    {
      &quot;Sid&quot;: &quot;Stmt1313626078249&quot;,
      &quot;Action&quot;: &quot;*&quot;,
      &quot;Effect&quot;: &quot;Deny&quot;,
      &quot;Resource&quot;: &quot;arn:aws:ec2:::address/192.168.10.140&quot;
    }
  ]
  }
</code></pre><p>The following policy denies volume access.</p><pre><code>{
  &quot;Statement&quot;: [
    {
      &quot;Action&quot;: [
        &quot;ec2:*&quot;
      ],
      &quot;Effect&quot;: &quot;Deny&quot;,
      &quot;Resource&quot;: &quot;arn:aws:ec2:::volume/*&quot;
    }
  ]
   
}
</code></pre><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>For policies attached to an account, quota limits can be specified. See the Quotas section for further details.</div></div><div class=td-content style=page-break-before:always><h1 id=pg-211e97ce1f13ff3dbf0a61508e74de7c>4.5.2 - Access Tasks</h1><h1 id=access-tasks>Access Tasks</h1><p>This section provides details about the tasks you perform using policies and identities. The tasks you can perform are divided up into tasks for users, tasks for groups, and tasks for policies.</p></div><div class=td-content><h1 id=pg-66b688f91bd75e9ff79293a8cecea97a>4.5.2.1 - Use Case: Create an Administrator</h1><p>This use case details tasks for creating an administrator. These tasks require that you have your account credentials for sending requests to Eucalyptus using the command line interface (CLI) tools. To create an administrator account, perform the following tasks.</p><h2 id=create-an-admin-group>Create an Admin Group</h2><p>Eucalyptus recommends using account credentials as little as possible. You can avoid using account credentials by creating a group of users with administrative privileges.</p><p>Create a group called administrators.</p><pre><code>euare-groupcreate -g administrators
</code></pre><p>Verify that the group was created.</p><pre><code>euare-grouplistbypath
</code></pre><p>Eucalyptus returns a listing of the groups that have been created, as in the following example.</p><pre><code>arn:aws:iam::123456789012:group/administrators
</code></pre><h2 id=add-a-policy-to-the-group>Add a Policy to the Group</h2><p>Add a policy to the administrators group that allows its members to perform all actions in Eucalyptus.</p><p>Enter the following command to create a policy called <code>admin-root</code> that grants all actions on all resources to all users in the administrators group:</p><pre><code>euare-groupaddpolicy -p admin-root -g administrators -e Allow -a &quot;*&quot; -r &quot;*&quot; -o
</code></pre><h2 id=create-an-administrative-user>Create an Administrative User</h2><p>Create a user for day-to-day administrative work and add that user to the administrators group.</p><p>Eucalyptus admin tools and Euca2ools commands need configuration from <em>~/.euca</em> . If the directory does not yet exist, create it:</p><pre><code>mkdir ~/.euca
</code></pre><p>Create an administrative user, for example alice and create it along with an access key:</p><pre><code>euare-usercreate -wd DOMAIN USER &gt;~/.euca/FILE.ini
</code></pre><p>where:</p><ul><li><p>means output access keys and region information in a euca2ools.ini type configuration file.</p></li><li><p><strong>DOMAIN</strong> is the DNS domain to use for region information in configuration file output (default: based on IAM URL).</p></li><li><p><strong>USER</strong> is the name of the new admin user: alice.</p></li><li><p><strong>FILE</strong> can be anything; we recommend a descriptive name that includes the user&rsquo;s name; for example:</p><p>euare-usercreate -wd DNS_DOMAIN alice >~/.euca/alice.ini</p></li></ul><p>This creates a user admin file with a region name that matches that of your cloud&rsquo;s DNS domain.</p><p>Add the new admin user to the administrators group.</p><pre><code>euare-groupadduser -u alice administrators
</code></pre><p>To list the new user&rsquo;s access keys:</p><pre><code>euare-userlistkeys --region alice@DNS_DOMAIN
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-b3ab8773164c8b2c00d5acec7fb01370>4.5.2.2 - Use Case: Create a User</h1><p>This use case details tasks needed to create a user with limited access.</p><h2 id=create-a-group>Create a Group</h2><p>We recommend that you apply permissions to groups, not users. In this example, we will create a group for users with limited access.</p><p>Enter the following command to create a group for users who will be allowed create snapshots of volumes in Eucalyptus.</p><pre><code>euare-groupcreate -g ebs-backup
</code></pre><p>Open an editor and enter the following JSON policy:</p><pre><code>{
  &quot;Statement&quot;: [
    {
      &quot;Action&quot;: [
        &quot;ec2:CreateSnapshot&quot;
      ],
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Resource&quot;: &quot;*&quot;
    }
  ]
}
</code></pre><p>Save and close the file. Enter the following to add the new policy name <code>allow-snapshot</code> and the JSON policy file to the <code>ebs-backup</code> group:</p><pre><code>euare-groupuploadpolicy -g ebs-backup -p allow-snapshot -f allow-snapshot.json
</code></pre><h2 id=create-the-user>Create the User</h2><p>Create the user for the group with limited access.</p><p>Enter the following command to create the user <code>sam</code> in the group <code>ebs-backup</code> and generate a new key pair for the user:</p><pre><code>euare-usercreate -u sam -g ebs-backup -k
</code></pre><p>Eucalyptus responds with the access key ID and the secret key, as in the following example:</p><pre><code>AKIAJ25S6IJ5K53Y5GCA
QLKyiCpfjWAvlo9pWqWCbuGB9L3T61w7nYYF057l
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-1f570e81f370916ad106fc0a2c96693c>4.5.2.3 - Accounts</h1><h1 id=accounts>Accounts</h1><p>Accounts are the primary unit for resource usage accounting. Each account is a separate name space and is identified by its account number (fixed) and account alias/name (modifiable). Tasks performed at the account level can only be done by the users in the <strong>eucalyptus</strong> account.</p></div><div class=td-content><h1 id=pg-ee5db335419f0605c0ef830d9d1b33bd>4.5.2.3.1 - Add an Account</h1><p>To add an account perform the steps listed in this topic.To add a new account:</p><p>Enter the following command:</p><pre><code>euare-accountcreate -a &lt;account_name&gt;
</code></pre><p>Eucalyptus returns the account name and its ID, as in this example:</p><pre><code>account01 	592459037010
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-d69f4dd3c4ac7c6cbf91511a959f1bd2>4.5.2.3.2 - Rename an Account</h1><p>To rename an account perform the steps listed in this topic.To change an account&rsquo;s name:</p><p>Enter the following command:</p><pre><code>uare-accountaliascreate -a &lt;new_name&gt;
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-6cd17355e2e96493bb90897e4a2f8c33>4.5.2.3.3 - List Accounts</h1><p>To list accounts perform the steps in this topic.Use the <code>euare-accountlist</code> command to list all the accounts in an account or to list all the users with a particular path prefix. The output lists the ARN for each resulting user.</p><pre><code>euare-userlistbypath -p &lt;path&gt;
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-582e00b20c363033f7b83ba92bd0b838>4.5.2.3.4 - Delete an Account</h1><p>To delete an account perform the steps listed in this topic.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If there are resources tied to the account that you delete, the resources remain. We recommend that you delete these resources first.</div>Enter the following command:</p><pre><code>euare-accountdel -a &lt;account_name&gt; -r true
</code></pre><p>Use the <code>-r</code> option set to <code>true</code> to delete the account recursively. You don&rsquo;t have to use this option if have already deleted users, keys, and passwords in this account.</p><p>Eucalyptus does not return any message.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-33ce4312fe81b2a6519096dfdbaa2d35>4.5.2.4 - Groups</h1><h1 id=groups>Groups</h1><p>Groups are used to share resource access authorizations among a set of users within an account. Users can belong to multiple groups.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>A group in the context of access is not the same as a security group.</div><p>This section details tasks that can be performed on groups.</p></div><div class=td-content><h1 id=pg-e923951fba34c12b5e794474eebc511b>4.5.2.4.1 - Create a Group</h1><p>To create a group perform the steps listed in this topic.Enter the following command:</p><pre><code>euare-groupcreate -g &lt;group_name&gt;
</code></pre><p>Eucalyptus does not return anything.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-668ca8d059318ac7c2e987847a894801>4.5.2.4.2 - Add a Group Policy</h1><p>To add a group policy perform the steps listed in this topic.Enter the following command:</p><pre><code>euare-groupaddpolicy -g &lt;group_name&gt; -p &lt;policy_name&gt; -e &lt;effect&gt; -a
							&lt;actions&gt; -o
</code></pre><p>The optional <code>-o</code> parameter tells Eucalyptus to return the JSON policy, as in this example:</p><pre><code>{&quot;Version&quot;:&quot;2008-10-17&quot;,&quot;Statement&quot;:[{&quot;Effect&quot;:&quot;Allow&quot;, &quot;Action&quot;:[&quot;ec2:RunInstances&quot;], &quot;Resource&quot;:[&quot;*&quot;]}]}
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-5fc1960c90e1ce37dea91ee71ce340e2>4.5.2.4.3 - Modify a Group</h1><p>To modify a group perform the steps listed in this topic.Modifying a group is similar to a &ldquo;move&rdquo; operation. Whoever wants to modify the group must have permission to do it on both sides of the move. That is, you need permission to remove the group from its current path or name, and put that group in the new path or name.</p><p>For example, if a group changes from one area in a company to another, you can change the group&rsquo;s path from <em>/area_abc/</em> to <em>/area_efg/</em> . You need permission to remove the group from <em>/area_abc/</em> . You also need permission to put the group into <em>/area_efg/</em> . This means you need permission to call <code>UpdateGroup</code> on both <em>arn:aws:iam::123456789012:group/area_abc/</em>* and <em>arn:aws:iam::123456789012:group/area_efg/</em>* .</p><p>Enter the following command to modify the group&rsquo;s name:</p><pre><code>euare-groupmod -g &lt;group_name&gt; --new-group-name &lt;new_name&gt;
</code></pre><p>Eucalyptus does not return a message. Enter the following command to modify a group&rsquo;s path:</p><pre><code>euare-groupmod -g &lt;group_name&gt; -p &lt;new_path&gt;
</code></pre><p>Eucalyptus does not return a message.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-272a727e7141c758cd69d2a1a6390811>4.5.2.4.4 - Remove a User from a Group</h1><p>To remove a user from a group perform the steps listed in this topic.Enter the following command:</p><pre><code>euare-groupremoveuser -g &lt;group_name&gt; -u &lt;user-name&gt; 
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-4bf78627ecd1a139de1c5a212ac996a7>4.5.2.4.5 - List Groups</h1><p>To list groups perform the steps listed in this topic.Enter the following command:</p><pre><code>euare-grouplistbypath
</code></pre><p>Eucalyptus returns a list of paths followed by the ARNs for the groups in each path. For example:</p><pre><code>arn:aws:iam::eucalyptus:group/groupa
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-aa0e7d2e3857a776753212c9ed8715c3>4.5.2.4.6 - List Policies for a Group</h1><p>To list policies for a group perform the steps listed in this topic.Enter the following command:</p><pre><code>euare-grouplistpolicies -g &lt;group_name&gt;
</code></pre><p>Eucalyptus returns a listing of all policies associated with the group.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-f2ce03eabebf66486b27234034aea9e9>4.5.2.4.7 - Delete a Group</h1><p>To delete a group perform the steps listed in this topic.When you delete a group, you have to remove users from the group and delete any policies from the group. You can do this with one command, using the <code>euare-groupdel</code> command with the <code>-r</code> option. Or you can follow the following steps to specify who and what you want to delete.</p><p>Individually remove all users from the group.</p><pre><code>euare-groupremoveuser -g &lt;group_name&gt; -u &lt;user_name&gt;
</code></pre><p>Delete the policies attached to the group.</p><pre><code>euare-groupdelpolicy -g &lt;group_name&gt; -p &lt;policy_name&gt;
</code></pre><p>Delete the group.</p><pre><code>euare-groupdel -g &lt;group_name&gt;
</code></pre><p>The group is now deleted.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-4afff178247fe629dd1d5d9acb2be979>4.5.2.5 - Users</h1><h1 id=users>Users</h1><p>Users are subsets of accounts and are added to accounts by an appropriately credentialed administrator. While the term <strong>user</strong> typically refers to a specific person, in Eucalyptus, a <strong>user</strong> is defined by a specific set of credentials generated to enable access to a given account. Each set of user credentials is valid for accessing only the account for which they were created. Thus a user only has access to one account within a Eucalyptus system. If an individual person wishes to have access to more than one account within a Eucalyptus system, a separate set of credentials must be generated (in effect a new ‘user’) for each account (though the same username and password can be used for different accounts).</p><p>When you need to add a new user to your Eucalyptus cloud, you&rsquo;ll go through the following process:</p><ol><li>Create a user</li><li>Add user to a group</li><li>Give user a login profile</li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-dd72d1e88ac0a1d16ad0b337152e146a>4.5.2.5.1 - Add a User</h1><p>To add a user, perform the steps in this topic.Enter the following command</p><pre><code>euare-usercreate -u &lt;user_name&gt; -g &lt;group_name&gt; -k
</code></pre><p>Eucalyptus does not return a response.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If you include the parameter, Eucalyptus returns a response that includes the user&rsquo;s ARN and GUID.</div></p></div><div class=td-content style=page-break-before:always><h1 id=pg-749b80672158f431a1d7d9bb97c1a249>4.5.2.5.2 - Add a User to a Group</h1><p>To add a user to a group perform the steps listed in this topic.Enter the following command:</p><pre><code>euare-groupadduser -g &lt;group_name&gt; -u &lt;user-name&gt; 
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-5d0f0396bee32b62b263b2b8339ced18>4.5.2.5.3 - Create a Login Profile</h1><p>To create a login profile, perform the tasks in this topic.Enter the following command:</p><pre><code>euare-useraddloginprofile -u &lt;user_name&gt; -p &lt;password&gt;
</code></pre><p>Eucalyptus does not return a response.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-0aca94e11d4a95cff001c7f0329bfc49>4.5.2.5.4 - Generating User Credentials</h1><p>The first time you get credentials using the <em>clcadmin-assume-system-credentials</em> command, a new secret access key is generated. On each subsequent request to get credentials, an existing active secret key is returned. You can also generate new keys using the <em>euare-useraddkey</em> command.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Each request to get a user&rsquo;s credentials generates a new pair of a private key and X.509 certificate..</div><p>To generate a new key for a user by an account administrator, enter the following</p><pre><code>euare-useraddkey USER_NAME
</code></pre><p>To generate a private key and an X.509 certificate pair, enter the following:</p><pre><code>euare-usercreatecert USER_NAME
</code></pre><p>The cloud administrator can obtain temporary access credentials for any cloud user via the <em>clcadmin-impersonate-user</em> command.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-cfa9d31d4cd20d9e7b9fe0b970545a1c>4.5.2.5.5 - Uploading a Certificate</h1><p>To upload a certificate provided by a user:</p><p>Enter the following command:</p><pre><code>euare-useraddcert -f CERT_FILE USER_NAME
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-389f024ceefc48314659d7755e6a3c9b>4.5.2.5.6 - Modify a User</h1><p>Modifying a user is similar to a &ldquo;move&rdquo; operation. To modify a user, you need permission to remove the user from the current path or name, and put that user in the new path or name.For example, if a user changes from one team in a company to another, you can change the user&rsquo;s path from <em>/team_abc/</em> to <em>/team_efg/</em> . You need permission to remove the user from <em>/team_abc/</em> . You also need permission to put the user into <em>/team_efg/</em> . This means you need permission to call UpdateUser on both <em>arn:aws:iam::123456789012:user/team_abc/</em>* and <em>arn:aws:iam::123456789012:user/team_efg/</em>* .</p><p>To rename a user:</p><p>Enter the following command to rename a user:</p><pre><code>euare-usermod -u &lt;user_name&gt; --new-user-name &lt;new_name&gt;
</code></pre><p>Eucalyptus does not return a message. Enter the following command:</p><pre><code>euare-groupmod -u &lt;user_name&gt; -p &lt;new_path&gt;
</code></pre><p>Eucalyptus does not return a message.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-0542bfe18474766936611fdf92b19945>4.5.2.5.7 - List Users</h1><p>To list users within a path, perform the steps in this topic.Use the <code>euare-userlistbypath</code> command to list all the users in an account or to list all the users with a particular path prefix. The output lists the ARN for each resulting user.</p><pre><code>euare-userlistbypath -p &lt;path&gt;
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-28d56f710b14e8cec57a979316b116d2>4.5.2.5.8 - Delete a User</h1><p>To delete a user, perform the tasks in this topic.Enter the following command</p><pre><code>euare-userdel -u &lt;user_name&gt;
</code></pre><p>Eucalyptus does not return a response.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-b1b0637f24aff2f57dd658f327d66299>4.5.2.6 - Roles</h1><h1 id=roles>Roles</h1><p>A <strong>role</strong> is a mechanism that allows applications to request temporary security credentials on a user or application&rsquo;s behalf.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Eucalyptus roles are managed through the Eucalyptus Euare service, which is compatible with Amazon&rsquo;s Identity and Access Management (IAM) service.</div></div><div class=td-content><h1 id=pg-2f6d69b689bb4ca2ac8340b80c6b0b8e>4.5.2.6.1 - Launch an Instance with a Role</h1><p>To create a role for a Eucalyptus instance, you must first create a trust policy that you can use for it.</p><h2 id=create-trust-policy>Create Trust Policy</h2><p>You can create trust policies in two ways:</p><ul><li>a file method</li><li>a command line method</li></ul><h2 id=create-trust-policy-using-a-file>Create trust policy using a file</h2><p>Create a trust policy file with the contents below and save it in a text file called <code>role-trust-policy.json</code> :</p><pre><code>{
  &quot;Version&quot;: &quot;2012-10-17&quot;,
  &quot;Statement&quot;: [
    {
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Principal&quot;: { &quot;Service&quot;: &quot;ec2.amazonaws.com&quot;},
      &quot;Action&quot;: &quot;sts:AssumeRole&quot;
    }
  ]
}
</code></pre><p>Create the role using the <code>euare-rolecreate</code> command, specifying the trust policy file that was previously created:</p><pre><code># euare-rolecreate --role-name describe-instances -f role-trust-policy.json
# euare-rolelistbypath 
arn:aws:iam::408396244283:role/describe-instances
</code></pre><p>Proceed with applying an access policy to a role.</p><h2 id=create-trust-policy-using-the-command-line>Create trust policy using the command line</h2><p>The other way to create the role is to use the command line options to specify the trust policy:Issue the following string on the command line:</p><pre><code># euare-rolecreate --role-name describe-instances --service http://compute.acme.eucalyptus-systems.com:8773/
# euare-rolelistbypath 
arn:aws:iam::408396244283:role/describe-instances
</code></pre><p>Proceed with applying an access policy to a role.</p><h2 id=create-and-apply-an-access-policy-to-a-role>Create and apply an access policy to a role</h2><p>Create a policy and save it in a text file with a <code>.json</code> extension. The following example shows a policy that allows listing the contents of an S3 bucket called &ldquo;mybucket&rdquo;:</p><pre><code>{
  &quot;Statement&quot;: [
    {
      &quot;Action&quot;: [
        &quot;s3:ListBucket&quot;
      ],
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Resource&quot;: &quot;arn:aws:s3:::mybucket&quot;
    }
  ]
}
</code></pre><p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>For more information on policies, see .</div>Apply the access policy to the role using the <code>euare-roleuploadpolicy</code> command, passing in the filename of the policy you created in the previous step: <code>euare-roleuploadpolicy --role-name mytestrole --policy-name s3-list-bucket --policy-document my-test-policy.json</code></p></div><div class=td-content style=page-break-before:always><h1 id=pg-5560a10e0d26af09b396e8fac12da746>4.5.2.6.2 - Use a Role with an Instance Application</h1><p>You can use the AWS Java SDK to programmatically perform IAM role-related operations in your Eucalyptus cloud. This example shows how to use the AWS SDK to retrieve the credentials for the IAM role associated with the Eucalyptus instance.The following program lists the contents of the bucket &ldquo;my-test-bucket&rdquo; using the credentials stored in the Java system properties:</p><pre><code>import com.amazonaws.auth.*;
import com.amazonaws.AmazonClientException;
import com.amazonaws.AmazonServiceException;
import com.amazonaws.auth.AWSCredentialsProvider;
import com.amazonaws.auth.ClasspathPropertiesFileCredentialsProvider;
import com.amazonaws.services.ec2.AmazonEC2;
import com.amazonaws.services.ec2.AmazonEC2Client;
import com.amazonaws.services.s3.*;
import com.amazonaws.services.s3.model.*;

public class MyTestApp {

    static AmazonEC2 ec2;
    static AmazonS3 s3;

    private static void init() throws Exception {

        AWSCredentialsProvider credentials = new ClasspathPropertiesFileCredentialsProvider();
 
        s3 = new AmazonS3Client(credentials);
        s3.setEndpoint(&quot;http://128.0.0.1:8773/services/Walrus&quot;);
    }


    public static void main(String[] args) throws Exception {

        init();

        try {
           
            String bucketName = &quot;my-test-bucket&quot;;           
            System.out.println(&quot;Listing bucket &quot; + bucketName + &quot;:&quot;);
            ListObjectsRequest listObjectsRequest = new ListObjectsRequest(bucketName, &quot;&quot;, &quot;&quot;, &quot;&quot;, 200);
            ObjectListing bucketList;
            do {
                bucketList = s3.listObjects(listObjectsRequest);
                for (S3ObjectSummary objectInfo :
                        bucketList.getObjectSummaries()) {
                    System.out.println(&quot; - &quot; + objectInfo.getKey() + &quot;  &quot; +
                            &quot;(size = &quot; + objectInfo.getSize() +
                            &quot;)&quot;);
                }
                listObjectsRequest.setMarker(bucketList.getNextMarker());
            } while (bucketList.isTruncated());

        } catch (AmazonServiceException eucaServiceException ) {
            System.out.println(&quot;Exception: &quot; + eucaServiceException.getMessage());
            System.out.println(&quot;Status Code: &quot; + eucaServiceException.getStatusCode());
            System.out.println(&quot;Error Code: &quot; + eucaServiceException.getErrorCode());
            System.out.println(&quot;Request ID: &quot; + eucaServiceException.getRequestId());
        } catch (AmazonClientException eucaClientException) {
            System.out.println(&quot;Error Message: &quot; + eucaClientException.getMessage());
        }
        System.out.println(&quot;===== FINISHED =====&quot;);
    }

}                    
</code></pre><p>This application produces output similar to the following:</p><pre><code>Listing bucket my-test-bucket:
 - precise-server-cloudimg-amd64-vmlinuz-virtual.manifest.xml  (size = 3553)
 - precise-server-cloudimg-amd64-vmlinuz-virtual.part.0  (size = 4904032)
 - precise-server-cloudimg-amd64.img.manifest.xml  (size = 7014)
 - precise-server-cloudimg-amd64.img.part.0  (size = 10485760)
 - precise-server-cloudimg-amd64.img.part.1  (size = 10485760)
 - precise-server-cloudimg-amd64.img.part.10  (size = 10485760)
 - precise-server-cloudimg-amd64.img.part.11  (size = 10485760)
 - precise-server-cloudimg-amd64.img.part.12  (size = 10485760)
 - precise-server-cloudimg-amd64.img.part.13  (size = 10485760)
 - precise-server-cloudimg-amd64.img.part.14  (size = 10485760)
 - precise-server-cloudimg-amd64.img.part.15  (size = 10485760)
 - precise-server-cloudimg-amd64.img.part.16  (size = 10485760)
 - precise-server-cloudimg-amd64.img.part.17  (size = 10485760)
 - precise-server-cloudimg-amd64.img.part.18  (size = 10485760)
 - precise-server-cloudimg-amd64.img.part.19  (size = 10485760)
 - precise-server-cloudimg-amd64.img.part.2  (size = 10485760)
 - precise-server-cloudimg-amd64.img.part.20  (size = 10485760)
 - precise-server-cloudimg-amd64.img.part.21  (size = 10485760)
 - precise-server-cloudimg-amd64.img.part.22  (size = 2570400)
 - precise-server-cloudimg-amd64.img.part.3  (size = 10485760)
 - precise-server-cloudimg-amd64.img.part.4  (size = 10485760)
 - precise-server-cloudimg-amd64.img.part.5  (size = 10485760)
 - precise-server-cloudimg-amd64.img.part.6  (size = 10485760)
 - precise-server-cloudimg-amd64.img.part.7  (size = 10485760)
 - precise-server-cloudimg-amd64.img.part.8  (size = 10485760)
 - precise-server-cloudimg-amd64.img.part.9  (size = 10485760)
===== FINISHED =====
</code></pre><p>The problem with this approach is that the credentials are hardcoded into the application - this makes them less secure, and makes the application more difficult to maintain. Using IAM roles is a more secure and easier way to manage credentials for applications that run on Eucalyptus cloud instances.</p><p>Create a role with a policy that allows an instance to list the contents of a specific bucket, and then launch an instance with that role (for an example, see <a href=https://www.eucastack.io/docs/iam_guide/managing_auth/eiam_task_oview/roles_tasks/roles_tasks_create_role_application/>Launch an Instance with a Role</a> . An example policy that allows listing of a specific bucket will look similar to the following:</p><pre><code>{
  &quot;Statement&quot;: [
    {
      &quot;Action&quot;: [
        &quot;s3:ListBucket&quot;
      ],
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Resource&quot;: &quot;arn:aws:s3:::my-test-bucket&quot;
    }
  ]
}             
</code></pre><p>The following line of code retrieves the credentials that are stored in the application&rsquo;s credentials profile: <code>AWSCredentialsProvider credentials = new ClasspathPropertiesFileCredentialsProvider();</code> To use the role-based credentials associated with the instance, replace that line of code with the following: <code>AWSCredentialsProvider credentials = new InstanceProfileCredentialsProvider();</code> The program now looks like this:</p><pre><code>import com.amazonaws.auth.*;
import com.amazonaws.AmazonClientException;
import com.amazonaws.AmazonServiceException;
import com.amazonaws.auth.AWSCredentialsProvider;
import com.amazonaws.auth.ClasspathPropertiesFileCredentialsProvider;
import com.amazonaws.services.ec2.AmazonEC2;
import com.amazonaws.services.ec2.AmazonEC2Client;
import com.amazonaws.services.s3.*;
import com.amazonaws.services.s3.model.*;

public class MyTestApp {

    static AmazonEC2 ec2;
    static AmazonS3 s3;

    private static void init() throws Exception {

        AWSCredentialsProvider credentials = new InstanceProfileCredentialsProvider();
 
        s3 = new AmazonS3Client(credentials);
        s3.setEndpoint(&quot;http://128.0.0.1:8773/services/Walrus&quot;);
    }


    public static void main(String[] args) throws Exception {

        init();

        try {
           
            String bucketName = &quot;my-test-bucket&quot;;
           
            System.out.println(&quot;Listing bucket &quot; + bucketName + &quot;:&quot;);
            ListObjectsRequest listObjectsRequest = new ListObjectsRequest(bucketName, &quot;&quot;, &quot;&quot;, &quot;&quot;, 200);
            ObjectListing bucketList;
            do {
                bucketList = s3.listObjects(listObjectsRequest);
                for (S3ObjectSummary objectInfo :
                        bucketList.getObjectSummaries()) {
                    System.out.println(&quot; - &quot; + objectInfo.getKey() + &quot;  &quot; +
                            &quot;(size = &quot; + objectInfo.getSize() +
                            &quot;)&quot;);
                }
                listObjectsRequest.setMarker(bucketList.getNextMarker());
            } while (bucketList.isTruncated());

        } catch (AmazonServiceException eucaServiceException ) {
            System.out.println(&quot;Exception: &quot; + eucaServiceException.getMessage());
            System.out.println(&quot;Status Code: &quot; + eucaServiceException.getStatusCode());
            System.out.println(&quot;Error Code: &quot; + eucaServiceException.getErrorCode());
            System.out.println(&quot;Request ID: &quot; + eucaServiceException.getRequestId());
        } catch (AmazonClientException eucaClientException) {
            System.out.println(&quot;Error Message: &quot; + eucaClientException.getMessage());
        }
        System.out.println(&quot;===== FINISHED =====&quot;);
    }

}
</code></pre><p>NOTE: Running this code outside of an instance will result in the following error message:</p><pre><code>Listing bucket my-test-bucket:
Error Message: Unable to load credentials from Amazon EC2 metadata service
</code></pre><p>When the application is running on an instance that was launched with the role you created, the credentials for the role assigned to the instance will be retrieved from the Instance Metadata Service.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-28ddd1def442ce481c7968ae53b8633c>4.5.2.6.3 - Assume a Role</h1><p>A role is assigned a specific set of tasks and permissions. Users may assume a different role than the one they have in order to perform a different set of tasks. For example, the primary administrator is unavailable and the backup administrator is asked to assume the role of the primary administrator during his or her absence. A few points to consider before assuming a role:</p><ul><li>A role must first be set up by an administrator.</li><li>You must log in as an IAM user, not as an account root user.</li><li>Once you assume another role, you temporarily give up your existing user permissions and assume the permissions of your new role.</li><li>When you are no longer assuming another role, your usual user permissions are automatically restored.</li></ul><h2 id=create-role>Create Role</h2><p>The scenario described in this section outlines the procedure for creating a role in order to delegate permissions to an IAM user.Create a role that allows users of an account to manage keypairs. Management of keypairs include the following EC2 actions:</p><ul><li><p>CreateKeyPair</p></li><li><p>DeleteKeyPair</p></li><li><p>DescribeKeyPairs</p></li><li><p>ImportKeyPair
Create a role for managing keypairs for the account. In this example, the admin user of &lsquo;devops&rsquo; account (001827830003) is creating the role:</p><h1 id=cat-devops-role-trustpolicyjson>cat devops-role-trustpolicy.json</h1><p>{
&ldquo;Version&rdquo;: &ldquo;2012-10-17&rdquo;,
&ldquo;Statement&rdquo;: [{
&ldquo;Effect&rdquo;: &ldquo;Allow&rdquo;,
&ldquo;Principal&rdquo;: {&ldquo;AWS&rdquo;: &ldquo;arn:aws:iam::001827830003:root&rdquo;},
&ldquo;Action&rdquo;: &ldquo;sts:AssumeRole&rdquo;
}]
}</p><h1 id=euare-rolecreate--f-devops-role-trustpolicyjson-devops-ec2-keypair-mgmt-role---region-devops-adminfuture>euare-rolecreate -f devops-role-trustpolicy.json devops-ec2-keypair-mgmt-role &ndash;region devops-admin@future</h1></li></ul><p>Add IAM access policy for keypair management to the role:</p><pre><code># cat keypair-mgmt-policy.json
{
  &quot;Version&quot;: &quot;2012-10-17&quot;,
  &quot;Statement&quot;: [
    {
      &quot;Sid&quot;: &quot;Stmt1445362739663&quot;,
      &quot;Action&quot;: [
        &quot;ec2:CreateKeyPair&quot;,
        &quot;ec2:DeleteKeyPair&quot;,
        &quot;ec2:DescribeKeyPairs&quot;,
        &quot;ec2:ImportKeyPair&quot;
      ],
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Resource&quot;: &quot;*&quot;
    }
  ]
}

# euare-roleuploadpolicy --policy-name ec2-keypair-actions --policy-document keypair-mgmt-policy.json devops-ec2-keypair-mgmt-role --region devops-admin@future
</code></pre><p>Now that the role has been created, follow the <a href=http://docs.aws.amazon.com/IAM/latest/UserGuide/IAMBestPractices.html#use-groups-for-permissions>AWS IAM best practice of using groups to assign permission to IAM users</a> and attach an IAM access policy to the group to allow any members (example shows &lsquo;user01&rsquo; user) to assume the &lsquo;devops-ec2-keypair-mgmt-role&rsquo; role:</p><pre><code># euare-groupcreate -g Key-Managers --region devops-admin@future
# euare-groupadduser -u user01 -g Key-Managers --region devops-admin@future
# cat devops-keypair-mgmt-assume-role-policy.json
{
 &quot;Version&quot;: &quot;2012-10-17&quot;,
 &quot;Statement&quot;: [{
 &quot;Effect&quot;: &quot;Allow&quot;,
 &quot;Action&quot;: &quot;sts:AssumeRole&quot;,
 &quot;Resource&quot;: &quot;arn:aws:iam::001827830003:role/devops-ec2-keypair-mgmt-role&quot;
 }]
}
# euare-groupuploadpolicy -p keypair-mgmt-role-perm -f devops-keypair-mgmt-assume-role-policy.json Key-Managers --region devops-admin@future
</code></pre><p>Now that members can assume the &lsquo;devops-ec2-keypair-mgmt-role&rsquo; role, run the following command to list all keypairs under the account:</p><pre><code># eval `/usr/bin/euare-assumerole devops-ec2-keypair-mgmt-role --region devops-user01@future`
# euca-describe-keypairs --region @future
KEYPAIR	devops-admin	9e:1a:bc:ac:98:b1:97:7c:65:b0:b3:7c:96:f5:d5:7b:a1:3e:36:a6
</code></pre><p>When done assuming the role, the role must be released using <code>euare-releaserole</code> :</p><pre><code># eval `/usr/bin/euare-releaserole --region devops-user01@future`
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-67ba8f7be3147b2c7fbd12e16b4e0725>4.5.2.6.4 - Delegate Access Across Your Accounts Using Roles</h1><p>A role can be used to delegate access to resources that are in different accounts that you own.Using roles to access resources across different accounts allows users to assume a role that can access all the resources in in different acccounts, rather than having users log into different accounts to achieve the same result.</p><h2 id=using-roles-to-access-resources-in-another-account>Using Roles to Access Resources in Another Account</h2><p>The scenario described in this section outlines the procedure for a user in Account B to create a role that provides access to a particular OSGObject Storage Gateway (OSG) bucket owned by Account B, which can be assumed by user in Account A.Using <a href=https://github.com/s3tools/s3cmd>s3cmd</a> , list bucket that will be shared through role:</p><pre><code># ./s3cmd/s3cmd --config=.s3cfg-acctB-user11 ls s3://mongodb-snapshots
2014-12-01 22:34 188563920   s3://mongodb-snapshots/mongodb-backup-monday.img.xz
2014-12-02 13:34 188564068   s3://mongodb-snapshots/mongodb-backup-tuesday.img.xz
</code></pre><p>Create Role in Account B with Trust Policy for User from Account A:</p><pre><code># cat acctB-role-trust-acctA-policy.json
{
  &quot;Version&quot;: &quot;2012-10-17&quot;,
  &quot;Statement&quot;: [{
    &quot;Effect&quot;: &quot;Allow&quot;,
    &quot;Principal&quot;: {&quot;AWS&quot;: &quot;arn:aws:iam::290122656840:user/user01&quot;},
    &quot;Action&quot;: &quot;sts:AssumeRole&quot;
  }]
}

# euare-rolecreate --role-name cross-bucket-access-mongodb-logs --policy-document acctB-role-trust-acctA-policy.json
</code></pre><p>Upload IAM Access Policy for Role in Account B:</p><pre><code># cat acctB-mongodb-snapshots-bucket-access-policy.json
{
  &quot;Version&quot;: &quot;2012-10-17&quot;,
  &quot;Statement&quot;: [
    {
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Action&quot;: &quot;s3:ListBucket&quot;,
      &quot;Resource&quot;: &quot;arn:aws:s3:::mongodb-snapshots&quot;
    },
    {
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Action&quot;: [
        &quot;s3:GetObject&quot;,
        &quot;s3:PutObject&quot;,
        &quot;s3:DeleteObject&quot;
      ],
      &quot;Resource&quot;: &quot;arn:aws:s3:::mongodb-snapshots/*&quot;
    }
  ]
}

# euare-roleuploadpolicy --role-name cross-bucket-access-mongodb-logs --policy-document acctB-mongodb-snapshots-bucket-access-policy.json --policy-name mongodb-logs-bucket-access
</code></pre><p>Upload IAM access policy to Group (e.g. Testers) associated with user in Account A to allow for Role in Account B to be assumed. For more information, go to <a href=http://docs.aws.amazon.com/IAM/latest/UserGuide/IAMBestPractices.html#use-groups-for-permissions>Amazon Web Services IAM Best Practices</a> .</p><pre><code># cat acctA-assume-role-acctB-policy.json
{
  &quot;Statement&quot;: [
    {
      &quot;Sid&quot;: &quot;Stmt1417531456446&quot;,
      &quot;Action&quot;: [
        &quot;sts:AssumeRole&quot;
      ],
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Resource&quot;: &quot;arn:aws:iam::325271821652:role/cross-bucket-access-mongodb-logs&quot;
    }
  ]
}

# euare-groupuploadpolicy --policy-name mongodb-bucket-access-role --group-name Testers --policy-document acctA-assume-role-acctB-policy.json
</code></pre><p>The example below demonstrates how to use a python script leveraging the <a href=http://boto.readthedocs.org/en/latest/index.html>boto</a> library. Another way to assume this role is to run the Euca2ools command, <code>euare-assumerole</code> , using the AccountA/user01 credentials. For more information regarding assuming a role, see an example from the <a href=https://www.eucastack.io/docs/iam_guide/managing_auth/eiam_task_oview/roles_tasks/roles_tasks_assume_role_application/>Assume a Role</a> section. The script below performs the following actions:</p><ul><li><p>Accesses STS to get temporary access key, secret key and token</p></li><li><p>List contents of bucket &ldquo;mongodb-snapshots&rdquo;</p><p>=======================
#!/bin/env python</p><p>import boto
from boto.sts import STSConnection
from boto.s3.connection import S3Connection
from boto.s3.connection import OrdinaryCallingFormat</p><p>if <strong>name</strong> == &ldquo;<strong>main</strong>&rdquo;:
"""
Assuming &lsquo;cross-bucket-access-mongodb-logs&rsquo; role by AccountA, User01 user
"""
STSConnection.DefaultRegionEndpoint = &ldquo;tokens.future.euca-hasp.cs.prc.eucalyptus-systems.com&rdquo;
sts_connection = STSConnection(aws_access_key_id="<accounta user01 access key id>",
aws_secret_access_key="<accounta user01 secret key>",
is_secure=False, port=&ldquo;8773&rdquo;)
assumedRoleObject = sts_connection.assume_role(
role_arn=&ldquo;arn:aws:iam::325271821652:role/cross-bucket-access-mongodb-logs&rdquo;,
role_session_name=&ldquo;AcctAUser01MongoDBBucketAccess&rdquo;)</p><pre><code>  s3 = S3Connection(aws_access_key_id=assumedRoleObject.credentials.access_key,
  aws_secret_access_key=assumedRoleObject.credentials.secret_key,
  security_token=assumedRoleObject.credentials.session_token,
  host=&quot;objectstorage.future.euca-hasp.cs.prc.eucalyptus-systems.com&quot;,
  is_secure=False, port=8773, calling_format=OrdinaryCallingFormat())

  bucket_name = &quot;mongodb-snapshots&quot;
  bucket = s3.lookup(bucket_name)
  if bucket:
      print &quot;Bucket Information [%s]:&quot; % bucket_name
      print &quot;------------------------------------------------------------&quot;
      for key in bucket:
          print &quot;\t&quot; + key.name
  else:
      print &quot;Bucket is not available: &quot; + bucket_name + &quot;\n&quot;
</code></pre><p>==================</p></li></ul><p>Run the script:</p><pre><code># ./describe-bucket-script.py
Bucket Information [mongodb-snapshots]:
------------------------------------------------------------
	mongodb-backup-monday.img.xz
	mongodb-backup-tuesday.img.xz
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-18a34a33922bf60fbc3affdcbf7663e6>5 - Image Management Guide</h1><h1 id=image-management-guide>Image Management Guide</h1><p>This guide contains concepts and tasks to help you work with images in your cloud.</p></div><div class=td-content><h1 id=pg-95baf3f86c33cef7adb3b53047a62983>5.1 - Image Management Overview</h1><p>Welcome to the Eucalyptus Image Management Guide. This guide contains conceptual overview about what images are, as well as best practices and common tasks for using images in your cloud.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>This guide assumes a moderately high level of expertise with the Linux command line.</div><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Because of the wide variety of Linux distributions (and other operating systems) that may be running on an instance, specific examples may vary.</div></div><div class=td-content style=page-break-before:always><h1 id=pg-43adcca7528e430b8c80d48e6d9c7635>5.2 - Image Overview</h1><p>An image defines what will run on a guest instance in your Eucalyptus cloud. An image contains everything necessary to boot and run an operating system, e.g. a Linux distribution – CentOS, Fedora, Ubuntu, Debian, etc.</p><p>Images of two types are supported by Eucalyptus:</p><ul><li>HVM images are raw disks that can boot independently. HVM stands for Hardware-assisted Virtual Machine because such images can only run efficiently on hardware that supports virtualization. When an HVM image is uploaded and registered, it becomes a Eucalyptus Machine Image (EMI) of type &ldquo;hvm&rdquo;, with a unique ID.</li><li>Paravirtual images are Linux images that can boot if they are paired with a kernel and ramdisk that are compatible with the host&rsquo;s hypervisor. Currently only root file system images are supported (on AWS, a paravirtual image can be a file system or a full disk). When a paravirtual image is uploaded and registered, it also becomes an EMI of &ldquo;paravirtual&rdquo; type, which needs to be paired with a kernel (EKI) and ramdisk (ERI) images to be usable. EKI contains a kernel (i.e., the ‘vmlinuz’ file typically found in the /boot directory of a Linux system). ERI contains the kernel modules (i.e., the ‘initrd’ file from the /boot directory).</li></ul><p>Depending on the method used for upload, an instance&rsquo;s disk will reside on one of two types of storage:</p><ul><li>volumes are located on temporary disk space that is destroyed when instances shut down. These volumes are based on a template residing in Object Storage. Instance Store can host either HVM or paravirtual images.</li><li>volumes are disks with lifetimes that can be independent of instances. These volumes are based on snapshots of EBS volumes (instead of templates in Object Storage). Only HVM images can be deployed on EBS in Eucalyptus (in AWS, EBS can also host paravirtual images).</li></ul><p>To help get you started, Eucalyptus provides pre-packaged virtual machine images that are ready to run in your cloud. You can download them from the Eucalyptus Machine Image catalog . Both HVM and paravirtual images are available there. Each paravirtual image comes bundled with a corresponding EKI and ERI.</p><p>If you find that the pre-packaged images don&rsquo;t meet your needs, you can migrate an image from another cloud system (such as Amazon Web Services) or create your own image. See the rest of this guide for more information.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>For a list of supported guest operating systems, .</div></div><div class=td-content style=page-break-before:always><h1 id=pg-bbce802474b3563a37c590a7850aa76c>5.3 - Image Tasks</h1><h1 id=image-tasks>Image Tasks</h1><p>An image is the basis for instances that you spin up for your computing needs. This section explains how to create or acquire an image and then add it to your Eucalyptus cloud. There are a few ways you can create or acquire an image for use in a Eucalyptus cloud:</p><ul><li>Add an image based on an existing image. For more information, see <a href=https://www.eucalyptus.cloud/index.html#Images>https://www.eucalyptus.cloud/index.html#Images</a>.</li><li>Add an image that you create from scratch, by installing an operating system into a virtual machine.</li><li>Migrate an image or an instance from another cloud, such as Amazon Web Services (AWS) or a virtualization platform.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-a083b7deb3e20a834645aa2bd24d9925>5.3.1 - Browse and Download from Eucalyptus</h1><p>Eucalyptus provides a few prebuilt &ldquo;starter&rdquo; images that you can download and install. This is one of the simplest ways to get started with Eucalyptus. Many other organizations, including Linux distributions, publish starter images for use on cloud systems, which can also be installed on Eucalyptus using the steps in this guide.With your Web browser, explore the Eucalyptus Machine Image catalog . Download an image of your choice (we suggest starting with images that have &ldquo;hvm&rdquo; as their Virtualization Type, as they are easier to install and work for both Instance Store and EBS-backed instances). Optionally, if the image is compressed (has a .tgz or .gz extension), you will have to uncompress it. If you obtained an HVM image, you now have a raw disk file that can be installed using instructions in the <a href=https://www.eucastack.io/docs/image_guide/img_task_intro/img_task_install_hvm_image/>Install an HVM image</a> section. If you obtained a paravirtual image with kernel and ramdisk, you can install them with instructions in the <a href=https://www.eucastack.io/docs/image_guide/img_task_intro/img_add_existing/>Install a paravirtual image</a> section.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-5acab9f9462dcc08070fbaebe7007f83>5.3.2 - Install an HVM Image</h1><p>HVM (Hardware-assisted Virtual Machine) images are sequences of raw sectors of a complete bootable disk, including a boot loader and one or more partitions with an operating system. Such images are self-contained and can be booted on hardware that supports virtualization or on a full software emulation of hardware (QEMU).</p><p>At run time, HVM images can be deployed to disks local to the hypervisor (so-called Instance Store images) or they can run off of dynamic volumes on EBS (so-called EBS-backed instances or boot-from-EBS instances). This topic covers methods for installing an HVM image into either type of EMI.</p><h2 id=install-an-hvm-image-as-an-instance-store-emi>Install an HVM image as an Instance Store EMI</h2><p>Bundle, upload, and register the HVM image. All of this can be accomplished with a single command. For Linux images, the required options are:</p><p><code>euca-install-image -i /path/to/hvm-image -n name-of-the-image -r x86_64 --virtualization-type hvm -b bucket-name-for-image</code></p><h2 id=install-an-hvm-image-as-an-ebs-backed-emi>Install an HVM image as an EBS-Backed EMI</h2><p>An EBS-backed image (sometimes referred to as a &ldquo;bfEBS&rdquo; image) is an image with a root device that is an EBS volume created from an EBS snapshot. An EBS-backed image has a number of advantages (over an Instance Store image), including:</p><ul><li>Faster boot time</li><li>Larger volume size limits</li><li>Changes to the data on the image persist after instance termination</li></ul><h2 id=option-a-install-an-ebs-image-with-euca-import-vol>Option A: Install an EBS image with euca-import-vol</h2><p>With this method, a single command uploads image data into Object Store and triggers a conversion task, which copies the data into an EBS volume. The volume will be the source of the snapshot behind the EBS-backed EMI.Import the HVM image file into Object Storage and then copy it into EBS. For example: <code>euca-import-volume /path/to/hvm-image --format raw --availability-zone AZ-NAME --bucket bucket-for-hvm-image --owner-akid $EC2_ACCESS_KEY --owner-sak $EC2_SECRET_KEY --prefix image-name-prefix --description "textual description"</code><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If the volume import process was interrupted, import can be resumed (within a one-week deadline) with the following command:</div>After the volume data has been uploaded to Object Store, an internal conversion task will copy the data into a new EBS volume. You can query the progress of this task with the following command: <code>euca-describe-conversion-tasks import-vol-fae1e94d</code> Once the task has finished successfully and the volume is available, you can take a snapshot of the volume: <code>euca-create-snapshot &lt;volume-id></code> You can now register the snapshot: <code>euca-register --name &lt;image-name> --snapshot &lt;snapshot-id> --root-device-name &lt;device></code> You&rsquo;ve now created a EBS-backed image. To maintain data persistence, be sure to use <code>euca-stop-instances</code> and <code>euca-start-instances</code> to stop and start your EBS-backed instance.</p><h2 id=option-b-install-an-ebs-image-with-euca-import-instance>Option B: Install an EBS image with euca-import-instance</h2><p>With this method, a single command uploads image data into the Object Store and triggers a conversion task; this conversion task copies the data into an EBS volumetakes a snapshot of the volume, registers the snapshot as an EMI, and deploys the EMI as an instance.Turn an HVM image into a running EBS instance with a single command:<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Just as with euca-run-instance, one can specify the Instance Type for the instance that will run, as well as the SSH key. For example:</div><code>euca-import-instance /root/paravirtualimage/ubuntuJune06.img --format raw --architecture x86_64 --platform Linux --availability-zone EDU --bucket import_instance --owner-akid $EC2_ACCESS_KEY --owner-sak $EC2_SECRET_KEY --prefix eduii --description "import instance" --key admin --instance-type m1.small</code><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4><p>If volume import process was interrupted (by an interruption of the command or due to a network mishap, import can be resumed (within a one-week deadline).</p><p><code>euca-resume-import -t import-i-b393f3f6 /path/to/hvm-image</code></p></div>After the volume data has been uploaded to Object Store, an internal conversion task will copy the data into a new EBS volume. You can query the progress of this task with the following command: <code>euca-describe-conversion-tasks import-i-b393f3f6</code> Once the conversion task has finished successfully, you should see a running instance. You may log into that instance if you specified an SSH key. To maintain data persistence, be sure to use <code>euca-stop-instances</code> and <code>euca-start-instances</code> to stop and start your EBS-backed instance.</p><h2 id=option-c-install-an-ebs-image-using-a-helper-instance>Option C: Install an EBS image using a helper instance</h2><p>This is a more manual method for installing an HVM image into an EBS-backed EMI. Instead of importing the image data into an EBS volume directly, a helper instance is used to copy data from the image file into the volume. The helper instance can be either an instance store or an EBS-backed instance, and can be deleted when ﬁnished. The volume will be the source of the snapshot behind the EBS-backed EMI.Create and launch a help instance. Create a volume big enough to hold the bootable image file: <code>euca-create-volume -z &lt;cluster_name> -s &lt;size_in_GB></code> Attach the volume to the helper instance: <code>euca-attach-volume &lt;volume-id> -i &lt;instance-id> -d &lt;device></code> Log in to the instance and copy the bootable image to the attached volume by performing one of the following steps: If the bootable image is saved in an http or ftp repository, use <code>curl</code> or <code>wget</code> to download the .img file to the attached volume. For example: <code>curl &lt;path_to_bootable_image> > &lt;device></code></p><p>If the bootable image is from a source other than an http or FTP repository, copy the bootable image from its source to the helper instance, and then copy it to the attached volume using the <code>dd</code> command. For example: <code>dd if=&lt;path_to_bootable_image> of=&lt;device> bs=1M</code></p><p>Detach the volume from the instance: <code>euca-detach-volume &lt;volume-id></code> Create a snapshot of the volume: <code>euca-create-snapshot &lt;volume-id></code> Register the snapshot: <code>euca-register --name &lt;image-name> --snapshot &lt;snapshot-id> --root-device-name &lt;device></code> You&rsquo;ve now created a EBS-backed image. To maintain data persistence, be sure to use <code>euca-stop-instances</code> and <code>euca-start-instances</code> to stop and start your EBS-backed instance.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-c907c3df7ce28d2ca48fad707ab84eb1>5.3.3 - Create an HVM Image</h1><h1 id=create-an-hvm-image>Create an HVM Image</h1><p>This section covers how to create a new image for use in your Eucalyptus cloud.</p></div><div class=td-content><h1 id=pg-45164578f8923bf27cb79d783bb5ddb9>5.3.3.1 - Create an HVM Image from a Linux Distribution ISO (KVM)</h1><p>This topic shows how to install a Linux distribution ISO and prepare an image for registration with Eucalyptus.Use the QEMU disk utility to create a disk image. In the following example, we create a 5GB disk image: <code>qemu-img create -f raw centos7.img 5G</code> Use the <code>parted</code> utility to set the disk label. <code>parted centos7.img mklabel msdos</code> Use <code>virt-install</code> to start a new virtual machine installation, as in the following example (note the example has been broken into multiple lines for formatting purposes):</p><pre><code>virt-install --name centos7 --ram 1024 --os-type linux --os-variant rhel7 
 -c /tmp/CentOS-7.0-x86_64-bin-DVD1.iso --disk path=/tmp/centos7.img,device=disk,bus=virtio 
 --graphics vnc,listen=0.0.0.0 --force 
</code></pre><p>Use the VNC client of your choice to connect to the new virtual machine and complete the installation. Modify the following <code>libvirt.xml</code> template to create the VM and run <code>virsh create &lt;libvirt.xml>"</code> .</p><pre><code> &lt;domain type='kvm'&gt;
    &lt;name&gt;eucalyptus-centos&lt;/name&gt;
    &lt;os&gt;
        &lt;type&gt;hvm&lt;/type&gt;
    &lt;/os&gt;
    &lt;features&gt;
        &lt;acpi/&gt;
    &lt;/features&gt;
    &lt;memory&gt;1073741&lt;/memory&gt;
    &lt;vcpu&gt;1&lt;/vcpu&gt;
    &lt;devices&gt;
        &lt;!--&lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;--&gt;
        &lt;disk type='file'&gt;
            &lt;source file='/tmp/centos7.img'/&gt;
            &lt;target dev='hda'/&gt;
        &lt;/disk&gt;
     &lt;interface type='bridge'&gt;
         &lt;source bridge='br0'/&gt;
         &lt;model type='virtio'/&gt;
     &lt;/interface&gt;
        &lt;graphics type='vnc' port='-1' autoport='yes' listen='0.0.0.0'/&gt;
    &lt;/devices&gt;
&lt;/domain&gt;
</code></pre><p>Connect to the virtual machine using your VNC client of choice and make the following configuration changes: Modify the <code>/etc/sysconfig/network-scripts/ifcfg-eth0</code> file and set the <code>ONBOOT</code> option to &ldquo;yes&rdquo;. For example:</p><pre><code>DEVICE=&quot;eth0&quot;
BOOTPROTO=&quot;dhcp&quot;
#HWADDR=&quot;B8:AC:6F:83:1C:45&quot;
IPV6INIT=&quot;yes&quot;
MTU=&quot;1500&quot;
NM_CONTROLLED=&quot;yes&quot;
ONBOOT=&quot;yes&quot;
TYPE=&quot;Ethernet&quot;
UUID=&quot;499c07cc-4a53-408c-87d2-ce0db991648e&quot;
PERSISTENT_DHCLIENT=1
</code></pre><p>Enable a serial console on the virtual machine by adding the following option to the end of the /boot/grub/menu.lst: <code>console=ttyS0</code> Remove the <code>quiet</code> option from the kernel parameters and the grub menu splash image in the <code>/boot/grub/menu.lst</code> file. For example:</p><pre><code># grub.conf generated by anaconda
#
# Note that you do not have to rerun grub after making changes to this file
# NOTICE:  You have a /boot partition.  This means that
#          all kernel and initrd paths are relative to /boot/, eg.
#          root (hd0,0)
#          kernel /vmlinuz-version ro root=/dev/sda2
#          initrd /initrd-[generic-]version.img
#boot=/dev/sda
default=0
timeout=5
#splashimage=(hd0,0)/grub/splash.xpm.gz
hiddenmenu
title Eucalyptus (n.n.32-358.18.1.el7.x86_64)
	root (hd0,0)
	kernel /vmlinuz-n.n.32-358.18.1.el7.x86_64 ro root=UUID=062b9c31-95f3-424f-8b47-35107cfdfc08 rd_NO_LUKS rd_NO_LVM LANG=en_US.UTF-8 rd_NO_MD SYSFONT=latarcyrheb-sun16 crashkernel=auto  KEYBOARDTYPE=pc KEYTABLE=us rd_NO_DM rhgb
	initrd /initramfs-n.n.32-358.18.1.el7.x86_64.img
</code></pre><p>Add the following line to the <code>/etc/sysconfig/network</code> file to disable the zeroconf route, which can interfere with access to the metadata service: <code>NOZEROCONF=yes</code> Edit the <code>/etc/udev/rules.d/70-persistent-net.rules</code> file and remove all entries for the existing network interface. Make sure that you delete all entries before terminating the virtual machine and registering it with Eucalyptus. Eucalyptus instances use cloud-init to specify actions to run on your instance at boot time, which can be passed using the userdata parameter. To install and configure <code>cloud-init</code> on your instance: Install cloud-init:</p><pre><code># rpm -Uvh http://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm
# yum install cloud-init
</code></pre><p>By default, cloud-init uses ec2-user as the log-in user. Add ec2-user to your instance and give it appropriate sudo permissions:</p><pre><code> # adduser ec2-user
 # passwd ec2-user
</code></pre><p>Run visudo and add the following entries at the bottom of the sudoers file:</p><pre><code>## Allow root to run any commands anywhere
     root    ALL=(ALL)       ALL 
     ec2-user        ALL=(ALL)       NOPASSWD: ALL  
</code></pre><p>You can optionally copy Eucalyptus <code>rc.local</code> file (available at <a href=https://github.com/eucalyptus/Eucalyptus-Scripts/blob/master/rc.local></a> ) to the <code>/etc</code> directory on your virtual machine and modify it as needed. You now have a raw disk file that can be installed using instructions in the <a href=https://www.eucastack.io/docs/image_guide/img_task_intro/img_task_install_hvm_image/>Install an HVM image</a> section.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-2f36b1734e7c4ede8a5fa61fa256d3eb>5.3.4 - Migrate an Image</h1><h1 id=migrate-an-image>Migrate an Image</h1><p>This section covers migrating images to and from your Eucalyptus cloud.</p></div><div class=td-content><h1 id=pg-c4467c3959f12bd32dd51b6e0a608dc9>5.3.4.1 - Create an Image from an Existing EBS-Backed Instance</h1><p>A common way to create a new image is to customize an existing instance. This topic describes how to create a new image by modifying an existing EBS-backed instance.This example shows how to create a new EBS-backed Eucalyptus image based on an existing EBS-backed Eucalyptus instance.</p><p>Log on to an existing Eucalyptus EBS-backed instance and customize the instance. Prepare the image. See <a href></a> for instructions. Create a new image based on the image you just modified by using the eucalyptus-create-image command, specifying a name, a description, and the instance ID of the Eucalyptus instance you customized in the previous step. For example: <code>euca-create-image -n "mynewimage" -d "This is my new custom recycled image" i-1ABCDEFF</code> This command will show the ID of the new machine image and exit immediately. In the background, Eucalyptus will begin the process of creating a new image based on the instance you supplied.</p><p>You can monitor the status of the image using the euca-describe-images command, supplying the ID of the image returned from the euca-create-image command. For example:</p><p><code>euca-describe-images i-e12398ab</code></p></div><div class=td-content style=page-break-before:always><h1 id=pg-7ae829a308446b76f985667650c1a46a>5.3.4.2 - Create an Image from an Existing Instance-Store Instance</h1><p>A common way to create a new image is to customize an existing instance.This example shows how to create a new instance store Eucalyptus image based on an existing instance store Eucalyptus instance. This topic describes how to create a new image by modifying an existing instance-store instance.</p><p>Log on to an existing Eucalyptus instance-store instance and customize the instance. See Prepare a Linux Image for Eucalyptus <a href></a> for instructions on required changes the instance needs before re-bundling. Create a new image based on the image you just modified by using the <code>euca-bundle-instance</code> command, specifying a name, a description, and the instance ID of the Eucalyptus instance you customized in the previous step. For example:</p><pre><code>euca-bundle-instance -b mybundle -p mycentos6 -o $EC2_ACCESS_KEY -w $EC2_SECRET_KEY i-96154365
BUNDLE     bun-96154365     i-96154365     mybundle     mycentos     62013-11-05T21:37:23.469Z2013-11-05T21:37:23.469Z     pending     0
</code></pre><p>This command will the bundle task ID and exit immediately. In the background, Eucalyptus will begin the bundling process. Depending on the size of the instance, it can take several minutes for the bundling task to complete.</p><p>You can monitor the status of the bundle task using the <code>euca-describe-bundle-tasks</code> command, supplying the ID of the image returned from the <code>eucalyptus-bundle-instance</code> command. For example:</p><pre><code>euca-describe-bundle-tasks
BUNDLE     bun-96154365     i-96154365     mybundle     mycentos6     2013-11-05T21:37:23.469Z2013-11-05T21:37:58.446Z     storing     0
</code></pre><p>Once the bundle task is complete, you can register thebundle as an instance-store image using the euca-register command, specifying the path to the bundle manifest in the format <code>[bucket]/[prefix].manifest.xml</code> .<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>You should always explicitly declare the instance type of a bundle created with as an HVM type using &ndash;virtualization-type parameter. For example:</div><code>euca-register --virtualization-type=hvm mybundle/mycentos6.manifest.xml.</code> Your new image is now ready for use in your Eucalyptus cloud.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-a6c7933f04213a52b2578c77b81cbc98>5.3.4.3 - Prepare a Linux System for Eucalyptus</h1><p>This section explains how to prepare a running Linux system (cloud instance, virtual machine, or a system running on bare metal) before importing it for use in Eucalyptus.<strong>Install cloud software and drivers:</strong> Make sure Virtio drivers are installed if the image is going to be run in a KVM cluster which has virtio enabled, and verify use if possible (ie. set disks and network interface in hypervisor, try hot plug in for disks, etc). For most recent Linux distributions nothing is needed to be done. Make sure appropriate init scripts are in place; for example: cloud-init packages (if appropriate), and rc.local or similar scripts to prepare new instances at boot time utilizing user/meta-data.</p><p>Install cloud-init:</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>For more information on cloud-init, go to <a href=https://help.ubuntu.com/community/CloudInit>https://help.ubuntu.com/community/CloudInit</a></div><p>For Red Hat Enterprise Linux, and CentOS 7:</p><pre><code>yum install cloud-init
</code></pre><p>Install and configure ssh: For Red Hat and CentOS:</p><pre><code>yum install openssh-server
systemctl enable sshd.service
</code></pre><p>Install Euca2ools: For Red Hat and CentOS:</p><pre><code>yum install euca2ools
</code></pre><p>Optionally, update existing packages. For RHEL and CentOS:</p><pre><code>yum update
</code></pre><p><strong>Prepare the network:</strong> Disable the firewall. It is recommended that the firewall is disabled and network rules are instead enforced in the security-group the instances run in. If the guest&rsquo;s firewall is not disabled, review the existing rules and make sure they are appropriate for the guest&rsquo;s future use within a cloud environment. Clear or disable iptable rules: Save the rules in case you want to restore them later:</p><pre><code>sudo iptables-save &gt; /root/firewall.rules
</code></pre><p>Clear the rules:</p><pre><code>iptables -F
iptables -X
iptables -t nat -F
iptables -t nat -X
iptables -t mangle -F
iptables -t mangle -X
iptables -P INPUT ACCEPT
iptables -P OUTPUT ACCEPT
iptables -P FORWARD ACCEPT
</code></pre><p>For RHEL and CentOS 7, see the Red Hat Migration and Planning Guide <a href=https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Migration_Planning_Guide/sect-Red_Hat_Enterprise_Linux-Migration_Planning_Guide-Security_and_Access_Control.html>Security and Access Control section</a> .</p><p>Make sure there is only a single primary network interface. Check the configuration for:</p><ul><li>Enabled on boot (ONBOOT=&ldquo;yes&rdquo;)</li><li>IP provisioning is done via DHCP (BOOTPROTO=&ldquo;dhcp&rdquo;)</li><li>MAC address is commented out (for example: #HWADDR=&ldquo;AA:BB:CC:DD:EE:FF&rdquo;)</li></ul><p>For RHEL and CentOS images, the configuration for the default network interface can usually be found in the following file:</p><pre><code>/etc/sysconfig/network-scripts/ifcfg-eth0
</code></pre><p>The following is an example of an <code>ifcfg-eth0</code> configuration file:</p><pre><code>DEVICE=eth0
ONBOOT=yes
#THE HWADDR LINE MUST BE COMMENTED OUT OR REMOVED
#HWADDR=AA:BB:CC:DD:EE:FF
TYPE=Ethernet
BOOTPROTO=dhcp
PERSISTENT_DHCLIENT=yes
</code></pre><p>Remove persistent udev rules:</p><pre><code>echo &quot;&quot; &gt; /etc/udev/rules.d/70-persistent-net.rules 
echo &quot;&quot; &gt; /lib/udev/rules.d/75-persistent-net-generator.rules 
</code></pre><p>On CentOS and RHEL, disable zeroconf by adding an entry to the <code>/etc/sysconfig/network</code> file:</p><pre><code>NETWORKING=yes
NOZEROCONF=yes
</code></pre><p><strong>Clean the image:</strong> We recommend that you remove all non-root, non-administrator users before bundling the image. Remove root/Administrator password. We recommend that you remove root&rsquo;s password for Linux systems.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Once these passwords are removed, access to this system will be limited or blocked until this image is recreated as a cloud instance. SSH host and authorization keys for Linux will be used going forward.</div>Remove any unwanted programs. Configure a serial port by adding an option to the end of the <code>/boot/grub/menu.lst</code> file: <code>console=ttyS0</code> You&rsquo;ve now prepared your instance for image creation.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-83a5584fa76ae7d7f1cd6f56000c1f48>5.3.4.4 - Migrate a Linux Image from AWS to Eucalyptus</h1><p>You can migrate an S3-backed image from AWS to Eucalyptus.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>This topic assumes you are migrating an S3-backed Amazon Machine Image (AMI) that you own. For instructions on creating an S3-backed AMI from an existing AMI, see .</div></p><p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Specific examples may vary depending on the distro running on the image that you want to migrate.</div>Set up your Euca2ools configuration to work with both Eucalyptus and Amazon Web Services. Check ownership of the AMI that you want to migrate to Eucalyptus by using the euca-describe-images command. For example:</p><pre><code>euca-describe-images --region us-east-1 --owner 999999999999
IMAGE	ami-e1a1e888	999999999999/precise-test	999999999999	available	private		x86_64	machine	aki-88aa75e1			instance-store	paravirtual	xen
	BLOCKDEVICEMAPPING	EPHEMERAL	sda2	ephemeral0
</code></pre><p>Run the AWS instance.</p><pre><code>euca-run-instance ami-e1a1e888 --region us-east-1 
</code></pre><p>Install Euca2ools on the instance. For instructions, see the Euca2ools Guide. Make sure that you have enough space on a volume to hold the bundle that we will create. Bundle the running AWS instance. For example:</p><pre><code>sudo -s
ec2-bundle-vol -b testbucket -d /mnt -u 4299-4227-3585 -k my-aws.pem -c my-aws-cert.pem -r x86_64 -s 2048
Copying / into the image file /mnt/image...
Excluding:
	 /dev/pts
	 /
	 /sys
	 /proc
	 /proc/sys/fs/binfmt_misc
	 /dev
	 /media
	 /mnt
	 /proc
	 /sys
	 /mnt/image
	 /mnt/img-mnt
1+0 records in
1+0 records out
1048576 bytes (1.0 MB) copied, 0.00209056 s, 502 MB/s
mke2fs 1.42.3 (14-May-2012)
Bundling image file...
Splitting /mnt/image.tar.gz.enc...
Created image.part.00
Created image.part.01
[example truncated]
Created image.part.30
Generating digests for each part...
Digests generated.
Unable to read instance meta-data for ancestor-ami-ids
Unable to read instance meta-data for ramdisk-id
Unable to read instance meta-data for product-codes
Creating bundle manifest...
ec2-bundle-vol complete.
</code></pre><p>Switch the Euca2ools configuration file to use Eucalyptus. You can do this by specifying the Eucalyptus region as defined in your Euca2ools configuration file by specifying the <code>--region</code> parameter on the command line, or by changing the <code>default-region</code> option in the Euca2ools configuration file:</p><pre><code>default-region = euca-release
</code></pre><p>Download the bundle from the AWS S3 bucket:</p><pre><code>euca-download-bundle --bucket testbucket --directory /tmp/aws-image/ --region us-east-1
</code></pre><p>Unbundle the AWS instance bundle:</p><pre><code>euca-unbundle --manifest /tmp/aws-image/image.manifest.xml --source /tmp/aws-image/ --destination /tmp/aws-image/ --region us-east-1
</code></pre><p>Run some checks to make sure that the image can be used with Eucalyptus: Mount the image via loopback:</p><pre><code>#  sudo mkdir /mnt/aws-image
	#  sudo mount -o loop /tmp/aws-image/image /mnt/aws-image
	#  df -ah 
	……
	/tmp/aws-image/image
                      9.9G  1.1G  8.3G  12% /mnt/aws-image
</code></pre><p>Make sure that the distro repositories in the image do not point to EC2-specific repositories. TODO: Need an actual example here. Install a non-Xen kernel into the image from distro and make sure VirtIO modules are added. TODO: Need an actual example here. Extract the ramdisk and kernel to be bundled, uploaded and registered as ERI and EKI files. In this example, initrd.img-3.2.0-53-virtual and vmlinuz-3.2.0-53-virtual will be copied from /mnt/aws-image/boot to the /tmp/aws-image directory:</p><pre><code># sudo cp /mnt/aws-image/boot/initrd.img-3.2.0-53-virtual /tmp/aws-image/.
# sudo cp /mnt/aws-image/boot/vmlinuz-3.2.0-53-virtual /tmp/aws-image/.
</code></pre><p>Make sure that the file system of the image is either ext2, ext3, or ext4 by using the file command. For example:</p><pre><code># file /tmp/aws-image/image
/tmp/aws-image/image: Linux rev 1.0 ext4 filesystem data (extents) (large files) (huge files)
</code></pre><p>Bundle the image using euca-bundle-image:</p><pre><code>euca-bundle-image -i /tmp/aws-image/image
</code></pre><p>Upload the AWS bundled instance to Eucalyptus.</p><pre><code>euca-upload-bundle -b hybrid-guide-sample-bucket -m /tmp/aws-image/image.manifest.xml --access-key myaccesskey --secret-key mysecretkey
</code></pre><p>Test the new uploaded image.</p><pre><code>euca-run-instance emi-a6e15bcf
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-d754d743eb9edad186e0971725e7173b>5.3.4.5 - Migrate a Linux Image from Eucalyptus to AWS</h1><p>This topic describes how to migrate an image from Eucalyptus to AWS.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>These are high-level guidelines for moving an instance from Eucalyptus to AWS. Specific examples will vary depending on the distro running on the image.</div>Run an instance from the image you chose.</p><pre><code>euca-run-instance emi-1A6338AE
</code></pre><p>SSH into the instance and verify that the instance is valid for use with AWS: Download the latest ec2-modules from <a href=http://s3.amazonaws.com/ec2-downloads></a> and put them into the <code>/lib/modules</code> directory on the instance. Copy the AWS EC2 certificate and private key from the AWS instance to your local workstation. Shut down unneeded services on the AWS instance (for example, Apache and MySQL). Clear out log files and bash history files. Remove your ssh keys from the instance. Reset passwords for the instance, and for any services that maintain their own password database. Clear out any temporary directories. Install Euca2ools on the instance.</p><p>Mount a volume that is at least 1.5 times as large as the entire instance. Bundle the running instance.</p><pre><code>euca-bundle-instance 
</code></pre><p>Switch the Euca2ools configuration file to use Eucalyptus</p><pre><code>default-region = euca-release
</code></pre><p>Upload the AWS bundled instance to Eucalyptus.</p><pre><code>euca-upload-bundle -b bucket_name -m manifest_file
</code></pre><p>Test the new uploaded image.</p><pre><code>euca-run-instance emi-a6e15bcf
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-f0a7abff6f890e9d6a76f4948f030b61>5.3.5 - Install a paravirtual image</h1><h1 id=install-a-paravirtual-image>Install a paravirtual image</h1><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>As of Eucalyptus version 4.0, it is now required to pass a Eucalyptus Kernel Image (EKI) and a Eucalyptus Ramdisk Image (ERI) when uploading and registering a paravirtual Eucalyptus Machine Image (EMI) using the , , and command line tools.</div><p>Once you&rsquo;ve customized or acquired a paravirtual image to use with Eucalyptus, you can enable the image as an executable entity with the following steps:</p><ol><li>Unless a suitable kernel is already registered, bundle the kernel, upload it to Object Storage, and register it as a new EKI.</li><li>Unless a suitable ramdisk is already registered, bundle the ramdisk, upload it to Object Storage, and register it as a new ERI</li><li>Bundle the root disk image, which must be a Linux partition, requesting the kernel and ramdisk that you desire, upload the bundle to Object Storage, and register it as a new EMI.</li></ol><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Note that while all users can bundle, upload and register images, only users under the account have the required permissions to upload and register kernels and ramdisks.</div><p>Once you have an image that meets your needs, perform the tasks listed in this section to add the image to your cloud.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-124214d3be37c49eb70ea51c9e3be93a>5.3.5.1 - Add a Kernel</h1><p>When you add a kernel to Walrus, you bundle the kernel file, upload the file to a bucket in Walrus that you name, and then register the kernel with Eucalyptus.</p><p>To add a kernel to Walrus:</p><p>Use the following three commands:</p><pre><code>euca-bundle-image -i &lt;kernel_file&gt; --kernel true --arch &lt;architecture&gt;
euca-upload-bundle -b &lt;kernel_bucket&gt; -m /tmp/&lt;kernel_file&gt;.manifest.xml
euca-register &lt;kernel_bucket&gt;/&lt;kernel_file&gt;.manifest.xml -a x86_64 -n mynewkernel
</code></pre><p>For example:</p><pre><code>euca-bundle-image -i euca-fedora-10-x86_64/xen-kernel/vmlinuz-2.6.27.21-0.1-xen --kernel true --arch x86_64
...
Generating manifest /tmp/vmlinuz-2.6.27.21-0.1-xen.manifest.xml

euca-upload-bundle -b example_kernel_bucket -m /tmp/vmlinuz-2.6.27.21-0.1-xen.manifest.xml
...
Uploaded image as example_kernel_bucket/vmlinuz-2.6.27.21-0.1-xen.manifest.xml

euca-register example_kernel_bucket/vmlinuz-2.6.27.21-0.1-xen.manifest.xml -a x86_64 -n mynewkernel
IMAGE	eki-XXXXXXXX
</code></pre><p>Where the returned value <code>eki-XXXXXXXX</code> is the unique ID of the registered kernel image.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-a58ff9b57c5502b55b633d737a109153>5.3.5.2 - Add a Ramdisk</h1><p>When you add a ramdisk to Walrus, you bundle the ramdisk file, upload the file to a bucket in Walrus that you name, and then register the ramdisk with Eucalyptus.</p><p>To add a ramdisk to Walrus:</p><p>Use the following three commands:</p><pre><code>euca-bundle-image -i &lt;ramdisk_file&gt; --ramdisk true -r x86_64
euca-upload-bundle -b &lt;ramdisk_bucket&gt; -m /tmp/&lt;ramdisk_file&gt;.manifest.xml
euca-register &lt;ramdisk_bucket&gt;/&lt;ramdisk_file&gt;.manifest.xml -n &lt;name_of_ramdisk&gt;
</code></pre><p>For example:</p><pre><code>euca-bundle-image -i euca-fedora-10-x86_64/xen-kernel/initrd-2.6.27.21-0.1-xen 
--ramdisk true -r x86_64
...
Generating manifest /tmp/initrd-2.6.27.21-0.1-xen.manifest.xml

euca-upload-bundle -b example_rd_bucket -m /tmp/initrd-2.6.27.21-0.1-xen.manifest.xml
...
Uploaded image as example_rd_bucket/initrd-2.6.27.21-0.1-xen.manifest.xm

euca-register example_rd_bucket/initrd-2.6.27.21-0.1-xen.manifest.xml -n mynewramdisk
IMAGE	eri-XXXXXXXX 
</code></pre><p>Where the returned value <code>eri-XXXXXXXX</code> is the unique ID of the registered ramdisk image.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-5b52a2311765cea7d4c67e50b33cee77>5.3.5.3 - Add a Root Filesystem</h1><p>When you add a root filesystem to Walrus, you bundle the root filesystem file, upload the file to a bucket in Walrus that you name, and then register the root filesystem with Eucalyptus. The bundle operation can include a registered ramdisk (ERI ID) and a registered kernel (EKI ID). The resulting image will associate the three images.</p><p>You can also bundle the root file system independently and associate the ramdisk and kernel with the resulting EMI at run time.</p><p>To add a root filesystem to Walrus:</p><p>Use the following three commands:</p><pre><code>euca-bundle-image -i &lt;root_filesystem_file&gt; -r &lt;architecture&gt;
euca-upload-bundle -b &lt;root_filesystem_file_bucket&gt; -m /tmp/&lt;root_filesystem_file&gt;.manifest.xml
euca-register &lt;root_filesystem_file_bucket&gt;/&lt;root_filesystem_file&gt;.manifest.xml -n &lt;rootfs_name&gt; -a &lt;architecture&gt;
</code></pre><p>For example:</p><pre><code>euca-bundle-image -i euca-fedora-10-x86_64/fedora.10.x86-64.img  --ramdisk eri-722B3CBA --kernel eki-5B3D3859 -r x86_64
...
Generating manifest /tmp/fedora.10.x86-64.img.manifest.xml

euca-upload-bundle -b example_rf_bucket -m /tmp/fedora.10.x86-64.img.manifest.xml
...
Generating manifest /tmp/fedora.10.x86-64.img.manifest.xml

euca-register example_rf_bucket/fedora.10.x86-64.img.manifest.xml -n example_rf -a x86_64
IMAGE	 emi-XXXXXXXX
</code></pre><p>Where the returned value <code>emi-XXXXXXXX</code> is the unique ID of the registered machine image.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-dd61de6258e3b46d3f1d9e7ca4b14e4f>5.3.6 - Remove an Image</h1><p>When a new image is uploaded to Eucalyptus, Eucalyptus saves the bundle and the image manifest to a bucket in Walrus. This bucket is stored in the Walrus directory that is defined in the Eucalyptus property <code>walrusbackend.storageDir</code> . The default value for this property is <code>/var/lib/eucalyptus/bukkits</code> .</p><p>When you register an image, Eucalyptus creates the actual image file. Both the image manifest and the bundle must remain intact to run as an instance.</p><p>To delete an image fully, you must deregister the image and delete the bundle. To successfully remove an image and associated bundle files:</p><p>Find the image you want to remove.</p><pre><code>euca-describe-images 
IMAGE   emi-E533392E    alpha/centos.5-3.x86-64.img.manifest.xml    965590394582
available   public   i386    machine eki-345135C9    eri-C4F135BC  instance-store
IMAGE   emi-623C38B0  alpha/ubuntu.9-04.x86-64.img.manifest.xml   965590394582 
available   public   i386    machine eki-E6B13926    eri-94DB3AB9  instance-store
</code></pre><p>Note the image file name (for example, emi-623C38B0). Deregister the image.</p><pre><code>euca-deregister emi-623C38B0
IMAGE   emi-623C38B0
</code></pre><p>Delete the bundle.</p><pre><code>euca-delete-bundle -b alpha -p ubuntu.9-04.x86-64.img
</code></pre><p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If you accidentally try to delete a bundle for a second time, you might see an error message: . This error only displays if you try to delete a bundle that no longer exists.</div>When you have finished these steps, display all images to confirm that the image was removed.</p><pre><code>euca-describe-images 
IMAGE   emi-E533392E    alpha/centos.5-3.x86-64.img.manifest.xml    965590394582
available   public   i386    machine eki-345135C9    eri-C4F135BC  instance-store
</code></pre></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Community forums" aria-label="Community forums"><a class=text-white target=_blank rel=noopener href=https://github.com/orgs/eucastack/discussions aria-label="Community forums"><i class="fa fa-comments"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank rel=noopener href=https://twitter.com/eucastack aria-label=Twitter><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Stack Overflow" aria-label="Stack Overflow"><a class=text-white target=_blank rel=noopener href=https://stackoverflow.com/questions/tagged/eucastack aria-label="Stack Overflow"><i class="fab fa-stack-overflow"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/eucastack aria-label=GitHub><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Discord aria-label=Discord><a class=text-white target=_blank rel=noopener href=https://discord.gg/A9UPtck4 aria-label=Discord><i class="fab fa-discord"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2022 EucaStack All Rights Reserved</small>
<small class=ml-1><a href=https://policies.google.com/privacy target=_blank rel=noopener>Privacy Policy</a></small></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA==" crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script>
<script src=/js/main.min.6f618f935d0e212fc39316b4023fa69460fd4a5779211bdc3535ec542578f225.js integrity="sha256-b2GPk10OIS/Dkxa0Aj+mlGD9Sld5IRvcNTXsVCV48iU=" crossorigin=anonymous></script></body></html>