<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.99.0"><link rel=canonical type=text/html href=https://www.eucastack.io/docs/image_guide/img_task_intro/><link rel=alternate type=application/rss+xml href=https://www.eucastack.io/docs/image_guide/img_task_intro/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Image Tasks | EucaStack</title><meta name=description content="Image Tasks
An image is the basis for instances that you spin up for your computing needs. This section explains how to create or acquire an image and …"><meta property="og:title" content="Image Tasks"><meta property="og:description" content="A Docsy example site"><meta property="og:type" content="website"><meta property="og:url" content="https://www.eucastack.io/docs/image_guide/img_task_intro/"><meta property="og:site_name" content="EucaStack"><meta itemprop=name content="Image Tasks"><meta itemprop=description content="A Docsy example site"><meta name=twitter:card content="summary"><meta name=twitter:title content="Image Tasks"><meta name=twitter:description content="A Docsy example site"><link rel=preload href=/scss/main.min.dbc832a6b41f9cb352db274e4a5e4f9087c9f9f914bcd919a25e9dad92d530f3.css as=style><link href=/scss/main.min.dbc832a6b41f9cb352db274e4a5e4f9087c9f9f914bcd919a25e9dad92d530f3.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-00000000-0","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><svg viewBox="0 0 1388.9 333.38" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g transform="translate(-136.21 41.582)"><path transform="matrix(.26458 0 0 .26458 136.21 -41.582)" d="m1616.4 487.23c-38.46.0-73.324 9.8216-104.59 29.467s-55.615 47.177-73.047 82.594c-17.155 35.14-25.732 75.123-25.732 119.95v12.451c0 66.96 19.782 120.64 59.35 161.04 39.844 40.12 91.725 60.18 155.64 60.18 37.354.0 70.971-7.3314 100.85-21.996 30.16-14.941 54.232-35.833 72.217-62.672l-54.369-51.879c-29.053 37.354-66.683 56.029-112.89 56.029-32.926.0-60.319-10.791-82.178-32.373-21.582-21.582-33.896-50.911-36.939-87.988h293.43v-40.674c0-71.387-16.741-126.59-50.221-165.6-33.203-39.014-80.378-58.52-141.53-58.52zm927.61.0c-63.086.0-112.89 20.613-149.41 61.84-36.523 40.951-54.785 95.598-54.785 163.94v10.377c0 71.663 18.399 127.83 55.199 168.51 36.8 40.674 86.605 61.01 149.41 61.01 32.373.0 62.532-7.0547 90.478-21.166 27.946-14.111 50.081-33.203 66.406-57.275 16.325-24.349 25.042-50.497 26.148-78.443h-95.045c-1.1067 21.582-9.9609 39.706-26.562 54.371-16.602 14.665-37.491 21.996-62.67 21.996-33.203.0-58.659-11.898-76.367-35.693-17.432-24.072-26.148-60.456-26.148-109.15v-16.188c.2767-48.145 9.2702-83.975 26.978-107.49 17.708-23.796 42.887-35.695 75.537-35.695 25.456.0 46.345 8.3008 62.67 24.902 16.602 16.602 25.456 37.77 26.562 63.502h95.045c-1.6602-50.635-19.368-91.448-53.125-122.44-33.48-31.266-76.921-46.898-130.32-46.898zm439.94.0c-34.587.0-65.992 6.0872-94.215 18.262-27.946 12.174-50.081 29.053-66.406 50.635-16.325 21.305-24.486 44.271-24.486 68.896h100.85c0-17.708 7.3333-32.236 21.998-43.58 14.665-11.621 33.48-17.432 56.445-17.432 26.562.0 46.345 7.0566 59.35 21.168 13.004 13.835 19.508 32.373 19.508 55.615v29.469h-61.842c-66.13.0-117.04 12.865-152.73 38.598-35.417 25.456-53.125 62.118-53.125 109.99.0 37.907 14.251 69.727 42.75 95.459s65.299 38.598 110.4 38.598c46.484.0 85.775-16.739 117.87-50.219 3.3203 19.369 7.194 33.34 11.621 41.918h102.93v-7.0547c-11.344-24.072-17.018-56.308-17.018-96.705v-202.54c-.8301-47.868-16.878-84.945-48.144-111.23-31.266-26.563-73.184-39.844-125.76-39.844zm-1099.9 8.3008v290.94c0 53.955 12.451 95.182 37.354 123.68 25.179 28.499 62.118 42.748 110.82 42.748 54.508.0 96.566-17.432 126.17-52.295l2.4903 43.994h95.045v-449.07h-100.86v322.49c-17.155 35.14-50.221 52.709-99.195 52.709-47.314.0-70.971-28.499-70.971-85.498v-289.7h-100.86zm-268.12 72.631c27.946.0 49.805 8.7168 65.576 26.148 15.772 17.155 24.765 42.611 26.978 76.367v7.4707h-192.16c4.7038-34.587 15.495-61.563 32.373-80.932 17.155-19.369 39.567-29.055 67.236-29.055zm1386.6 165.6h54.371v84.668c-8.8542 16.325-22.135 29.329-39.844 39.014-17.432 9.6842-36.109 14.527-56.031 14.527-21.582.0-38.874-5.6732-51.879-17.018-12.728-11.621-19.092-27.116-19.092-46.484.0-23.796 9.4075-42.195 28.223-55.199 18.815-13.005 46.898-19.508 84.252-19.508z" fill="#fff"/><path transform="matrix(.26458 0 0 .26458 136.21 -41.582)" d="m4889.8 307.1v637.5h100.85V798.09l44.824-46.07 133.23 192.58h116.62l-184.69-261.89 166.85-187.18h-121.19l-124.1 139.87-31.543 39.43V307.11h-100.85zm-1162.1 79.271v109.16h-73.877v74.707h73.877v254.42c0 85.498 38.737 128.25 116.21 128.25 21.305.0 43.441-3.181 66.406-9.5449v-78.027c-11.898 2.7669-23.656 4.1504-35.277 4.1504-17.432.0-29.606-3.7364-36.523-11.207-6.6406-7.7474-9.9609-20.199-9.9609-37.354v-250.68h79.272v-74.707h-79.272v-109.16h-100.86zm-296.34 100.86c-50.358.0-91.862 13.005-124.51 39.014-32.65 26.009-48.975 58.382-48.975 97.119.0 46.208 25.179 81.487 75.537 105.84 22.965 11.068 51.602 20.199 85.912 27.393 34.31 7.194 58.798 15.495 73.463 24.902 14.942 9.4076 22.412 23.103 22.412 41.088.0 16.325-6.9174 29.606-20.752 39.844-13.835 9.9609-34.033 14.941-60.596 14.941-27.392.0-49.39-6.3639-65.992-19.092-16.602-13.005-25.593-31.404-26.977-55.199h-97.949c0 26.839 8.0241 51.879 24.072 75.121 16.048 23.242 38.46 41.504 67.236 54.785s61.563 19.922 98.363 19.922c54.232.0 98.088-12.451 131.57-37.354 33.48-25.179 50.221-57.966 50.221-98.363.0-24.072-5.5338-44.548-16.602-61.426-10.791-16.878-27.532-31.266-50.221-43.164-22.412-12.174-53.402-22.551-92.969-31.129-39.567-8.8542-65.853-17.569-78.857-26.146-13.005-8.5775-19.508-20.615-19.508-36.109.0-17.155 6.9173-30.852 20.752-41.09 14.112-10.238 32.236-15.355 54.371-15.355 23.795.0 42.887 6.5013 57.275 19.506 14.388 12.728 21.582 28.776 21.582 48.145h100.86c0-42.334-16.602-76.781-49.805-103.34-32.926-26.563-76.23-39.844-129.91-39.844zm733.79.0c-34.587.0-65.99 6.0872-94.213 18.262-27.946 12.174-50.081 29.053-66.406 50.635-16.325 21.305-24.488 44.271-24.488 68.896h100.86c0-17.708 7.3313-32.236 21.996-43.58 14.665-11.621 33.48-17.432 56.445-17.432 26.562.0 46.347 7.0566 59.352 21.168 13.005 13.835 19.506 32.373 19.506 55.615v29.469h-61.84c-66.13.0-117.04 12.865-152.73 38.598-35.417 25.456-53.125 62.118-53.125 109.99.0 37.907 14.249 69.727 42.748 95.459 28.499 25.732 65.3 38.598 110.4 38.598 46.484.0 85.775-16.739 117.87-50.219 3.3202 19.369 7.194 33.34 11.621 41.918h102.93v-7.0547c-11.344-24.072-17.016-56.308-17.016-96.705v-202.54c-.83-47.868-16.878-84.945-48.144-111.23-31.266-26.563-73.186-39.844-125.76-39.844zm464.84.0c-63.086.0-112.89 20.613-149.41 61.84-36.524 40.951-54.785 95.598-54.785 163.94v10.377c0 71.663 18.401 127.83 55.201 168.51 36.8 40.674 86.605 61.01 149.41 61.01 32.373.0 62.532-7.0547 90.479-21.166 27.946-14.111 50.081-33.203 66.406-57.275 16.325-24.349 25.042-50.497 26.148-78.443h-95.045c-1.1066 21.582-9.9608 39.706-26.562 54.371-16.601 14.665-37.493 21.996-62.672 21.996-33.203.0-58.659-11.898-76.367-35.693-17.432-24.072-26.146-60.456-26.146-109.15V711.36c.2769-48.145 9.2682-83.975 26.976-107.49 17.708-23.796 42.888-35.695 75.537-35.695 25.456.0 46.347 8.3008 62.672 24.902 16.602 16.602 25.456 37.77 26.562 63.502h95.045c-1.6602-50.635-19.37-91.448-53.127-122.44-33.48-31.266-76.921-46.898-130.32-46.898zm-446.17 246.53h54.369v84.668c-8.8541 16.325-22.135 29.329-39.844 39.014-17.432 9.6842-36.107 14.527-56.029 14.527-21.582.0-38.876-5.6732-51.881-17.018-12.728-11.621-19.092-27.116-19.092-46.484.0-23.796 9.4075-42.195 28.223-55.199 18.815-13.005 46.9-19.508 84.254-19.508z" fill="#8bc13a"/></g><g transform="translate(9.5814 7.9375)"><path transform="scale(.26458)" d="m560.34-22.102-558.42 231.31c-21.06 8.7235-38.133 34.275-38.133 57.07v688.09c0 11.398 8.5364 24.173 19.067 28.535l577.49 239.2c10.53 4.3617 27.603 4.3617 38.133.0l558.42-231.31c21.06-8.7235 38.133-34.275 38.133-57.07v-688.09c0-11.398-8.5364-24.173-19.067-28.535l-577.49-239.2c-10.53-4.3617-27.603-4.3617-38.133.0z" fill="#fff"/></g><g transform="translate(-1331.7 150.96)"><g transform="translate(-.13227 -.14313)"><path transform="scale(.26458)" d="m5651.4-517.82c-4.3107-.18795-9.0505.68347-14.025 2.7441l-507.35 210.15c-19.9 8.2427-36.031 32.385-36.031 53.924v642c0 11.537 4.7163 19.84 12.072 23.934v.06641l1.0156.41992c1.147.55934 2.2859 1.1151 3.5469 1.4688l116.15 48.111v-90l410.6-170.08c19.9-8.2427 36.031-32.385 36.031-53.924v-581l108.64 45v-80l-120.26-49.812c-3.0346-1.7765-6.523-2.8394-10.385-3.0078z" fill="#8bc13a"/><path d="m1379.7 116.68V-53.18c0-5.6989 4.2682-12.087 9.5333-14.268l134.24-55.602c5.2651-2.1809 9.5333.67105 9.5333 6.3699v169.86c0 5.6989-4.2682 12.087-9.5333 14.268l-134.24 55.602c-5.2651 2.1809-9.5333-.67105-9.5333-6.3699z" fill="#003556"/><path transform="scale(.26458)" d="m5856.6-432.82c-4.3107-.18795-9.0505.68347-14.025 2.7441l-507.35 210.15c-19.9 8.2427-36.031 32.385-36.031 53.924v642c0 11.536 4.7155 19.84 12.07 23.934v.06641l1.0352.42969c1.1397.55448 2.2713 1.1073 3.5234 1.459l116.15 48.111v-90l410.6-170.08c19.9-8.2427 36.031-32.385 36.031-53.924v-561l108.64 45v-1e2l-120.26-49.812c-3.0347-1.7765-6.525-2.8394-10.387-3.0078z" fill="#8bc13a"/><path d="m1434 139.17V-30.69c0-5.6989 4.2682-12.087 9.5333-14.268l134.24-55.602c5.2651-2.1809 9.5333.67105 9.5333 6.3699v169.86c0 5.6989-4.2682 12.087-9.5333 14.268l-134.24 55.602c-5.2651 2.1809-9.5333-.67105-9.5333-6.3699z" fill="#003556"/><path transform="scale(.26458)" d="m6061.8-347.82c-4.3107-.18795-9.0505.68347-14.025 2.7441l-507.35 210.15c-19.9 8.2427-36.031 32.385-36.031 53.924v642c1e-4 11.537 4.7163 19.84 12.072 23.934v.06641l1.0156.41992c1.147.55934 2.2859 1.1151 3.5469 1.4688l116.15 48.111v-90l410.6-170.08c19.9-8.2427 36.031-32.385 36.031-53.924v-561l108.64 45v-1e2l-120.25-49.811c-3.036-1.7784-6.5287-2.8413-10.393-3.0098z" fill="#8bc13a"/><path d="m1488.3 161.66v-169.86c0-5.6989 4.2682-12.087 9.5333-14.268l134.24-55.602c5.2651-2.1809 9.5333.67105 9.5333 6.3699v169.86c0 5.6989-4.2682 12.087-9.5333 14.268l-134.24 55.602c-5.2651 2.1809-9.5333-.67105-9.5333-6.3699z" fill="#003556"/><path d="m1520.2-14.532 89.523-37.082c5.2651-2.1809 9.5333.67105 9.5333 6.3699v135.47c0 5.6989-4.2682 12.087-9.5333 14.268l-89.523 37.082c-5.2651 2.1809-9.5333-.67104-9.5333-6.3699v-135.47c0-5.6989 4.2682-12.087 9.5333-14.268z" fill="#fff"/><path d="m1596.9 85.99-63.876 26.458-1e-4-46.302 49.504-20.505V29.766l-49.504 20.505 1e-4-46.302 63.876-26.458z" fill="#8bc13a"/></g></g></svg></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/docs/><i class="fas fa-book"></i><span class=active>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/blog/><i class="fas fa-rss"></i><span>Blog</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community/><i class="fas fa-users"></i><span>Community</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/docs/image_guide/img_task_intro/>Return to the regular view of this page</a>.</p></div><h1 class=title>Image Tasks</h1><ul><li>1: <a href=#pg-a083b7deb3e20a834645aa2bd24d9925>Browse and Download from Eucalyptus</a></li><ul></ul><li>2: <a href=#pg-5acab9f9462dcc08070fbaebe7007f83>Install an HVM Image</a></li><ul></ul><li>3: <a href=#pg-c907c3df7ce28d2ca48fad707ab84eb1>Create an HVM Image</a></li><ul><li>3.1: <a href=#pg-45164578f8923bf27cb79d783bb5ddb9>Create an HVM Image from a Linux Distribution ISO (KVM)</a></li><ul></ul></ul><li>4: <a href=#pg-2f36b1734e7c4ede8a5fa61fa256d3eb>Migrate an Image</a></li><ul><li>4.1: <a href=#pg-c4467c3959f12bd32dd51b6e0a608dc9>Create an Image from an Existing EBS-Backed Instance</a></li><ul></ul><li>4.2: <a href=#pg-7ae829a308446b76f985667650c1a46a>Create an Image from an Existing Instance-Store Instance</a></li><ul></ul><li>4.3: <a href=#pg-a6c7933f04213a52b2578c77b81cbc98>Prepare a Linux System for Eucalyptus</a></li><ul></ul><li>4.4: <a href=#pg-83a5584fa76ae7d7f1cd6f56000c1f48>Migrate a Linux Image from AWS to Eucalyptus</a></li><ul></ul><li>4.5: <a href=#pg-d754d743eb9edad186e0971725e7173b>Migrate a Linux Image from Eucalyptus to AWS</a></li><ul></ul></ul><li>5: <a href=#pg-f0a7abff6f890e9d6a76f4948f030b61>Install a paravirtual image</a></li><ul><li>5.1: <a href=#pg-124214d3be37c49eb70ea51c9e3be93a>Add a Kernel</a></li><ul></ul><li>5.2: <a href=#pg-a58ff9b57c5502b55b633d737a109153>Add a Ramdisk</a></li><ul></ul><li>5.3: <a href=#pg-5b52a2311765cea7d4c67e50b33cee77>Add a Root Filesystem</a></li><ul></ul></ul><li>6: <a href=#pg-dd61de6258e3b46d3f1d9e7ca4b14e4f>Remove an Image</a></li><ul></ul></ul><div class=content><h1 id=image-tasks>Image Tasks</h1><p>An image is the basis for instances that you spin up for your computing needs. This section explains how to create or acquire an image and then add it to your Eucalyptus cloud. There are a few ways you can create or acquire an image for use in a Eucalyptus cloud:</p><ul><li>Add an image based on an existing image. For more information, see <a href=https://www.eucalyptus.cloud/index.html#Images>https://www.eucalyptus.cloud/index.html#Images</a>.</li><li>Add an image that you create from scratch, by installing an operating system into a virtual machine.</li><li>Migrate an image or an instance from another cloud, such as Amazon Web Services (AWS) or a virtualization platform.</li></ul></div></div><div class=td-content style=page-break-before:always><h1 id=pg-a083b7deb3e20a834645aa2bd24d9925>1 - Browse and Download from Eucalyptus</h1><p>Eucalyptus provides a few prebuilt &ldquo;starter&rdquo; images that you can download and install. This is one of the simplest ways to get started with Eucalyptus. Many other organizations, including Linux distributions, publish starter images for use on cloud systems, which can also be installed on Eucalyptus using the steps in this guide.With your Web browser, explore the Eucalyptus Machine Image catalog . Download an image of your choice (we suggest starting with images that have &ldquo;hvm&rdquo; as their Virtualization Type, as they are easier to install and work for both Instance Store and EBS-backed instances). Optionally, if the image is compressed (has a .tgz or .gz extension), you will have to uncompress it. If you obtained an HVM image, you now have a raw disk file that can be installed using instructions in the <a href=https://www.eucastack.io/docs/image_guide/img_task_intro/img_task_install_hvm_image/>Install an HVM image</a> section. If you obtained a paravirtual image with kernel and ramdisk, you can install them with instructions in the <a href=https://www.eucastack.io/docs/image_guide/img_task_intro/img_add_existing/>Install a paravirtual image</a> section.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-5acab9f9462dcc08070fbaebe7007f83>2 - Install an HVM Image</h1><p>HVM (Hardware-assisted Virtual Machine) images are sequences of raw sectors of a complete bootable disk, including a boot loader and one or more partitions with an operating system. Such images are self-contained and can be booted on hardware that supports virtualization or on a full software emulation of hardware (QEMU).</p><p>At run time, HVM images can be deployed to disks local to the hypervisor (so-called Instance Store images) or they can run off of dynamic volumes on EBS (so-called EBS-backed instances or boot-from-EBS instances). This topic covers methods for installing an HVM image into either type of EMI.</p><h2 id=install-an-hvm-image-as-an-instance-store-emi>Install an HVM image as an Instance Store EMI</h2><p>Bundle, upload, and register the HVM image. All of this can be accomplished with a single command. For Linux images, the required options are:</p><p><code>euca-install-image -i /path/to/hvm-image -n name-of-the-image -r x86_64 --virtualization-type hvm -b bucket-name-for-image</code></p><h2 id=install-an-hvm-image-as-an-ebs-backed-emi>Install an HVM image as an EBS-Backed EMI</h2><p>An EBS-backed image (sometimes referred to as a &ldquo;bfEBS&rdquo; image) is an image with a root device that is an EBS volume created from an EBS snapshot. An EBS-backed image has a number of advantages (over an Instance Store image), including:</p><ul><li>Faster boot time</li><li>Larger volume size limits</li><li>Changes to the data on the image persist after instance termination</li></ul><h2 id=option-a-install-an-ebs-image-with-euca-import-vol>Option A: Install an EBS image with euca-import-vol</h2><p>With this method, a single command uploads image data into Object Store and triggers a conversion task, which copies the data into an EBS volume. The volume will be the source of the snapshot behind the EBS-backed EMI.Import the HVM image file into Object Storage and then copy it into EBS. For example: <code>euca-import-volume /path/to/hvm-image --format raw --availability-zone AZ-NAME --bucket bucket-for-hvm-image --owner-akid $EC2_ACCESS_KEY --owner-sak $EC2_SECRET_KEY --prefix image-name-prefix --description "textual description"</code><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If the volume import process was interrupted, import can be resumed (within a one-week deadline) with the following command:</div>After the volume data has been uploaded to Object Store, an internal conversion task will copy the data into a new EBS volume. You can query the progress of this task with the following command: <code>euca-describe-conversion-tasks import-vol-fae1e94d</code> Once the task has finished successfully and the volume is available, you can take a snapshot of the volume: <code>euca-create-snapshot &lt;volume-id></code> You can now register the snapshot: <code>euca-register --name &lt;image-name> --snapshot &lt;snapshot-id> --root-device-name &lt;device></code> You&rsquo;ve now created a EBS-backed image. To maintain data persistence, be sure to use <code>euca-stop-instances</code> and <code>euca-start-instances</code> to stop and start your EBS-backed instance.</p><h2 id=option-b-install-an-ebs-image-with-euca-import-instance>Option B: Install an EBS image with euca-import-instance</h2><p>With this method, a single command uploads image data into the Object Store and triggers a conversion task; this conversion task copies the data into an EBS volumetakes a snapshot of the volume, registers the snapshot as an EMI, and deploys the EMI as an instance.Turn an HVM image into a running EBS instance with a single command:<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Just as with euca-run-instance, one can specify the Instance Type for the instance that will run, as well as the SSH key. For example:</div><code>euca-import-instance /root/paravirtualimage/ubuntuJune06.img --format raw --architecture x86_64 --platform Linux --availability-zone EDU --bucket import_instance --owner-akid $EC2_ACCESS_KEY --owner-sak $EC2_SECRET_KEY --prefix eduii --description "import instance" --key admin --instance-type m1.small</code><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4><p>If volume import process was interrupted (by an interruption of the command or due to a network mishap, import can be resumed (within a one-week deadline).</p><p><code>euca-resume-import -t import-i-b393f3f6 /path/to/hvm-image</code></p></div>After the volume data has been uploaded to Object Store, an internal conversion task will copy the data into a new EBS volume. You can query the progress of this task with the following command: <code>euca-describe-conversion-tasks import-i-b393f3f6</code> Once the conversion task has finished successfully, you should see a running instance. You may log into that instance if you specified an SSH key. To maintain data persistence, be sure to use <code>euca-stop-instances</code> and <code>euca-start-instances</code> to stop and start your EBS-backed instance.</p><h2 id=option-c-install-an-ebs-image-using-a-helper-instance>Option C: Install an EBS image using a helper instance</h2><p>This is a more manual method for installing an HVM image into an EBS-backed EMI. Instead of importing the image data into an EBS volume directly, a helper instance is used to copy data from the image file into the volume. The helper instance can be either an instance store or an EBS-backed instance, and can be deleted when ﬁnished. The volume will be the source of the snapshot behind the EBS-backed EMI.Create and launch a help instance. Create a volume big enough to hold the bootable image file: <code>euca-create-volume -z &lt;cluster_name> -s &lt;size_in_GB></code> Attach the volume to the helper instance: <code>euca-attach-volume &lt;volume-id> -i &lt;instance-id> -d &lt;device></code> Log in to the instance and copy the bootable image to the attached volume by performing one of the following steps: If the bootable image is saved in an http or ftp repository, use <code>curl</code> or <code>wget</code> to download the .img file to the attached volume. For example: <code>curl &lt;path_to_bootable_image> > &lt;device></code></p><p>If the bootable image is from a source other than an http or FTP repository, copy the bootable image from its source to the helper instance, and then copy it to the attached volume using the <code>dd</code> command. For example: <code>dd if=&lt;path_to_bootable_image> of=&lt;device> bs=1M</code></p><p>Detach the volume from the instance: <code>euca-detach-volume &lt;volume-id></code> Create a snapshot of the volume: <code>euca-create-snapshot &lt;volume-id></code> Register the snapshot: <code>euca-register --name &lt;image-name> --snapshot &lt;snapshot-id> --root-device-name &lt;device></code> You&rsquo;ve now created a EBS-backed image. To maintain data persistence, be sure to use <code>euca-stop-instances</code> and <code>euca-start-instances</code> to stop and start your EBS-backed instance.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-c907c3df7ce28d2ca48fad707ab84eb1>3 - Create an HVM Image</h1><h1 id=create-an-hvm-image>Create an HVM Image</h1><p>This section covers how to create a new image for use in your Eucalyptus cloud.</p></div><div class=td-content><h1 id=pg-45164578f8923bf27cb79d783bb5ddb9>3.1 - Create an HVM Image from a Linux Distribution ISO (KVM)</h1><p>This topic shows how to install a Linux distribution ISO and prepare an image for registration with Eucalyptus.Use the QEMU disk utility to create a disk image. In the following example, we create a 5GB disk image: <code>qemu-img create -f raw centos7.img 5G</code> Use the <code>parted</code> utility to set the disk label. <code>parted centos7.img mklabel msdos</code> Use <code>virt-install</code> to start a new virtual machine installation, as in the following example (note the example has been broken into multiple lines for formatting purposes):</p><pre><code>virt-install --name centos7 --ram 1024 --os-type linux --os-variant rhel7 
 -c /tmp/CentOS-7.0-x86_64-bin-DVD1.iso --disk path=/tmp/centos7.img,device=disk,bus=virtio 
 --graphics vnc,listen=0.0.0.0 --force 
</code></pre><p>Use the VNC client of your choice to connect to the new virtual machine and complete the installation. Modify the following <code>libvirt.xml</code> template to create the VM and run <code>virsh create &lt;libvirt.xml>"</code> .</p><pre><code> &lt;domain type='kvm'&gt;
    &lt;name&gt;eucalyptus-centos&lt;/name&gt;
    &lt;os&gt;
        &lt;type&gt;hvm&lt;/type&gt;
    &lt;/os&gt;
    &lt;features&gt;
        &lt;acpi/&gt;
    &lt;/features&gt;
    &lt;memory&gt;1073741&lt;/memory&gt;
    &lt;vcpu&gt;1&lt;/vcpu&gt;
    &lt;devices&gt;
        &lt;!--&lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;--&gt;
        &lt;disk type='file'&gt;
            &lt;source file='/tmp/centos7.img'/&gt;
            &lt;target dev='hda'/&gt;
        &lt;/disk&gt;
     &lt;interface type='bridge'&gt;
         &lt;source bridge='br0'/&gt;
         &lt;model type='virtio'/&gt;
     &lt;/interface&gt;
        &lt;graphics type='vnc' port='-1' autoport='yes' listen='0.0.0.0'/&gt;
    &lt;/devices&gt;
&lt;/domain&gt;
</code></pre><p>Connect to the virtual machine using your VNC client of choice and make the following configuration changes: Modify the <code>/etc/sysconfig/network-scripts/ifcfg-eth0</code> file and set the <code>ONBOOT</code> option to &ldquo;yes&rdquo;. For example:</p><pre><code>DEVICE=&quot;eth0&quot;
BOOTPROTO=&quot;dhcp&quot;
#HWADDR=&quot;B8:AC:6F:83:1C:45&quot;
IPV6INIT=&quot;yes&quot;
MTU=&quot;1500&quot;
NM_CONTROLLED=&quot;yes&quot;
ONBOOT=&quot;yes&quot;
TYPE=&quot;Ethernet&quot;
UUID=&quot;499c07cc-4a53-408c-87d2-ce0db991648e&quot;
PERSISTENT_DHCLIENT=1
</code></pre><p>Enable a serial console on the virtual machine by adding the following option to the end of the /boot/grub/menu.lst: <code>console=ttyS0</code> Remove the <code>quiet</code> option from the kernel parameters and the grub menu splash image in the <code>/boot/grub/menu.lst</code> file. For example:</p><pre><code># grub.conf generated by anaconda
#
# Note that you do not have to rerun grub after making changes to this file
# NOTICE:  You have a /boot partition.  This means that
#          all kernel and initrd paths are relative to /boot/, eg.
#          root (hd0,0)
#          kernel /vmlinuz-version ro root=/dev/sda2
#          initrd /initrd-[generic-]version.img
#boot=/dev/sda
default=0
timeout=5
#splashimage=(hd0,0)/grub/splash.xpm.gz
hiddenmenu
title Eucalyptus (n.n.32-358.18.1.el7.x86_64)
	root (hd0,0)
	kernel /vmlinuz-n.n.32-358.18.1.el7.x86_64 ro root=UUID=062b9c31-95f3-424f-8b47-35107cfdfc08 rd_NO_LUKS rd_NO_LVM LANG=en_US.UTF-8 rd_NO_MD SYSFONT=latarcyrheb-sun16 crashkernel=auto  KEYBOARDTYPE=pc KEYTABLE=us rd_NO_DM rhgb
	initrd /initramfs-n.n.32-358.18.1.el7.x86_64.img
</code></pre><p>Add the following line to the <code>/etc/sysconfig/network</code> file to disable the zeroconf route, which can interfere with access to the metadata service: <code>NOZEROCONF=yes</code> Edit the <code>/etc/udev/rules.d/70-persistent-net.rules</code> file and remove all entries for the existing network interface. Make sure that you delete all entries before terminating the virtual machine and registering it with Eucalyptus. Eucalyptus instances use cloud-init to specify actions to run on your instance at boot time, which can be passed using the userdata parameter. To install and configure <code>cloud-init</code> on your instance: Install cloud-init:</p><pre><code># rpm -Uvh http://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm
# yum install cloud-init
</code></pre><p>By default, cloud-init uses ec2-user as the log-in user. Add ec2-user to your instance and give it appropriate sudo permissions:</p><pre><code> # adduser ec2-user
 # passwd ec2-user
</code></pre><p>Run visudo and add the following entries at the bottom of the sudoers file:</p><pre><code>## Allow root to run any commands anywhere
     root    ALL=(ALL)       ALL 
     ec2-user        ALL=(ALL)       NOPASSWD: ALL  
</code></pre><p>You can optionally copy Eucalyptus <code>rc.local</code> file (available at <a href=https://github.com/eucalyptus/Eucalyptus-Scripts/blob/master/rc.local></a> ) to the <code>/etc</code> directory on your virtual machine and modify it as needed. You now have a raw disk file that can be installed using instructions in the <a href=https://www.eucastack.io/docs/image_guide/img_task_intro/img_task_install_hvm_image/>Install an HVM image</a> section.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-2f36b1734e7c4ede8a5fa61fa256d3eb>4 - Migrate an Image</h1><h1 id=migrate-an-image>Migrate an Image</h1><p>This section covers migrating images to and from your Eucalyptus cloud.</p></div><div class=td-content><h1 id=pg-c4467c3959f12bd32dd51b6e0a608dc9>4.1 - Create an Image from an Existing EBS-Backed Instance</h1><p>A common way to create a new image is to customize an existing instance. This topic describes how to create a new image by modifying an existing EBS-backed instance.This example shows how to create a new EBS-backed Eucalyptus image based on an existing EBS-backed Eucalyptus instance.</p><p>Log on to an existing Eucalyptus EBS-backed instance and customize the instance. Prepare the image. See <a href></a> for instructions. Create a new image based on the image you just modified by using the eucalyptus-create-image command, specifying a name, a description, and the instance ID of the Eucalyptus instance you customized in the previous step. For example: <code>euca-create-image -n "mynewimage" -d "This is my new custom recycled image" i-1ABCDEFF</code> This command will show the ID of the new machine image and exit immediately. In the background, Eucalyptus will begin the process of creating a new image based on the instance you supplied.</p><p>You can monitor the status of the image using the euca-describe-images command, supplying the ID of the image returned from the euca-create-image command. For example:</p><p><code>euca-describe-images i-e12398ab</code></p></div><div class=td-content style=page-break-before:always><h1 id=pg-7ae829a308446b76f985667650c1a46a>4.2 - Create an Image from an Existing Instance-Store Instance</h1><p>A common way to create a new image is to customize an existing instance.This example shows how to create a new instance store Eucalyptus image based on an existing instance store Eucalyptus instance. This topic describes how to create a new image by modifying an existing instance-store instance.</p><p>Log on to an existing Eucalyptus instance-store instance and customize the instance. See Prepare a Linux Image for Eucalyptus <a href></a> for instructions on required changes the instance needs before re-bundling. Create a new image based on the image you just modified by using the <code>euca-bundle-instance</code> command, specifying a name, a description, and the instance ID of the Eucalyptus instance you customized in the previous step. For example:</p><pre><code>euca-bundle-instance -b mybundle -p mycentos6 -o $EC2_ACCESS_KEY -w $EC2_SECRET_KEY i-96154365
BUNDLE     bun-96154365     i-96154365     mybundle     mycentos     62013-11-05T21:37:23.469Z2013-11-05T21:37:23.469Z     pending     0
</code></pre><p>This command will the bundle task ID and exit immediately. In the background, Eucalyptus will begin the bundling process. Depending on the size of the instance, it can take several minutes for the bundling task to complete.</p><p>You can monitor the status of the bundle task using the <code>euca-describe-bundle-tasks</code> command, supplying the ID of the image returned from the <code>eucalyptus-bundle-instance</code> command. For example:</p><pre><code>euca-describe-bundle-tasks
BUNDLE     bun-96154365     i-96154365     mybundle     mycentos6     2013-11-05T21:37:23.469Z2013-11-05T21:37:58.446Z     storing     0
</code></pre><p>Once the bundle task is complete, you can register thebundle as an instance-store image using the euca-register command, specifying the path to the bundle manifest in the format <code>[bucket]/[prefix].manifest.xml</code> .<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>You should always explicitly declare the instance type of a bundle created with as an HVM type using &ndash;virtualization-type parameter. For example:</div><code>euca-register --virtualization-type=hvm mybundle/mycentos6.manifest.xml.</code> Your new image is now ready for use in your Eucalyptus cloud.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-a6c7933f04213a52b2578c77b81cbc98>4.3 - Prepare a Linux System for Eucalyptus</h1><p>This section explains how to prepare a running Linux system (cloud instance, virtual machine, or a system running on bare metal) before importing it for use in Eucalyptus.<strong>Install cloud software and drivers:</strong> Make sure Virtio drivers are installed if the image is going to be run in a KVM cluster which has virtio enabled, and verify use if possible (ie. set disks and network interface in hypervisor, try hot plug in for disks, etc). For most recent Linux distributions nothing is needed to be done. Make sure appropriate init scripts are in place; for example: cloud-init packages (if appropriate), and rc.local or similar scripts to prepare new instances at boot time utilizing user/meta-data.</p><p>Install cloud-init:</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>For more information on cloud-init, go to <a href=https://help.ubuntu.com/community/CloudInit>https://help.ubuntu.com/community/CloudInit</a></div><p>For Red Hat Enterprise Linux, and CentOS 7:</p><pre><code>yum install cloud-init
</code></pre><p>Install and configure ssh: For Red Hat and CentOS:</p><pre><code>yum install openssh-server
systemctl enable sshd.service
</code></pre><p>Install Euca2ools: For Red Hat and CentOS:</p><pre><code>yum install euca2ools
</code></pre><p>Optionally, update existing packages. For RHEL and CentOS:</p><pre><code>yum update
</code></pre><p><strong>Prepare the network:</strong> Disable the firewall. It is recommended that the firewall is disabled and network rules are instead enforced in the security-group the instances run in. If the guest&rsquo;s firewall is not disabled, review the existing rules and make sure they are appropriate for the guest&rsquo;s future use within a cloud environment. Clear or disable iptable rules: Save the rules in case you want to restore them later:</p><pre><code>sudo iptables-save &gt; /root/firewall.rules
</code></pre><p>Clear the rules:</p><pre><code>iptables -F
iptables -X
iptables -t nat -F
iptables -t nat -X
iptables -t mangle -F
iptables -t mangle -X
iptables -P INPUT ACCEPT
iptables -P OUTPUT ACCEPT
iptables -P FORWARD ACCEPT
</code></pre><p>For RHEL and CentOS 7, see the Red Hat Migration and Planning Guide <a href=https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Migration_Planning_Guide/sect-Red_Hat_Enterprise_Linux-Migration_Planning_Guide-Security_and_Access_Control.html>Security and Access Control section</a> .</p><p>Make sure there is only a single primary network interface. Check the configuration for:</p><ul><li>Enabled on boot (ONBOOT=&ldquo;yes&rdquo;)</li><li>IP provisioning is done via DHCP (BOOTPROTO=&ldquo;dhcp&rdquo;)</li><li>MAC address is commented out (for example: #HWADDR=&ldquo;AA:BB:CC:DD:EE:FF&rdquo;)</li></ul><p>For RHEL and CentOS images, the configuration for the default network interface can usually be found in the following file:</p><pre><code>/etc/sysconfig/network-scripts/ifcfg-eth0
</code></pre><p>The following is an example of an <code>ifcfg-eth0</code> configuration file:</p><pre><code>DEVICE=eth0
ONBOOT=yes
#THE HWADDR LINE MUST BE COMMENTED OUT OR REMOVED
#HWADDR=AA:BB:CC:DD:EE:FF
TYPE=Ethernet
BOOTPROTO=dhcp
PERSISTENT_DHCLIENT=yes
</code></pre><p>Remove persistent udev rules:</p><pre><code>echo &quot;&quot; &gt; /etc/udev/rules.d/70-persistent-net.rules 
echo &quot;&quot; &gt; /lib/udev/rules.d/75-persistent-net-generator.rules 
</code></pre><p>On CentOS and RHEL, disable zeroconf by adding an entry to the <code>/etc/sysconfig/network</code> file:</p><pre><code>NETWORKING=yes
NOZEROCONF=yes
</code></pre><p><strong>Clean the image:</strong> We recommend that you remove all non-root, non-administrator users before bundling the image. Remove root/Administrator password. We recommend that you remove root&rsquo;s password for Linux systems.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Once these passwords are removed, access to this system will be limited or blocked until this image is recreated as a cloud instance. SSH host and authorization keys for Linux will be used going forward.</div>Remove any unwanted programs. Configure a serial port by adding an option to the end of the <code>/boot/grub/menu.lst</code> file: <code>console=ttyS0</code> You&rsquo;ve now prepared your instance for image creation.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-83a5584fa76ae7d7f1cd6f56000c1f48>4.4 - Migrate a Linux Image from AWS to Eucalyptus</h1><p>You can migrate an S3-backed image from AWS to Eucalyptus.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>This topic assumes you are migrating an S3-backed Amazon Machine Image (AMI) that you own. For instructions on creating an S3-backed AMI from an existing AMI, see .</div></p><p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Specific examples may vary depending on the distro running on the image that you want to migrate.</div>Set up your Euca2ools configuration to work with both Eucalyptus and Amazon Web Services. Check ownership of the AMI that you want to migrate to Eucalyptus by using the euca-describe-images command. For example:</p><pre><code>euca-describe-images --region us-east-1 --owner 999999999999
IMAGE	ami-e1a1e888	999999999999/precise-test	999999999999	available	private		x86_64	machine	aki-88aa75e1			instance-store	paravirtual	xen
	BLOCKDEVICEMAPPING	EPHEMERAL	sda2	ephemeral0
</code></pre><p>Run the AWS instance.</p><pre><code>euca-run-instance ami-e1a1e888 --region us-east-1 
</code></pre><p>Install Euca2ools on the instance. For instructions, see the Euca2ools Guide. Make sure that you have enough space on a volume to hold the bundle that we will create. Bundle the running AWS instance. For example:</p><pre><code>sudo -s
ec2-bundle-vol -b testbucket -d /mnt -u 4299-4227-3585 -k my-aws.pem -c my-aws-cert.pem -r x86_64 -s 2048
Copying / into the image file /mnt/image...
Excluding:
	 /dev/pts
	 /
	 /sys
	 /proc
	 /proc/sys/fs/binfmt_misc
	 /dev
	 /media
	 /mnt
	 /proc
	 /sys
	 /mnt/image
	 /mnt/img-mnt
1+0 records in
1+0 records out
1048576 bytes (1.0 MB) copied, 0.00209056 s, 502 MB/s
mke2fs 1.42.3 (14-May-2012)
Bundling image file...
Splitting /mnt/image.tar.gz.enc...
Created image.part.00
Created image.part.01
[example truncated]
Created image.part.30
Generating digests for each part...
Digests generated.
Unable to read instance meta-data for ancestor-ami-ids
Unable to read instance meta-data for ramdisk-id
Unable to read instance meta-data for product-codes
Creating bundle manifest...
ec2-bundle-vol complete.
</code></pre><p>Switch the Euca2ools configuration file to use Eucalyptus. You can do this by specifying the Eucalyptus region as defined in your Euca2ools configuration file by specifying the <code>--region</code> parameter on the command line, or by changing the <code>default-region</code> option in the Euca2ools configuration file:</p><pre><code>default-region = euca-release
</code></pre><p>Download the bundle from the AWS S3 bucket:</p><pre><code>euca-download-bundle --bucket testbucket --directory /tmp/aws-image/ --region us-east-1
</code></pre><p>Unbundle the AWS instance bundle:</p><pre><code>euca-unbundle --manifest /tmp/aws-image/image.manifest.xml --source /tmp/aws-image/ --destination /tmp/aws-image/ --region us-east-1
</code></pre><p>Run some checks to make sure that the image can be used with Eucalyptus: Mount the image via loopback:</p><pre><code>#  sudo mkdir /mnt/aws-image
	#  sudo mount -o loop /tmp/aws-image/image /mnt/aws-image
	#  df -ah 
	……
	/tmp/aws-image/image
                      9.9G  1.1G  8.3G  12% /mnt/aws-image
</code></pre><p>Make sure that the distro repositories in the image do not point to EC2-specific repositories. TODO: Need an actual example here. Install a non-Xen kernel into the image from distro and make sure VirtIO modules are added. TODO: Need an actual example here. Extract the ramdisk and kernel to be bundled, uploaded and registered as ERI and EKI files. In this example, initrd.img-3.2.0-53-virtual and vmlinuz-3.2.0-53-virtual will be copied from /mnt/aws-image/boot to the /tmp/aws-image directory:</p><pre><code># sudo cp /mnt/aws-image/boot/initrd.img-3.2.0-53-virtual /tmp/aws-image/.
# sudo cp /mnt/aws-image/boot/vmlinuz-3.2.0-53-virtual /tmp/aws-image/.
</code></pre><p>Make sure that the file system of the image is either ext2, ext3, or ext4 by using the file command. For example:</p><pre><code># file /tmp/aws-image/image
/tmp/aws-image/image: Linux rev 1.0 ext4 filesystem data (extents) (large files) (huge files)
</code></pre><p>Bundle the image using euca-bundle-image:</p><pre><code>euca-bundle-image -i /tmp/aws-image/image
</code></pre><p>Upload the AWS bundled instance to Eucalyptus.</p><pre><code>euca-upload-bundle -b hybrid-guide-sample-bucket -m /tmp/aws-image/image.manifest.xml --access-key myaccesskey --secret-key mysecretkey
</code></pre><p>Test the new uploaded image.</p><pre><code>euca-run-instance emi-a6e15bcf
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-d754d743eb9edad186e0971725e7173b>4.5 - Migrate a Linux Image from Eucalyptus to AWS</h1><p>This topic describes how to migrate an image from Eucalyptus to AWS.<div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>These are high-level guidelines for moving an instance from Eucalyptus to AWS. Specific examples will vary depending on the distro running on the image.</div>Run an instance from the image you chose.</p><pre><code>euca-run-instance emi-1A6338AE
</code></pre><p>SSH into the instance and verify that the instance is valid for use with AWS: Download the latest ec2-modules from <a href=http://s3.amazonaws.com/ec2-downloads></a> and put them into the <code>/lib/modules</code> directory on the instance. Copy the AWS EC2 certificate and private key from the AWS instance to your local workstation. Shut down unneeded services on the AWS instance (for example, Apache and MySQL). Clear out log files and bash history files. Remove your ssh keys from the instance. Reset passwords for the instance, and for any services that maintain their own password database. Clear out any temporary directories. Install Euca2ools on the instance.</p><p>Mount a volume that is at least 1.5 times as large as the entire instance. Bundle the running instance.</p><pre><code>euca-bundle-instance 
</code></pre><p>Switch the Euca2ools configuration file to use Eucalyptus</p><pre><code>default-region = euca-release
</code></pre><p>Upload the AWS bundled instance to Eucalyptus.</p><pre><code>euca-upload-bundle -b bucket_name -m manifest_file
</code></pre><p>Test the new uploaded image.</p><pre><code>euca-run-instance emi-a6e15bcf
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-f0a7abff6f890e9d6a76f4948f030b61>5 - Install a paravirtual image</h1><h1 id=install-a-paravirtual-image>Install a paravirtual image</h1><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>As of Eucalyptus version 4.0, it is now required to pass a Eucalyptus Kernel Image (EKI) and a Eucalyptus Ramdisk Image (ERI) when uploading and registering a paravirtual Eucalyptus Machine Image (EMI) using the , , and command line tools.</div><p>Once you&rsquo;ve customized or acquired a paravirtual image to use with Eucalyptus, you can enable the image as an executable entity with the following steps:</p><ol><li>Unless a suitable kernel is already registered, bundle the kernel, upload it to Object Storage, and register it as a new EKI.</li><li>Unless a suitable ramdisk is already registered, bundle the ramdisk, upload it to Object Storage, and register it as a new ERI</li><li>Bundle the root disk image, which must be a Linux partition, requesting the kernel and ramdisk that you desire, upload the bundle to Object Storage, and register it as a new EMI.</li></ol><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>Note that while all users can bundle, upload and register images, only users under the account have the required permissions to upload and register kernels and ramdisks.</div><p>Once you have an image that meets your needs, perform the tasks listed in this section to add the image to your cloud.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-124214d3be37c49eb70ea51c9e3be93a>5.1 - Add a Kernel</h1><p>When you add a kernel to Walrus, you bundle the kernel file, upload the file to a bucket in Walrus that you name, and then register the kernel with Eucalyptus.</p><p>To add a kernel to Walrus:</p><p>Use the following three commands:</p><pre><code>euca-bundle-image -i &lt;kernel_file&gt; --kernel true --arch &lt;architecture&gt;
euca-upload-bundle -b &lt;kernel_bucket&gt; -m /tmp/&lt;kernel_file&gt;.manifest.xml
euca-register &lt;kernel_bucket&gt;/&lt;kernel_file&gt;.manifest.xml -a x86_64 -n mynewkernel
</code></pre><p>For example:</p><pre><code>euca-bundle-image -i euca-fedora-10-x86_64/xen-kernel/vmlinuz-2.6.27.21-0.1-xen --kernel true --arch x86_64
...
Generating manifest /tmp/vmlinuz-2.6.27.21-0.1-xen.manifest.xml

euca-upload-bundle -b example_kernel_bucket -m /tmp/vmlinuz-2.6.27.21-0.1-xen.manifest.xml
...
Uploaded image as example_kernel_bucket/vmlinuz-2.6.27.21-0.1-xen.manifest.xml

euca-register example_kernel_bucket/vmlinuz-2.6.27.21-0.1-xen.manifest.xml -a x86_64 -n mynewkernel
IMAGE	eki-XXXXXXXX
</code></pre><p>Where the returned value <code>eki-XXXXXXXX</code> is the unique ID of the registered kernel image.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-a58ff9b57c5502b55b633d737a109153>5.2 - Add a Ramdisk</h1><p>When you add a ramdisk to Walrus, you bundle the ramdisk file, upload the file to a bucket in Walrus that you name, and then register the ramdisk with Eucalyptus.</p><p>To add a ramdisk to Walrus:</p><p>Use the following three commands:</p><pre><code>euca-bundle-image -i &lt;ramdisk_file&gt; --ramdisk true -r x86_64
euca-upload-bundle -b &lt;ramdisk_bucket&gt; -m /tmp/&lt;ramdisk_file&gt;.manifest.xml
euca-register &lt;ramdisk_bucket&gt;/&lt;ramdisk_file&gt;.manifest.xml -n &lt;name_of_ramdisk&gt;
</code></pre><p>For example:</p><pre><code>euca-bundle-image -i euca-fedora-10-x86_64/xen-kernel/initrd-2.6.27.21-0.1-xen 
--ramdisk true -r x86_64
...
Generating manifest /tmp/initrd-2.6.27.21-0.1-xen.manifest.xml

euca-upload-bundle -b example_rd_bucket -m /tmp/initrd-2.6.27.21-0.1-xen.manifest.xml
...
Uploaded image as example_rd_bucket/initrd-2.6.27.21-0.1-xen.manifest.xm

euca-register example_rd_bucket/initrd-2.6.27.21-0.1-xen.manifest.xml -n mynewramdisk
IMAGE	eri-XXXXXXXX 
</code></pre><p>Where the returned value <code>eri-XXXXXXXX</code> is the unique ID of the registered ramdisk image.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-5b52a2311765cea7d4c67e50b33cee77>5.3 - Add a Root Filesystem</h1><p>When you add a root filesystem to Walrus, you bundle the root filesystem file, upload the file to a bucket in Walrus that you name, and then register the root filesystem with Eucalyptus. The bundle operation can include a registered ramdisk (ERI ID) and a registered kernel (EKI ID). The resulting image will associate the three images.</p><p>You can also bundle the root file system independently and associate the ramdisk and kernel with the resulting EMI at run time.</p><p>To add a root filesystem to Walrus:</p><p>Use the following three commands:</p><pre><code>euca-bundle-image -i &lt;root_filesystem_file&gt; -r &lt;architecture&gt;
euca-upload-bundle -b &lt;root_filesystem_file_bucket&gt; -m /tmp/&lt;root_filesystem_file&gt;.manifest.xml
euca-register &lt;root_filesystem_file_bucket&gt;/&lt;root_filesystem_file&gt;.manifest.xml -n &lt;rootfs_name&gt; -a &lt;architecture&gt;
</code></pre><p>For example:</p><pre><code>euca-bundle-image -i euca-fedora-10-x86_64/fedora.10.x86-64.img  --ramdisk eri-722B3CBA --kernel eki-5B3D3859 -r x86_64
...
Generating manifest /tmp/fedora.10.x86-64.img.manifest.xml

euca-upload-bundle -b example_rf_bucket -m /tmp/fedora.10.x86-64.img.manifest.xml
...
Generating manifest /tmp/fedora.10.x86-64.img.manifest.xml

euca-register example_rf_bucket/fedora.10.x86-64.img.manifest.xml -n example_rf -a x86_64
IMAGE	 emi-XXXXXXXX
</code></pre><p>Where the returned value <code>emi-XXXXXXXX</code> is the unique ID of the registered machine image.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-dd61de6258e3b46d3f1d9e7ca4b14e4f>6 - Remove an Image</h1><p>When a new image is uploaded to Eucalyptus, Eucalyptus saves the bundle and the image manifest to a bucket in Walrus. This bucket is stored in the Walrus directory that is defined in the Eucalyptus property <code>walrusbackend.storageDir</code> . The default value for this property is <code>/var/lib/eucalyptus/bukkits</code> .</p><p>When you register an image, Eucalyptus creates the actual image file. Both the image manifest and the bundle must remain intact to run as an instance.</p><p>To delete an image fully, you must deregister the image and delete the bundle. To successfully remove an image and associated bundle files:</p><p>Find the image you want to remove.</p><pre><code>euca-describe-images 
IMAGE   emi-E533392E    alpha/centos.5-3.x86-64.img.manifest.xml    965590394582
available   public   i386    machine eki-345135C9    eri-C4F135BC  instance-store
IMAGE   emi-623C38B0  alpha/ubuntu.9-04.x86-64.img.manifest.xml   965590394582 
available   public   i386    machine eki-E6B13926    eri-94DB3AB9  instance-store
</code></pre><p>Note the image file name (for example, emi-623C38B0). Deregister the image.</p><pre><code>euca-deregister emi-623C38B0
IMAGE   emi-623C38B0
</code></pre><p>Delete the bundle.</p><pre><code>euca-delete-bundle -b alpha -p ubuntu.9-04.x86-64.img
</code></pre><p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If you accidentally try to delete a bundle for a second time, you might see an error message: . This error only displays if you try to delete a bundle that no longer exists.</div>When you have finished these steps, display all images to confirm that the image was removed.</p><pre><code>euca-describe-images 
IMAGE   emi-E533392E    alpha/centos.5-3.x86-64.img.manifest.xml    965590394582
available   public   i386    machine eki-345135C9    eri-C4F135BC  instance-store
</code></pre></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Community forums" aria-label="Community forums"><a class=text-white target=_blank rel=noopener href=https://github.com/orgs/eucastack/discussions aria-label="Community forums"><i class="fa fa-comments"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank rel=noopener href=https://twitter.com/eucastack aria-label=Twitter><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Stack Overflow" aria-label="Stack Overflow"><a class=text-white target=_blank rel=noopener href=https://stackoverflow.com/questions/tagged/eucastack aria-label="Stack Overflow"><i class="fab fa-stack-overflow"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/eucastack aria-label=GitHub><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Discord aria-label=Discord><a class=text-white target=_blank rel=noopener href=https://discord.gg/rZfweFv2dM aria-label=Discord><i class="fab fa-discord"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2022 EucaStack All Rights Reserved</small>
<small class=ml-1><a href=https://policies.google.com/privacy target=_blank rel=noopener>Privacy Policy</a></small></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA==" crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script>
<script src=/js/main.min.6f618f935d0e212fc39316b4023fa69460fd4a5779211bdc3535ec542578f225.js integrity="sha256-b2GPk10OIS/Dkxa0Aj+mlGD9Sld5IRvcNTXsVCV48iU=" crossorigin=anonymous></script></body></html>