<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>EucaStack â€“ Configure Block Storage</title><link>https://www.eucastack.io/docs/install_guide/eucalyptus/configure_runtime/config_storage/config_block_storage/</link><description>Recent content in Configure Block Storage on EucaStack</description><generator>Hugo -- gohugo.io</generator><atom:link href="https://www.eucastack.io/docs/install_guide/eucalyptus/configure_runtime/config_storage/config_block_storage/index.xml" rel="self" type="application/rss+xml"/><item><title>Docs: Use Ceph-RBD</title><link>https://www.eucastack.io/docs/install_guide/eucalyptus/configure_runtime/config_storage/config_block_storage/config_storage_ceph_rbd/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://www.eucastack.io/docs/install_guide/eucalyptus/configure_runtime/config_storage/config_block_storage/config_storage_ceph_rbd/</guid><description>
&lt;h1 id="use-ceph-rbd">Use Ceph-RBD&lt;/h1>
&lt;p>This topic describes how to configure Ceph-RBD as the block storage backend provider for the Storage Controller (SC).&lt;strong>Prerequisites&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>
&lt;p>Successful completion of all the install sections prior to this section.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>The SC must be installed, registered, and running.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>You must execute the steps below as a administrator.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>You must have a functioning Ceph cluster.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Ceph user credentials with the following privileges are available to SCs and NCs (different user credentials can be used for the SCs and NCs).&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Hypervisor support for Ceph-RBD on NCs. Node Controllers (NCs) are designed to communicate with the Ceph cluster via libvirt. This interaction requires a hypervisor that supports Ceph-RBD. See to satisfy this prerequisite.
&lt;strong>To configure Ceph-RBD block storage for the zone, run the following commands on the CLC&lt;/strong> Configure the SC to use Ceph-RBD for EBS.&lt;/p>
&lt;p>euctl ZONE.storage.blockstoragemanager=ceph-rbd&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>The output of the command should be similar to:&lt;/p>
&lt;pre>&lt;code>one.storage.blockstoragemanager=ceph-rbd
&lt;/code>&lt;/pre>
&lt;p>Verify that the property value is now &lt;code>ceph-rbd&lt;/code> :&lt;/p>
&lt;pre>&lt;code>euctl ZONE.storage.blockstoragemanager
&lt;/code>&lt;/pre>
&lt;p>Check the SC to be sure that it has transitioned out of the &lt;code>BROKEN&lt;/code> state and is in the &lt;code>NOTREADY&lt;/code> , &lt;code>DISABLED&lt;/code> or &lt;code>ENABLED&lt;/code> state before configuring the rest of the properties for the SC. The ceph-rbd provider will assume defaults for the following properties for the SC:&lt;/p>
&lt;pre>&lt;code>euctl ZONE.storage.ceph
PROPERTY one.storage.cephconfigfile /etc/ceph/ceph.conf
DESCRIPTION one.storage.cephconfigfile Absolute path to Ceph configuration (ceph.conf) file. Default value is '/etc/ceph/ceph.conf'
PROPERTY one.storage.cephkeyringfile /etc/ceph/ceph.client.eucalyptus.keyring
DESCRIPTION one.storage.cephkeyringfile Absolute path to Ceph keyring (ceph.client.eucalyptus.keyring) file. Default value is '/etc/ceph/ceph.client.eucalyptus.keyring'
PROPERTY one.storage.cephsnapshotpools rbd
DESCRIPTION one.storage.cephsnapshotpools Ceph storage pool(s) made available to for EBS snapshots. Use a comma separated list for configuring multiple pools. Default value is 'rbd'
PROPERTY one.storage.cephuser eucalyptus
DESCRIPTION one.storage.cephuser Ceph username employed by operations. Default value is 'eucalyptus'
PROPERTY one.storage.cephvolumepools rbd
DESCRIPTION one.storage.cephvolumepools Ceph storage pool(s) made available to for EBS volumes. Use a comma separated list for configuring multiple pools. Default value is 'rbd'
&lt;/code>&lt;/pre>
&lt;p>The following steps are optional if the default values do not work for your cloud: To set the Ceph username (the default value for Eucalyptus is &amp;rsquo;eucalyptus&amp;rsquo;):&lt;/p>
&lt;pre>&lt;code>euctl ZONE.storage.cephuser=myuser
&lt;/code>&lt;/pre>
&lt;p>To set the absolute path to keyring file containing the key for the &amp;rsquo;eucalyptus&amp;rsquo; user (the default value is &amp;lsquo;/etc/ceph/ceph.client.eucalyptus.keyring&amp;rsquo;):&lt;/p>
&lt;pre>&lt;code>euctl ZONE.storage.cephkeyringfile='/etc/ceph/ceph.client.myuser.keyring'
&lt;/code>&lt;/pre>
&lt;p>
&lt;div class="alert alert-success" role="alert">
&lt;h4 class="alert-heading">Note&lt;/h4>
If cephuser was modified, ensure that cephkeyringfile is also updated with the location to the keyring for the specific cephuser:
&lt;/div>
To set the absolute path to ceph.conf file (default value is &amp;lsquo;/etc/ceph/ceph.conf&amp;rsquo;):&lt;/p>
&lt;pre>&lt;code>euctl ZONE.storage.cephconfigfile=/path/to/ceph.conf
&lt;/code>&lt;/pre>
&lt;p>To change the comma-delimited list of Ceph pools assigned to Eucalyptus for managing EBS volumes (default value is &amp;lsquo;rbd&amp;rsquo;) :&lt;/p>
&lt;pre>&lt;code>euctl ZONE.storage.cephvolumepools=rbd,myvolumes
&lt;/code>&lt;/pre>
&lt;p>To change the comma-delimited list of Ceph pools assigned to Eucalyptus for managing EBS snapshots (default value is &amp;lsquo;rbd&amp;rsquo;) :&lt;/p>
&lt;pre>&lt;code>euctl ZONE.storage.cephsnapshotpools=mysnapshots
&lt;/code>&lt;/pre>
&lt;p>If you want to enable snapshot deltas for your Ceph backend:
&lt;div class="alert alert-success" role="alert">
&lt;h4 class="alert-heading">Note&lt;/h4>
Snapshot deltas are supported only on Ceph-RBD.
&lt;/div>
&lt;/p>
&lt;p>
&lt;div class="alert alert-success" role="alert">
&lt;h4 class="alert-heading">Note&lt;/h4>
&lt;/div>
Verify that snapshots are enabled:&lt;/p>
&lt;pre>&lt;code>euctl ZONE.storage.shouldtransfersnapshots=true
&lt;/code>&lt;/pre>
&lt;p>Set the maximum number of deltas to be created before creating a new full snapshot:&lt;/p>
&lt;pre>&lt;code>euctl ZONE.storage.maxsnapshotdeltas=NON_ZERO_INTEGER
&lt;/code>&lt;/pre>
&lt;div class="alert alert-success" role="alert">
&lt;h4 class="alert-heading">Note&lt;/h4>
This variable applies to all Ceph volumes.
&lt;/div>
&lt;p>
&lt;div class="alert alert-success" role="alert">
&lt;h4 class="alert-heading">Note&lt;/h4>
If you need to create a non-Ceph volume from a Ceph snapshot, this value would need to be set to zero (at least temporarily).
&lt;/div>
Every NC will assume the following defaults:&lt;/p>
&lt;pre>&lt;code>CEPH_USER_NAME=&amp;quot;eucalyptus&amp;quot;
CEPH_KEYRING_PATH=&amp;quot;/etc/ceph/ceph.client.eucalyptus.keyring&amp;quot;
CEPH_CONFIG_PATH=&amp;quot;/etc/ceph/ceph.conf&amp;quot;
&lt;/code>&lt;/pre>
&lt;p>To override the above defaults, add/edit the following properties in the &lt;code>/etc/eucalyptus/eucalyptus.conf&lt;/code> on the specific NC file:&lt;/p>
&lt;pre>&lt;code>CEPH_USER_NAME=&amp;quot;ceph-username-for-use-by-this-NC&amp;quot;
CEPH_KEYRING_PATH=&amp;quot;path-to-keyring-file-for-ceph-username&amp;quot;
CEPH_CONFIG_PATH=&amp;quot;path-to-ceph.conf-file&amp;quot;
&lt;/code>&lt;/pre>
&lt;p>Repeat this step for every NC in the specific Eucalyptus zone. Your Ceph backend is now ready to use with Eucalyptus .&lt;/p></description></item><item><title>Docs: About the BROKEN State</title><link>https://www.eucastack.io/docs/install_guide/eucalyptus/configure_runtime/config_storage/config_block_storage/config_storage_broken_state/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://www.eucastack.io/docs/install_guide/eucalyptus/configure_runtime/config_storage/config_block_storage/config_storage_broken_state/</guid><description>
&lt;p>This topic describes the initial state of the Storage Controller (SC) after you have registered it with the Cloud Controller (CLC).The SC automatically goes to the &lt;code>broken&lt;/code> state after being registered with the CLC; it will remain in that state until you explicitly configure the SC by telling it which backend storage provider to use.&lt;/p>
&lt;p>You can check the state of a storage controller by running &lt;code>euserv-describe-services --expert&lt;/code> and note the state and status message of the SC(s). The output for an unconfigured SC looks something like this:&lt;/p>
&lt;pre>&lt;code>SERVICE storage ZONE1 SC71 BROKEN 37 http://192.168.51.71:8773/services/Storage arn:euca:eucalyptus:ZONE1:storage:SC71/
SERVICEEVENT 6c1f7a0a-21c9-496c-bb79-23ddd5749222 arn:euca:eucalyptus:ZONE1:storage:SC71/
SERVICEEVENT 6c1f7a0a-21c9-496c-bb79-23ddd5749222 ERROR
SERVICEEVENT 6c1f7a0a-21c9-496c-bb79-23ddd5749222 Sun Nov 18 22:11:13 PST 2012
SERVICEEVENT 6c1f7a0a-21c9-496c-bb79-23ddd5749222 SC blockstorageamanger not configured. Found empty or unset manager(unset). Legal values are: das,overlay,ceph
&lt;/code>&lt;/pre>
&lt;p>Note the error above: &lt;code>SC blockstoragemanager not configured. Found empty or unset manager(unset). Legal values are: das,overlay,ceph&lt;/code> .&lt;/p>
&lt;p>This indicates that the SC is not yet configured. It can be configured by setting the &lt;code>ZONE.storage.blockstoragemanager&lt;/code> property to &amp;lsquo;das&amp;rsquo;, &amp;lsquo;overlay&amp;rsquo;, or &amp;lsquo;ceph&amp;rsquo;.&lt;/p>
&lt;p>You can verify that the configured SC block storage manager using:&lt;/p>
&lt;pre>&lt;code>euctl ZONE.storage.blockstoragemanager
&lt;/code>&lt;/pre>
&lt;p>to show the current value.&lt;/p></description></item><item><title>Docs: Use Direct Attached Storage (JBOD)</title><link>https://www.eucastack.io/docs/install_guide/eucalyptus/configure_runtime/config_storage/config_block_storage/config_storage_das_jbod/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://www.eucastack.io/docs/install_guide/eucalyptus/configure_runtime/config_storage/config_block_storage/config_storage_das_jbod/</guid><description>
&lt;p>This topic describes how to configure the DAS-JBOD as the block storage backend provider for the Storage Controller (SC).&lt;strong>Prerequisites&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>
&lt;p>Successful completion of all the install sections prior to this section.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>The SC must be installed, registered, and running.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Direct Attached Storage requires that have enough space for locally cached snapshots.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>You must execute the steps below as a administrator.
&lt;strong>To configure DAS-JBOD block storage for the zone, run the following commands on the CLC&lt;/strong> Configure the SC to use the Direct Attached Storage for EBS.&lt;/p>
&lt;p>euctl ZONE.storage.blockstoragemanager=das&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>The output of the command should be similar to:&lt;/p>
&lt;pre>&lt;code>one.storage.blockstoragemanager=das
&lt;/code>&lt;/pre>
&lt;p>Verify that the property value is now: &amp;lsquo;das&amp;rsquo;&lt;/p>
&lt;pre>&lt;code>euctl ZONE.storage.blockstoragemanager
&lt;/code>&lt;/pre>
&lt;p>Set the DAS device name property. The device name can be either a raw device (/dev/sdX, for example), or the name of an existing Linux LVM volume group.&lt;/p>
&lt;pre>&lt;code>euctl ZONE.storage.dasdevice=DEVICE_NAME
&lt;/code>&lt;/pre>
&lt;p>For example:&lt;/p>
&lt;pre>&lt;code>euctl one.storage.dasdevice=/dev/sdb
&lt;/code>&lt;/pre>
&lt;p>Your DAS-JBOD backend is now ready to use with Eucalyptus .&lt;/p></description></item><item><title>Docs: Use the Overlay Local Filesystem</title><link>https://www.eucastack.io/docs/install_guide/eucalyptus/configure_runtime/config_storage/config_block_storage/config_storage_overlay_local/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://www.eucastack.io/docs/install_guide/eucalyptus/configure_runtime/config_storage/config_block_storage/config_storage_overlay_local/</guid><description>
&lt;p>This topic describes how to configure the local filesystem as the block storage backend provider for the Storage Controller (SC).&lt;strong>Prerequisites&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>Successful completion of all the install sections prior to this section.&lt;/li>
&lt;li>The SC must be installed, registered, and running.&lt;/li>
&lt;li>The local filesystem must have enough space to hold volumes and snapshots created in the cloud.&lt;/li>
&lt;li>You must execute the steps below as a administrator.
In this configuration the SC itself hosts the volume and snapshots for EBS and stores them as files on the local filesystem. It uses standard Linux iSCSI tools to serve the volumes to instances running on NCs.&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>To configure overlay block storage for the zone, run the following commands on the CLC&lt;/strong> Configure the SC to use the local filesystem for EBS.&lt;/p>
&lt;pre>&lt;code>euctl ZONE.storage.blockstoragemanager=overlay
&lt;/code>&lt;/pre>
&lt;p>The output of the command should be similar to:&lt;/p>
&lt;pre>&lt;code>one.storage.blockstoragemanager=overlay
&lt;/code>&lt;/pre>
&lt;p>Verify that the property value is now: &amp;lsquo;overlay&amp;rsquo;&lt;/p>
&lt;pre>&lt;code>euctl ZONE.storage.blockstoragemanager
&lt;/code>&lt;/pre>
&lt;p>Your local filesystem (overlay) backend is now ready to use with Eucalyptus .&lt;/p></description></item></channel></rss>