<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.100.1"><link rel=canonical type=text/html href=https://www.eucastack.io/docs/install_guide/eucalyptus/installing_dependencies/install_midonet/><link rel=alternate type=application/rss+xml href=https://www.eucastack.io/docs/install_guide/eucalyptus/installing_dependencies/install_midonet/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Install MidoNet | EucaStack</title><meta name=description content="Install MidoNet
Eucalyptus requires MidoNet for VPC functionality. This section describes how to install MidoNet for use with Eucalyptus.



Note â€¦"><meta property="og:title" content="Install MidoNet"><meta property="og:description" content="A Docsy example site"><meta property="og:type" content="website"><meta property="og:url" content="https://www.eucastack.io/docs/install_guide/eucalyptus/installing_dependencies/install_midonet/"><meta property="og:site_name" content="EucaStack"><meta itemprop=name content="Install MidoNet"><meta itemprop=description content="A Docsy example site"><meta name=twitter:card content="summary"><meta name=twitter:title content="Install MidoNet"><meta name=twitter:description content="A Docsy example site"><link rel=preload href=/scss/main.min.dbc832a6b41f9cb352db274e4a5e4f9087c9f9f914bcd919a25e9dad92d530f3.css as=style><link href=/scss/main.min.dbc832a6b41f9cb352db274e4a5e4f9087c9f9f914bcd919a25e9dad92d530f3.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-00000000-0','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><svg viewBox="0 0 1388.9 333.38" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g transform="translate(-136.21 41.582)"><path transform="matrix(.26458 0 0 .26458 136.21 -41.582)" d="m1616.4 487.23c-38.46.0-73.324 9.8216-104.59 29.467s-55.615 47.177-73.047 82.594c-17.155 35.14-25.732 75.123-25.732 119.95v12.451c0 66.96 19.782 120.64 59.35 161.04 39.844 40.12 91.725 60.18 155.64 60.18 37.354.0 70.971-7.3314 100.85-21.996 30.16-14.941 54.232-35.833 72.217-62.672l-54.369-51.879c-29.053 37.354-66.683 56.029-112.89 56.029-32.926.0-60.319-10.791-82.178-32.373-21.582-21.582-33.896-50.911-36.939-87.988h293.43v-40.674c0-71.387-16.741-126.59-50.221-165.6-33.203-39.014-80.378-58.52-141.53-58.52zm927.61.0c-63.086.0-112.89 20.613-149.41 61.84-36.523 40.951-54.785 95.598-54.785 163.94v10.377c0 71.663 18.399 127.83 55.199 168.51 36.8 40.674 86.605 61.01 149.41 61.01 32.373.0 62.532-7.0547 90.478-21.166 27.946-14.111 50.081-33.203 66.406-57.275 16.325-24.349 25.042-50.497 26.148-78.443h-95.045c-1.1067 21.582-9.9609 39.706-26.562 54.371-16.602 14.665-37.491 21.996-62.67 21.996-33.203.0-58.659-11.898-76.367-35.693-17.432-24.072-26.148-60.456-26.148-109.15v-16.188c.2767-48.145 9.2702-83.975 26.978-107.49 17.708-23.796 42.887-35.695 75.537-35.695 25.456.0 46.345 8.3008 62.67 24.902 16.602 16.602 25.456 37.77 26.562 63.502h95.045c-1.6602-50.635-19.368-91.448-53.125-122.44-33.48-31.266-76.921-46.898-130.32-46.898zm439.94.0c-34.587.0-65.992 6.0872-94.215 18.262-27.946 12.174-50.081 29.053-66.406 50.635-16.325 21.305-24.486 44.271-24.486 68.896h100.85c0-17.708 7.3333-32.236 21.998-43.58 14.665-11.621 33.48-17.432 56.445-17.432 26.562.0 46.345 7.0566 59.35 21.168 13.004 13.835 19.508 32.373 19.508 55.615v29.469h-61.842c-66.13.0-117.04 12.865-152.73 38.598-35.417 25.456-53.125 62.118-53.125 109.99.0 37.907 14.251 69.727 42.75 95.459s65.299 38.598 110.4 38.598c46.484.0 85.775-16.739 117.87-50.219 3.3203 19.369 7.194 33.34 11.621 41.918h102.93v-7.0547c-11.344-24.072-17.018-56.308-17.018-96.705v-202.54c-.8301-47.868-16.878-84.945-48.144-111.23-31.266-26.563-73.184-39.844-125.76-39.844zm-1099.9 8.3008v290.94c0 53.955 12.451 95.182 37.354 123.68 25.179 28.499 62.118 42.748 110.82 42.748 54.508.0 96.566-17.432 126.17-52.295l2.4903 43.994h95.045v-449.07h-100.86v322.49c-17.155 35.14-50.221 52.709-99.195 52.709-47.314.0-70.971-28.499-70.971-85.498v-289.7h-100.86zm-268.12 72.631c27.946.0 49.805 8.7168 65.576 26.148 15.772 17.155 24.765 42.611 26.978 76.367v7.4707h-192.16c4.7038-34.587 15.495-61.563 32.373-80.932 17.155-19.369 39.567-29.055 67.236-29.055zm1386.6 165.6h54.371v84.668c-8.8542 16.325-22.135 29.329-39.844 39.014-17.432 9.6842-36.109 14.527-56.031 14.527-21.582.0-38.874-5.6732-51.879-17.018-12.728-11.621-19.092-27.116-19.092-46.484.0-23.796 9.4075-42.195 28.223-55.199 18.815-13.005 46.898-19.508 84.252-19.508z" fill="#fff"/><path transform="matrix(.26458 0 0 .26458 136.21 -41.582)" d="m4889.8 307.1v637.5h100.85V798.09l44.824-46.07 133.23 192.58h116.62l-184.69-261.89 166.85-187.18h-121.19l-124.1 139.87-31.543 39.43V307.11h-100.85zm-1162.1 79.271v109.16h-73.877v74.707h73.877v254.42c0 85.498 38.737 128.25 116.21 128.25 21.305.0 43.441-3.181 66.406-9.5449v-78.027c-11.898 2.7669-23.656 4.1504-35.277 4.1504-17.432.0-29.606-3.7364-36.523-11.207-6.6406-7.7474-9.9609-20.199-9.9609-37.354v-250.68h79.272v-74.707h-79.272v-109.16h-100.86zm-296.34 100.86c-50.358.0-91.862 13.005-124.51 39.014-32.65 26.009-48.975 58.382-48.975 97.119.0 46.208 25.179 81.487 75.537 105.84 22.965 11.068 51.602 20.199 85.912 27.393 34.31 7.194 58.798 15.495 73.463 24.902 14.942 9.4076 22.412 23.103 22.412 41.088.0 16.325-6.9174 29.606-20.752 39.844-13.835 9.9609-34.033 14.941-60.596 14.941-27.392.0-49.39-6.3639-65.992-19.092-16.602-13.005-25.593-31.404-26.977-55.199h-97.949c0 26.839 8.0241 51.879 24.072 75.121 16.048 23.242 38.46 41.504 67.236 54.785s61.563 19.922 98.363 19.922c54.232.0 98.088-12.451 131.57-37.354 33.48-25.179 50.221-57.966 50.221-98.363.0-24.072-5.5338-44.548-16.602-61.426-10.791-16.878-27.532-31.266-50.221-43.164-22.412-12.174-53.402-22.551-92.969-31.129-39.567-8.8542-65.853-17.569-78.857-26.146-13.005-8.5775-19.508-20.615-19.508-36.109.0-17.155 6.9173-30.852 20.752-41.09 14.112-10.238 32.236-15.355 54.371-15.355 23.795.0 42.887 6.5013 57.275 19.506 14.388 12.728 21.582 28.776 21.582 48.145h100.86c0-42.334-16.602-76.781-49.805-103.34-32.926-26.563-76.23-39.844-129.91-39.844zm733.79.0c-34.587.0-65.99 6.0872-94.213 18.262-27.946 12.174-50.081 29.053-66.406 50.635-16.325 21.305-24.488 44.271-24.488 68.896h100.86c0-17.708 7.3313-32.236 21.996-43.58 14.665-11.621 33.48-17.432 56.445-17.432 26.562.0 46.347 7.0566 59.352 21.168 13.005 13.835 19.506 32.373 19.506 55.615v29.469h-61.84c-66.13.0-117.04 12.865-152.73 38.598-35.417 25.456-53.125 62.118-53.125 109.99.0 37.907 14.249 69.727 42.748 95.459 28.499 25.732 65.3 38.598 110.4 38.598 46.484.0 85.775-16.739 117.87-50.219 3.3202 19.369 7.194 33.34 11.621 41.918h102.93v-7.0547c-11.344-24.072-17.016-56.308-17.016-96.705v-202.54c-.83-47.868-16.878-84.945-48.144-111.23-31.266-26.563-73.186-39.844-125.76-39.844zm464.84.0c-63.086.0-112.89 20.613-149.41 61.84-36.524 40.951-54.785 95.598-54.785 163.94v10.377c0 71.663 18.401 127.83 55.201 168.51 36.8 40.674 86.605 61.01 149.41 61.01 32.373.0 62.532-7.0547 90.479-21.166 27.946-14.111 50.081-33.203 66.406-57.275 16.325-24.349 25.042-50.497 26.148-78.443h-95.045c-1.1066 21.582-9.9608 39.706-26.562 54.371-16.601 14.665-37.493 21.996-62.672 21.996-33.203.0-58.659-11.898-76.367-35.693-17.432-24.072-26.146-60.456-26.146-109.15V711.36c.2769-48.145 9.2682-83.975 26.976-107.49 17.708-23.796 42.888-35.695 75.537-35.695 25.456.0 46.347 8.3008 62.672 24.902 16.602 16.602 25.456 37.77 26.562 63.502h95.045c-1.6602-50.635-19.37-91.448-53.127-122.44-33.48-31.266-76.921-46.898-130.32-46.898zm-446.17 246.53h54.369v84.668c-8.8541 16.325-22.135 29.329-39.844 39.014-17.432 9.6842-36.107 14.527-56.029 14.527-21.582.0-38.876-5.6732-51.881-17.018-12.728-11.621-19.092-27.116-19.092-46.484.0-23.796 9.4075-42.195 28.223-55.199 18.815-13.005 46.9-19.508 84.254-19.508z" fill="#8bc13a"/></g><g transform="translate(9.5814 7.9375)"><path transform="scale(.26458)" d="m560.34-22.102-558.42 231.31c-21.06 8.7235-38.133 34.275-38.133 57.07v688.09c0 11.398 8.5364 24.173 19.067 28.535l577.49 239.2c10.53 4.3617 27.603 4.3617 38.133.0l558.42-231.31c21.06-8.7235 38.133-34.275 38.133-57.07v-688.09c0-11.398-8.5364-24.173-19.067-28.535l-577.49-239.2c-10.53-4.3617-27.603-4.3617-38.133.0z" fill="#fff"/></g><g transform="translate(-1331.7 150.96)"><g transform="translate(-.13227 -.14313)"><path transform="scale(.26458)" d="m5651.4-517.82c-4.3107-.18795-9.0505.68347-14.025 2.7441l-507.35 210.15c-19.9 8.2427-36.031 32.385-36.031 53.924v642c0 11.537 4.7163 19.84 12.072 23.934v.06641l1.0156.41992c1.147.55934 2.2859 1.1151 3.5469 1.4688l116.15 48.111v-90l410.6-170.08c19.9-8.2427 36.031-32.385 36.031-53.924v-581l108.64 45v-80l-120.26-49.812c-3.0346-1.7765-6.523-2.8394-10.385-3.0078z" fill="#8bc13a"/><path d="m1379.7 116.68V-53.18c0-5.6989 4.2682-12.087 9.5333-14.268l134.24-55.602c5.2651-2.1809 9.5333.67105 9.5333 6.3699v169.86c0 5.6989-4.2682 12.087-9.5333 14.268l-134.24 55.602c-5.2651 2.1809-9.5333-.67105-9.5333-6.3699z" fill="#003556"/><path transform="scale(.26458)" d="m5856.6-432.82c-4.3107-.18795-9.0505.68347-14.025 2.7441l-507.35 210.15c-19.9 8.2427-36.031 32.385-36.031 53.924v642c0 11.536 4.7155 19.84 12.07 23.934v.06641l1.0352.42969c1.1397.55448 2.2713 1.1073 3.5234 1.459l116.15 48.111v-90l410.6-170.08c19.9-8.2427 36.031-32.385 36.031-53.924v-561l108.64 45v-1e2l-120.26-49.812c-3.0347-1.7765-6.525-2.8394-10.387-3.0078z" fill="#8bc13a"/><path d="m1434 139.17V-30.69c0-5.6989 4.2682-12.087 9.5333-14.268l134.24-55.602c5.2651-2.1809 9.5333.67105 9.5333 6.3699v169.86c0 5.6989-4.2682 12.087-9.5333 14.268l-134.24 55.602c-5.2651 2.1809-9.5333-.67105-9.5333-6.3699z" fill="#003556"/><path transform="scale(.26458)" d="m6061.8-347.82c-4.3107-.18795-9.0505.68347-14.025 2.7441l-507.35 210.15c-19.9 8.2427-36.031 32.385-36.031 53.924v642c1e-4 11.537 4.7163 19.84 12.072 23.934v.06641l1.0156.41992c1.147.55934 2.2859 1.1151 3.5469 1.4688l116.15 48.111v-90l410.6-170.08c19.9-8.2427 36.031-32.385 36.031-53.924v-561l108.64 45v-1e2l-120.25-49.811c-3.036-1.7784-6.5287-2.8413-10.393-3.0098z" fill="#8bc13a"/><path d="m1488.3 161.66v-169.86c0-5.6989 4.2682-12.087 9.5333-14.268l134.24-55.602c5.2651-2.1809 9.5333.67105 9.5333 6.3699v169.86c0 5.6989-4.2682 12.087-9.5333 14.268l-134.24 55.602c-5.2651 2.1809-9.5333-.67105-9.5333-6.3699z" fill="#003556"/><path d="m1520.2-14.532 89.523-37.082c5.2651-2.1809 9.5333.67105 9.5333 6.3699v135.47c0 5.6989-4.2682 12.087-9.5333 14.268l-89.523 37.082c-5.2651 2.1809-9.5333-.67104-9.5333-6.3699v-135.47c0-5.6989 4.2682-12.087 9.5333-14.268z" fill="#fff"/><path d="m1596.9 85.99-63.876 26.458-1e-4-46.302 49.504-20.505V29.766l-49.504 20.505 1e-4-46.302 63.876-26.458z" fill="#8bc13a"/></g></g></svg></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/docs/><i class='fas fa-book'></i><span class=active>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/blog/><i class='fas fa-rss'></i><span>Blog</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community/><i class='fas fa-users'></i><span>Community</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this siteâ€¦" aria-label="Search this siteâ€¦" autocomplete=off></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/docs/install_guide/eucalyptus/installing_dependencies/install_midonet/>Return to the regular view of this page</a>.</p></div><h1 class=title>Install MidoNet</h1><ul><li>1: <a href=#pg-5bb925d2c296c64558ffa27487ecb1a6>Prerequisites</a></li><ul></ul><li>2: <a href=#pg-5002f76f28ab24c82d06601830a8d53a>MidoNet Component Topology</a></li><ul></ul><li>3: <a href=#pg-b670fbdd76e9d8c060bb6a50218a5226>Install MidoNet for Eucalyptus</a></li><ul></ul></ul><div class=content><h1 id=install-midonet>Install MidoNet</h1><p>Eucalyptus requires MidoNet for VPC functionality. This section describes how to install MidoNet for use with Eucalyptus.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>If you are not using VPC with Eucalyptus, you do not need to install MidoNet. See <a href=https://www.eucastack.io/docs/install_guide/eucalyptus/configuring_euca/configure_network_modes/nw_edge/>Configure EDGE Network Mode</a>.</div><p><strong>Before you begin:</strong></p><ul><li>See the <a href=https://www.eucastack.io/docs/install_guide/eucalyptus/planning/planning_networking_modes/>Planning your Network</a> section of the guide to create a map of how MidoNet / will be deployed into your environment.</li><li>See the <a href=https://docs.midonet.org/docs/latest-en/quick-start-guide/rhel-7_newton-rdo/content/_midonet_installation.html>MidoNet Installation Guide</a> to become familiar with the general MidoNet installation procedure and concepts.</li></ul></div></div><div class=td-content style=page-break-before:always><h1 id=pg-5bb925d2c296c64558ffa27487ecb1a6>1 - Prerequisites</h1><p>This topic discusses the prerequisites for installing MidoNet 5.2.</p><p>You need to configure software repositories and install Network State Database (NSDB) services: ZooKeeper and Cassandra.</p><h2 id=repository-access>Repository Access</h2><p>In order to use MidoNet with Eucalyptus you need to configure the MidoNet repositories.</p><p>Create <code>/etc/yum.repos.d/midonet.repo</code> and <code>/etc/yum.repos.d/midonet-misc.repo</code> on all host machines that will run MidoNet components including ZooKeeper and Cassandra. For example:</p><pre><code>[midonet]
name=MidoNet
baseurl=http://builds.midonet.org/midonet-5.2/stable/el7/
enabled=1
gpgcheck=1
gpgkey=https://builds.midonet.org/midorepo.key
</code></pre><p>and:</p><pre><code>[midonet-misc]
name=MidoNet 3rd Party Tools and Libraries
baseurl=http://builds.midonet.org/misc/stable/el7/
enabled=1
gpgcheck=1
gpgkey=https://builds.midonet.org/midorepo.key
</code></pre><p>See <a href=https://docs.midonet.org/docs/latest-en/quick-start-guide/rhel-7_newton-rdo/content/_repository_configuration.html>MidoNet Repository Configuration</a>.</p><h2 id=zookeeper>ZooKeeper</h2><p>MidoNet uses Apache ZooKeeper to store critical path data about the virtual and physical network topology.</p><p>For a simple single-server installation, install ZooKeeper on any server that is IP accessible from all Midolman agents (for example: on the CLC host machine itself). You can also cluster ZooKeeper for fault tolerance. See <a href=https://docs.midonet.org/docs/latest-en/quick-start-guide/rhel-7_newton-rdo/content/_zookeeper_installation.html>MidoNet NSDB ZooKeeper Installation</a>.</p><p>Enable and start the ZooKeeper service before installing the other MidoNet services.</p><h2 id=cassandra>Cassandra</h2><p>MidoNet uses Apache Cassandra to store flow state information.</p><p>For a simple single-server installation, install Cassandra on any server that is IP accessible from all Midolman agents (for example: on the CLC host machine itself). You can also cluster Cassandra for fault tolerance. See <a href=https://docs.midonet.org/docs/latest-en/quick-start-guide/rhel-7_newton-rdo/content/_cassandra_installation.html>MidoNet NSDB Cassandra Installation</a>.</p><p>Enable and start the Cassandra service before installing the other MidoNet services.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-5002f76f28ab24c82d06601830a8d53a>2 - MidoNet Component Topology</h1><p>This topic lists topology recommendations for installing MidoNet.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>See [Understanding VPCMIDO and MidoNet]https://www.eucastack.io/docs/install_guide/eucalyptus/planning/planning_networking_modes/preparing_vpc_midonet/ for more information on MidoNet.</div><ul><li>The midonet-api must run co-located with the Cloud Controller (CLC).</li><li>Each Node Controller (NC) must run a Midolman agent.</li><li>The Cloud Controller (CLC) must run a Midolman agent.</li><li>It is recommended that your User Facing Services (UFS) host be used as the MidoNet Gateway (i.e., running a Midolman agent) when configuring .</li><li>The network interface(s) specified as * (in the configuration file) should be dedicated for /MidoNet (for configuration/operation/use).</li><li>/MidoNet expects exclusive use of the network interface specified in .</li><li>If the main network interface of a server is specified in , most likely the connectivity to that server will be lost once is deployed.</li></ul><h2 id=network-yaml-example>Network YAML Example</h2><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>The older (JSON) network configuration format is still accepted, however the YAML format is recommended.</div><p>The following Eucalyptus network YAML file shows a sample VPCMIDO mode configuration:</p><pre><code>Mode: VPCMIDO

InstanceDnsServers:
- &quot;10.10.10.1&quot;

PublicIps:
- &quot;1.A.B.1-1.A.B.255&quot;

Mido:
  Gateways:
  - ExternalCidr: &quot;172.19.0.0/30&quot;
    ExternalDevice: &quot;veth1&quot;
    ExternalIp: &quot;172.19.0.2&quot;
    ExternalRouterIp: &quot;172.19.0.1&quot;
    Ip: &quot;10.10.10.1&quot;
</code></pre><p>Where <code>1.A.B.1-1.A.B.255</code> represents the public IP address range for your cloud.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-b670fbdd76e9d8c060bb6a50218a5226>3 - Install MidoNet for Eucalyptus</h1><p>This topic shows how to install MidoNet for use in your Eucalyptus cloud.</p><h2 id=install-the-midonet-cluster-on-the-cloud-controller-clc>Install the MidoNet Cluster on the Cloud Controller (CLC)</h2><p>This topic describes how to install the MidoNet Cluster. MidoNet Cluster services provide a means to manage MidoNet functions that MidoNet agents (Midolman) are unable to perform on their own. MidoNet Cluster services include state synchronization of VxLAN gateways and the MidoNet REST API. A MidoNet v5 deployment requires at least one MidoNet cluster node, and it must be co-located on the CLC host machine in Eucalyptus deployments. For security reasons, the MidoNet REST API is accessed only on the CLC (localhost interface).</p><p><strong>To install the MidoNet Cluster on the CLC</strong></p><p>Add the MidoNet repo file as described in <a href=https://www.eucastack.io/docs/install_guide/eucalyptus/installing_dependencies/install_midonet/install_midonet_prereqs/>Prerequisites</a> . Install MidoNet Cluster packages.</p><pre><code>yum install midonet-cluster python-midonetclient
</code></pre><p>Edit the <em>/etc/midonet/midonet.conf</em> file to set the ZooKeeper host IP(s). Replace ZOOKEEPER_HOST_IP in the following example:</p><pre><code>[zookeeper]
zookeeper_hosts = ZOOKEEPER_HOST_IP:2181 
</code></pre><p>Configure cloud-wide access to the NSDB services:</p><pre><code>cat &lt;&lt; EOF | mn-conf set -t default
zookeeper {
  zookeeper_hosts = â€œZOOKEEPER_HOST:2181&quot;
}

cassandra {
  servers = â€œCASSANDRA_HOST&quot;
}
EOF
</code></pre><p>Enable and start the MidoNet Cluster:</p><pre><code>systemctl enable midonet-cluster.service
systemctl start midonet-cluster.service
</code></pre><p>Set the midonet-api end point:</p><pre><code>mn-conf set cluster.rest_api.http_port=8080
mn-conf set cluster.rest_api.http_host=&quot;127.0.0.1&quot;
</code></pre><p>Restart the Midonet Cluster so the rest_api parameters take effect:</p><pre><code>systemctl restart midonet-cluster.service
</code></pre><h2 id=install-midolman-on-components>Install Midolman on components</h2><p>This topic describes how to install the Midolman agent. Midolman is the MidoNet Agent, which is a daemon that runs on all hosts where traffic enters and leaves MidoNet. The Midolman agent is required on the Cloud Controller (CLC), Node Controllers (NCs), and any host that is a MidoNet Gateway node (e.g., UFS).</p><p><strong>To install Midolman agent</strong></p><p>Edit the <code>/etc/midolman/midolman.conf</code> file to set the ZooKeeper host IP(s). Replace ZOOKEEPER_HOST_IP in the following example:</p><pre><code>[zookeeper]
zookeeper_hosts = ZOOKEEPER_HOST_IP:2181
</code></pre><p>Enable and start Midolman:</p><pre><code>systemctl enable midolman.service
systemctl start midolman.service
</code></pre><p>Configure a Midolman resource usage template. For large Eucalyptus clouds, use the agent-compute-large template. For standard (small or medium) Eucalyptus clouds, use the default template. For gateway nodes, use the agent-gateway templates.</p><div class="alert alert-success" role=alert><h4 class=alert-heading>Note</h4>For production environments, large templates are recommended.</div><p>See the <a href=https://docs.midonet.org/docs/v5.2/en/quick-start-guide/rhel-7_mitaka-rdo/content/_midolman_installation.html>Midolman Installation documentation</a> for more information.</p><p>Choose the Midolman resource usage template name, based on the size and type of installation:</p><pre><code>agent-compute-large
agent-compute-medium
agent-gateway-large
agent-gateway-medium
default
</code></pre><p>Run this command, replacing <code>TEMPLATE_NAME</code> with your chosen template:</p><pre><code>mn-conf template-set -h local -t TEMPLATE_NAME
</code></pre><h2 id=create-a-tunnel-zone-in-midonet-and-add-hosts>Create a tunnel zone in MidoNet and add hosts</h2><p>This topic describes how to create a MidoNet tunnel zone. In MidoNet, a tunnel zone is an isolation zone for hosts. Physical hosts that are members of a given tunnel zone communicate directly with one another and establish network tunnels as needed, and on demand. These network tunnels are used to transport overlay traffic (e.g., inter-VM communication) and isolate the underlay physical network communication (i.e., inter-physical hosts communication). On a Eucalyptus deployment, one MidoNet tunnel zone is expected with the IP address on the physical network designated to carry VM traffic being used when configuring its members. Eucalyptus accepts the following tunnel zone names:</p><ul><li>eucatz</li><li>euca-tz</li><li>midotz</li><li>mido-tz</li></ul><p>For more information, see <a href=https://docs.midonet.org/docs/v5.2/en/operations-guide/content/tunnel_zones.html>What are Tunnel Zones?</a></p><p><strong>To create a tunnel zone in MidoNet</strong></p><p>Log into the MidoNet shell. For example:</p><pre><code>midonet-cli -A --midonet-url=http://127.0.0.1:8080/midonet-api
</code></pre><p>Create a GRE tunnel zone:</p><pre><code>[root@clcfrontend mido-docs]# midonet-cli -A --midonet-url=http://127.0.0.1:8080/midonet-api
midonet&gt; tunnel-zone add name eucatz type gre
midonet&gt; tunnel-zone list
tzone tzone0 name eucatz type gre
midonet&gt; host list
host host0 name node1 alive true
host host1 name clcfrontend alive true
host host2 name node2 alive true
</code></pre><p>You should see a host listed for each of your Node Controllers and for your User Facing Service host; if not, check the <code>/var/log/midolman/midolman.log</code> log file on the missing hosts to ensure there are no error messages.</p><p>After verifying all your hosts are listed, add each host to your tunnel zone as follows. Replace HOST_N_IP with the IP of your Node Controller or User Facing Service host that you used to register the component with Eucalyptus :</p><pre><code>midonet&gt; tunnel-zone tzone0 add member host host0 address HOST_0_IP
midonet&gt; tunnel-zone tzone0 add member host host1 address HOST_1_IP
midonet&gt; tunnel-zone tzone0 add member host host2 address HOST_2_IP
</code></pre><p>You are now ready to install and configure Eucalyptus to use this MidoNet installation.</p><h2 id=additional-zookeeper-configuration>Additional ZooKeeper Configuration</h2><p>Ongoing data directory cleanup is required for ZooKeeper. The following parameters should be added in <em>/etc/zookeeper/zoo.cfg</em> for automatic purging of the snapshots and corresponding transaction logs:</p><pre><code>autopurge.snapRetainCount=3  # The number of snapshots to retain in dataDir
autopurge.purgeInterval=1  # Purge task interval in hours
</code></pre><p>For more information, see <a href=http://zookeeper.apache.org/doc/r3.4.8/zookeeperAdmin.html#Ongoing+Data+Directory+Cleanup>ZooKeeper Admin Guide, Ongoing Data Directory Cleanup</a>.</p></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Community forums" aria-label="Community forums"><a class=text-white target=_blank rel=noopener href=https://github.com/orgs/eucastack/discussions aria-label="Community forums"><i class="fa fa-comments"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank rel=noopener href=https://twitter.com/eucastack aria-label=Twitter><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Stack Overflow" aria-label="Stack Overflow"><a class=text-white target=_blank rel=noopener href=https://stackoverflow.com/questions/tagged/eucastack aria-label="Stack Overflow"><i class="fab fa-stack-overflow"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/eucastack aria-label=GitHub><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Discord aria-label=Discord><a class=text-white target=_blank rel=noopener href=https://discord.gg/rZfweFv2dM aria-label=Discord><i class="fab fa-discord"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2022 EucaStack All Rights Reserved</small>
<small class=ml-1><a href=https://policies.google.com/privacy target=_blank rel=noopener>Privacy Policy</a></small></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA==" crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script>
<script src=/js/main.min.c5fabd07bf74a61523c3b0406527237220f5cc80a23a9ae709f194b46828e68f.js integrity="sha256-xfq9B790phUjw7BAZScjciD1zICiOprnCfGUtGgo5o8=" crossorigin=anonymous></script></body></html>